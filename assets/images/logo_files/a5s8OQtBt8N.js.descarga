if (self.CavalryLogger) { CavalryLogger.start_js(["vGedu"]); }

__d("MessengerPlatformBubbleAspectRatio",[],(function a(b,c,d,e,f,g){f.exports={IMAGE_ASPECT_RATIO_HORIZONTAL:1.91,IMAGE_ASPECT_RATIO_SQUARE:1}}),null);
__d("PageProductTransactionPaymentTypeDataKey",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ACCOUNT_NAME:"account_name",ACCOUNT_NO:"account_no"})}),null);
__d("XOmnipickerPhotoUploadController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/omnipicker/upload/file/photo/",{source:{type:"Enum",required:true,enumType:0},waterfall_id:{type:"String"},vault_fbid:{type:"String"}})}),null);
__d("CommerceContactMerchantManualPaymentSection.react",["cx","fbt","FBPaymentsStringHelper","FileInput.react","FileInputUploader","Image.react","PageProductTransactionPaymentTypeDataKey","React","ReactDOM","XOmnipickerPhotoUploadController","XUIButton.react","XUIGrayText.react","XUISpinner.react","XUIText.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=29,n=120;j=babelHelpers.inherits(o,c("React").Component);k=j&&j.prototype;function o(p){__p&&__p();k.constructor.call(this,p);this.$CommerceContactMerchantManualPaymentSection6=function(event,q){var r=q.response.getPayload()[0];this.setState({photoUploading:false,receiptPhotoID:r.fbid,receiptPhotoURL:r.src});this.props.onReceiptUpdated(r.fbid,r.src)}.bind(this);this.$CommerceContactMerchantManualPaymentSection2=function(q){var r=c("XOmnipickerPhotoUploadController").getURIBuilder().setEnum("source",m).getURI(),s=this.refs.fileInput,t=new(c("FileInputUploader"))(c("ReactDOM").findDOMNode(s)).setURI(r);t.subscribe("failure",this.$CommerceContactMerchantManualPaymentSection5);t.subscribe("success",this.$CommerceContactMerchantManualPaymentSection6);t.send();s.getFileInput().clear();this.setState({photoUploading:true})}.bind(this);this.state={receiptPhotoID:null,receiptPhotoURL:null,photoUploading:false}}o.prototype.render=function(){var p=this.props.paymentOptionDetails,q=p[c("PageProductTransactionPaymentTypeDataKey").ACCOUNT_NAME],r=p[c("PageProductTransactionPaymentTypeDataKey").ACCOUNT_NO],s=c("FBPaymentsStringHelper").stringToMarkup(p.description),t=r==null?null:c("React").createElement(c("XUIGrayText.react"),{display:"block",shade:"dark",size:"meta1",className:"_3-8m"},i._("N\u00famero de cuenta"),": ",r),u=q==null?null:c("React").createElement(c("XUIGrayText.react"),{display:"block",shade:"dark",size:"meta1",className:"_3-8m"},i._("Nombre de la cuenta"),": ",q);return c("React").createElement("div",{className:"_2ph-"},c("React").createElement(c("XUIGrayText.react"),{display:"block",shade:"light",size:"meta1"},this.$CommerceContactMerchantManualPaymentSection1()),c("React").createElement(c("XUIText.react"),{display:"block",weight:"bold",size:"meta1",className:"_3-8m"},this.props.paymentOptionDetails.name),t,u,c("React").createElement(c("XUIGrayText.react"),{display:"block",shade:"dark",size:"meta1",className:"_3-8m"},s),c("React").createElement(c("XUIGrayText.react"),{className:"_3-97",display:"block",size:"meta1"},i._("Pedido n.\u00ba {order_number}",[i.param("order_number",this.props.invoiceID)])),c("React").createElement("div",null,c("React").createElement(c("XUISpinner.react"),{className:"_3-9c"+(!this.state.photoUploading?" hidden_elem":"")}),c("React").createElement("div",{className:(this.state.photoUploading?"hidden_elem":"")+" _3-96"},c("React").createElement(c("FileInput.react"),{name:"file",multiple:false,ref:"fileInput",accept:"image/*",onChange:this.$CommerceContactMerchantManualPaymentSection2},c("React").createElement(c("XUIButton.react"),{href:{url:"#"},label:this.$CommerceContactMerchantManualPaymentSection3()})))),this.$CommerceContactMerchantManualPaymentSection4())};o.prototype.$CommerceContactMerchantManualPaymentSection4=function(){if(!this.state.receiptPhotoURL)return null;return c("React").createElement(c("Image.react"),{src:this.state.receiptPhotoURL,height:n,width:n})};o.prototype.$CommerceContactMerchantManualPaymentSection3=function(){return this.state.receiptPhotoID?i._("Adjuntar otro recibo"):i._("Adjuntar recibo")};o.prototype.$CommerceContactMerchantManualPaymentSection1=function(){return i._("Instrucciones de pago del vendedor")};o.prototype.$CommerceContactMerchantManualPaymentSection5=function(p){};o.propTypes={paymentOptionDetails:l.object.isRequired,invoiceID:l.string.isRequired,onReceiptUpdated:l.func.isRequired};f.exports=o}),null);
__d("MercuryAttachmentConstants",[],(function a(b,c,d,e,f,g){var h=Object.freeze({SIDE_LENGTH:9});f.exports=h}),null);
__d("FBAccordion.react",["cx","invariant","React","joinClasses"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(){__p&&__p();var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.$FBAccordion1=function(r){__p&&__p();var s=0,t=this.state?this.state.expandedSectionKey:null,u=null;c("React").Children.forEach(r.children,function(v,w){var x=v.props.expanded;u=t===w?t:u;if(x&&t===null){s===0||i(0);s++;u=w}else if(u===null)u=w});return u}.bind(this),this.$FBAccordion2=function(r){if(this.state.expandedSectionKey!==r)this.setState({expandedSectionKey:r})}.bind(this),this.state={expandedSectionKey:this.$FBAccordion1(this.props)},n}l.prototype.componentWillReceiveProps=function(m){"use strict";var n=this.$FBAccordion1(m);if(this.state.expandedSectionKey!==n)this.setState({expandedSectionKey:n})};l.prototype.render=function(){"use strict";var m=c("React").Children.map(this.props.children,function(n,o){return c("React").cloneElement(n,{isExpanded:this.state.expandedSectionKey===o,onSectionClick:this.$FBAccordion2,sectionKey:o})}.bind(this));return c("React").createElement("div",babelHelpers["extends"]({},this.props,{className:c("joinClasses")(this.props.className,"_5ygd")}),m)};f.exports=l}),null);
__d("FBAccordionSection.react",["cx","React","ShimButton.react","emptyFunction"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.onClick=function(){this.props.onSectionClick(this.props.sectionKey);this.props.onClick(this.props.sectionKey)}.bind(this),n}l.prototype.render=function(){"use strict";var m=this.props.maxHeight||"100%";return c("React").createElement("div",{className:"_4r-a"+(this.props.isExpanded?" _3uxn":"")},c("React").createElement(c("ShimButton.react"),{className:"_5yg8",onClick:this.onClick},this.props.header),c("React").createElement("div",{className:"_1flr",style:{maxHeight:this.props.isExpanded?m:0}},this.props.children))};l.propTypes={expanded:k.bool,header:k.node.isRequired,maxHeight:k.number,onClick:k.func};l.defaultProps={expanded:false,onClick:c("emptyFunction")};f.exports=l}),null);
__d("FBButtonMenuCombo.react",["invariant","FBActionSelector.react","React","Tooltip","XUIButton.react","XUIButtonGroup.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k,l,m=c("FBActionSelector.react").Option,n=c("React").PropTypes;i=babelHelpers.inherits(o,c("React").PureComponent);j=i&&i.prototype;function o(){__p&&__p();var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.$FBButtonMenuCombo1=function(){__p&&__p();var u=[],v=[];c("React").Children.forEach(this.props.children,function(w,x){w.type.__FBButtonMenuComboItem__||h(0);if(x<this.props.numberOfButtons){var y=this.props.useImageOnlyButtons?null:w.props.label;u.push(c("React").createElement(c("XUIButton.react"),babelHelpers["extends"]({},c("Tooltip").propsFor(w.props.tooltip),{"data-testid":w.props["data-testid"],"data-tooltip-alignh":this.props.tooltipAlignH,"data-tooltip-position":this.props.tooltipPosition,disabled:this.props.disabled||w.props.disabled,image:w.props.image,key:w.props.value,label:y,onClick:function(){return this.props.onClick(w.props.value)}.bind(this),size:this.props.size})))}else v.push(c("React").createElement(m,babelHelpers["extends"]({},c("Tooltip").propsFor(w.props.tooltip),{"data-tooltip-alignh":this.props.tooltipAlignH,"data-tooltip-position":this.props.tooltipPosition,disabled:this.props.disabled||w.props.disabled,key:w.props.value,value:w.props.value}),w.props.label))}.bind(this));return{buttons:u,menuItems:v}}.bind(this),q}o.prototype.render=function(){var p=this.$FBButtonMenuCombo1(),q=p.buttons,r=p.menuItems,s=null;if(r.length>0)s=c("React").createElement(c("FBActionSelector.react"),{alignment:"right",disabled:this.props.disabled,onAction:this.props.onClick,size:this.props.size},r);return c("React").createElement(c("XUIButtonGroup.react"),{className:"uiContextualLayerParent"},q,s)};o.__FBButtonMenuCombo__=true;o.propTypes={disabled:n.bool,numberOfButtons:n.number,onClick:n.func.isRequired,size:n.oneOf(["small","medium","large","xlarge","xxlarge"]),tooltipPosition:n.oneOf(["above","below","left","right"]),tooltipAlignH:n.oneOf(["left","right","center"]),useImageOnlyButtons:n.bool};o.defaultProps={numberOfButtons:1,size:"medium"};o.Item=(l=k=function(){__p&&__p();var p,q;p=babelHelpers.inherits(r,c("React").PureComponent);q=p&&p.prototype;r.prototype.render=function(){"use strict";return null};function r(){"use strict";p.apply(this,arguments)}return r}(),k.__FBButtonMenuComboItem__=true,k.propTypes={disabled:n.bool,image:n.element,label:n.string.isRequired,tooltip:n.string,value:n.string.isRequired},l);f.exports=o}),null);
__d("FBPaymentsPaymentMethodShape_DEPRECATED",["FBPaymentsMethodType","React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=h.shape({title:h.string,type:h.oneOf(Object.values(c("FBPaymentsMethodType"))).isRequired});f.exports=i}),null);
__d("FBPaymentsChoosePaymentMethodForm_DEPRECATED.react",["cx","fbt","FBAccordion.react","FBAccordionSection.react","FBPaymentsBankSelector_DEPRECATED.react","FBPaymentsCreditCardForm_DEPRECATED.react","FBPaymentsMethodType","FBPaymentsPaymentMethodShape_DEPRECATED","Link.react","P2PCreditCardDetails.react","P2PLinkConstants","P2PText.react","React","XUIRadioList.react","emptyFunction","setImmediate"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("XUIRadioList.react").Item,m=c("React").PropTypes;j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(o){__p&&__p();k.constructor.call(this,o);this.handleBankSelected=function(p){this.props.onPaymentMethodConfigured({bank:p,isValid:!!p,type:c("FBPaymentsMethodType").NET_BANKING})}.bind(this);this.handleCreditCardFormValidation=function(p,q){this.props.onPaymentMethodConfigured({isValid:p,formData:q,type:c("FBPaymentsMethodType").NEW_CREDIT_CARD})}.bind(this);this.renderPaymentMethodItem=function(p,q){__p&&__p();var r=null,s=null;switch(p.type){case c("FBPaymentsMethodType").GENERIC_CARD:r=c("React").createElement(c("P2PCreditCardDetails.react"),{creditCard:p.creditCard});break;case c("FBPaymentsMethodType").NEW_CREDIT_CARD:r=i._("Tarjeta de cr\u00e9dito o d\u00e9bito");s=this.renderCreditCardFormSection(q);break;case c("FBPaymentsMethodType").NET_BANKING:r=i._("Banca por internet");s=this.renderBankSelectorSection(p);break;case c("FBPaymentsMethodType").PAY_OVER_COUNTER:r=i._("Pago en la tienda");break;case c("FBPaymentsMethodType").MANUAL_TRANSFER:r=p.title;break;default:r=p.title?p.title:p.type;s=c("React").createElement(c("P2PText.react"),{type:"primary"},"Expanded content for ",r);break}s=s?c("React").createElement("div",{className:"_51c-"},s):null;var t=c("React").createElement(l,{className:"_51c_",selectedValue:this.state.selectedKey,value:q},c("React").createElement(c("P2PText.react"),{type:"primary"},r));return c("React").createElement(c("FBAccordionSection.react"),{header:t,key:q,onClick:this.onSectionClick.bind(this)},s)}.bind(this);this.state={selectedKey:0}}n.prototype.componentWillMount=function(){c("setImmediate")(function(){return this.onSectionClick(this.state.selectedKey)}.bind(this))};n.prototype.onSectionClick=function(o){__p&&__p();this.setState({selectedKey:o});var p=this.props.paymentMethods[o];this.props.onPaymentMethodSelected(p);switch(p.type){case c("FBPaymentsMethodType").PAY_OVER_COUNTER:this.props.onPaymentMethodConfigured({isValid:true,type:p.type});break;case c("FBPaymentsMethodType").MANUAL_TRANSFER:var q=p.manual_transfer_info&&p.manual_transfer_info.id;this.props.onPaymentMethodConfigured({isValid:true,type:p.type,optionId:q});break;case c("FBPaymentsMethodType").GENERIC_CARD:this.props.onPaymentMethodConfigured({isValid:true,creditCard:p.creditCard,type:p.type});break}};n.prototype.getSections=function(){return this.props.paymentMethods.map(this.renderPaymentMethodItem,this)};n.prototype.renderCreditCardFormSection=function(o){if(o!==this.state.selectedKey)return null;return c("React").createElement("div",null,c("React").createElement(c("FBPaymentsCreditCardForm_DEPRECATED.react"),{onValidation:this.handleCreditCardFormValidation,saveErrors:this.props.saveErrors,showIcons:false,showSecondaryIcons:true,showZipCodeField:false,useGutters:true}),c("React").createElement(c("P2PText.react"),{className:"_3-8y",type:"secondary"},i._("Tu informaci\u00f3n de pago se guardar\u00e1 de forma segura. {Link with text that goes to learn more page}",[i.param("Link with text that goes to learn more page",c("React").createElement(c("Link.react"),{href:c("P2PLinkConstants").securePayInfoLearnMoreURI,target:"_blank"},i._("M\u00e1s informaci\u00f3n")))])))};n.prototype.renderBankSelectorSection=function(o){return c("React").createElement(c("FBPaymentsBankSelector_DEPRECATED.react"),{banks:o.banks,onBankSelected:this.handleBankSelected})};n.prototype.render=function(){return c("React").createElement("ul",{className:"_51d0"},c("React").createElement(c("FBAccordion.react"),null,this.getSections()))};n.propTypes={onPaymentMethodConfigured:m.func.isRequired,onPaymentMethodSelected:m.func.isRequired,paymentMethods:m.arrayOf(c("FBPaymentsPaymentMethodShape_DEPRECATED")).isRequired,saveErrors:m.object};n.defaultProps={onPaymentMethodConfigured:c("emptyFunction")};f.exports=n}),null);
__d("FBPaymentsLegalDisclaimer_DEPRECATED.react",["fbt","FBPaymentsLinkHelper","FBPaymentsMethodType","Link.react","P2PText.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(m){j.constructor.call(this,m)}l.prototype.getLegalDisclaimerText=function(){var m=c("FBPaymentsLinkHelper").getPayTermsAndPoliciesURI(this.props.paymentType),n=h._("Al hacer clic en \"Finalizar la compra\", aceptas las {=terms and policies} de Facebook y 2C2P",[h.param("=terms and policies",c("React").createElement(c("Link.react"),{href:m,target:"_blank"},"terms and policies"))]),o=h._("Al hacer clic en \"Pagar\", aceptas las {=terms and policies} de Facebook y 2C2P",[h.param("=terms and policies",c("React").createElement(c("Link.react"),{href:m,target:"_blank"},"terms and policies"))]),p=h._("Al hacer clic en \"Iniciar sesi\u00f3n y pagar\", aceptas las {=terms and policies} de Facebook y 2C2P",[h.param("=terms and policies",c("React").createElement(c("Link.react"),{href:m,target:"_blank"},"terms and policies"))]),q=h._("Al hacer clic en \"Seguir y pagar\" aceptas las {=terms and policies} de Facebook y 2C2P",[h.param("=terms and policies",c("React").createElement(c("Link.react"),{href:m,target:"_blank"},"terms and policies"))]);switch(this.props.paymentMethodType){case c("FBPaymentsMethodType").GENERIC_CARD:return o;case c("FBPaymentsMethodType").NET_BANKING:return p;case c("FBPaymentsMethodType").PAY_OVER_COUNTER:return q;case c("FBPaymentsMethodType").MANUAL_TRANSFER:return n;default:return null}};l.prototype.render=function(){return c("React").createElement(c("P2PText.react"),{type:"secondary"},this.getLegalDisclaimerText())};l.propTypes={paymentMethodType:k.string.isRequired,paymentType:k.string.isRequired};l.defaultProps={paymentType:""};f.exports=l}),null);
__d("FBPaymentsCreditCardVerificationDialog_DEPRECATED.react",["cx","fbt","CreditCardFormParam","FBPaymentsCreditCardVerificationForm_DEPRECATED.react","P2PButton.react","P2PCreditCard","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PText.react","PaymentMethodUtils","React","emptyFunction"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={cscInput:null,isValid:false},this.handleValidation=function(s,t){this.setState({cscInput:t[c("CreditCardFormParam").CSC],isValid:s})}.bind(this),this.handleConfirmClick=function(){this.props.onConfirm(this.state.cscInput)}.bind(this),this.getMaxCSCLength=function(){var s=this.props.creditCard.getCardType();return c("PaymentMethodUtils").getCardTypeFromCode(s).cscDigits}.bind(this),this.getMessage=function(){if(this.getMaxCSCLength()===3)return i._("Vuelve a ingresar el c\u00f3digo de seguridad de tres d\u00edgitos de tu tarjeta.");else return i._("Vuelve a ingresar el c\u00f3digo de seguridad de cuatro d\u00edgitos de tu tarjeta.")}.bind(this),this.renderFooter=function(){var s=i._("Cancelar"),t=this.props.showCancelButton?c("React").createElement(c("P2PButton.react"),{label:s,onClick:this.props.onCancel,use:"default"}):null;return c("React").createElement(c("P2PDialogFooter.react"),{className:"_3-8-",leftContent:this.props.leftContent},t,c("React").createElement(c("P2PButton.react"),{disabled:!this.state.isValid,label:this.props.primaryButtonText,onClick:this.handleConfirmClick,use:"confirm"}))}.bind(this),o}m.prototype.render=function(){var n={};n[c("CreditCardFormParam").CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();n[c("CreditCardFormParam").CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();return c("React").createElement(c("P2PDialog.react"),{layerHideOnBlur:false,repositionOnUpdate:true,shown:true},c("React").createElement(c("P2PDialogTitle.react"),null,i._("Ingresar c\u00f3digo de seguridad")),c("React").createElement(c("P2PDialogBody.react"),null,c("React").createElement(c("FBPaymentsCreditCardVerificationForm_DEPRECATED.react"),{cscMaxLength:this.getMaxCSCLength(),onValidation:this.handleValidation,prefilledFormData:n}),c("React").createElement(c("P2PText.react"),{className:"_3-8y",type:"secondary"},this.getMessage())),this.renderFooter(),c("React").createElement(c("P2PLoadingMask.react"),{visible:this.props.loading}))};m.propTypes={creditCard:l.instanceOf(c("P2PCreditCard")).isRequired,leftContent:l.node,loading:l.bool,onCancel:l.func,onConfirm:l.func.isRequired,primaryButtonText:l.node,showCancelButton:l.bool};m.defaultProps={loading:false,onCancel:c("emptyFunction"),onConfirm:c("emptyFunction"),primaryButtonText:i._("Confirmar"),showCancelButton:true};f.exports=m}),null);
__d("BrowserExtensionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:BrowserExtensionsLoggerConfig",this.$BrowserExtensionsTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:BrowserExtensionsLoggerConfig",this.$BrowserExtensionsTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$BrowserExtensionsTypedLogger1={};return this};h.prototype.updateData=function(j){this.$BrowserExtensionsTypedLogger1=babelHelpers["extends"]({},this.$BrowserExtensionsTypedLogger1,j);return this};h.prototype.setAPIEndpoint=function(j){this.$BrowserExtensionsTypedLogger1.api_endpoint=j;return this};h.prototype.setAppID=function(j){this.$BrowserExtensionsTypedLogger1.appid=j;return this};h.prototype.setAppversion=function(j){this.$BrowserExtensionsTypedLogger1.appversion=j;return this};h.prototype.setClientUserID=function(j){this.$BrowserExtensionsTypedLogger1.client_userid=j;return this};h.prototype.setClienttime=function(j){this.$BrowserExtensionsTypedLogger1.clienttime=j;return this};h.prototype.setCountry=function(j){this.$BrowserExtensionsTypedLogger1.country=j;return this};h.prototype.setDeviceid=function(j){this.$BrowserExtensionsTypedLogger1.deviceid=j;return this};h.prototype.setErrorCode=function(j){this.$BrowserExtensionsTypedLogger1.error_code=j;return this};h.prototype.setErrorMessage=function(j){this.$BrowserExtensionsTypedLogger1.error_message=j;return this};h.prototype.setExtraClientData=function(j){this.$BrowserExtensionsTypedLogger1.extra_client_data=j;return this};h.prototype.setIsemployee=function(j){this.$BrowserExtensionsTypedLogger1.isemployee=j;return this};h.prototype.setName=function(j){this.$BrowserExtensionsTypedLogger1.name=j;return this};h.prototype.setSessionid=function(j){this.$BrowserExtensionsTypedLogger1.sessionid=j;return this};h.prototype.setStartURL=function(j){this.$BrowserExtensionsTypedLogger1.start_url=j;return this};h.prototype.setStringPageID=function(j){this.$BrowserExtensionsTypedLogger1.string_page_id=j;return this};h.prototype.setThreadID=function(j){this.$BrowserExtensionsTypedLogger1.thread_id=j;return this};h.prototype.setWebsiteURL=function(j){this.$BrowserExtensionsTypedLogger1.website_url=j;return this};var i={api_endpoint:true,appid:true,appversion:true,client_userid:true,clienttime:true,country:true,deviceid:true,error_code:true,error_message:true,extra_client_data:true,isemployee:true,name:true,sessionid:true,start_url:true,string_page_id:true,thread_id:true,website_url:true};f.exports=h}),null);
__d("MNContentSubscriptionMessageUserEngagementTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MNContentSubscriptionMessageUserEngagementLoggerConfig",this.$MNContentSubscriptionMessageUserEngagementTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MNContentSubscriptionMessageUserEngagementLoggerConfig",this.$MNContentSubscriptionMessageUserEngagementTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1={};return this};h.prototype.updateData=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1=babelHelpers["extends"]({},this.$MNContentSubscriptionMessageUserEngagementTypedLogger1,j);return this};h.prototype.setAppID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.appid=j;return this};h.prototype.setAppversion=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.appversion=j;return this};h.prototype.setBroadcastUnitID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.broadcast_unit_id=j;return this};h.prototype.setClientUserID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.client_userid=j;return this};h.prototype.setClienttime=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.clienttime=j;return this};h.prototype.setCommerceItemID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.commerce_item_id=j;return this};h.prototype.setCommerceMessageType=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.commerce_message_type=j;return this};h.prototype.setCountry=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.country=j;return this};h.prototype.setDeviceid=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.deviceid=j;return this};h.prototype.setInterface=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1["interface"]=j;return this};h.prototype.setMessageID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.message_id=j;return this};h.prototype.setMessageTs=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.message_ts=j;return this};h.prototype.setName=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.name=j;return this};h.prototype.setPageID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.page_id=j;return this};var i={appid:true,appversion:true,broadcast_unit_id:true,client_userid:true,clienttime:true,commerce_item_id:true,commerce_message_type:true,country:true,deviceid:true,"interface":true,message_id:true,message_ts:true,name:true,page_id:true};f.exports=h}),null);
__d("MNPlatformMessageUserEngagementTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MNPlatformMessageUserEngagementLoggerConfig",this.$MNPlatformMessageUserEngagementTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MNPlatformMessageUserEngagementLoggerConfig",this.$MNPlatformMessageUserEngagementTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$MNPlatformMessageUserEngagementTypedLogger1={};return this};h.prototype.updateData=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1=babelHelpers["extends"]({},this.$MNPlatformMessageUserEngagementTypedLogger1,j);return this};h.prototype.setAppID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.appid=j;return this};h.prototype.setAppversion=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.appversion=j;return this};h.prototype.setClientUserID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.client_userid=j;return this};h.prototype.setClienttime=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.clienttime=j;return this};h.prototype.setCommerceItemID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.commerce_item_id=j;return this};h.prototype.setCommerceMessageType=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.commerce_message_type=j;return this};h.prototype.setCountry=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.country=j;return this};h.prototype.setDeviceid=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.deviceid=j;return this};h.prototype.setInterface=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1["interface"]=j;return this};h.prototype.setMessageID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.message_id=j;return this};h.prototype.setMessageTs=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.message_ts=j;return this};h.prototype.setName=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.name=j;return this};h.prototype.setPageID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.page_id=j;return this};var i={appid:true,appversion:true,client_userid:true,clienttime:true,commerce_item_id:true,commerce_message_type:true,country:true,deviceid:true,"interface":true,message_id:true,message_ts:true,name:true,page_id:true};f.exports=h}),null);
__d("ChatImageArrowDirection",["keyMirror"],(function a(b,c,d,e,f,g){"use strict";var h=c("keyMirror")({BOTH:null,LEFT:null,RIGHT:null});f.exports=h}),null);
__d("ChatImageWithArrow.react",["cx","ChatImageArrowDirection","CssBackgroundImage.react","Link.react","MercuryAttachmentConstants","React","XUISpinner.react","cssURL","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l=30,m=15;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.$ChatImageWithArrow3=function(){return Math.max(this.props.width,m)}.bind(this),this.$ChatImageWithArrow6=function(){return Math.max(this.props.height,l)}.bind(this),this.$ChatImageWithArrow7=function(t,u,v,w){if(u===c("ChatImageArrowDirection").LEFT)return"translate("+v+"px, "+w+"px)rotate(45deg)";else return"translate("+(t-v)+"px, "+w+"px)rotate(45deg)"},this.$ChatImageWithArrow8=function(t,u,v,w){if(u===c("ChatImageArrowDirection").LEFT)return"rotate(-45deg)translate(-"+(this.$ChatImageWithArrow1+v)+"px,-"+w+"px)";else return"rotate(-45deg)translate(-"+(t-v)+"px, -"+w+"px)"}.bind(this),p}n.prototype.render=function(){this.$ChatImageWithArrow1=Math.floor(this.props.sideLength/Math.sqrt(2));this.$ChatImageWithArrow2=Math.ceil(this.$ChatImageWithArrow3()+this.$ChatImageWithArrow1);if(this.props.isLoading)return this.$ChatImageWithArrow4();var o=c("joinClasses")("_4yp6"+(this.props.round?" _3lk2":""),this.props.rootClassName);return this.$ChatImageWithArrow5(c("React").createElement("div",{className:o},c("React").createElement("div",{className:"_52kr"+(this.props.round?" _3_om":""),style:{width:this.$ChatImageWithArrow3(),height:this.$ChatImageWithArrow6()}},c("React").createElement(c("CssBackgroundImage.react"),{className:"_4yp9"+(this.props.isSpherical?" _3603":""),imageURI:this.props.source,backgroundPosition:"center",style:{width:this.$ChatImageWithArrow3(),height:this.$ChatImageWithArrow6(),borderRadius:"inherit"}},this.props.isSpherical?c("React").createElement("div",{className:"_64ks"}):null))))};n.prototype.$ChatImageWithArrow5=function(o){if(this.props.onClick)return c("React").createElement(c("Link.react"),{onClick:this.props.onClick},o);return o};n.prototype.$ChatImageWithArrow4=function(){__p&&__p();var o={width:this.props.sideLength,height:this.props.sideLength};if(this.props.source)o.backgroundImage=c("cssURL")(this.props.source);var p={width:this.props.sideLength,height:this.props.sideLength};if(this.props.source)p.opacity=0;var q={width:this.$ChatImageWithArrow3(),height:this.$ChatImageWithArrow6()};if(this.props.source){q.backgroundImage=c("cssURL")(this.props.source);q.backgroundSize="cover"}return c("React").createElement("div",{className:"_4yp6"},c("React").createElement("div",{className:"_4ypb _3_om",style:q},c("React").createElement(c("XUISpinner.react"),{size:"small"})))};n.propTypes={arrowDirection:k.oneOf(Object.keys(c("ChatImageArrowDirection"))),onClick:k.func,height:k.number.isRequired,isLoading:k.bool,isSpherical:k.bool,round:k.bool,rootClassName:k.string,sideLength:k.number,source:k.string,width:k.number.isRequired};n.defaultProps={sideLength:c("MercuryAttachmentConstants").SIDE_LENGTH,isLoading:false,isSpherical:false,round:false};f.exports=n}),null);
__d("ChatContentSearchContextualDialog.react",["cx","ContextualLayerAutoFlipHorizontal","LayerHideOnEscape","ReactAbstractContextualDialog","ReactLayer"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("ReactLayer").createClass(c("ReactAbstractContextualDialog").createSpec({addedBehaviors:[c("ContextualLayerAutoFlipHorizontal"),c("LayerHideOnEscape")],displayName:"StickerXUIContextualDialog",theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:47,length:16}}}));f.exports=i}),null);
__d("ChatContentSearchButton.react",["cx","fbt","BootloadOnRender.react","ChatFlyoutPlaceholder.react","ChatContentSearchContextualDialog.react","JSResource","LazyComponent.react","Link.react","ReactComponentWithPureRenderMixin","React","MercuryShareAttachmentRenderLocations","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("React").PropTypes,k=278,l=c("React").createClass({displayName:"ChatContentSearchButton",_clickGuard:false,mixins:[c("ReactComponentWithPureRenderMixin")],propTypes:{clicked:j.bool,ContextualDialogClass:j.func,flyoutAlignment:j.oneOf(["left","right"]),getQuery:j.func.isRequired,location:j.oneOf(c("MercuryShareAttachmentRenderLocations").getValues()),onLoad:j.func,onSelect:j.func.isRequired},getDefaultProps:function m(){return{flyoutAlignment:"left",location:c("MercuryShareAttachmentRenderLocations").CHAT}},getInitialState:function m(){return{query:"",shown:!!this.props.clicked}},componentDidMount:function m(){this.props.onLoad&&this.props.onLoad(this)},updateQuery:function m(){this.setState({query:this.props.getQuery()})},hideFlyout:function m(){this.setState(this.getInitialState())},render:function m(){return c("React").createElement("span",null,c("React").createElement(c("Link.react"),{className:c("joinClasses")(this.props.className,this.state.shown?"open":""),href:"#",onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:"button",title:i._("Elige un GIF"),ref:"link"}),this.renderLayers())},renderLayers:function m(){if(!this.state.shown)return null;var n=this.props.ContextualDialogClass||c("ChatContentSearchContextualDialog.react");return c("React").createElement(n,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link}.bind(this),onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:k,key:"contextualDialog"},c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{location:this.props.location,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,query:this.state.query}),loader:c("JSResource")("ChatContentSearchFlyout.react").__setRef("ChatContentSearchButton.react"),placeholder:c("React").createElement(c("ChatFlyoutPlaceholder.react"),null)}))},_handleMouseDown:function m(n){this._clickGuard=this.state.shown},_handleClick:function m(n){n.stopPropagation();if(this.state.shown||this._clickGuard)return;this.setState({query:this.props.getQuery(),shown:!this.state.shown})},_handleSelect:function m(n,o){this.props.onSelect(n,o);this.hideFlyout()},_handleContextualDialogToggle:function m(n){this.setState({shown:n})}});f.exports=l}),null);
__d("MNCommerceOrderConfigActions",["MessengerDispatcher","MNCommerceActionTypes"],(function a(b,c,d,e,f,g){"use strict";var h={itemLoaded:function i(j){c("MessengerDispatcher").dispatch({type:c("MNCommerceActionTypes").RETAIL_ITEM.LOADED,item:j})},itemLoadError:function i(j){c("MessengerDispatcher").dispatch({type:c("MNCommerceActionTypes").RETAIL_ITEM.LOAD_ERROR,itemID:j})},itemReload:function i(j){c("MessengerDispatcher").dispatch({type:c("MNCommerceActionTypes").RETAIL_ITEM.RELOAD,itemID:j})}};f.exports=h}),null);
__d("MessengerAttachmentImageBlockUtils",["isFacebookURI","isLinkshimURI"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){return k.getPath().indexOf("/moments_app")===0}function i(k,l){return k<=300&&l<=300}function j(k,l,m){if(i(k,l))return true;return c("isFacebookURI")(m)&&!c("isLinkshimURI")(m)&&!h(m)}f.exports={isIcon:j}}),null);
__d("MessengerAttachmentImageBlock.react",["cx","React","StoryAttachmentStyle","URI","cssURL","gkx","joinClasses","MessengerAttachmentImageBlockUtils"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",{className:c("joinClasses")(this.props.className,this.$MessengerAttachmentImageBlock1())},this.$MessengerAttachmentImageBlock2(),c("React").createElement("div",{className:"_5swm"},this.props.children))};l.prototype.$MessengerAttachmentImageBlock2=function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var m=this.$MessengerAttachmentImageBlock3(),n=m.height,o=m.width,p=n>o,q=new(c("URI"))(this.props.attachment.uri),r=c("MessengerAttachmentImageBlockUtils").isIcon(n,o,q),s=n&&o?n/o*100:100,t=p||r?.2:1,u=p||r?s:52,v={backgroundImage:c("cssURL")(this.props.attachment.media.image),minHeight:"0px",paddingBottom:p&&s>150?"136px":u*t+"%"};if(this.props.attachment.description&&this.props.attachment.source)v.minHeight="112px";return c("React").createElement("div",{className:"_3xn1",style:v})};l.prototype.$MessengerAttachmentImageBlock1=function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return"_3xn3 _5swn";var m=this.$MessengerAttachmentImageBlock3(),n=m.height,o=m.width,p=n>o,q=new(c("URI"))(this.props.attachment.uri),r=c("MessengerAttachmentImageBlockUtils").isIcon(n,o,q);return"_3xn3"+(r&&!p?" _3xn5":"")+(p?" _3xn6":"")+(o>=n&&!r?" _3xn7":"")+(c("gkx")("AT5jVqghs9R-Nalfuant-OpQGexKpV-Lvk0zsjcgyNeCAPkQFy-F7Ku4x6WSSnQxEXUiMEmPIqbnxuBACYn4sSsR")&&this.$MessengerAttachmentImageBlock4()?" _2e9e":"")};l.prototype.$MessengerAttachmentImageBlock4=function(){var m=this.props.attachment.style_list;return Array.isArray(m)&&m[0]==c("StoryAttachmentStyle").LIGHTWEIGHT_ACTION};l.prototype.$MessengerAttachmentImageBlock5=function(){var m=this.props.attachment.properties;if(!m||!m.height||!m.width)return null;return{height:m.height,width:m.width}};l.prototype.$MessengerAttachmentImageBlock3=function(){var m=this.$MessengerAttachmentImageBlock5()||this.props.attachment.media.image_size||{},n=m.height,o=m.width;if(n&&o){n=parseInt(n,10);o=parseInt(o,10);return{height:n,width:o}}return{height:0,width:0}};function l(){i.apply(this,arguments)}l.propTypes={attachment:k.object.isRequired};f.exports=l}),null);
__d("MessengerGamesPlayGameLink.react",["BootloadOnRender.react","InstantGameContextType","JSResource","LazyComponent.react","Link.react","MercuryIDs","QuicksilverSources","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes;h=babelHelpers.inherits(k,c("React").PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.state={playerOpen:false},this.$MessengerGamesPlayGameLink1=function(event){if(this.props.onClick)this.props.onClick(event);this.$MessengerGamesPlayGameLink3()}.bind(this),this.$MessengerGamesPlayGameLink2=function(){this.setState({playerOpen:false})}.bind(this),m}k.prototype.render=function(){var l=c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID),m=this.props.contextType,n=this.props.contextSourceID;if(!m){m=c("InstantGameContextType").THREAD;n=l}return c("React").createElement("div",null,c("React").createElement(c("Link.react"),{className:this.props.className,onClick:this.$MessengerGamesPlayGameLink1},this.props.title),this.state.playerOpen?c("React").createElement(c("BootloadOnRender.react"),{loader:c("JSResource")("MessengerGamesQuicksilverPlayerContainer.react").__setRef("MessengerGamesPlayGameLink.react"),placeholder:c("React").createElement("div",null),component:c("React").createElement(c("LazyComponent.react"),{contextType:m,contextSourceID:n,entryPointData:this.props.payload,gameID:this.props.gameID,onHide:this.$MessengerGamesPlayGameLink2,source:this.props.source||c("QuicksilverSources").UNKNOWN,sourceID:l})}):null)};k.prototype.$MessengerGamesPlayGameLink3=function(){this.setState({playerOpen:true})};k.propTypes={className:j.string,contextSourceID:j.string,contextType:j.string.isRequired,gameID:j.string.isRequired,payload:j.string,source:j.string,threadID:j.string.isRequired,title:j.string.isRequired};f.exports=k}),null);
__d("MNCommerceBubbleImage.react",["cx","React","cssURL","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",{className:c("joinClasses")("_4y9n"+(this.props.isSquare?" _2j_n":"")+(!this.props.isSquare?" _2j_r":""),this.props.className),style:{backgroundImage:c("cssURL")(this.props.source)}})};function l(){i.apply(this,arguments)}l.propTypes={location:k.string,source:k.string.isRequired,width:k.number,isSquare:k.bool};f.exports=l}),null);
__d("MNCommerceCheckoutButton.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l="medium";i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.getButtonSize=function(n){return l};m.prototype.render=function(){var n="_48a0"+(this.props.disabled?" _48a1":"")+(this.props.use==="default"?" _48a2":"")+(this.props.use==="confirm"&&!this.props.disabled?" _48a3":"");return c("React").createElement("span",{className:c("joinClasses")(this.props.className,n),use:"default"},this.props.children)};function m(){i.apply(this,arguments)}m.propTypes={disabled:k.bool,use:k.oneOf(["default","confirm"])};f.exports=m}),null);
__d("MNCommerceCheckoutOrderConfigReactShape",["React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=h.shape({allVariantOptions:h.object,id:h.string,initialVariantOptions:h.object,itemIDToItem:h.object,logo:h.string,name:h.string,optionToItems:h.object,ordered_product_items:h.array,product_item_id:h.string,variant_labels:h.array});f.exports=i}),null);
__d("MNCommerceCheckoutOrderConfigUtils",["Map","Set"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={DELIMITER:"!@*",addVariantOptions:function i(j){var k=j,l=this._buildItemMaps(k),m=l.optionToItems,n=l.itemIDToItem,o=l.variantToItemID,p=this._getVariantOptionsAndEligibleItems(k,m,n),q=p.allVariantOptions,r=p.initialVariantOptions;k.itemIDToItem=n;k.optionToItems=m;k.variantToItemID=o;k.allVariantOptions=q;k.initialVariantOptions=r;return k},_buildItemMaps:function i(j){__p&&__p();var k=new(c("Map"))(),l=new(c("Map"))(),m=new(c("Map"))();j.ordered_product_items.forEach(function(n){__p&&__p();var o=n.variant_values,p=[];Object.keys(o).forEach(function(q){p.push(o[q])});var q=p.join(h.DELIMITER);m.set(q,n.item_id);k.set(n.item_id,n);for(var r=0;r<p.length;r++){if(!l.has(r))l.set(r,new(c("Map"))());var s=p[r],t=l.get(r);if(!t.has(s))t.set(s,new(c("Set"))([n.item_id]));else t.get(s).add(n.item_id)}});return{itemIDToItem:k,optionToItems:l,variantToItemID:m}},_getVariantOptionsAndEligibleItems:function i(j,k,l){__p&&__p();var m={},n={};for(var o=0;o<j.variant_labels.length;o++){m[o]={};var p=[];k.get(o).forEach(function(q,r){__p&&__p();var s=new(c("Map"))();p.push({label:r,available:true});for(var t=0;t<j.variant_labels.length;t++){if(o===t)continue;var u=[];k.get(t).forEach(function(v,w){var x=this._getIntersection(v,k.get(o).get(r)),y=false;if(x.size>0)y=this._isInStock(x,l);u.push({label:w,available:y})}.bind(this),this);s.set(t,u)}m[o][r]=s;n[o]=p}.bind(this),this)}return{allVariantOptions:m,initialVariantOptions:n}},_getIntersection:function i(j,k){var l=new(c("Set"))([]);j.forEach(function(m){if(k.has(m))l.add(m)});return l},_isInStock:function i(j,k){var l=false;j.forEach(function(m){var n=k.get(m);if(n.commerce_inventory>0)l=true});return l}};f.exports=h}),null);
__d("MNCommerceLogoHeaderReact.bs",["cx","React","ImageReact.bs","ReasonReact.bs","bs_js_primitive"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i="24px",j="12px",k=c("ReasonReact.bs").statelessComponent("MNCommerceLogoHeader");function l(p,q,r,s){__p&&__p();var t=function t(){if(p){var v=p[0],w=v.src;if(w==null)return null;else{var x=v.width/v.height,y=Math.abs(3-x)<=.75?j:i;return c("React").createElement("div",{key:"logo",className:"_b0-"},c("React").createElement("div",{className:"_fz0"},c("ReasonReact.bs").element(0,0,c("ImageReact.bs").make(["_56rs"],0,[w],[v.height],0,[v.width],[{maxHeight:y}],[]))))}}else return null},u=k.slice();u[9]=function(){__p&&__p();var v=t(0);if(s.length!==0){var w=c("React").createElement("div",{key:"children",className:"_fy-"+((q!==0?0:1)?" _fy_":"")},c("React").createElement("div",{className:"_56rv"},s)),x;if(p){var y=p[0].src;x=y==null?[1,[w]]:q!==0?[0,[w,v]]:[0,[v,w]]}else x=[1,[w]];return c("React").createElement("div",{className:(x[0]&&(r!==0?1:0)?"_fy_":"")+" _56rt"},x[1])}else return v};return u}var m=c("ReasonReact.bs").wrapReasonForJs(k,function(p){var q=p.children;return l(c("bs_js_primitive").null_undefined_to_opt(p.logo),p.logoPosition==="right"?1:0,p.childPosition==="right"?1:0,q==null?[]:[].concat(q))}),n=3,o=.75;g.defaultMaxHeight=i;g.defaultHalfMaxHeight=j;g.defaultAspectRatio=n;g.aspectRatioMargin=o;g.component=k;g.make=l;g.jsComponent=m}),null);
__d("MNCommerceItemTextReact.bs",["cx","fbt","React","Utils.bs","ReasonReact.bs","joinClasses","MNCommerceOrderItemsStatus"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ReasonReact.bs").statelessComponent("MNCommerceItemText");function k(l,m,n,o,p,q,r,s){__p&&__p();var t=function t(x){if(p!==0)return null;else{var y=x?x[0]:null;if(q&&q[0]===c("MNCommerceOrderItemsStatus").CANCELED)return c("React").createElement("div",undefined,c("React").createElement("span",{className:"__hz"},i._("Cancelado")," \xb7"),y);else return c("React").createElement("div",undefined,y)}},u=function u(x){if(x)return c("React").createElement("div",undefined,x[0]);else return null},v=function v(){if(n){var x=n[0];return c("React").createElement("div",undefined,u(x[0]),u(x[1]),t(x[2]))}else return null},w=j.slice();w[9]=function(){return c("React").createElement("div",{className:c("joinClasses")(c("Utils.bs").$pipe$unknown(l,""),"_swr"+((p!==0?true:false)?" _sws":"")),style:{left:m,paddingLeft:o},title:c("Utils.bs").$pipe$unknown(r,"")},c("React").createElement("div",{className:"_51fw"},r?r[0]:null),c("React").createElement("div",{className:"_2y0f"},v(0)))};return w}g.component=j;g.make=k}),null);
__d("MNCommerceSingleListItemReact.bs",["cx","React","Utils.bs","ImageReact.bs","bs_pervasives","ReasonReact.bs","joinClasses","bs_js_primitive","MNCommerceItemTextReact.bs"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("ReasonReact.bs").statelessComponent("MNCommerceSingleListItem");function j(l,m,n,o,p,q,r,s,t){var u=function u(){if(m)return c("React").createElement("div",{className:"_1fld"},c("ReasonReact.bs").element(0,0,c("ImageReact.bs").make(["_1fle"],0,[m[0]],[n],0,[n],0,[])));else return null},v=i.slice();v[9]=function(){return c("React").createElement("div",{className:c("joinClasses")(c("Utils.bs").$pipe$unknown(l,""),"_39q_"),style:{height:c("bs_pervasives").string_of_int(n)+"px",width:c("Utils.bs").$pipe$unknown(q,"auto")}},u(0),c("ReasonReact.bs").element(0,0,c("MNCommerceItemTextReact.bs").make(["_1flf"],m?c("bs_pervasives").string_of_int(n)+"px":"auto",r,m?"6px":"auto",o,p,s,[])))};return v}var k=c("ReasonReact.bs").wrapReasonForJs(i,function(l){var m=l.width,n=l.metalines;return j(c("bs_js_primitive").null_undefined_to_opt(l.className),c("bs_js_primitive").null_undefined_to_opt(l.thumbURL),l.imageDimension,l.size==="large"?0:1,c("bs_js_primitive").null_undefined_to_opt(l.statusType),m==null?0:[c("bs_pervasives").string_of_int(m)+"px"],n==null?0:[[c("bs_js_primitive").null_undefined_to_opt(n.metaline_1),c("bs_js_primitive").null_undefined_to_opt(n.metaline_2),c("bs_js_primitive").null_undefined_to_opt(n.metaline_3)]],c("bs_js_primitive").null_undefined_to_opt(l.title),[])});g.component=i;g.make=j;g.jsComponent=k}),null);
__d("MNCommerceCheckoutOrderConfigDialog.react",["cx","fbt","MessengerEnvironment","MNCommerceButton.react","MNCommerceCheckoutButton.react","MNCommerceCheckoutOrderConfigReactShape","MNCommerceCheckoutOrderConfigUtils","MNCommerceDetailsDialog.react","MNCommerceDialogFooter.react","MNCommerceDialogBody.react","MNCommerceLogoHeaderReact.bs","MNCommerceSingleListItemReact.bs","React","Set","XUIRadioButtonGroup.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("MNCommerceLogoHeaderReact.bs").jsComponent,m=c("MNCommerceSingleListItemReact.bs").jsComponent,n=c("React").PropTypes,o=18,p="\xb7";j=babelHelpers.inherits(q,c("React").Component);k=j&&j.prototype;function q(s,t){k.constructor.call(this,s,t);r.call(this);this.state=this.$MNCommerceCheckoutOrderConfigDialog1()}q.prototype.componentWillReceiveProps=function(s){this.setState(this.$MNCommerceCheckoutOrderConfigDialog1(s))};q.prototype.render=function(){var s=i._("No se pudo mostrar el art\u00edculo.");return c("React").createElement(c("MNCommerceDetailsDialog.react"),babelHelpers["extends"]({errorMessage:s},this.props),this.$MNCommerceCheckoutOrderConfigDialog2())};q.prototype.$MNCommerceCheckoutOrderConfigDialog2=function(){__p&&__p();if(this.props.error||this.props.loading)return null;var s=i._("Continuar"),t=i._("Cancelar"),u=this.props.checkoutOrderConfig,v=null,w=this.$MNCommerceCheckoutOrderConfigDialog3(),x=u&&u.ordered_product_items;if(w&&w.size){var y=w.values().next().value,z=u&&u.itemIDToItem.get(y);v=z&&z.images}else if(x&&x.length)v=x[0].images;var A=this.state.variants.filter(function(I){return I}).join(" "+p+" "),B=A?{metaline_1:A}:null,C=this.state.variants,D=u&&u.variant_labels,E=u&&(!D||D.length===0||C.length>0&&C.every(function(I){return I})),F={src:u?u.logo:"",width:o,height:o},G=c("React").createElement(c("MNCommerceButton.react"),{className:"_23qd",label:t,onClick:this.$MNCommerceCheckoutOrderConfigDialog4,use:"default"});G=!c("MessengerEnvironment").messengerui?G:null;var H=u&&D&&D.length>0;return c("React").createElement("div",{className:"_vg4"},c("React").createElement(c("MNCommerceDialogBody.react"),null,c("React").createElement("div",{className:H?"_vg5":""},c("React").createElement(l,{className:"_vg6",logo:F,logoPosition:"left"}),c("React").createElement("div",{className:"_vg7"},c("React").createElement(m,{imageDimension:60,metalines:B,size:"large",thumbURL:v,title:u&&u.name}))),this.$MNCommerceCheckoutOrderConfigDialog5()),c("React").createElement(c("MNCommerceDialogFooter.react"),null,G,c("React").createElement(c("MNCommerceButton.react"),{className:"_23qe",disabled:!E,label:s,onClick:this.$MNCommerceCheckoutOrderConfigDialog6,use:"default"})))};q.prototype.$MNCommerceCheckoutOrderConfigDialog3=function(s){__p&&__p();var t=this.props.checkoutOrderConfig;if(!t)return null;var u=s||this.state.variants,v=t.optionToItems,w=null;for(var x=0;x<u.length;x++){var y=u[x];if(y){var z=v.get(x),A=z&&z.get(y);if(!w)w=A;else w=c("MNCommerceCheckoutOrderConfigUtils").$MNCommerceCheckoutOrderConfigDialog7(w,A)}}return w};q.prototype.$MNCommerceCheckoutOrderConfigDialog8=function(s,t){this.setState(this.$MNCommerceCheckoutOrderConfigDialog9(s,t))};q.prototype.$MNCommerceCheckoutOrderConfigDialog10=function(s,t,u){__p&&__p();var v=this.props.checkoutOrderConfig;if(!v)return null;var w=this.state.variants.slice();if(this.state.variants[s]!==t){w[s]=t;w[u]=null}var x=this.$MNCommerceCheckoutOrderConfigDialog3(w),y=[],z=v.optionToItems,A=v.itemIDToItem;z.get(u).forEach(function(B,C){var D=c("MNCommerceCheckoutOrderConfigUtils").$MNCommerceCheckoutOrderConfigDialog7(B,x?x:new(c("Set"))()),E=false;if(D.size>0)E=c("MNCommerceCheckoutOrderConfigUtils").$MNCommerceCheckoutOrderConfigDialog11(D,A);y.push({label:C,available:E})},this);return y};q.prototype.$MNCommerceCheckoutOrderConfigDialog5=function(){var s=this.props.checkoutOrderConfig;if(!s)return null;var t=i._("Seleccionar"),u=s.variant_labels.map(function(v,w){return c("React").createElement("div",{key:w},c("React").createElement("div",{className:"_vg8"},t+" "+v),c("React").createElement("div",{className:"_vg9"},this.$MNCommerceCheckoutOrderConfigDialog12(this.state.variantOptions[w],this.$MNCommerceCheckoutOrderConfigDialog8.bind(this,w),this.state.variants[w])))}.bind(this));return u};q.propTypes={error:n.object,checkoutOrderConfig:c("MNCommerceCheckoutOrderConfigReactShape"),loading:n.bool.isRequired,onContinue:n.func.isRequired,onTryAgain:n.func,shown:n.bool.isRequired,statusType:n.number};q.defaultProps={shown:false};var r=function r(){__p&&__p();this.$MNCommerceCheckoutOrderConfigDialog1=function(s){var t=s||this.props,u=t.checkoutOrderConfig;if(!u)return{};return{variantOptions:u.initialVariantOptions,variants:[]}}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog9=function(s,t){__p&&__p();var u=this.props.checkoutOrderConfig;if(!u)return null;var v=[],w=[],x=u.allVariantOptions[s][t];for(var y=0;y<u.variant_labels.length;y++)if(y===s){v.push(t);w.push(this.state.variantOptions[y])}else{var z=this.state.variants.filter(function(B){return B}),A=null;if(u.variant_labels.length<=2||z.length<2)A=x.get(y);else A=this.$MNCommerceCheckoutOrderConfigDialog10(s,t,y);w.push(A);v.push(this.state.variants[y])}return{variants:v,variantOptions:w}}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog6=function(s){var t=this.props.checkoutOrderConfig;if(!t||this.state.variants.some(function(x){return!x}))return;var u=t.seller_id,v=this.state.variants.join(c("MNCommerceCheckoutOrderConfigUtils").DELIMITER),w=t.variantToItemID.get(v);this.props.onContinue(w,u,this.state.variants.join(" "+p+" "));this.props.onToggle(false)}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog4=function(s){this.props.onToggle(false)}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog12=function(s,t,u){var v=s.map(function(w,x){return c("React").createElement(c("MNCommerceCheckoutButton.react"),{key:x,disabled:w.available===false,use:"default",value:w.label},w.label)});return c("React").createElement(c("XUIRadioButtonGroup.react"),{onValueChange:t,selectedValue:u,selectedUse:"confirm"},v)}};f.exports=q}),null);
__d("XMNCommerceCheckoutOrderConfigController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messages/commerce/checkout_order_config/",{item_id:{type:"String",required:true},owner_id:{type:"String",required:true}})}),null);
__d("MNCommerceOrderConfigDataManager",["AsyncRequest","MNCommerceOrderConfigActions","XMNCommerceCheckoutOrderConfigController"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.prototype.fetchItem=function(i,j){var k=c("XMNCommerceCheckoutOrderConfigController").getURIBuilder().setString("item_id",i).setString("owner_id",j).getURI();new(c("AsyncRequest"))().setURI(k).setHandler(this.$MNCommerceOrderConfigDataManager1).setErrorHandler(this.$MNCommerceOrderConfigDataManager2).send()};h.prototype.$MNCommerceOrderConfigDataManager1=function(i){c("MNCommerceOrderConfigActions").itemLoaded(i.payload)};h.prototype.$MNCommerceOrderConfigDataManager2=function(i){var j=i.getRequest().uri.getQueryData(),k=j.item_id;c("MNCommerceOrderConfigActions").itemLoadError(k)};function h(){}f.exports=new h()}),null);
__d("MNCommerceOrderConfigStore",["Cache","FluxStore","LoadObject","MessengerDispatcher","MNCommerceActionTypes","MNCommerceCacheTimeoutLimits","MNCommerceCheckoutOrderConfigUtils","MNCommerceOrderConfigDataManager"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("FluxStore"));i=h&&h.prototype;function j(){i.constructor.call(this,c("MessengerDispatcher"));this.$MNCommerceOrderConfigStore1=new(c("Cache"))()}j.prototype.__onDispatch=function(k){__p&&__p();var l=k.type,m=k.item?k.item.id:k.itemID;switch(l){case c("MNCommerceActionTypes").RETAIL_ITEM.LOADED:var n=k.item;n=c("MNCommerceCheckoutOrderConfigUtils").addVariantOptions(n);this.$MNCommerceOrderConfigStore1.set(m,c("LoadObject").empty().setValue(n),null,c("MNCommerceCacheTimeoutLimits").SUCCESS_TIMEOUT);this.__emitChange();break;case c("MNCommerceActionTypes").RETAIL_ITEM.LOAD_ERROR:this.$MNCommerceOrderConfigStore1.set(m,c("LoadObject").empty().setError(new Error("Unable to load item: "+m)),null,c("MNCommerceCacheTimeoutLimits").ERROR_TIMEOUT);this.__emitChange();break;case c("MNCommerceActionTypes").RETAIL_ITEM.RELOAD:if(m){this.$MNCommerceOrderConfigStore1.set(m,c("LoadObject").loading());c("MNCommerceOrderConfigDataManager").fetchItem(m)}this.__emitChange();break}};j.prototype.getItem=function(k,l){if(k&&!this.$MNCommerceOrderConfigStore1.has(k)){this.$MNCommerceOrderConfigStore1.set(k,c("LoadObject").loading().setValue({itemID:k}));c("MNCommerceOrderConfigDataManager").fetchItem(k,l)}return this.$MNCommerceOrderConfigStore1.get(k)||c("LoadObject").empty()};f.exports=new j()}),null);
__d("MNCommerceCheckoutOrderConfigDialogContainer.react",["BanzaiLogger","MNCommerceDialogStateActions","MNCommerceDialogStateStore","MNCommerceLoggingConstants","MNCommerceLoggerEvents","MNCommerceCheckoutOrderConfigDialog.react","MNCommerceOrderConfigActions","MNCommerceOrderConfigStore","PureStoreBasedStateMixin","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("React").createClass({displayName:"MNCommerceCheckoutOrderConfigDialogContainer",mixins:[c("PureStoreBasedStateMixin")(c("MNCommerceOrderConfigStore"))],statics:{calculateState:function i(){__p&&__p();var j=c("MNCommerceDialogStateStore").getState(),k=null,l=null,m=null;if(j){k=j.itemID;l=j.ownerID;m=j.onContinue}var n=c("MNCommerceOrderConfigStore").getItem(k,l);if(!n.isLoading())c("BanzaiLogger").log("MessengerCommerceLoggerConfig",{event:n.hasError()?c("MNCommerceLoggerEvents").DIALOG_LOAD_ERROR:c("MNCommerceLoggerEvents").DIALOG_LOAD_SUCCESS,debug_data:JSON.stringify({dialog_surface:c("MNCommerceLoggingConstants").DIALOG_SURFACE.CHECKOUT_ORDER_CONFIG,item_id:k})});return{shown:!!j,loading:n.isLoading(),itemID:k,checkoutOrderConfig:n.getValue(),onContinue:m,error:n.getError()}}},render:function i(){return c("React").createElement(c("MNCommerceCheckoutOrderConfigDialog.react"),{error:this.state.error,checkoutOrderConfig:this.state.loading?null:this.state.checkoutOrderConfig,loading:this.state.loading,onContinue:this.state.onContinue,onToggle:this._onToggle,onTryAgain:this._onTryAgainClick,shown:this.state.shown})},_onToggle:function i(j){if(!j){c("BanzaiLogger").log("MessengerCommerceLoggerConfig",{event:c("MNCommerceLoggerEvents").DIALOG_CLOSED,debug_data:JSON.stringify({dialog_surface:c("MNCommerceLoggingConstants").DIALOG_SURFACE.CHECKOUT_ORDER_CONFIG,item_id:this.state.itemID})});c("MNCommerceDialogStateActions").hideDialog()}},_onTryAgainClick:function i(){c("MNCommerceOrderConfigActions").itemReload(this.state.itemID)}});f.exports=h}),null);
__d("MercuryFallbackShareAttachmentTextBlock.react",["cx","LineClamp.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){if(!this.props||!this.props.attachment)return c("React").createElement("div",{className:"__6j"});if(c("MercuryShareAttachmentRenderLocations").MESSENGER===this.props.location)return c("React").createElement("div",{className:"__6j"},this.renderMessengerTitle(),this.renderMessengerDescription(),this.renderMessengerSource());return c("React").createElement("div",{className:"__6j"},this.renderTitle(),this.renderDescription(),this.renderSource(),this.props.extraComponent)};l.prototype.renderMessengerTitle=function(){if(!this.props.attachment.title)return null;return c("React").createElement("div",{className:"__6k"},c("React").createElement(c("LineClamp.react"),{customEllipsis:" ",lines:2,lineHeight:18},this.props.attachment.title))};l.prototype.renderMessengerDescription=function(){if(!this.props.attachment.description)return null;return c("React").createElement("div",{className:"__6l"},c("React").createElement(c("LineClamp.react"),{customEllipsis:" ",lines:2,lineHeight:16},this.props.attachment.description))};l.prototype.renderMessengerSource=function(){if(!this.props.attachment.source)return null;return c("React").createElement("div",{className:"__6m"},this.props.attachment.source)};l.prototype.renderTitle=function(){if(!this.props.attachment.title)return null;return c("React").createElement("div",{className:"__6k"+(!this.props.attachment.uri&&!this.props.attachment.description||this.props.attachment.target!=null&&this.props.attachment.target.lwa_type!=null&&this.props.attachment.target.lwa_state==="INITIATED"?" _2xsq":"")+(!!this.props.extraComponent?" _1dw9":"")},this.props.attachment.title)};l.prototype.renderDescription=function(){if(!this.props.attachment.description)return null;return c("React").createElement("div",{className:"__6l"},this.props.attachment.description)};l.prototype.renderSource=function(){if(!this.props.attachment.source)return null;return c("React").createElement("div",{className:"__6m"},this.props.attachment.source)};function l(){i.apply(this,arguments)}l.propTypes={attachment:c("MercuryShareAttachmentReactShape"),extraComponent:k.object,location:k.oneOf(c("MercuryShareAttachmentRenderLocations").getValues())};f.exports=l}),null);
__d("MercuryShareImage.react",["cx","ChatImageArrowDirection","ChatImageWithArrow.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",{className:"_4hsl"},c("React").createElement(c("ChatImageWithArrow.react"),{arrowDirection:c("ChatImageArrowDirection").BOTH,height:this.props.height,round:!!this.props.round,source:this.props.source,width:this.props.width}))};function l(){i.apply(this,arguments)}l.propTypes={height:k.number.isRequired,round:k.bool,source:k.string.isRequired,width:k.number.isRequired};f.exports=l}),null);
__d("MercuryFallbackShareAttachmentContent.react",["cx","Image.react","ImageBlock.react","MercuryFallbackShareAttachmentTextBlock.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MercuryShareImage.react","MessengerAttachmentImageBlock.react","React","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l=72;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.prototype.renderTextBlock=function(){return c("React").createElement(c("MercuryFallbackShareAttachmentTextBlock.react"),this.props)};m.prototype.renderChatImage=function(n){return c("React").createElement(c("ImageBlock.react"),{className:n,spacing:"medium"},c("React").createElement(c("MercuryShareImage.react"),{height:l,source:this.props.attachment.media.image,width:l}),c("React").createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",height:l}},this.renderTextBlock()))};m.prototype.renderMessengerImage=function(n){return c("React").createElement(c("MessengerAttachmentImageBlock.react"),{className:n,attachment:this.props.attachment},this.renderTextBlock(),this.props.children)};m.prototype.renderDefaultImage=function(n){return c("React").createElement(c("ImageBlock.react"),{className:c("joinClasses")(this.props.className,n)},c("React").createElement(c("Image.react"),{className:"__6n",src:this.props.attachment.media.image,width:l}),this.renderTextBlock(),this.props.children)};m.prototype.getCSSClasses=function(){var n=this.props.attachment,o=this.props.location;return(c("MercuryShareAttachmentRenderLocations").CHAT===o?"_49or":"")+(c("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW===o?" _324d":"")+(c("MercuryShareAttachmentRenderLocations").CHAT!==o?" _tih":"")+(!(n&&n.media.image)?" _49ou":"")+" _310t"};m.prototype.render=function(){var n=this.props.attachment,o=this.props.location,p=this.getCSSClasses();if(n.media&&n.media.image){if(c("MercuryShareAttachmentRenderLocations").CHAT===o||c("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW===o)return this.renderChatImage(p);else if(c("MercuryShareAttachmentRenderLocations").MESSENGER===o)return this.renderMessengerImage(p);return this.renderDefaultImage(p)}return c("React").createElement("div",{className:c("joinClasses")(this.props.className,p)},this.renderTextBlock(),this.props.children)};function m(){i.apply(this,arguments)}m.propType={attachment:c("MercuryShareAttachmentReactShape"),location:k.oneOf(c("MercuryShareAttachmentRenderLocations").getValues())};f.exports=m}),null);
__d("SaveMessageUtils",["immutable","StoryAttachmentStyle"],(function a(b,c,d,e,f,g){var h=c("immutable").Set.of(c("StoryAttachmentStyle").FALLBACK,c("StoryAttachmentStyle").SHARE,c("StoryAttachmentStyle").EVENT,c("StoryAttachmentStyle").ATTACHED_STORY,c("StoryAttachmentStyle").MUSIC_AGGREGATION,c("StoryAttachmentStyle").AVATAR),i={isSavableMessageAttachment:function j(k){for(var l=0;l<k.length;l++)if(!h.has(k[l]))return false;return true}};f.exports=i}),null);
__d("XMessengerDotComSavedForLaterNuxSeenController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/save/savemessagenux/",{})}),null);
__d("MercuryFallbackShareAttachment.react",["cx","fbt","AsyncRequest","CollectionsDisplaySurface","CollectionCurationMechanisms","Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MessengerAdsWebTypedLogger","MessengerDotComSaveModule","MNAdsLoggerEventEnum","React","ReactFragment","SaveMessageUtils","XMessengerDotComSavedForLaterNuxSeenController","XUIAmbientNUX.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="focus",n="click",o="scroll",p=1e4,q=3e4;j=babelHelpers.inherits(r,c("React").Component);k=j&&j.prototype;function r(){k.constructor.call(this);this.state={showNux:false,nuxDisabled:false}}r.prototype.renderLink=function(s){if(c("MercuryShareAttachmentRenderLocations").isPreview(this.props.location)||!this.props.attachment.uri)return s;return c("React").createElement(c("Link.react"),{className:"_5rw4",href:this.props.attachment.uri,onClick:this.$MercuryFallbackShareAttachment1.bind(this),target:"_blank"},s,this.renderLayers())};r.prototype.render=function(){return this.renderLink(c("React").createElement(c("MercuryFallbackShareAttachmentContent.react"),babelHelpers["extends"]({ref:"mercury_fallback_share_attachment"},this.props)))};r.prototype.$MercuryFallbackShareAttachment1=function(event){__p&&__p();if(this.props.isSponsored){var s=this.props.attachment&&this.props.attachment.subattachments;if(!s)return;for(var t=s,u=Array.isArray(t),v=0,t=u?t:t[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var w;if(u){if(v>=t.length)break;w=t[v++]}else{v=t.next();if(v.done)break;w=v.value}var x=w;new(c("MessengerAdsWebTypedLogger"))().setEvent(c("MNAdsLoggerEventEnum").LINK_CLICK).setIsSponsored(this.props.isSponsored).setItemID(x&&x.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log()}}if(this.state.nuxDisabled||!this.$MercuryFallbackShareAttachment2())return;this.$MercuryFallbackShareAttachment3();this.interactionTime=0;this.cancelMinConsumeTimeout=setTimeout(function(){if(!this.$MercuryFallbackShareAttachment4())this.setState({showNux:true,nuxDisabled:true})}.bind(this),p);this.cancelMaxConsumeTimeout=setTimeout(function(){if(!this.$MercuryFallbackShareAttachment4()){this.setState({showNux:false,nuxDisabled:false});this.clearTimeouts()}}.bind(this),q);var y=Date.now();this.cancelWindowInteractionTimeout=setTimeout(function(){this.$MercuryFallbackShareAttachment5(function(){if(!this.interactionTime)this.interactionTime=Date.now()-y}.bind(this))}.bind(this),0)};r.prototype.clearTimeouts=function(){__p&&__p();if(this.cancelWindowInteractionTimeout){clearTimeout(this.cancelWindowInteractionTimeout);this.cancelWindowInteractionTimeout=null}if(this.cancelMaxConsumeTimeout){clearTimeout(this.cancelMaxConsumeTimeout);this.cancelMaxConsumeTimeout=null}if(this.cancelMinConsumeTimeout){clearTimeout(this.cancelMinConsumeTimeout);this.cancelMinConsumeTimeout=null}};r.prototype.onNUXCloseButtonClick=function(){this.setState({showNux:false});this.$MercuryFallbackShareAttachment6();this.$MercuryFallbackShareAttachment7();this.clearTimeouts()};r.prototype.renderLayers=function(){return this.$MercuryFallbackShareAttachment2()?c("ReactFragment").create(c("React").createElement(c("XUIAmbientNUX.react"),{contextRef:function(){return this.refs.mercury_fallback_share_attachment}.bind(this),shown:this.state.showNux,onCloseButtonClick:this.onNUXCloseButtonClick.bind(this),position:"below",width:"custom",customwidth:300},i._("Ahora puedes guardar enlaces y videos en Facebook haciendo clic con el bot\u00f3n derecho en un mensaje."))):null};r.prototype.$MercuryFallbackShareAttachment3=function(){if(!this.$MercuryFallbackShareAttachment8){this.$MercuryFallbackShareAttachment9=[];this.$MercuryFallbackShareAttachment8=[Event.listen(window,"click",this.$MercuryFallbackShareAttachment10.bind(this,n)),Event.listen(window,"focus",this.$MercuryFallbackShareAttachment10.bind(this,m)),Event.listen(window,"scroll",this.$MercuryFallbackShareAttachment10.bind(this,o))]}};r.prototype.$MercuryFallbackShareAttachment10=function(s){this.$MercuryFallbackShareAttachment9.forEach(function(t){t.call(this,s)},this)};r.prototype.$MercuryFallbackShareAttachment5=function(s){this.$MercuryFallbackShareAttachment9.push(s)};r.prototype.$MercuryFallbackShareAttachment4=function(){return this.interactionTime&&this.interactionTime>0};r.prototype.$MercuryFallbackShareAttachment7=function(){if(this.$MercuryFallbackShareAttachment8){while(this.$MercuryFallbackShareAttachment8.length)this.$MercuryFallbackShareAttachment8.pop().remove();this.$MercuryFallbackShareAttachment8=null;this.$MercuryFallbackShareAttachment9=null}};r.prototype.$MercuryFallbackShareAttachment2=function(){return c("MessengerDotComSaveModule").eligible_for_nux&&this.$MercuryFallbackShareAttachment11()};r.prototype.$MercuryFallbackShareAttachment11=function(){var s=this.props.attachment;if(!s)return false;var t=s.style_list;return c("SaveMessageUtils").isSavableMessageAttachment(t)};r.prototype.$MercuryFallbackShareAttachment6=function(){new(c("AsyncRequest"))().setURI(c("XMessengerDotComSavedForLaterNuxSeenController").getURIBuilder().getURI()).setData({action:"impression",surface:c("CollectionsDisplaySurface").MESSENGER_DOT_COM_MESSAGE,mechanism:c("CollectionCurationMechanisms").SAVE_MESSAGE_NUX,object_id:this.props.message_id,collection_id:98}).send()};r.propTypes={attachment:c("MercuryShareAttachmentReactShape"),isSponsored:l.bool,location:l.oneOf(c("MercuryShareAttachmentRenderLocations").getValues()),messageID:l.string,pageID:l.string};f.exports=r}),null);
__d("BrowserExtensionsErrorHandler",["errorCode","errorDesc"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j={getExternalError:function k(l){__p&&__p();switch(l){case 2018062:return{code:2018062,message:i._(function(m,n){return m._("The URL provided is not whitelisted for messenger extensions")},{})};case 2018067:return{code:2018067,message:i._(function(m,n){return m._("Pages using Messenger Extensions must use https and not include any port.")},{})};case 2018164:return{code:2018164,message:i._(function(m,n){return m._("Please pass in a valid app ID.")},{})};case 2018166:return{code:2018166,message:i._(function(m,n){return m._("Permission not valid to call the SDK API.")},{})};case 2018159:return{code:2018159,message:i._(function(m,n){return m._("Invalid payload were passed to the share flow.")},{})};case 2018160:return{code:2018160,message:i._(function(m,n){return m._("The provided open graph template is not supported.")},{})};case 2018161:return{code:2018161,message:i._(function(m,n){return m._("Open graph URL in the preview content does not match the one in share content.")},{})};case 2018053:return{code:2018053,message:i._(function(m,n){return m._("Element button title cannot be empty.")},{})};case 2018125:return{code:2018125,message:i._(function(m,n){return m._("Invalid URL button fields provided. Please check documentation for details.")},{})};case 2018041:return{code:2018041,message:i._(function(m,n){return m._("Web url cannot be empty for url type button")},{})};case 2018158:return{code:2018158,message:i._(function(m,n){return m._("There was a problem creating the share attachment. Please try again later.")},{})};case 2018142:return{code:2018142,message:i._(function(m,n){return m._("Beginshare parameters are not valid.")},{})};case 2018034:return{code:2018034,message:i._(function(m,n){return m._("Message cannot be empty, must provide valid attachment or text")},{})};case 2018167:return{code:2018167,message:i._(function(m,n){return m._("Another API operation is in progress.")},{})};case 2018012:return{code:2018012,message:i._(function(m,n){return m._("Error interno inesperado")},{})};case 2018154:default:return{code:2018154,message:i._(function(m,n){return m._("Messenger Extensions unexpected error.")},{})}}}};f.exports=j}),null);
__d("MessengerPlatformBeginShareMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1467034453348931"};j.getQueryID=function(){"use strict";return"294980674291966"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("BrowserExtensionsShareChatTabDialog.react",["cx","fbt","AbstractTextArea.react","AsyncRequest","MessengerPlatformBeginShareMutationWebGraphQLMutation","CurrentUser","BrowserExtensionsErrorHandler","Image.react","immutable","MessengerComposeViewHeader.react","MessengerTextWithEntities.react","React","XUIDialogBody.react","XUIDialogButton.react","XUIDialogCancelButton.react","XUIDialogFooter.react","XUIDialogHeader.react","XUIDialogHeaderTitle.react","XUISpinner.react","emptyFunction","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="broadcast";j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={isSending:false,message:"",recipients:c("immutable").List()},this.$BrowserExtensionsShareChatTabDialog3=function(t){this.setState({recipients:this.state.recipients.push(t)})}.bind(this),this.$BrowserExtensionsShareChatTabDialog4=function(t){var u=this.state.recipients;this.setState({recipients:u["delete"](u.indexOf(t))})}.bind(this),this.$BrowserExtensionsShareChatTabDialog2=function(){this.setState({recipients:c("immutable").List()})}.bind(this),this.$BrowserExtensionsShareChatTabDialog6=function(){__p&&__p();this.setState({isSending:true});var t=this.state.recipients.map(function(v){return v.getUniqueID()}).toArray(),u=c("MessengerPlatformBeginShareMutationWebGraphQLMutation").getURI({content_for_preview:{button_url:this.props.buttonUrl,button_title:this.props.buttonTitle,image_url:this.props.imageUrl,item_url:this.props.itemUrl,open_graph_url:this.props.openGraphUrl,preview_type:this.props.previewType,subtitle:this.props.subtitle,target_display:this.props.targetDisplay,title:this.props.title,attachment_id:this.props.attachmentID,facebook_media_url:this.props.facebookMediaUrl,media_type:this.props.mediaType},content_for_share:this.props.contentForShare,message_text:this.state.message,page_id:this.props.pageID,thread_ids:this.props.sharingType===m?t:this.props.threadID,trigger:this.props.sharingType===m?"JS_BRIDGE_BROADCAST":"JS_BRIDGE_DIRECT"});new(c("AsyncRequest"))(u).setHandler(function(v){var w;if(this.$BrowserExtensionsShareChatTabDialog1)this.setState({isSending:false});var x=(w=v)!=null?(w=w.payload)!=null?(w=w.errors)!=null?w[0]:w:w:w;if(x){var y=x?x.code:null;this.props.errorCallback(c("BrowserExtensionsErrorHandler").getExternalError(y))}else this.props.successCallback({is_sent:true})}.bind(this)).send()}.bind(this),p}n.prototype.componentDidMount=function(){this.$BrowserExtensionsShareChatTabDialog1=true};n.prototype.componentWillUnmount=function(){this.$BrowserExtensionsShareChatTabDialog1=false};n.prototype.render=function(){var o=this.props.sharingType===m?i._("Compartir"):i._("Enviar a la conversaci\u00f3n actual"),p=this.props.sharingType===m?this.state.recipients.size!==0:true,q=this.props.sharingType===m?c("React").createElement(c("MessengerComposeViewHeader.react"),{className:"_189v",forceHideClearButton:false,onClear:this.$BrowserExtensionsShareChatTabDialog2,onAddRecipient:this.$BrowserExtensionsShareChatTabDialog3,onRemoveRecipient:this.$BrowserExtensionsShareChatTabDialog4,onResize:c("emptyFunction"),recipients:this.state.recipients,viewer:c("CurrentUser").getID()}):null,r=this.props.sharingType===m?c("React").createElement("div",{className:"_4te6"},c("React").createElement(c("AbstractTextArea.react"),{autoFocus:true,className:"_4te8",disabled:this.state.isSending,onChange:function(u){return this.setState({message:u.target.value})}.bind(this),placeholder:i._("Escribe un mensaje..."),rows:2,value:this.state.message})):null,s=this.state.isSending?c("React").createElement(c("XUISpinner.react"),{size:"large"}):null,t=this.props.imageUrl?this.props.imageUrl:this.props.facebookMediaPreviewUrl;return c("React").createElement("div",null,c("React").createElement(c("XUIDialogHeader.react"),null,c("React").createElement(c("XUIDialogHeaderTitle.react"),null,o)),c("React").createElement(c("XUIDialogBody.react"),{className:"_189w"},q,r,c("React").createElement("div",{className:"_5l-3"},c("React").createElement("div",{className:"_4tea"},c("React").createElement(c("Image.react"),{src:t})),c("React").createElement("div",{className:"_4tef"},c("React").createElement("div",{style:{fontWeight:"bold"}},this.$BrowserExtensionsShareChatTabDialog5(this.props.title)),c("React").createElement("div",null,this.$BrowserExtensionsShareChatTabDialog5(this.props.subtitle)),c("React").createElement("div",null,this.$BrowserExtensionsShareChatTabDialog5(this.props.targetDisplay))))),c("React").createElement(c("XUIDialogFooter.react"),{leftContent:s},c("React").createElement(c("XUIDialogCancelButton.react"),null),c("React").createElement(c("XUIDialogButton.react"),{action:"confirm",disabled:this.state.isSending||!p,label:i._("Enviar"),onClick:this.$BrowserExtensionsShareChatTabDialog6,use:"default"})))};n.prototype.$BrowserExtensionsShareChatTabDialog5=function(o){return c("React").createElement(c("MessengerTextWithEntities.react"),{renderEmoji:true,text:o||""})};n.propTypes={buttonTitle:l.string,buttonUrl:l.string,contentForShare:l.string,imageUrl:l.string,itemUrl:l.string,openGraphUrl:l.string,facebookMediaUrl:l.string,facebookMediaPreviewUrl:l.string,attachmentID:l.string,mediaType:l.string,previewType:l.string,subtitle:l.string,targetDisplay:l.string,title:l.string,sharingType:l.string.isRequired,pageID:l.string.isRequired,threadID:l.string.isRequired,successCallback:l.func.isRequired,errorCallback:l.func.isRequired};f.exports=n}),null);
__d("BrowserExtensionsShareMessengerDialog.react",["cx","fbt","AbstractTextArea.react","AsyncRequest","MessengerPlatformBeginShareMutationWebGraphQLMutation","CurrentUser","BrowserExtensionsErrorHandler","Image.react","immutable","LayerFadeOnHide","MessengerComposeViewHeader.react","MessengerDialog.react","MessengerDialogs.bs","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogTitle.react","MessengerSpinner.react","MessengerTextWithEntities.react","React","emptyFunction","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("MessengerDialogBodyReact.bs").jsComponent,m=c("React").PropTypes,n="broadcast";j=babelHelpers.inherits(o,c("React").Component);k=j&&j.prototype;function o(){__p&&__p();var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=k.constructor).call.apply(p,[this].concat(s)),this.state={clickedSend:false,isSending:false,message:"",recipients:c("immutable").List()},this.$BrowserExtensionsShareMessengerDialog3=function(u){this.setState({recipients:this.state.recipients.push(u)})}.bind(this),this.$BrowserExtensionsShareMessengerDialog4=function(u){var v=this.state.recipients;this.setState({recipients:v["delete"](v.indexOf(u))})}.bind(this),this.$BrowserExtensionsShareMessengerDialog2=function(){this.setState({recipients:c("immutable").List()})}.bind(this),this.$BrowserExtensionsShareMessengerDialog7=function(){__p&&__p();this.setState({clickedSend:true,isSending:true});var u=this.state.recipients.map(function(w){return w.getUniqueID()}).toArray(),v=c("MessengerPlatformBeginShareMutationWebGraphQLMutation").getURI({content_for_preview:{button_url:this.props.buttonUrl,button_title:this.props.buttonTitle,image_url:this.props.imageUrl,item_url:this.props.itemUrl,open_graph_url:this.props.openGraphUrl,preview_type:this.props.previewType,subtitle:this.props.subtitle,target_display:this.props.targetDisplay,title:this.props.title,attachment_id:this.props.attachmentID,facebook_media_url:this.props.facebookMediaUrl,media_type:this.props.mediaType},content_for_share:this.props.contentForShare,message_text:this.state.message,page_id:this.props.pageID,thread_ids:this.props.sharingType===n?u:this.props.threadID,trigger:this.props.sharingType===n?"JS_BRIDGE_BROADCAST":"JS_BRIDGE_DIRECT"});new(c("AsyncRequest"))(v).setHandler(function(w){__p&&__p();var x;if(this.$BrowserExtensionsShareMessengerDialog1)this.setState({isSending:false},function(){c("MessengerDialogs.bs").removeDialog()});var y=(x=w)!=null?(x=x.payload)!=null?(x=x.errors)!=null?x[0]:x:x:x;if(y){var z=y?y.code:null;this.props.errorCallback(c("BrowserExtensionsErrorHandler").getExternalError(z))}else this.props.successCallback({is_sent:true})}.bind(this)).send()}.bind(this),this.$BrowserExtensionsShareMessengerDialog5=function(u){if(!u){if(!this.state.clickedSend)this.props.successCallback({is_sent:false});c("MessengerDialogs.bs").removeDialog()}}.bind(this),q}o.prototype.componentDidMount=function(){this.$BrowserExtensionsShareMessengerDialog1=true};o.prototype.componentWillUnmount=function(){this.$BrowserExtensionsShareMessengerDialog1=false};o.prototype.render=function(){var p=this.props.sharingType===n?i._("Compartir"):i._("Enviar a la conversaci\u00f3n actual"),q=this.props.sharingType===n?this.state.recipients.size!==0:true,r=this.props.sharingType===n?c("React").createElement(c("MessengerComposeViewHeader.react"),{className:"_189v",forceHideClearButton:false,onClear:this.$BrowserExtensionsShareMessengerDialog2,onAddRecipient:this.$BrowserExtensionsShareMessengerDialog3,onRemoveRecipient:this.$BrowserExtensionsShareMessengerDialog4,onResize:c("emptyFunction"),recipients:this.state.recipients,viewer:c("CurrentUser").getID()}):null,s=this.props.sharingType===n?c("React").createElement("div",{className:"_4te6"},c("React").createElement(c("AbstractTextArea.react"),{autoFocus:true,className:"_4te8",disabled:this.state.isSending,onChange:function(v){return this.setState({message:v.target.value})}.bind(this),placeholder:i._("Escribe un mensaje..."),rows:2,value:this.state.message})):null,t=this.state.isSending?c("React").createElement(c("MessengerSpinner.react"),null):null,u=this.props.imageUrl?this.props.imageUrl:this.props.facebookMediaPreviewUrl;return c("React").createElement(c("MessengerDialog.react"),{behaviors:{LayerFadeOnHide:c("LayerFadeOnHide")},hideOnEscape:true,onToggle:this.$BrowserExtensionsShareMessengerDialog5,shown:true,width:500},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,p)),c("React").createElement(l,{className:"_189w"},r,s,c("React").createElement("div",{className:"_5l-3"},c("React").createElement("div",{className:"_4tea"},c("React").createElement(c("Image.react"),{src:u})),c("React").createElement("div",{className:"_4tef"},c("React").createElement("div",{style:{fontWeight:"bold"}},this.$BrowserExtensionsShareMessengerDialog6(this.props.title)),c("React").createElement("div",null,this.$BrowserExtensionsShareMessengerDialog6(this.props.subtitle)),c("React").createElement("div",null,this.$BrowserExtensionsShareMessengerDialog6(this.props.targetDisplay))))),c("React").createElement(c("MessengerDialogFooter.react"),{leftContent:t},c("React").createElement(c("MessengerDialogCancelButton.react"),null),c("React").createElement(c("MessengerDialogButton.react"),{action:"confirm",disabled:this.state.isSending||!q,label:i._("Enviar"),onClick:this.$BrowserExtensionsShareMessengerDialog7,type:"primary"})))};o.prototype.$BrowserExtensionsShareMessengerDialog6=function(p){return c("React").createElement(c("MessengerTextWithEntities.react"),{renderEmoji:true,text:p||""})};o.propTypes={buttonTitle:m.string,buttonUrl:m.string,contentForShare:m.string,imageUrl:m.string,itemUrl:m.string,openGraphUrl:m.string,facebookMediaUrl:m.string,facebookMediaPreviewUrl:m.string,attachmentID:m.string,mediaType:m.string,previewType:m.string,subtitle:m.string,targetDisplay:m.string,title:m.string,sharingType:m.string.isRequired,pageID:m.string.isRequired,threadID:m.string.isRequired,successCallback:m.func.isRequired,errorCallback:m.func.isRequired};f.exports=o}),null);
__d("MessengerPlatformMediaAttachmentPreviewWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1480172682071484"};j.getQueryID=function(){"use strict";return"1145458142265315"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("BrowserExtensionsBeginShareHelper",["AsyncRequest","BrowserExtensionsShareChatTabDialog.react","BrowserExtensionsShareMessengerDialog.react","DialogX","BrowserExtensionsErrorHandler","LayerDestroyOnHide","LayerFadeOnHide","LayerHideOnBlur","MessengerPlatformMediaAttachmentPreviewWebGraphQLQuery","MessengerDialogs.bs","MessengerEnvironment","React","WebGraphQL","XShareScrapeAttachmentAsyncController","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="OPEN_GRAPH",i=150,j=150;function k(m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){__p&&__p();var F;if(c("MessengerEnvironment").messengerui)c("MessengerDialogs.bs").showDialog(function(){return c("React").createElement(c("BrowserExtensionsShareMessengerDialog.react"),{buttonTitle:m,buttonUrl:n,contentForShare:o,imageUrl:p,itemUrl:q,openGraphUrl:r,facebookMediaUrl:s,facebookMediaPreviewUrl:t,attachmentID:u,mediaType:v,previewType:w,subtitle:x,targetDisplay:y,title:z,sharingType:A,pageID:B,threadID:C,successCallback:D,errorCallback:E})});else(function(){var G={width:500,addedBehaviors:[c("LayerDestroyOnHide"),c("LayerFadeOnHide"),c("LayerHideOnBlur")]},H=c("React").createElement(c("BrowserExtensionsShareChatTabDialog.react"),{buttonTitle:m,buttonUrl:n,contentForShare:o,imageUrl:p,itemUrl:q,openGraphUrl:r,facebookMediaUrl:s,facebookMediaPreviewUrl:t,attachmentID:u,mediaType:v,previewType:w,subtitle:x,targetDisplay:y,title:z,sharingType:A,pageID:B,threadID:C,successCallback:D,errorCallback:E}),I=new(c("DialogX"))(G,H);I.subscribe("confirm",function(){I.hide()});I.subscribe("cancel",function(){D({is_sent:false})});I.show()})()}var l={beginShareFlow:function m(n,o,p,q,r,s,t){__p&&__p();if(r.preview_type===h){var u=c("XShareScrapeAttachmentAsyncController").getURIBuilder().getURI();new(c("AsyncRequest"))().setMethod("POST").setURI(u).setData({image_height:i,image_width:j,uri:r.open_graph_url}).setHandler(function(v){var w,x,y,z=(w=v)!=null?(w=w.payload)!=null?(w=w.media)!=null?w.image:w:w:w,A=(x=v)!=null?(x=x.payload)!=null?x.title:x:x,B=(y=v)!=null?(y=y.payload)!=null?(y=y.target)!=null?(y=y.artists)!=null?y[0]:y:y:y:y;k(r.button_title,r.button_url,q,z,r.item_url,r.open_graph_url,null,null,null,null,r.preview_type,B,r.target_display,A,p,n,o,s,t)}).send()}else if(!r.image_url)c("WebGraphQL").exec(new(c("MessengerPlatformMediaAttachmentPreviewWebGraphQLQuery"))({params:{attachment_id:r.attachment_id,page_id:n,url:r.facebook_media_url,media_type:r.media_type}})).done(function(v){var w=v.messenger_platform_media_attachment_preview_info;k(r.button_title,r.button_url,q,null,r.item_url,r.open_graph_url,r.facebook_media_url,w.media_attachment.image.uri,r.attachment_id,r.media_type,r.preview_type,r.subtitle,r.target_display,r.title,p,n,o,s,t)},function(v){var w,x=(w=v)!=null?(w=w.errors)!=null?(w=w[0])!=null?w.code:w:w:w;t(c("BrowserExtensionsErrorHandler").getExternalError(x))});else k(r.button_title,r.button_url,q,r.image_url,r.item_url,r.open_graph_url,r.facebook_media_url,null,r.attachment_id,r.media_type,r.preview_type,r.subtitle,r.target_display,r.title,p,n,o,s,t)}};f.exports=l}),null);
__d("BrowserExtensionsAskPermissionsChatTabDialog.react",["cx","BrowserExtensionsTypedLogger","BrowserExtensionsPermissionsHelper","Image.react","React","URI","XUIDialogBody.react","XUIDialogButton.react","XUIDialogFooter.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",null,c("React").createElement(c("XUIDialogBody.react"),null,c("React").createElement("div",null,c("React").createElement(c("Image.react"),{className:"_5_jw",src:this.props.profileImageUrl})),this.props.message),c("React").createElement(c("XUIDialogFooter.react"),null,c("React").createElement(c("XUIDialogButton.react"),{action:"cancel",label:this.props.rejectButtonTitle,onClick:function(){this.$BrowserExtensionsAskPermissionsChatTabDialog1(false)}.bind(this)}),c("React").createElement(c("XUIDialogButton.react"),{action:"cancel",label:this.props.confirmButtonTitle,onClick:function(){this.$BrowserExtensionsAskPermissionsChatTabDialog1(true);c("BrowserExtensionsPermissionsHelper").grantPermissions(this.props.pageID,this.props.threadID,this.props.permissionToGrant,this.props.successCallback,this.props.errorCallback)}.bind(this),use:"confirm"})))};l.prototype.$BrowserExtensionsAskPermissionsChatTabDialog1=function(m){new(c("BrowserExtensionsTypedLogger"))().setAPIEndpoint("askPermission").setExtraClientData(JSON.stringify({source:"platform_api",extension_type:"messenger_extension",permission_requested:this.props.permissionToGrant,permission_accepted:m})).setName("browser_extensions_permission_dialog_action").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()};function l(){i.apply(this,arguments)}l.propTypes={thirdPartyURI:k.instanceOf(c("URI")).isRequired,pageID:k.string.isRequired,threadID:k.string.isRequired,message:k.string.isRequired,profileImageUrl:k.string.isRequired,confirmButtonTitle:k.string.isRequired,rejectButtonTitle:k.string.isRequired,permissionToGrant:k.string.isRequired,successCallback:k.func.isRequired,errorCallback:k.func.isRequired};f.exports=l}),null);
__d("BrowserExtensionsAskPermissionsMessengerDialog.react",["cx","BrowserExtensionsPermissionsHelper","BrowserExtensionsTypedLogger","Image.react","LayerFadeOnHide","MessengerDialog.react","MessengerDialogs.bs","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","React","URI"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("MessengerDialogBodyReact.bs").jsComponent,l=c("React").PropTypes;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={clickedConfirm:false},this.$BrowserExtensionsAskPermissionsMessengerDialog1=function(s){if(!s){if(!this.state.clickedConfirm)this.props.successCallback({permissions:this.props.grantedPermissions});c("MessengerDialogs.bs").removeDialog()}}.bind(this),o}m.prototype.render=function(){return c("React").createElement(c("MessengerDialog.react"),{behaviors:{LayerFadeOnHide:c("LayerFadeOnHide")},hideOnEscape:true,onToggle:this.$BrowserExtensionsAskPermissionsMessengerDialog1,shown:true},c("React").createElement(k,null,c("React").createElement("div",null,c("React").createElement(c("Image.react"),{className:"_5_jw",src:this.props.profileImageUrl})),this.props.message),c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogCancelButton.react"),{label:this.props.rejectButtonTitle,onClick:function(){this.$BrowserExtensionsAskPermissionsMessengerDialog2(false)}.bind(this)}),c("React").createElement(c("MessengerDialogButton.react"),{action:"confirm",label:this.props.confirmButtonTitle,onClick:function(){this.setState({clickedConfirm:true},function(){this.$BrowserExtensionsAskPermissionsMessengerDialog2(true);c("MessengerDialogs.bs").removeDialog();c("BrowserExtensionsPermissionsHelper").grantPermissions(this.props.pageID,this.props.threadID,this.props.permissionToGrant,this.props.successCallback,this.props.errorCallback)}.bind(this))}.bind(this),type:"primary"})))};m.prototype.$BrowserExtensionsAskPermissionsMessengerDialog2=function(n){new(c("BrowserExtensionsTypedLogger"))().setAPIEndpoint("askPermission").setExtraClientData(JSON.stringify({source:"platform_api",extension_type:"messenger_extension",permission_requested:this.props.permissionToGrant,permission_accepted:n})).setName("browser_extensions_permission_dialog_action").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()};m.propTypes={thirdPartyURI:l.instanceOf(c("URI")).isRequired,pageID:l.string.isRequired,threadID:l.string.isRequired,message:l.string.isRequired,profileImageUrl:l.string.isRequired,confirmButtonTitle:l.string.isRequired,rejectButtonTitle:l.string.isRequired,permissionToGrant:l.string.isRequired,grantedPermissions:l.arrayOf(l.string).isRequired,successCallback:l.func.isRequired,errorCallback:l.func.isRequired};f.exports=m}),null);
__d("MessengerPlatformGrantPermissionsMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1544630875548192"};j.getQueryID=function(){"use strict";return"611085139087610"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("MessengerPlatformPermissionWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1068951296538364"};j.getQueryID=function(){"use strict";return"1526731417350771"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("BrowserExtensionsPermissionsHelper",["AsyncRequest","BrowserExtensionsAskPermissionsChatTabDialog.react","BrowserExtensionsAskPermissionsMessengerDialog.react","BrowserExtensionsTypedLogger","DialogX","BrowserExtensionsErrorHandler","MessengerPlatformGrantPermissionsMutationWebGraphQLMutation","LayerDestroyOnHide","LayerFadeOnHide","LayerHideOnBlur","MessengerDialogs.bs","MessengerEnvironment","MessengerPlatformPermissionWebGraphQLQuery","React","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j,k,l,m,n,o,p,q,r,s,t){__p&&__p();var u;if(c("MessengerEnvironment").messengerui)c("MessengerDialogs.bs").showDialog(function(){return c("React").createElement(c("BrowserExtensionsAskPermissionsMessengerDialog.react"),{thirdPartyURI:j,pageID:k,threadID:l,message:m,profileImageUrl:n,confirmButtonTitle:o,rejectButtonTitle:p,permissionToGrant:q,grantedPermissions:r,successCallback:s,errorCallback:t})});else(function(){var v={width:400,addedBehaviors:[c("LayerDestroyOnHide"),c("LayerFadeOnHide"),c("LayerHideOnBlur")]},w=c("React").createElement(c("BrowserExtensionsAskPermissionsChatTabDialog.react"),{thirdPartyURI:j,pageID:k,threadID:l,message:m,profileImageUrl:n,confirmButtonTitle:o,rejectButtonTitle:p,permissionToGrant:q,successCallback:s,errorCallback:t}),x=new(c("DialogX"))(v,w),y=false;x.subscribe("confirm",function(){y=true});x.subscribe("hide",function(){if(!y)s({permissions:r})});x.show()})();new(c("BrowserExtensionsTypedLogger"))().setAPIEndpoint("askPermission").setName("browser_extensions_permission_dialog_shown").setWebsiteURL(j.toString()).setStartURL(j.toString()).setStringPageID(k).setThreadID(l).log()}var i={askPermissions:function j(k,l,m,n,o,p){__p&&__p();var q=c("MessengerPlatformPermissionWebGraphQLQuery").getURI({params:{page_id:l,thread_id:m},selected_permissions:[n]});new(c("AsyncRequest"))().setURI(q).setHandler(function(r){__p&&__p();var s,t,u,v=(s=r)!=null?(s=s.payload)!=null?(s=s.data)!=null?(s=s.messenger_platform_permission)!=null?(s=s.selected_permission_infos)!=null?s[0]:s:s:s:s:s,w=(t=r)!=null?(t=t.payload)!=null?(t=t.data)!=null?(t=t.messenger_platform_permission)!=null?t.granted_permission_infos:t:t:t:t,x=(u=r)!=null?(u=u.payload)!=null?(u=u.errors)!=null?u[0]:u:u:u;if(!w){var y=x?x.code:null;p(c("BrowserExtensionsErrorHandler").getExternalError(y))}else{var z=w.map(function(B){return B.permission_type});if(!v||v.is_granted)o({permissions:z});else{var A=v.dialog_info;h(k,l,m,A.title,A.profile_image.uri,A.confirm_button_text,A.reject_button_text,n,z,o,p)}}}).send()},grantPermissions:function j(k,l,m,n,o){__p&&__p();var p=c("MessengerPlatformGrantPermissionsMutationWebGraphQLMutation").getURI({page_id:k,thread_id:l,permissions:[m]});new(c("AsyncRequest"))().setURI(p).setHandler(function(q){var r,s,t=(r=q)!=null?(r=r.payload)!=null?(r=r.data)!=null?(r=r.messenger_platform_grant_permissions)!=null?r.granted_permission_infos:r:r:r:r,u=(s=q)!=null?(s=s.payload)!=null?(s=s.errors)!=null?s[0]:s:s:s;if(t){var v=t.map(function(x){return x.permission_type});n({permissions:v})}else{var w=u?u.code:null;o(c("BrowserExtensionsErrorHandler").getExternalError(w))}}).send()}};f.exports=i}),null);
__d("MessengerPlatformGetContextMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1350985785027565"};j.getQueryID=function(){"use strict";return"182243942324918"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("BrowserExtensionsDesktopController",["AsyncRequest","BrowserExtensionsBeginShareHelper","BrowserExtensionsPermissionsHelper","BrowserExtensionsTypedLogger","DOMEventListener","BrowserExtensionsErrorHandler","MessengerPlatformGetContextMutationWebGraphQLMutation","JSONRPC","MessengerPlatformPermissionWebGraphQLQuery","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="MESSENGER_EXTENSIONS_RPC:";function i(m,n,o,p,q,r,s){var t=c("MessengerPlatformGetContextMutationWebGraphQLMutation").getURI({actor_id:p,app_id:q,page_id:n,thread_id:o,extension_uri:m.getOrigin()});new(c("AsyncRequest"))().setURI(t).setHandler(function(u){var v,w,x=(v=u)!=null?(v=v.payload)!=null?(v=v.data)!=null?v.messenger_platform_get_context:v:v:v,y=(w=u)!=null?(w=w.payload)!=null?(w=w.errors)!=null?w[0]:w:w:w;if(x)r(x);else{var z=y?y.code:null;s(c("BrowserExtensionsErrorHandler").getExternalError(z))}}).send()}function j(m,n,o,p){__p&&__p();var q=c("MessengerPlatformPermissionWebGraphQLQuery").getURI({params:{page_id:m,thread_id:n}});new(c("AsyncRequest"))().setURI(q).setHandler(function(r){var s,t,u=(s=r)!=null?(s=s.payload)!=null?(s=s.data)!=null?(s=s.messenger_platform_permission)!=null?s.granted_permission_infos:s:s:s:s,v=(t=r)!=null?(t=t.payload)!=null?(t=t.errors)!=null?t[0]:t:t:t;if(u){var w=u.map(function(y){return y.permission_type});o({permissions:w})}else{var x=v?v.code:null;p(c("BrowserExtensionsErrorHandler").getExternalError(x))}}).send()}function k(m,n,o){m(n)}function l(m,n,o,p,q,r){__p&&__p();var s=new(c("JSONRPC"))(function(u){var v=m instanceof HTMLIFrameElement?m.contentWindow:m;v.postMessage(h+u,n.getOrigin())});this.$BrowserExtensionsDesktopController1=c("DOMEventListener").add(window,"message",function(event){if(typeof event.data!=="string"||!event.data.startsWith(h))return;s.read(event.data.substring(h.length))},false);function t(u){new(c("BrowserExtensionsTypedLogger"))().setAPIEndpoint(u).setName("browser_extensions_native_bridge_called").setWebsiteURL(n.toString()).setStartURL(n.toString()).setStringPageID(o).setThreadID(p).log()}s.local.askPermission=function(u,v,w){t("askPermission");c("BrowserExtensionsPermissionsHelper").askPermissions(n,o,p,u,v,w)};s.local.beginShareFlow=function(u,v,w,x,y){t("beginShareFlow");c("BrowserExtensionsBeginShareHelper").beginShareFlow(o,p,u,v,w,x,y)};s.local.getContext=function(u,v,w){t("getContext");i(n,o,p,q,u,v,w)};s.local.getGrantedPermissions=function(u,v){t("getGrantedPermissions");j(o,p,u,v)};s.local.requestCloseBrowser=function(u,v){t("requestCloseBrowser");k(r,u,v)}}l.prototype.getListener=function(){return this.$BrowserExtensionsDesktopController1};f.exports=l}),null);
__d("BrowserExtensionsDesktopCoordinator",["BrowserExtensionsDesktopController"],(function a(b,c,d,e,f,g){"use strict";var h=void 0,i={setActiveBridge:function j(k,l,m,n,o,p){if(h)h.remove();var q=new(c("BrowserExtensionsDesktopController"))(k,l,m,n,o,p);h=q.getListener()}};f.exports=i}),null);
__d("BrowserExtensionsIframe.react",["BrowserExtensionsDesktopCoordinator","BrowserExtensionsTypedLogger","ControlledRefererIFrame.react","MessengerEnvironment","React","URI","isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes;h=babelHelpers.inherits(k,c("React").Component);i=h&&h.prototype;k.prototype.componentDidMount=function(){if(this.refs.iframeRef){c("BrowserExtensionsDesktopCoordinator").setActiveBridge(this.refs.iframeRef,this.props.thirdPartyURI,this.props.pageID,this.props.threadID,this.props.userID,this.props.closeDialogHandler);new(c("BrowserExtensionsTypedLogger"))().setName("browser_extensions_browser_open").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()}};k.prototype.componentWillUnmount=function(){new(c("BrowserExtensionsTypedLogger"))().setName("browser_extensions_browser_closed").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()};k.prototype.render=function(){var l=new(c("URI"))(window.location.href),m=this.props.thirdPartyURI,n={ref:"iframeRef",src:m.addQueryData("fb_iframe_origin",l.getOrigin()).toString(),name:c("isFacebookURI")(l)?"facebook_ref":"messenger_ref",style:{border:0,height:this.props.height,width:this.props.width}};return c("isFacebookURI")(m)?c("React").createElement("iframe",n):c("React").createElement(c("ControlledRefererIFrame.react"),n)};function k(){h.apply(this,arguments)}k.propTypes={thirdPartyURI:j.instanceOf(c("URI")).isRequired,pageID:j.string.isRequired,threadID:j.string.isRequired,userID:j.string.isRequired,height:j.number.isRequired,width:j.number.isRequired,closeDialogHandler:j.func.isRequired};f.exports=k}),null);
__d("MessengerPageInfoWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1340699622714874"};j.getQueryID=function(){"use strict";return"794225320759977"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("BrowserExtensionsChatTabDialog.react",["cx","fbt","MessengerConstants","AsyncRequest","BrowserExtensionsIframe.react","Image.react","MessengerPageInfoWebGraphQLQuery","React","URI","XUICloseButton.react","XUIDialogBody.react","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("MessengerConstants").BROWSER_EXTENSIONS_DIALOG_DIMENSIONS,m=c("React").PropTypes;j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={profilePicUrl:null,title:null},p}n.prototype.componentDidMount=function(){var o=c("MessengerPageInfoWebGraphQLQuery").getURI({node_id:this.props.pageID});new(c("AsyncRequest"))().setURI(o).setHandler(function(p){var q,r,s=(q=p)!=null?(q=q.payload)!=null?(q=q.data)!=null?(q=q.node)!=null?(q=q.profile_picture)!=null?q.uri:q:q:q:q:q,t=(r=p)!=null?(r=r.payload)!=null?(r=r.data)!=null?(r=r.node)!=null?r.name:r:r:r:r;this.setState({profilePicUrl:s,title:t})}.bind(this)).send()};n.prototype.render=function(){return c("React").createElement("div",null,c("React").createElement("div",{className:"_4-i0"},c("React").createElement("div",{className:"_5l-3 _3qur"},c("React").createElement("div",{className:"_3o_f"},c("React").createElement(c("Image.react"),{className:"_3o_g",src:this.state.profilePicUrl})),c("React").createElement("div",{className:"_3o_i"},this.state.title),c("React").createElement("div",{className:"_3qus"},c("React").createElement(c("XUICloseButton.react"),{className:"layerCancel _51-t",label:i._("Cerrar")})))),c("React").createElement(c("XUIDialogBody.react"),{className:"_3o_l"},c("React").createElement(c("BrowserExtensionsIframe.react"),{thirdPartyURI:this.props.thirdPartyURI,pageID:this.props.pageID,threadID:this.props.threadID,userID:this.props.userID,height:this.props.height,width:this.props.width,closeDialogHandler:this.props.closeDialogHandler})))};n.defaultProps={height:l.HEIGHT,width:l.WIDTH};n.propTypes={thirdPartyURI:m.instanceOf(c("URI")).isRequired,pageID:m.string.isRequired,threadID:m.string.isRequired,userID:m.string.isRequired,height:m.number,width:m.number,closeDialogHandler:m.func.isRequired};f.exports=n}),null);
__d("BrowserExtensionsMessengerDialog.react",["cx","MessengerConstants","AsyncRequest","BrowserExtensionsIframe.react","Image.react","LayerFadeOnHide","MessengerDialog.react","MessengerDialogs.bs","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogHeader.react","MessengerPageInfoWebGraphQLQuery","React","URI","idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("MessengerConstants").BROWSER_EXTENSIONS_DIALOG_DIMENSIONS,l=c("MessengerDialogBodyReact.bs").jsComponent,m=c("React").PropTypes;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={profilePicUrl:null,title:null,shown:true},this.$BrowserExtensionsMessengerDialog3=function(t){this.setState({shown:false},t)}.bind(this),p}n.prototype.componentDidMount=function(){var o=c("MessengerPageInfoWebGraphQLQuery").getURI({node_id:this.props.pageID});this.$BrowserExtensionsMessengerDialog1=new(c("AsyncRequest"))().setURI(o).setHandler(function(p){var q,r,s=(q=p)!=null?(q=q.payload)!=null?(q=q.data)!=null?(q=q.node)!=null?(q=q.profile_picture)!=null?q.uri:q:q:q:q:q,t=(r=p)!=null?(r=r.payload)!=null?(r=r.data)!=null?(r=r.node)!=null?r.name:r:r:r:r;this.setState({profilePicUrl:s,title:t})}.bind(this));this.$BrowserExtensionsMessengerDialog1.send()};n.prototype.componentWillUnmount=function(){this.$BrowserExtensionsMessengerDialog1&&this.$BrowserExtensionsMessengerDialog1.abandon()};n.prototype.render=function(){return c("React").createElement(c("MessengerDialog.react"),{behaviors:{LayerFadeOnHide:c("LayerFadeOnHide")},hideOnEscape:true,onToggle:this.$BrowserExtensionsMessengerDialog2,shown:this.state.shown,type:"default",width:this.props.width},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement("div",{className:"_5l-3 _3o_e"},c("React").createElement("div",{className:"_3o_f"},c("React").createElement(c("Image.react"),{className:"_3o_g",src:this.state.profilePicUrl})),c("React").createElement("div",{className:"_3o_i"},this.state.title),c("React").createElement("div",{className:"_3o_f"},c("React").createElement(c("MessengerDialogButton.react"),{action:"cancel",className:"_3o_k",label:"",type:"primary",use:"default"})))),c("React").createElement(l,{className:"_3o_l"},c("React").createElement(c("BrowserExtensionsIframe.react"),{thirdPartyURI:this.props.thirdPartyURI,pageID:this.props.pageID,threadID:this.props.threadID,userID:this.props.userID,height:this.props.height,width:this.props.width,closeDialogHandler:this.$BrowserExtensionsMessengerDialog3})))};n.prototype.$BrowserExtensionsMessengerDialog2=function(o){if(!o)c("MessengerDialogs.bs").removeDialog()};n.defaultProps={height:k.HEIGHT,width:k.WIDTH};n.propTypes={thirdPartyURI:m.instanceOf(c("URI")).isRequired,pageID:m.string.isRequired,threadID:m.string.isRequired,userID:m.string.isRequired,height:m.number,width:m.number};f.exports=n}),null);
__d("BrowserExtensionsDialog",["MessengerConstants","BrowserExtensionsChatTabDialog.react","BrowserExtensionsMessengerDialog.react","DialogX","LayerDestroyOnHide","LayerFadeOnHide","LayerHideOnBlur","MessengerDialogs.bs","MessengerEnvironment","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MessengerConstants").BROWSER_EXTENSIONS_DIALOG_DIMENSIONS,i={show:function j(k,l,m,n){var o;if(c("MessengerEnvironment").messengerui)c("MessengerDialogs.bs").showDialog(function(){return c("React").createElement(c("BrowserExtensionsMessengerDialog.react"),{thirdPartyURI:k,pageID:l,threadID:m,userID:n})});else(function(){var p=void 0,q={width:h.WIDTH,addedBehaviors:[c("LayerDestroyOnHide"),c("LayerFadeOnHide"),c("LayerHideOnBlur")]},r=c("React").createElement(c("BrowserExtensionsChatTabDialog.react"),{thirdPartyURI:k,pageID:l,threadID:m,userID:n,closeDialogHandler:function s(t){return i.hideChatTabDialog(p,t)}});p=new(c("DialogX"))(q,r);p.show()})()},hideChatTabDialog:function j(k,l){if(k){k.hide();l()}}};f.exports=i}),null);
__d("FBPaymentsSerializableCheckoutConfigurationParser",["FBPaymentsContentConfigurationParser"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={parse:function i(j){var k=JSON.parse(j);return this._parseCheckoutConfiguration(k.checkout_configuration)},_parseCheckoutConfiguration:function i(j){var k={version:j.version,paymentInfo:this._parsePaymentInfo(j.payment_info),contentConfiguration:c("FBPaymentsContentConfigurationParser").parse(j.version,j.content_configuration),orderStatusModel:this._parseOrderStatusModel(j.order_status_model)};return k},_parsePaymentInfo:function i(j){var k={paymentItemType:j.payment_item_type,receiverId:j.receiver_id,orderId:j.order_id,action:j.action,extraData:j.extra_data};return k},_parseOrderStatusModel:function i(j){var k={type:j.type};return k}};f.exports=h}),null);
__d("GraphQLMessengerPlatformCtaPostHandlingWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1570574486349284"};j.getQueryID=function(){"use strict";return"389945858066688"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("XMNCommerceCTAPostProcessController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messages/commerce/cta/postprocess/",{cta_id:{type:"String",required:true},message_id:{type:"String"}})}),null);
__d("MNCommerceCTAProcessor",["AsyncRequest","GraphQLMessengerPlatformCtaPostHandlingWebGraphQLMutation","PopupWindow","XMNCommerceCTAPostProcessController"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.prototype.process=function(i){var j=arguments.length<=1||arguments[1]===undefined?null:arguments[1],k=c("PopupWindow").open("",500,1024),l=c("XMNCommerceCTAPostProcessController").getURIBuilder().setString("cta_id",i).setString("message_id",j).getURI();new(c("AsyncRequest"))().setURI(l).setMethod("POST").setHandler(function(m){return k.location=m.payload}).send()};h.prototype.postHandle=function(i,j){var k=c("GraphQLMessengerPlatformCtaPostHandlingWebGraphQLMutation").getURI({cta_id:i,message_id:j});new(c("AsyncRequest"))().setURI(k).send()};function h(){}f.exports=new h()}),null);
__d("MNCommerceCallToActionGenericIntentHandler",["cx","fbt","Link.react","MNCommerceCTAProcessor","React","Tooltip","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();function j(){this.fallbackOnClick=function(){};this.onClickHook=function(){};this.threadID=null}j.prototype.setFallbackOnClick=function(k){this.fallbackOnClick=k;return this};j.prototype.setThreadID=function(k){if(k)this.threadID=k;return this};j.prototype.setOnClickHook=function(k){this.onClickHook=k;return this};j.prototype.renderForWebLink=function(k,l){var m=k.onClick||this.fallbackOnClick,n=function(event){this.onClickHook();m(event);c("MNCommerceCTAProcessor").postHandle(k.id,null)}.bind(this);return c("React").createElement(c("Link.react"),{className:l,href:k.onClick?null:k.action_link||k.action_url,key:k.title+k.id,onClick:n,target:"_blank"},k.translated_title||k.title||k.action_title)};j.prototype.renderForNativeLink=function(k,l){var m=i._("Para usar esta funci\u00f3n, usa la aplicaci\u00f3n Messenger.");return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")("_3cno",l),"data-tooltip-alignh":"center","data-tooltip-position":"above",key:k.title},c("Tooltip").propsFor(m)),k.translated_title||k.title||k.action_title)};f.exports=j}),null);
__d("BuyOnMessengerCallToActionIntentHandler",["Link.react","MNCommerceCallToActionGenericIntentHandler","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("MNCommerceCallToActionGenericIntentHandler"));i=h&&h.prototype;j.prototype.renderForWebLink=function(k,l){return this.$BuyOnMessengerCallToActionIntentHandler1(k,l)};j.prototype.renderForNativeLink=function(k,l){return this.$BuyOnMessengerCallToActionIntentHandler1(k,l)};j.prototype.$BuyOnMessengerCallToActionIntentHandler1=function(k,l){return c("React").createElement(c("Link.react"),{className:l,key:k.title+k.id,onClick:k.onClick},k.translated_title||k.title)};function j(){h.apply(this,arguments)}f.exports=new j()}),null);
__d("MMeCallToActionIntentHandler",["MNCommerceCallToActionGenericIntentHandler"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("MNCommerceCallToActionGenericIntentHandler"));i=h&&h.prototype;j.prototype.renderForNativeLink=function(k,l){return this.renderForWebLink(k,l)};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("MNCommerceCallToActionAsyncIntentHandler",["AsyncRequest","Link.react","MNCommerceCallToActionGenericIntentHandler","React"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("MNCommerceCallToActionGenericIntentHandler"));i=h&&h.prototype;j.prototype.renderForWebLink=function(k,l){"use strict";return this.$MNCommerceCallToActionAsyncIntentHandler1(k,l)};j.prototype.renderForNativeLink=function(k,l){"use strict";return this.$MNCommerceCallToActionAsyncIntentHandler1(k,l)};j.prototype.$MNCommerceCallToActionAsyncIntentHandler1=function(k,l){"use strict";var m=function m(){new(c("AsyncRequest"))(k.action_link).send()};return c("React").createElement(c("Link.react"),{className:l,key:k.title+k.id,onClick:m},k.translated_title||k.title)};function j(){"use strict";h.apply(this,arguments)}f.exports=j}),null);
__d("MessengerPlayGameCallToActionHelper",["URI","idx"],(function a(b,c,d,e,f,g){__p&&__p();f.exports={parseMetadata:function h(i){var j,k,l,m,n=(j=i)!=null?j.instantgame_gameid:j;if(!n)return null;var o=(k=i)!=null?k.instantgame_payload:k,p=(l=i)!=null?l.instantgame_context_type:l,q=(m=i)!=null?m.instantgame_context_id:m;return{contextSourceID:q,contextType:p,gameID:n,payload:o}},parseActionLink:function h(i){var j=new(c("URI"))(i).getQueryData();if(!j)return null;var k=j.game_id;if(!k)return null;var l=j.payload,m=j.context_type,n=j.context_id;return{contextSourceID:n,contextType:m,gameID:k,payload:l}}}}),null);
__d("MessengerPlayGameCallToActionIntentHandler",["cx","invariant","InstantGameContextType","MercuryIDs","MessengerPlayGameCallToActionHelper","MNCommerceCallToActionGenericIntentHandler","MessengerGamesPlayGameLink.react","QuicksilverSources","React","idx","joinClasses"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("MNCommerceCallToActionGenericIntentHandler"));k=j&&j.prototype;l.prototype.renderForWebLink=function(m,n){"use strict";return this.$MessengerPlayGameCallToActionIntentHandler1(m,n)};l.prototype.renderForNativeLink=function(m,n){"use strict";return this.$MessengerPlayGameCallToActionIntentHandler1(m,n)};l.prototype.$MessengerPlayGameCallToActionIntentHandler1=function(m,n){__p&&__p();var o,p;"use strict";var q=this.threadID||"",r=(o=m)!=null?o.instantgame_metadata:o,s=(p=m)!=null?p.action_link:p,t=null;if(r)t=c("MessengerPlayGameCallToActionHelper").parseMetadata(r);else if(s)t=c("MessengerPlayGameCallToActionHelper").parseActionLink(s);if(!t)return c("React").createElement("div",null);var u=t.gameID;u||i(0);var v=t.contextSourceID,w=t.contextType;if(!w){w=c("InstantGameContextType").THREAD;v=c("MercuryIDs").getThreadFBIDFromThreadID(q)}return c("React").createElement(c("MessengerGamesPlayGameLink.react"),{className:c("joinClasses")(n,"_fy2"),contextSourceID:v,contextType:w,gameID:u,key:m.title+m.id,onClick:this.onClickHook,payload:t.payload||undefined,source:c("QuicksilverSources").MESSENGER_CALL_TO_ACTION,threadID:q,title:m.translated_title||m.title})};function l(){"use strict";j.apply(this,arguments)}f.exports=l}),null);
__d("MNCommerceCallToActionHandlerMap",["BuyOnMessengerCallToActionIntentHandler","MMeCallToActionIntentHandler","MNCommerceCallToActionAsyncIntentHandler","MNCommerceCallToActionGenericIntentHandler","MessengerPlayGameCallToActionIntentHandler","URI"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={"fb-messenger://payments/buy/mc?":c("BuyOnMessengerCallToActionIntentHandler"),"fb-messenger://business/commerce/":c("BuyOnMessengerCallToActionIntentHandler"),"fb-messenger://instant_games/play":c("MessengerPlayGameCallToActionIntentHandler"),"https://m.me/":c("MMeCallToActionIntentHandler")};function i(j){for(var k in h)if(j.startsWith(k)){var l=h[k];return new l()}if(new(c("URI"))(j).getQueryData().async)return new(c("MNCommerceCallToActionAsyncIntentHandler"))();return new(c("MNCommerceCallToActionGenericIntentHandler"))()}f.exports={getHandler:i}}),null);
__d("MNCommercePromotionReactShapes",["React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=h.arrayOf(h.shape({action_link:h.string,title:h.string})),j={CallToActions:i,RetailItem:h.shape({call_to_actions:i,id:h.string,metalines:h.shape({metaline_1:h.string,metaline_2:h.string,metaline_3:h.string}),name:h.string,url:h.string,source:h.string})};f.exports=j}),null);
__d("MessengerPlatformGenericItemMercuryAttachment.react",["cx","fbt","invariant","AsyncDialog","AsyncRequest","Banzai","Bootloader","BrowserExtensionsDialog","CurrentUser","MessengerEnvironment","FBConfirmDialog.react","FBPaymentsCheckoutFlowContainer.react","FBPaymentsSerializableCheckoutConfigurationParser","Image.react","Link.react","LazyComponent.react","LoadOnRender.react","MercuryIDs","MercuryShareAttachmentRenderLocations","MessageShareType","MessagingForwardAttachmentDialog.react","MessengerAdsWebTypedLogger","MessengerForwardAttachmentDialogReact.bs","MessengerPhotoViewCloseLink.react","MessengerPlatformBubbleAspectRatio","MessengerVideoPlayer.react","MNAdsLoggerEventEnum","MNCommerceCallToActionHandlerMap","MNCommerceCallToActionType","MNCommerceCTAProcessor","MNCommerceBubbleImage.react","MNCommerceMessageType","MNCommercePostbackCTADataManager","MNCommercePromotionReactShapes","MNContentSubscriptionMessageUserEngagementTypedLogger","bs_pervasives","React","SpotlightMessengerSharedMediaViewer.react","SpotlightViewer","SpotlightViewerImage","SpotlightViewport","Tooltip","URI","Vector","idx","joinClasses","nullthrows"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=c("MessengerForwardAttachmentDialogReact.bs").jsComponent,n="_4-og",o=c("React").PropTypes,p=function p(s){c("Bootloader").loadModules(["MessengerPreviewDialogReact.bs"],function(t){var u=t.jsComponent;return s(u)},"MessengerPlatformGenericItemMercuryAttachment.react")};function q(s){if(s!==undefined){var t=s.match(/\d+/);if(t!==undefined&&t!==null)return t[0]}return null}k=babelHelpers.inherits(r,c("React").PureComponent);l=k&&k.prototype;function r(){__p&&__p();var s,t;for(var u=arguments.length,v=Array(u),w=0;w<u;w++)v[w]=arguments[w];return t=(s=l.constructor).call.apply(s,[this].concat(v)),this.state={showDialog:false,showShare:false,showPaymentCheckoutDialog:false,showImageFullScreen:false},this.$MessengerPlatformGenericItemMercuryAttachment8=function(x,event){if(event&&event.target instanceof HTMLElement&&event.target.className===n)this.$MessengerPlatformGenericItemMercuryAttachment6()}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment24=function(){this.setState({showShare:true})}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment23=function(){this.setState({showShare:false})}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment10=function(){this.setState({showImageFullScreen:true})}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment6=function(){this.setState({showImageFullScreen:false})}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment22=function(){this.setState({showPaymentCheckoutDialog:true})}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment25=function(){this.setState({showPaymentCheckoutDialog:false})}.bind(this),this.onConfirm=function(){this.setState({showDialog:true})}.bind(this),this.onCancel=function(){this.setState({showDialog:false})}.bind(this),t}r.prototype.render=function(){var s={},t=this.props.location===c("MercuryShareAttachmentRenderLocations").CHAT;if(t&&this.props.width)s.width=this.props.width;if(this.props.isButtonList)return c("React").createElement("div",{className:"_3cn0",style:s},c("React").createElement("div",{className:(t?"_4id8":"")+(!t?" _4ida":"")},this.$MessengerPlatformGenericItemMercuryAttachment1()));return c("React").createElement("div",{className:"_3cn0",style:s},this.$MessengerPlatformGenericItemMercuryAttachment2(),c("React").createElement("div",{className:(t?"_4id8":"")+(!t?" _4ida":"")},this.$MessengerPlatformGenericItemMercuryAttachment3(),this.$MessengerPlatformGenericItemMercuryAttachment1()))};r.prototype.$MessengerPlatformGenericItemMercuryAttachment2=function(){if(this.props.isMediaAttachment)return this.$MessengerPlatformGenericItemMercuryAttachment4();else return this.$MessengerPlatformGenericItemMercuryAttachment5()};r.prototype.$MessengerPlatformGenericItemMercuryAttachment4=function(){__p&&__p();var s,t,u=this.props.retailItem;if(!u)return null;var v=(s=u)!=null?(s=s.media_blob_attachments)!=null?(s=s[0])!=null?s.large_preview:s:s:s;if(v)if(this.state.showImageFullScreen)return c("React").createElement(c("SpotlightViewer"),{className:"_53vs",onHide:this.$MessengerPlatformGenericItemMercuryAttachment6,open:true,ref:"spotlightViewer"},c("React").createElement(c("SpotlightViewport"),{active:false,fadeInNOut:true,media:this.$MessengerPlatformGenericItemMercuryAttachment7(v),onClick:this.$MessengerPlatformGenericItemMercuryAttachment8,ref:"viewport",showLoadingIndicator:true,stageDimensions:this.$MessengerPlatformGenericItemMercuryAttachment9(),useWidth:true}),c("React").createElement(c("MessengerPhotoViewCloseLink.react"),{onClick:this.$MessengerPlatformGenericItemMercuryAttachment6}));else return c("React").createElement(c("Image.react"),{className:"_4idc",src:v.uri,onClick:this.$MessengerPlatformGenericItemMercuryAttachment10});var w=(t=u)!=null?(t=t.media_blob_attachments)!=null?(t=t[0])!=null?t.playable_url:t:t:t;if(w){var x,y=c("nullthrows")((x=u)!=null?(x=x.media_blob_attachments)!=null?x[0]:x:x),z=y.legacy_attachment_id?y.legacy_attachment_id:y.id,A={};A.legacy_attachment_id=z;if(y.__typename==="MessageVideo")A.original_dimensions=this.$MessengerPlatformGenericItemMercuryAttachment11({width:y.original_dimensions.x,height:y.original_dimensions.y});else{A.original_dimensions=this.$MessengerPlatformGenericItemMercuryAttachment11({width:y.width,height:y.height});A.is_share=true}A.start_muted=true;A.no_fullscreen=false;A.hide_controls_on_finish=true;A.url=y.playable_url;return c("React").createElement(c("MessengerVideoPlayer.react"),{attachment:y,videoData:A,isInThread:true,isVisible:true,className:"_n4o _3_om _1wno"})}return null};r.prototype.$MessengerPlatformGenericItemMercuryAttachment11=function(s){var t=c("bs_pervasives").max(s.width,s.height),u=+(window.screen.width>1800),v=u!==0?640:450;if(t<=v)return{x:s.width,y:s.height};else{var w=v/t;return{x:Math.round(s.width*w),y:Math.round(s.height*w)}}};r.prototype.$MessengerPlatformGenericItemMercuryAttachment7=function(s){var t=c("SpotlightMessengerSharedMediaViewer.react").getImageDimensionsForStage(new(c("Vector"))(s.width,s.height),this.$MessengerPlatformGenericItemMercuryAttachment9());return c("React").createElement(c("SpotlightViewerImage"),{dimensions:t,ref:"image",src:s.uri})};r.prototype.$MessengerPlatformGenericItemMercuryAttachment9=function(){return new(c("Vector"))(c("Vector").getViewportDimensions().x,c("Vector").getViewportDimensions().y)};r.prototype.$MessengerPlatformGenericItemMercuryAttachment5=function(){__p&&__p();var s,t=this.props,u=t.isSubattachment,v=t.retailItem;if(!v)return null;var w=v.thumb_url?v.thumb_url:(s=v)!=null?(s=s.media_blob_attachments)!=null?(s=s[0])!=null?(s=s.image)!=null?s.uri:s:s:s:s;if(!w)return null;var x=c("React").createElement(c("MNCommerceBubbleImage.react"),{className:(!u?"_3_om":"")+(!u?" _4j39":""),location:this.props.location,source:w,width:this.props.width,isSquare:v.image_aspect_ratio===c("MessengerPlatformBubbleAspectRatio").IMAGE_ASPECT_RATIO_SQUARE}),y=null,z=v.default_action;if(z){var A,B=(A=z)!=null?(A=A.webview_metadata)!=null?A.messenger_extensions:A:A;if(B)y=c("React").createElement(c("Link.react"),{onClick:function(){this.$MessengerPlatformGenericItemMercuryAttachment12();this.$MessengerPlatformGenericItemMercuryAttachment13(z)}.bind(this)},x);else y=c("React").createElement(c("Link.react"),{href:z.action_link,onClick:function(){this.$MessengerPlatformGenericItemMercuryAttachment12()}.bind(this),target:"_blank"},x)}else y=x;var C=c("React").createElement("div",{className:"_3cn2",key:"image"},y);return C};r.prototype.$MessengerPlatformGenericItemMercuryAttachment12=function(){if(this.props.mnMessageType==c("MNCommerceMessageType").CONTENT_SUBSCRIPTION){var s=q(this.props.pageID),t=this.props.retailItem&&this.props.retailItem.id;new(c("MNContentSubscriptionMessageUserEngagementTypedLogger"))().setPageID(s).setMessageID(this.props.messageID).setCommerceItemID(t).setName("mn_platform_msg_click").log();c("Banzai").post("mn_platform_message_click_setsuna",{page_id:s,item_id:t})}};r.prototype.$MessengerPlatformGenericItemMercuryAttachment3=function(){var s=this.props.retailItem;if(!s||!s.name)return null;return c("React").createElement("div",{className:"_3cne"},c("React").createElement("div",{className:"_3cnf"},c("React").createElement("div",{className:"_3cng"},c("React").createElement("div",{className:"_3cnh"},this.props.longestName),c("React").createElement("div",{className:this.props.longestName?"_3cni":""},s.name)),this.$MessengerPlatformGenericItemMercuryAttachment14(),this.$MessengerPlatformGenericItemMercuryAttachment15()))};r.prototype.$MessengerPlatformGenericItemMercuryAttachment16=function(){if(this.props.isSponsored)return null;return c("React").createElement("div",{className:"_3cnj"},c("React").createElement("span",{className:"_3cnk"}),this.$MessengerPlatformGenericItemMercuryAttachment17())};r.prototype.$MessengerPlatformGenericItemMercuryAttachment17=function(){var s=this.props.label;if(s===0)return i._("Publicidad");else if(s===1)return i._("Publicidad");return null};r.prototype.$MessengerPlatformGenericItemMercuryAttachment14=function(){var s=this.props.retailItem&&this.props.retailItem.metalines;if(!s)return null;s=Object.keys(s).filter(function(t){return s&&s[t]}).map(function(t,u){var v=s&&s[t];return c("React").createElement("div",{className:"_3cnl",key:t},c("React").createElement("div",{className:"_3cnh"},this.props.longestMetaline),c("React").createElement("div",{className:this.props.longestMetaline?"_3cni":""},v))}.bind(this));return s};r.prototype.$MessengerPlatformGenericItemMercuryAttachment15=function(){__p&&__p();var s=this.props.retailItem&&this.props.retailItem.item_url;if(!this.props.isSponsored&&s){var t=document.createElement("a");t.href=s;var u=t.hostname;if(this.props.retailItem&&this.props.retailItem.source)u=this.props.retailItem.source;return c("React").createElement("div",{className:"_3cnn"},c("React").createElement("a",{href:s,target:"_blank"},u))}else return null};r.prototype.$MessengerPlatformGenericItemMercuryAttachment1=function(){__p&&__p();var s=this.props.retailItem,t=this.props.callToActions,u=this.props.threadID;if(!t||!t.length)return null;var v=function v(D,E){var F=i._("Se desactiv\u00f3 la funci\u00f3n.");return x(D,E,F)},w=function w(D,E){var F=i._("Para usar esta funci\u00f3n, usa la aplicaci\u00f3n Messenger.");return x(D,E,F)},x=function x(D,E,F){return c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")(E,"_3cno"),"data-tooltip-alignh":"center","data-tooltip-position":"above",key:D.title},c("Tooltip").propsFor(F)),D.translated_title||D.title)},y=function(D,E){return c("React").createElement("div",{key:D.id},c("React").createElement(c("Link.react"),{className:E,onClick:function(){this.$MessengerPlatformGenericItemMercuryAttachment13(D)}.bind(this)},D.title))}.bind(this);t=t.filter(function(D){return D.action_link}).map(function(D,E){__p&&__p();var F,G="_3cnp"+(E===0&&!s?" _3cnq":"");if(D.is_disabled)return v(D,G);switch(D.action_type){case c("MNCommerceCallToActionType").POSTBACK:var H=function(T){this.onCancel();this.$MessengerPlatformGenericItemMercuryAttachment18(D.id);if(D.is_mutable_by_server)c("MNCommercePostbackCTADataManager").send(D.id,null,null,this.props.messageID);else c("MNCommercePostbackCTADataManager").sendAndConfirm(D.id,D.title,u,null,null,null,[],this.props.messageID)}.bind(this),I=null;if(this.state.showDialog&&D.should_show_user_confirmation)I=c("React").createElement(c("FBConfirmDialog.react"),{title:D.confirmation_title,shown:true,onConfirm:H,onCancel:this.onCancel,confirmButtonText:D.confirmation_continue_label,cancelButtonText:D.confirmation_cancel_label,content:D.confirmation_message});var J=D.should_show_user_confirmation?this.onConfirm:H;return c("React").createElement("div",{key:E},c("React").createElement(c("Link.react"),{className:G,onClick:J},D.translated_title||D.title),I);case c("MNCommerceCallToActionType").OPEN_URL:return c("MNCommerceCallToActionHandlerMap").getHandler(D.action_link).setFallbackOnClick(this.$MessengerPlatformGenericItemMercuryAttachment19.bind(this,D.id)).setThreadID(u).renderForWebLink(D,G);case c("MNCommerceCallToActionType").OPEN_CANCEL_RIDE_MUTATION:return w(D,G);case c("MNCommerceCallToActionType").OPEN_NATIVE:var K=(F=D)!=null?(F=F.webview_metadata)!=null?F.messenger_extensions:F:F;if(K)return y(D,G);return c("MNCommerceCallToActionHandlerMap").getHandler(D.action_link).setFallbackOnClick(this.$MessengerPlatformGenericItemMercuryAttachment19.bind(this,D.id)).setThreadID(u).renderForNativeLink(D,G);case c("MNCommerceCallToActionType").PAYMENT:var L="_idv",M="_idw";return c("React").createElement("div",{key:E},this.$MessengerPlatformGenericItemMercuryAttachment20(D),c("React").createElement(c("Link.react"),{className:G,onClick:function(){this.$MessengerPlatformGenericItemMercuryAttachment21(D);this.$MessengerPlatformGenericItemMercuryAttachment22()}.bind(this)},c("React").createElement("div",{className:L},D.payment_metadata.total_price),c("React").createElement("div",{className:M},D.translated_title||D.title)));case c("MNCommerceCallToActionType").SHARE:var N=c("MessengerEnvironment").messengerui?m:c("MessagingForwardAttachmentDialog.react"),O=i._("Compartir en mensajes separados"),P=c("React").createElement(N,{attachmentID:D.id,messageID:this.props.messageID,onClose:this.$MessengerPlatformGenericItemMercuryAttachment23,shown:this.state.showShare,title:O,shareType:c("MessageShareType").PLATFORM_SHARE_CTA});return c("React").createElement("div",{key:E},c("React").createElement(c("Link.react"),{className:G,onClick:this.$MessengerPlatformGenericItemMercuryAttachment24},D.title),P);case c("MNCommerceCallToActionType").EXTENSIBLE_SHARE:var Q=i._("Compartir en mensajes separados");return c("React").createElement("div",{key:E},c("React").createElement(c("Link.react"),{className:G,onClick:this.$MessengerPlatformGenericItemMercuryAttachment24},D.title),c("React").createElement(c("LoadOnRender.react"),{key:"dialog",component:c("React").createElement(c("LazyComponent.react"),{attachmentID:D.id,image_url:D.action_objects[0].image_url,messageID:this.props.messageID,onClose:this.$MessengerPlatformGenericItemMercuryAttachment23,pageID:this.props.pageID,preview_title:D.action_objects[0].preview_title,preview_subtitle:D.action_objects[0].preview_subtitle,shown:this.state.showShare,target_display:D.action_objects[0].target_display,title:Q,threadID:this.props.threadID}),loader:p,placeholder:c("React").createElement("span",null)}));case c("MNCommerceCallToActionType").ACCOUNT_LINK:var R=function(T){c("MNCommerceCTAProcessor").process(D.id,this.props.messageID)}.bind(this);return c("React").createElement(c("Link.react"),{className:G,key:E,onClick:R},D.translated_title||D.title);case c("MNCommerceCallToActionType").FACEBOOK_REPORT_A_PROBLEM:var S=function S(T){c("AsyncDialog").send(new(c("AsyncRequest"))("/ajax/bugs/report"))};return c("React").createElement(c("Link.react"),{className:G,key:E,onClick:S},D.translated_title||D.title);default:return w(D,G)}}.bind(this));var z=this.props.longestCTAs,A=[];if(z&&z>t.length){for(var B=0;B<z-t.length;B++)A.push(c("React").createElement("div",{className:"_3cnh _3cnp",key:"placeholder"+B},"CTA placeHolder"));var C=A.concat(t);return c("React").createElement("div",{className:"_3cnr"},C)}return c("React").createElement("div",{className:"_3cnr"},t)};r.prototype.$MessengerPlatformGenericItemMercuryAttachment19=function(s,event){this.$MessengerPlatformGenericItemMercuryAttachment18(s)};r.prototype.$MessengerPlatformGenericItemMercuryAttachment18=function(s){if(this.props.isSponsored)new(c("MessengerAdsWebTypedLogger"))().setActionID(s).setEvent(c("MNAdsLoggerEventEnum").LINK_CLICK_CTA).setIsSponsored(this.props.isSponsored).setItemID(this.props.retailItem&&this.props.retailItem.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log()};r.prototype.$MessengerPlatformGenericItemMercuryAttachment20=function(s){if(this.state.showPaymentCheckoutDialog){var t=c("FBPaymentsSerializableCheckoutConfigurationParser").parse(this.$MessengerPlatformGenericItemMercuryAttachment26(s.payment_metadata.payment_module_config)),u=t.contentConfiguration.confirmationConfiguration||{};t.contentConfiguration.confirmationConfiguration=u;return c("React").createElement(c("FBPaymentsCheckoutFlowContainer.react"),{configuration:t,onCheckoutClosed:this.$MessengerPlatformGenericItemMercuryAttachment25,onConfirmationClosed:this.$MessengerPlatformGenericItemMercuryAttachment25})}return null};r.prototype.$MessengerPlatformGenericItemMercuryAttachment26=function(s){var t="";try{t=JSON.parse(s)}catch(u){return s}if(t.checkout_configuration&&t.checkout_configuration.payment_info&&t.checkout_configuration.payment_info.extra_data)t.checkout_configuration.payment_info.extra_data.message_id=this.props.messageID;return JSON.stringify(t)};r.prototype.$MessengerPlatformGenericItemMercuryAttachment13=function(s){c("BrowserExtensionsDialog").show(new(c("URI"))(s.native_url),c("MercuryIDs").getThreadFBIDFromThreadID(this.props.pageID),c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID),c("CurrentUser").getID());this.$MessengerPlatformGenericItemMercuryAttachment21(s)};r.prototype.$MessengerPlatformGenericItemMercuryAttachment21=function(s){c("MNCommerceCTAProcessor").postHandle(s.id,this.props.messageID)};r.propTypes={callToActions:c("MNCommercePromotionReactShapes").CallToActions,isMediaAttachment:o.bool,isSponsored:o.bool,isSubattachment:o.bool,label:o.number,logo:o.object,location:o.oneOf(c("MercuryShareAttachmentRenderLocations").getValues()),longestCTAs:o.number,longestMetaline:o.string,longestName:o.string,messageID:o.string,mnMessageType:o.string,pageID:o.string,retailItem:c("MNCommercePromotionReactShapes").RetailItem,url:o.string,width:o.number,threadID:o.string};f.exports=r}),null);
__d("P2PAddressStore",["P2PActionConstants","EventEmitter","ImmutableObject","P2PAPI","P2PDispatcher","immutable"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("immutable").List,k=j(),l=false,m=false,n={},o=void 0,p=null,q=false;function r(u,v){if(u)n[u]=new(c("ImmutableObject"))(v)}function s(u,v){p=v;if(u)n[u]={error:v}}h=babelHelpers.inherits(t,c("EventEmitter"));i=h&&h.prototype;function t(){i.constructor.call(this);l=false;m=false;k=j();n={};o=c("P2PDispatcher").register(this.onEventDispatched.bind(this))}t.prototype.onEventDispatched=function(u){__p&&__p();var v=u.data,w=u.type;switch(w){case c("P2PActionConstants").ADDRESS_SAVING:this.handleAddressSaving(v);this.emit("change");break;case c("P2PActionConstants").ADDRESSES_UPDATED:this.handleAddressesUpdated(v);this.emit("change");break;case c("P2PActionConstants").ADDRESS_ADDED:this.handleAddressAdded(v);this.emit("change");break;case c("P2PActionConstants").ADDRESS_ADDED_ERROR:this.handleAddressAddedError(v);this.emit("change");break;case c("P2PActionConstants").ADDRESS_ADDED_ERROR_CLEARED:this.handleAddressAddedErrorCleared();this.emit("change");break}};t.prototype.getAsyncRequestState=function(){return n};t.prototype.isAddressesFetchComplete=function(){return l};t.prototype.handleAddressSaving=function(){q=true;p=null};t.prototype.handleAddressesUpdated=function(u){l=true;u=u.map(function(v){return new(c("ImmutableObject"))(v)});k=j(u)};t.prototype.handleAddressAdded=function(u){q=false;r(u.requestID,u);if(!this.getAddressByID(u.id))k=k.push(new(c("ImmutableObject"))(u))};t.prototype.handleAddressAddedError=function(u){q=false;s(u.requestID,u.errors)};t.prototype.handleAddressAddedErrorCleared=function(){p=null};t.prototype.getAll=function(u){if(!m){m=true;c("P2PAPI").getAddresses()}if(u)return k.filter(function(v){return v.isVerified});return k};t.prototype.getAddressByID=function(u){return k.find(function(v){return v.id===u})};t.prototype.getDispatchToken=function(){return o};t.prototype.getSaveErrors=function(){return p};t.prototype.isSaving=function(){return q};f.exports=new t()}),null);
__d("P2PAddressShape",["React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=h.shape({label:h.string,care_of:h.string,city:h.string,id:h.string,state:h.string,street1:h.string,street2:h.string,zip:h.string});f.exports=i}),null);
__d("P2PAddressDetails.react",["P2PAddressShape","P2PText.react","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){var k=this.props.address,l=[k.city,k.state],m=void 0,n=void 0,o=void 0,p={display:"block",type:"primary"},q=k.zip?" "+k.zip:"",r=k.country?" "+k.country:"";l=l.join(", ")+q+r;if(k.streeet2)m=c("React").createElement(c("P2PText.react"),p,k.street2);if(k.label)n=c("React").createElement(c("P2PText.react"),p,k.label);if(k.care_of)o=c("React").createElement(c("P2PText.react"),p,k.care_of);return c("React").createElement("div",null,n,o,c("React").createElement(c("P2PText.react"),p,k.street1),m,c("React").createElement(c("P2PText.react"),p,l))};function j(){h.apply(this,arguments)}j.propTypes={address:c("P2PAddressShape").isRequired};f.exports=j}),null);
__d("P2PAddressForm.react",["cx","fbt","FBPaymentsAddressLabelFormField_DEPRECATED.react","FBPaymentsForm_DEPRECATED.react","FBPaymentsFormField_DEPRECATED.react","FBPaymentsFormFieldUtils_DEPRECATED","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={formData:{},isValid:false},this.handleValidation=function(s,t){this.setState({formData:t,isValid:s});this.props.onValidation(s,t)}.bind(this),o}m.prototype.render=function(){var n=!!(this.props.prefilledFormData&&this.props.prefilledFormData.care_of);return c("React").createElement(c("FBPaymentsForm_DEPRECATED.react"),{errorTitle:i._("Error al guardar la direcci\u00f3n"),prefilledFormData:this.props.prefilledFormData,onValidation:this.handleValidation,saveErrors:this.props.saveErrors},c("React").createElement(c("FBPaymentsAddressLabelFormField_DEPRECATED.react"),{className:"_3-96",name:"label",ignoreStyling:true,required:true}),c("React").createElement(c("FBPaymentsFormField_DEPRECATED.react"),{name:"care_of",initiallyFocused:!n,placeholder:i._("Nombre"),required:true,width:100}),c("React").createElement(c("FBPaymentsFormField_DEPRECATED.react"),{name:"street1",initiallyFocused:n,placeholder:i._("Direcci\u00f3n"),required:true,width:100}),c("React").createElement(c("FBPaymentsFormField_DEPRECATED.react"),{name:"street2",placeholder:i._("Direcci\u00f3n 2"),width:100}),c("React").createElement(c("FBPaymentsFormField_DEPRECATED.react"),{name:"city",placeholder:i._("Ciudad"),required:true,width:50}),c("React").createElement(c("FBPaymentsFormField_DEPRECATED.react"),{formatValue:function o(p){p=c("FBPaymentsFormFieldUtils_DEPRECATED").stripNonAlpha(p);return p.toUpperCase()},limit:2,name:"state",placeholder:i._("Estado o provincia"),required:true,width:25}),c("React").createElement(c("FBPaymentsFormField_DEPRECATED.react"),{formatValue:c("FBPaymentsFormFieldUtils_DEPRECATED").stripNonDigits,limit:5,name:"zip",placeholder:i._("C\u00f3digo postal"),required:true,width:25}))};m.propTypes={onValidation:l.func.isRequired,prefilledFormData:l.object,saveErrors:l.object};m.defaultProps={editMode:false,prefilledFormData:{},saveErrors:null};f.exports=m}),null);
__d("P2PCheckoutConfigSection.react",["cx","fbt","LeftRight.react","Link.react","React","emptyFunction"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.renderChangeLink=function(){if(this.props.showEditOptions||!this.props.hasOptions)return null;return c("React").createElement(c("Link.react"),{className:"_nb2",href:"#",onClick:this.props.onChangeClicked},i._("Cambiar"))}.bind(this),this.renderContent=function(){var s=this.props,t=void 0,u=void 0;if(s.showEditOptions)t=this.renderSelector();else if(s.hasOptions)t=this.renderCurrentItem();if(s.showForm)u=this.renderForm();return c("React").createElement("div",null,t,u)}.bind(this),this.renderForm=function(){var s=void 0;if(!this.props.renderFormComponent)return null;if(this.props.renderFormFooterMessage)s=c("React").createElement("div",{className:"_nb4"},this.props.renderFormFooterMessage());return c("React").createElement("div",{className:"_nb3",key:"form"},this.props.renderFormComponent(),s)}.bind(this),this.renderSelector=function(){return c("React").createElement("div",{className:"_nb5",key:"selector"},this.props.renderSelectorComponent())}.bind(this),this.renderCurrentItem=function(){if(!this.props.renderSelectedRow)return null;return c("React").createElement("div",{className:"_nb6",key:"currentItem"},this.props.renderSelectedRow())}.bind(this),o}m.prototype.render=function(){return c("React").createElement("div",{className:"_nb7"},c("React").createElement(c("LeftRight.react"),{className:"_nb8"},c("React").createElement("div",{className:"_nb9"},this.props.title),this.renderChangeLink()),c("React").createElement("div",{className:"_nba"},this.renderContent()))};m.propTypes={onChangeClicked:l.func,hasOptions:l.bool,showEditOptions:l.bool,showForm:l.bool,renderFormComponent:l.func,renderFormFooterMessage:l.func,renderSelectedRow:l.func,renderSelectorComponent:l.func.isRequired,title:l.string.isRequired};m.defaultProps={onChangeClicked:c("emptyFunction"),renderFormFooterMessage:c("emptyFunction"),renderFormComponent:c("emptyFunction"),renderSelectedRow:c("emptyFunction")};f.exports=m}),null);
__d("P2PChooseAddressForm.react",["cx","fbt","immutable","P2PAddressShape","P2PAddressDetails.react","P2PText.react","React","XUIRadioList.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("immutable").List,m=c("XUIRadioList.react").Item,n=c("React").PropTypes,o="add_address";j=babelHelpers.inherits(p,c("React").Component);k=j&&j.prototype;function p(){__p&&__p();var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=k.constructor).call.apply(q,[this].concat(t)),this.state={selectedValue:this.props.selectedAddress.id},this.getselectedAddress=function(){return this.props.addresses.filter(function(v){return v.id===this.state.selectedValue}.bind(this)).first()}.bind(this),this.handleChange=function(v){__p&&__p();var w=void 0;if(v===o){this.props.onNewAddressOptionSelected();this.setState({selectedValue:v})}else{w=this.props.addresses.filter(function(w){return w.id===v}).first();this.setState({selectedValue:w.id});this.props.onChange(w)}}.bind(this),this.renderAddressItem=function(v){return c("React").createElement(m,{className:"_54sy",key:v.id,value:v.id},c("React").createElement(c("P2PAddressDetails.react"),{address:v}))},this.renderAddNewAddressItem=function(){return c("React").createElement(m,{className:"_54sy",key:o,value:o},c("React").createElement(c("P2PText.react"),{type:"primary"},i._("Agregar nueva direcci\u00f3n")))},this.getRadioListItems=function(){var v=this.props.addresses,w=v.map(this.renderAddressItem).concat(this.renderAddNewAddressItem());return w}.bind(this),r}p.prototype.render=function(){return c("React").createElement(c("XUIRadioList.react"),{className:"_1ck2",onValueChange:this.handleChange,selectedValue:this.state.selectedValue},this.getRadioListItems())};p.propTypes={addresses:n.instanceOf(l),onChange:n.func.isRequired,onNewAddressOptionSelected:n.func.isRequired,selectedAddress:c("P2PAddressShape")};f.exports=p}),null);
__d("P2PAddressConfigSection.react",["fbt","MessengerEnvironment","FBPaymentsAddressForm_DEPRECATED.react","P2PAddressDetails.react","P2PAddressForm.react","P2PAddressShape","P2PCheckoutConfigSection.react","P2PChooseAddressForm.react","P2PText.react","React","immutable"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l="P2PAddressConfigSection_learnMoreSentenceID";i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.renderFormComponent=function(){var s=this.props;if(s.acceptInternational)return c("React").createElement(c("FBPaymentsAddressForm_DEPRECATED.react"),{onValidation:s.onValidation,prefilledFormData:{care_of:this.props.buyerName},saveErrors:s.saveErrors});return c("React").createElement(c("P2PAddressForm.react"),{onValidation:s.onValidation,prefilledFormData:{care_of:this.props.buyerName},saveErrors:s.saveErrors})}.bind(this),this.renderSelectedRow=function(){var s=this.props.selectedAddress;if(!s)return null;return c("React").createElement(c("P2PAddressDetails.react"),{address:s})}.bind(this),this.renderSelectorComponent=function(){var s=this.props;return c("React").createElement(c("P2PChooseAddressForm.react"),{addresses:s.addresses,onChange:this.props.onAddressSelected,onNewAddressOptionSelected:this.props.onNewAddressSelected,selectedAddress:s.selectedAddress})}.bind(this),this.renderFormFooterMessage=function(){return c("React").createElement(c("P2PText.react"),{id:l,type:"secondary"},h._("Tu direcci\u00f3n de env\u00edo se guardar\u00e1 de forma segura para las pr\u00f3ximas compras que hagas en Facebook."))},this.getTitle=function(){if(c("MessengerEnvironment").messengerui)return h._("Direcci\u00f3n de env\u00edo");return h._("DIRECCI\u00d3N DE ENV\u00cdO")},o}m.prototype.render=function(){var n=this.props;return c("React").createElement(c("P2PCheckoutConfigSection.react"),{hasOptions:n.addresses.count()!==0,showEditOptions:n.showEditOptions,showForm:n.showForm,onChangeClicked:n.onChangeClicked,renderFormComponent:this.renderFormComponent,renderFormFooterMessage:this.renderFormFooterMessage,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};m.propTypes={acceptInternational:k.bool,addresses:k.instanceOf(c("immutable").List).isRequired,buyerName:k.string,showEditOptions:k.bool,showForm:k.bool,onAddressSelected:k.func.isRequired,onChangeClicked:k.func.isRequired,onNewAddressSelected:k.func.isRequired,onValidation:k.func.isRequired,selectedAddress:c("P2PAddressShape"),saveErrors:k.object};f.exports=m}),null);
__d("P2PCreditCardConfigSection.react",["fbt","MessengerEnvironment","Link.react","MessengerPaymentProductType","P2PChooseCreditCardForm.react","P2PCreditCard","P2PCreditCardDetails.react","P2PCreditCardForm.react","P2PCheckoutConfigSection.react","P2PLinkConstants","P2PText.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l="P2PCreditCardConfigSection_learnMoreSentenceID";i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.renderFormComponent=function(){var s=this.props;return c("React").createElement(c("P2PCreditCardForm.react"),{onValidation:s.onValidation,saveErrors:s.saveErrors,productType:c("MessengerPaymentProductType").MESSENGER_COMMERCE})}.bind(this),this.renderSelectedRow=function(){var s=this.props.selectedCreditCard;if(!s)return null;return c("React").createElement(c("P2PCreditCardDetails.react"),{creditCard:s})}.bind(this),this.renderSelectorComponent=function(){var s=this.props;return c("React").createElement(c("P2PChooseCreditCardForm.react"),{addCardOptionText:h._("Agregar nueva tarjeta"),creditCards:s.creditCards,onAddDebitCardOptionSelected:this.props.onNewCreditCardSelected,onChange:this.props.onCreditCardSelected,selectedCard:s.selectedCreditCard,showAddDebitCardOption:true})}.bind(this),this.renderFormFooterMessage=function(){return c("React").createElement(c("P2PText.react"),{id:l,type:"secondary"},h._("Tu informaci\u00f3n de pago se guardar\u00e1 de forma segura."),c("React").createElement("div",null,c("React").createElement(c("Link.react"),{"aria-describedby":l,href:c("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},h._("M\u00e1s informaci\u00f3n"))))},this.getTitle=function(){if(c("MessengerEnvironment").messengerui)return h._("Informaci\u00f3n de pago");return h._("INFORMACI\u00d3N DE PAGO")},o}m.prototype.render=function(){var n=this.props;return c("React").createElement(c("P2PCheckoutConfigSection.react"),{hasOptions:n.creditCards.length!==0,showEditOptions:n.showEditOptions,showForm:n.showForm,onChangeClicked:n.onChangeClicked,renderFormComponent:this.renderFormComponent,renderFormFooterMessage:this.renderFormFooterMessage,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};m.propTypes={creditCards:k.arrayOf(k.instanceOf(c("P2PCreditCard"))).isRequired,showEditOptions:k.bool,showForm:k.bool,onCreditCardSelected:k.func.isRequired,onChangeClicked:k.func.isRequired,onNewCreditCardSelected:k.func.isRequired,onValidation:k.func.isRequired,selectedCreditCard:k.instanceOf(c("P2PCreditCard")),saveErrors:k.object};f.exports=m}),null);
__d("P2PPaymentMethodConfigSection.react",["fbt","MessengerEnvironment","P2PCheckoutConfigSection.react","P2PCreditCardDetails.react","P2PText.react","FBPaymentsChoosePaymentMethodForm_DEPRECATED.react","FBPaymentsPaymentMethodShape_DEPRECATED","FBPaymentsMethodType","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.renderFormComponent=function(){return c("React").createElement(c("FBPaymentsChoosePaymentMethodForm_DEPRECATED.react"),{onPaymentMethodConfigured:this.props.onPaymentMethodConfigured,onPaymentMethodSelected:this.props.onPaymentMethodSelected,paymentMethods:this.props.paymentMethods})}.bind(this),this.renderSelectedRow=function(){__p&&__p();var r=this.props.confirmedPaymentMethod;if(!r)return null;switch(r.type){case c("FBPaymentsMethodType").GENERIC_CARD:return c("React").createElement(c("P2PCreditCardDetails.react"),{creditCard:r.creditCard});case c("FBPaymentsMethodType").MANUAL_TRANSFER:return c("React").createElement(c("P2PText.react"),{type:"primary"},h._("Transferencia bancaria o por cajero autom\u00e1tico"));case c("FBPaymentsMethodType").NET_BANKING:var s=r.bank.name;return c("React").createElement(c("P2PText.react"),{type:"primary"},h._("{bank_name} (banca por internet)",[h.param("bank_name",s)]));case c("FBPaymentsMethodType").PAY_OVER_COUNTER:return c("React").createElement(c("P2PText.react"),{type:"primary"},h._("Pago en la tienda"));default:return c("React").createElement("div",null,r?r.toString():"")}}.bind(this),this.renderSelectorComponent=function(){return this.renderFormComponent()}.bind(this),n}l.prototype.getTitle=function(){if(c("MessengerEnvironment").messengerui)return h._("M\u00e9todo de pago");return h._("M\u00c9TODO DE PAGO")};l.prototype.render=function(){var m=this.props;return c("React").createElement(c("P2PCheckoutConfigSection.react"),{hasOptions:!!m.confirmedPaymentMethod,showEditOptions:m.showEditOptions,showForm:m.showForm,onChangeClicked:m.onChangeClicked,renderFormComponent:this.renderFormComponent,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};l.propTypes={confirmedPaymentMethod:k.shape(c("FBPaymentsPaymentMethodShape_DEPRECATED")),onChangeClicked:k.func.isRequired,onPaymentMethodConfigured:k.func.isRequired,onPaymentMethodSelected:k.func.isRequired,paymentMethods:k.arrayOf(c("FBPaymentsPaymentMethodShape_DEPRECATED")).isRequired,showEditOptions:k.bool,showForm:k.bool};f.exports=l}),null);
__d("P2PChooseShippingOptionForm.react",["cx","P2PPlatformContextShippingOptionShape","React","P2PText.react","XUIRadioList.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("XUIRadioList.react").Item,l=c("React").PropTypes;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={selectedValue:this.props.selectedShippingOption.id},this.handleChange=function(s){var t=this.props.shippingOptions.filter(function(t){return t.id===s})[0];this.setState({selectedValue:t.id});this.props.onChange(t)}.bind(this),this.renderShippingOptionItem=function(s){return c("React").createElement(k,{className:"_2i8o",key:s.id,value:s.id},c("React").createElement(c("P2PText.react"),{type:"primary"},s.title))},this.getRadioListItems=function(){return this.props.shippingOptions.map(this.renderShippingOptionItem)}.bind(this),o}m.prototype.render=function(){return c("React").createElement(c("XUIRadioList.react"),{className:"_2i8p",onValueChange:this.handleChange,selectedValue:this.state.selectedValue},this.getRadioListItems())};m.propTypes={shippingOptions:l.arrayOf(c("P2PPlatformContextShippingOptionShape")).isRequired,onChange:l.func.isRequired,selectedShippingOption:c("P2PPlatformContextShippingOptionShape")};f.exports=m}),null);
__d("P2PShippingOptionsConfigSection.react",["fbt","MessengerEnvironment","P2PChooseShippingOptionForm.react","P2PPlatformContextShippingOptionShape","P2PCheckoutConfigSection.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.renderSelectorComponent=function(){var r=this.props;return c("React").createElement(c("P2PChooseShippingOptionForm.react"),{shippingOptions:r.shippingOptions,onChange:this.props.onShippingOptionSelected,selectedShippingOption:r.selectedShippingOption})}.bind(this),this.getTitle=function(){if(c("MessengerEnvironment").messengerui)return h._("Opciones de env\u00edo");return h._("OPCIONES DE ENV\u00cdO")},n}l.prototype.render=function(){return c("React").createElement(c("P2PCheckoutConfigSection.react"),{hasOptions:true,showEditOptions:true,showForm:false,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};l.propTypes={onShippingOptionSelected:k.func.isRequired,selectedShippingOption:c("P2PPlatformContextShippingOptionShape"),shippingOptions:k.arrayOf(c("P2PPlatformContextShippingOptionShape"))};f.exports=l}),null);
__d("P2PCheckoutDialog.react",["cx","csx","fbt","CommerceContactMerchantManualPaymentSection.react","MessengerEnvironment","CSS","DOMQuery","FBPaymentsLegalDisclaimer_DEPRECATED.react","FBPaymentsMethodType","P2PActions","P2PAddressConfigSection.react","P2PAddressShape","P2PButton.react","P2PCheckoutPriceDetails.react","P2PCreditCardConfigSection.react","P2PCreditCard","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PPaymentMethodConfigSection.react","P2PPlatformContextShape","P2PPlatformContextShippingOptionShape","P2PPlatformProductItemDetails.react","P2PShippingOptionsConfigSection.react","React","immutable"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=c("React").PropTypes,l=c("React").createClass({displayName:"P2PCheckoutDialog",propTypes:{acceptInternationalAddresses:k.bool,addresses:k.instanceOf(c("immutable").List).isRequired,addressFormData:k.object,addressFormValid:k.bool,addressSaveErrors:k.object,asyncPaymentDetails:k.object,buyer:k.object,configuredPaymentMethod:k.object,confirmedPaymentMethod:k.object,creditCardFormData:k.object,creditCardFormValid:k.bool,creditCardSaveErrors:k.object,creditCards:k.arrayOf(k.instanceOf(c("P2PCreditCard"))).isRequired,customCheckoutDetails:k.node,editingPaymentMethod:k.bool,paymentMethods:k.array,paymentProductType:k.string,initialDataLoaded:k.bool,onClose:k.func.isRequired,onCompleteManualPayment:k.func.isRequired,onConfirmSelectedPaymentMethod:k.func.isRequired,onPlaceOrder:k.func.isRequired,onSaveAddress:k.func.isRequired,onSaveCreditCard:k.func.isRequired,onSetAddress:k.func.isRequired,orderID:k.string,platformContext:c("P2PPlatformContextShape"),receiptAttached:k.bool,saving:k.bool,selectedAddress:c("P2PAddressShape"),selectedCreditCard:k.instanceOf(c("P2PCreditCard")),selectedPaymentMethod:k.object,selectedShippingOption:c("P2PPlatformContextShippingOptionShape"),showAddressEditOptions:k.bool,showAsyncPaymentDetails:k.bool,showCreditCardEditOptions:k.bool,showPaymentMethodEditOptions:k.bool,showAddressForm:k.bool,showCreditCardForm:k.bool,showPaymentMethodForm:k.bool,showTaxField:k.bool,shippingOptions:k.arrayOf(c("P2PPlatformContextShippingOptionShape")),usePaymentMethods:k.bool},_toggledCreditCard:null,_toggledAddress:null,handleToggle:function m(n){if(!n)this.props.onClose();this.cleanup()},handleCloseDialog:function m(){this.props.onClose();this.cleanup()},componentDidMount:function m(){setTimeout(function(){if(this.isMounted()){var n=c("DOMQuery").find(document,"div._ugr");if(n)c("CSS").addClass(n,"_225w")}}.bind(this),200)},getProductFromPlatformContext:function m(){var n=this.props.platformContext;return n?n.product:null},renderPriceDetails:function m(){__p&&__p();var n=this.getProductFromPlatformContext(),o=this.props.selectedShippingOption,p=void 0,q=void 0,r=void 0,s=void 0;if(n){p=n.formattedAmount;s=p}if(o){p=o.formattedSubtotal;r=o.formattedShippingPrice;q=o.formattedTax;s=o.formattedTotal}return c("React").createElement(c("P2PCheckoutPriceDetails.react"),{shipping:r,subtotal:p,tax:q,total:s,showShippingField:!this.props.showAsyncPaymentDetails,showSubtotalField:!this.props.showAsyncPaymentDetails,showTaxField:this.props.showTaxField&&!this.props.showAsyncPaymentDetails})},renderItemSection:function m(){var n=this.getProductFromPlatformContext();if(!n)return null;var o=void 0;if(this.props.customCheckoutDetails)o=c("React").createElement("div",{className:"_145w"},this.props.customCheckoutDetails);return c("React").createElement("div",null,c("React").createElement("div",{className:"_4oyy"},c("React").createElement(c("P2PPlatformProductItemDetails.react"),{configSelections:this.props.configSelections,item:n,size:"medium"})),o,c("React").createElement("div",{className:"_4oz5"},this.renderPriceDetails()))},renderRightPanel:function m(){var n=!this.props.showAsyncPaymentDetails;return c("React").createElement("div",{className:(n?"_4oz9":"")+(!n?" _334":"")},n?this.renderConfigSection():this.renderAsyncPaymentDetailsSection(),this.renderDialogFooter())},renderConfigSection:function m(){__p&&__p();if(!this.props.initialDataLoaded)return null;var n=void 0,o=c("React").createElement("div",{className:"_4gf2",key:"addressConigSection"},c("React").createElement(c("P2PAddressConfigSection.react"),{acceptInternational:this.props.acceptInternationalAddresses,addresses:this.props.addresses,buyerName:this.props.buyer&&this.props.buyer.name,onAddressSelected:this.handleAddressSelected,onChangeClicked:this.handleAddressChangeClicked,onNewAddressSelected:this.handleNewAddressSelected,onValidation:this.handleAddressFormValidation,saveErrors:this.props.addressSaveErrors,selectedAddress:this.props.selectedAddress,showEditOptions:this.props.showAddressEditOptions,showForm:this.props.showAddressForm})),p=this.props.usePaymentMethods?c("React").createElement("div",{className:"_4gf2",key:"paymentMethodConfigSection"},c("React").createElement(c("P2PPaymentMethodConfigSection.react"),{confirmedPaymentMethod:this.props.confirmedPaymentMethod,onPaymentMethodConfigured:this.handlePaymentMethodConfigured,onPaymentMethodSelected:this.handlePaymentMethodSelected,onChangeClicked:this.handlePaymentMethodChangeClicked,paymentMethods:this.props.paymentMethods,showEditOptions:this.props.showPaymentMethodEditOptions,showForm:this.props.showPaymentMethodForm})):c("React").createElement("div",{className:"_4gf2",key:"creditCardConfigSection"},c("React").createElement(c("P2PCreditCardConfigSection.react"),{creditCards:this.props.creditCards,onCreditCardSelected:this.handleCreditCardSelected,onChangeClicked:this.handleCreditCardChangeClicked,onNewCreditCardSelected:this.handleNewCreditCardSelected,onValidation:this.handleCreditCardFormValidation,saveErrors:this.props.creditCardSaveErrors,selectedCreditCard:this.props.selectedCreditCard,showEditOptions:this.props.showCreditCardEditOptions,showForm:this.props.showCreditCardForm}));if(this.props.shippingOptions&&this.props.shippingOptions.length&&this.props.selectedShippingOption)n=c("React").createElement("div",{className:"_4gf2",key:"shippingConfigSection"},c("React").createElement(c("P2PShippingOptionsConfigSection.react"),{onShippingOptionSelected:this.handleShippingOptionSelected,shippingOptions:this.props.shippingOptions,selectedShippingOption:this.props.selectedShippingOption}));if(this.props.showAddressEditOptions||this.props.showAddressForm){p=null;n=null}if(this.props.showPaymentMethodEditOptions||this.props.showCreditCardEditOptions){o=null;n=null}return c("React").createElement("div",null,o,n,p)},renderAsyncPaymentDetailsSection:function m(){var n=this.props.asyncPaymentDetails,o=this.props.orderID;if(!n||!o)return null;return c("React").createElement(c("CommerceContactMerchantManualPaymentSection.react"),{paymentOptionDetails:n,invoiceID:o,onReceiptUpdated:function p(q,r){c("P2PActions").checkoutManualPaymentReceiptUpdated({receiptFbid:q})}})},renderDialogFooter:function m(){__p&&__p();if(!this.props.initialDataLoaded)return null;var n=void 0,o=void 0,p=j._("Cancelar"),q=j._("Continuar"),r=void 0;if(c("MessengerEnvironment").messengerui)r=c("React").createElement(c("P2PButton.react"),{label:p,onClick:this.props.onClose});var s=this.props.editingPaymentMethod;if(s&&this.props.selectedPaymentMethod)switch(this.props.selectedPaymentMethod.type){case c("FBPaymentsMethodType").NEW_CREDIT_CARD:q=j._("Agregar tarjeta");break;case c("FBPaymentsMethodType").NET_BANKING:q=j._("Confirmar banco");break}var t=this.props.showCreditCardEditOptions||s||this.props.showAddressEditOptions||this.props.showAddressForm;if(t)n=c("React").createElement("div",null,c("React").createElement(c("P2PButton.react"),{label:p,onClick:this.handleEditCancelClicked}),c("React").createElement(c("P2PButton.react"),{disabled:this.isSaveDisabled(),label:q,onClick:this.handleContinueClicked,use:"confirm"}));else if(this.props.showAsyncPaymentDetails)n=c("React").createElement("div",null,c("React").createElement(c("P2PButton.react"),{disabled:!this.props.receiptAttached,label:j._("Finalizar la compra"),onClick:this.handleCompleteManualPaymentClicked,use:"confirm"}));else{o=this.getLegalDisclaimerSection();n=c("React").createElement("div",{className:"_35cu"},r,c("React").createElement(c("P2PButton.react"),{className:this.props.usePaymentMethods?"_35cv":"",disabled:this.isSaveDisabled(),label:this.getCheckoutButtonLabel(),onClick:this.handlePlaceOrderClicked,use:"confirm"}))}return c("React").createElement("div",{className:"_35cw"},c("React").createElement(c("P2PDialogFooter.react"),{className:"_ugq"+(t?" _35cx":"")},o,n))},isSaveDisabled:function m(){var n=this.props.configuredPaymentMethod&&this.props.configuredPaymentMethod.isValid&&this.isConfiguredPaymentMethodSelected();return!!this.props.showCreditCardForm&&!this.props.creditCardFormValid||!!this.props.editingPaymentMethod&&!n||!!this.props.showAddressForm&&!this.props.addressFormValid},isConfiguredPaymentMethodSelected:function m(){return!!this.props.configuredPaymentMethod&&!!this.props.selectedPaymentMethod&&this.props.configuredPaymentMethod.type===this.props.selectedPaymentMethod.type},getCheckoutButtonLabel:function m(){__p&&__p();if(!this.props.usePaymentMethods)return j._("Realizar pedido");var n=this.props.confirmedPaymentMethod,o=j._("Finalizar la compra");if(!n)return o;switch(n.type){case c("FBPaymentsMethodType").NET_BANKING:return j._("Iniciar sesi\u00f3n y pagar");case c("FBPaymentsMethodType").GENERIC_CARD:return j._("Pagar");case c("FBPaymentsMethodType").PAY_OVER_COUNTER:return j._("Seguir y pagar");default:return o}},getLegalDisclaimerSection:function m(){if(!this.props.usePaymentMethods||!this.props.confirmedPaymentMethod)return null;return c("React").createElement("div",{className:"_35d1"},c("React").createElement(c("FBPaymentsLegalDisclaimer_DEPRECATED.react"),{paymentMethodType:this.props.confirmedPaymentMethod.type,paymentType:this.props.paymentProductType}))},handleShippingOptionSelected:function m(n){c("P2PActions").checkoutShippingOptionSelected(n.id)},handleCreditCardFormValidation:function m(n,o){c("P2PActions").checkoutCreditCardFormValidated(n,o)},handleCreditCardChangeClicked:function m(){c("P2PActions").checkoutCreditCardEditOptionsToggled(true)},handlePaymentMethodChangeClicked:function m(){c("P2PActions").checkoutPaymentMethodEditOptionsToggled(true)},handleCreditCardSelected:function m(n){this._toggledCreditCard=n;c("P2PActions").checkoutCreditCardFormToggled(false)},handleNewCreditCardSelected:function m(){c("P2PActions").addCreditCardErrorCleared();c("P2PActions").checkoutCreditCardFormToggled(true)},saveCreditCard:function m(){this.props.onSaveCreditCard()},handlePaymentMethodSelected:function m(n){c("P2PActions").checkoutPaymentMethodSelected(n)},handlePaymentMethodConfigured:function m(n){c("P2PActions").checkoutPaymentMethodConfigured(n)},handleAddressFormValidation:function m(n,o){c("P2PActions").checkoutAddressFormValidated(n,o)},handleAddressChangeClicked:function m(){c("P2PActions").checkoutAddressEditOptionsToggled(true)},handleAddressSelected:function m(n){this._toggledAddress=n;c("P2PActions").checkoutAddressFormToggled(false)},handleNewAddressSelected:function m(){c("P2PActions").addAddressErrorCleared();c("P2PActions").checkoutAddressFormToggled(true)},saveAddress:function m(){this.props.onSaveAddress()},handleEditCancelClicked:function m(){if(!this.props.addresses.count()||this.props.showPaymentMethodForm)this.props.onClose();this.cleanup()},cleanup:function m(){c("P2PActions").addCreditCardErrorCleared();c("P2PActions").addAddressErrorCleared();c("P2PActions").checkoutEditCompleted()},handleContinueClicked:function m(){__p&&__p();var n=this._toggledAddress;if(this.props.showCreditCardForm)this.saveCreditCard();else if(this.props.showAddressForm)this.saveAddress();else if(this.props.showCreditCardEditOptions)if(this._toggledCreditCard){c("P2PActions").checkoutCreditCardSelected(this._toggledCreditCard.getCredentialId());this._toggledCreditCard=null}else this.handleEditCancelClicked();else if(this.props.editingPaymentMethod){if(this.isConfiguredPaymentMethodSelected())this.props.onConfirmSelectedPaymentMethod()}else if(this.props.showAddressEditOptions)if(n){c("P2PActions").checkoutAddressSelected(n.id);if(this.props.platformContext)this.props.onSetAddress(n.id);this._toggledAddress=null}else this.handleEditCancelClicked()},handleCompleteManualPaymentClicked:function m(){this.props.onCompleteManualPayment()},handlePlaceOrderClicked:function m(){this.props.onPlaceOrder()},render:function m(){var n=void 0,o=c("MessengerEnvironment").messengerui,p=o?720:680;if(!o)n=c("React").createElement(c("P2PDialogTitle.react"),null,j._("Pagar"));return c("React").createElement(c("P2PDialog.react"),{className:"_ugr",hideOnEscape:true,layerHideOnBlur:o,onToggle:this.handleToggle,repositionOnUpdate:true,shown:true,width:p},n,c("React").createElement(c("P2PDialogBody.react"),{className:"_4oz6"+(this.props.initialDataLoaded?" _3t72":"")},c("React").createElement("div",{className:"_4oz7"},c("React").createElement("div",{className:"_4oz8"},this.renderItemSection()),this.renderRightPanel()),c("React").createElement(c("P2PLoadingMask.react"),{visible:!this.props.initialDataLoaded||this.props.saving})))}});f.exports=l}),null);
__d("P2PPaymentMethodStore",["P2PActionConstants","CreditCardFormParam","EventEmitter","FBPaymentsMethodType","Map","P2PCreditCard","P2PDispatcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("EventEmitter"));i=h&&h.prototype;function j(){i.constructor.call(this);this.$P2PPaymentMethodStore1=c("P2PDispatcher").register(this.onEventDispatched.bind(this));this.$P2PPaymentMethodStore2=new(c("Map"))();this.$P2PPaymentMethodStore3=new(c("Map"))();this.$P2PPaymentMethodStore4=new(c("Map"))()}j.prototype.onEventDispatched=function(k){var l=k.data,m=k.type;switch(m){case c("P2PActionConstants").PAYMENT_METHODS_UPDATED:this.handlePaymentMethodsUpdated(l);this.emit("change");break;case c("P2PActionConstants").PAYMENT_METHODS_UPDATED_ERROR:this.handlePaymentMethodsUpdatedError(l);this.emit("change")}};j.prototype.handlePaymentMethodsUpdated=function(k){__p&&__p();var l=k.id,m=k.paymentMethodsData,n=m.available_payment_methods_details,o=m.existing_payment_methods;if(o){o=o.map(function(p){var q=p.data;q[c("CreditCardFormParam").CARD_NUMBER]=p.data.ccNumber;q[c("CreditCardFormParam").CREDENTIAL_ID]=p.id;return{creditCard:new(c("P2PCreditCard"))(q),type:c("FBPaymentsMethodType").GENERIC_CARD}});n=o.concat(n)}this.$P2PPaymentMethodStore3["delete"](l);this.$P2PPaymentMethodStore2.set(l,n);this.$P2PPaymentMethodStore4.set(l,o[0])};j.prototype.handlePaymentMethodsUpdatedError=function(k){this.$P2PPaymentMethodStore3.set(k.id,k.error)};j.prototype.getPreviousPaymentMethod=function(k){if(k&&this.$P2PPaymentMethodStore4.has(k))return this.$P2PPaymentMethodStore4.get(k);return null};j.prototype.getDispatchToken=function(){return this.$P2PPaymentMethodStore1};j.prototype.failedPaymentMethodsFetch=function(k){return this.$P2PPaymentMethodStore3.has(k)};j.prototype.getPaymentMethodsFetchError=function(k){return this.$P2PPaymentMethodStore3.get(k)};f.exports=new j()}),null);
__d("P2PCheckoutStore",["P2PActionConstants","CreditCardFormParam","EventEmitter","MessengerPaymentProductType","P2PAddressStore","P2PAPI","P2PCreditCardStore","P2PDispatcher","P2PPaymentMethodStore","P2PPlatformContextStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=null,k=null,l=false,m=false,n=false,o=false,p=false,q=false,r=false,s=null,t=false,u=null,v=false,w=null,x=null,y=false,z=null,A=null,B=null,C=null,D=null,E=false,F=null;h=babelHelpers.inherits(G,c("EventEmitter"));i=h&&h.prototype;function G(){i.constructor.call(this);this.$P2PCheckoutStore1=c("P2PDispatcher").register(this.onEventDispatched.bind(this))}G.prototype.getDispatchToken=function(){return this.$P2PCheckoutStore1};G.prototype.onEventDispatched=function(H){__p&&__p();var I=H.data,J=H.type;c("P2PDispatcher").waitFor([c("P2PAddressStore").getDispatchToken(),c("P2PCreditCardStore").getDispatchToken(),c("P2PPlatformContextStore").getDispatchToken()]);switch(J){case c("P2PActionConstants").CREDIT_CARD_UPDATED:case c("P2PActionConstants").CREDIT_CARD_VERIFIED:this.handleCreditCardUpdated(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_CART_INITIATED:this.handleCheckoutCartInitiated();this.emit("change");break;case c("P2PActionConstants").CHECKOUT_CART_CREATED:this.handleCheckoutCartCreated(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_ADDRESS_SELECTED:this.handleAddressSelected(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_SHIPPING_OPTION_SELECTED:this.handleShippingOptionSelected(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_CREDIT_CARD_SELECTED:this.handleCreditCardSelected(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_ADDRESS_FORM_TOGGLED:this.handleAddressFormToggled(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_CREDIT_CARD_FORM_TOGGLED:this.handleCreditCardFormToggled(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_ADDRESS_EDIT_OPTIONS_TOGGLED:this.handleAddressEditOptionsToggled(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_CREDIT_CARD_EDIT_OPTIONS_TOGGLED:this.handleCreditCardEditOptionsToggled(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_EDIT_OPTIONS_TOGGLED:this.handlePaymentMethodEditOptionsToggled(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_CONFIGURED:this.handlePaymentMethodConfigured(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_CONFIRMED:this.handlePaymentMethodConfirmed(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_SELECTED:this.handlePaymentMethodSelected(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_ADDRESS_FORM_VALIDATED:this.handleAddressFormValidated(I.isValid,I.formData);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_CREDIT_CARD_FORM_VALIDATED:this.handleCreditCardFormValidated(I.isValid,I.formData);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_EDIT_COMPLETED:this.handleCheckoutEditCompleted();this.emit("change");break;case c("P2PActionConstants").CHECKOUT_PROCESSING:this.handleCheckoutProcessing(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_BUYER_PROFILE_UPDATED:this.handleCheckoutBuyerProfileUpdated(I);this.emit("change");break;case c("P2PActionConstants").CHECKOUT_MANUAL_PAYMENT_RECEIPT_UPDATED:this.handleManualPaymentReceiptUpdated(I);this.emit("change");break}};G.prototype.handleCreditCardUpdated=function(H){var I=this.getSelectedCreditCard();if(I&&I.getCredentialId()===H[c("CreditCardFormParam").CREDENTIAL_ID])k=c("P2PCreditCardStore").getCreditCardByCredentialID(I.getCredentialId())};G.prototype.handleCheckoutCartInitiated=function(){w=null;D=null;B=null;j=null;x=null;F=null;E=false};G.prototype.handleCheckoutCartCreated=function(H){w=H.sellerID;D=H.invoiceID;E=!!H.acceptInternationalAddresses};G.prototype.handleCheckoutProcessing=function(H){v=H};G.prototype.handleAddressSelected=function(H){var I=c("P2PAddressStore").getAll(!E),J=I.find(function(J){return J.id===H});j=J;x=null;this.handleCheckoutEditCompleted()};G.prototype.handleShippingOptionSelected=function(H){var I=this.getPlatformContext(),J=I&&I.shipping&&I.shipping.shippingOptions,K=void 0;if(J)K=J.filter(function(K){return K.id===H})[0];x=K};G.prototype.handleCreditCardSelected=function(H){var I=c("P2PCreditCardStore").getAll(c("MessengerPaymentProductType").MESSENGER_COMMERCE),J=I.filter(function(J){return J.getCredentialId()===H})[0];k=J;this.handleCheckoutEditCompleted()};G.prototype.handleAddressFormToggled=function(H){l=H;this.handleAddressFormValidated(false,null)};G.prototype.handleCreditCardFormToggled=function(H){m=H;this.handleCreditCardFormValidated(false,null)};G.prototype.handlePaymentMethodFormToggled=function(H){n=H};G.prototype.handleAddressEditOptionsToggled=function(H){o=H};G.prototype.handleAddressFormValidated=function(H,I){r=H;s=I};G.prototype.handleCreditCardFormValidated=function(H,I){t=H;u=I};G.prototype.handleCheckoutEditCompleted=function(){__p&&__p();this.handleAddressFormValidated(false,null);this.handleAddressEditOptionsToggled(false);this.handleAddressFormToggled(false);this.handleCreditCardFormValidated(false,null);this.handleCreditCardEditOptionsToggled(false);this.handleCreditCardFormToggled(false);this.handlePaymentMethodSelected(null);this.handlePaymentMethodConfigured(null);this.handlePaymentMethodFormToggled(false);this.handlePaymentMethodEditOptionsToggled(false)};G.prototype.handleCreditCardEditOptionsToggled=function(H){p=H};G.prototype.handlePaymentMethodEditOptionsToggled=function(H){q=H};G.prototype.handleCheckoutBuyerProfileUpdated=function(H){z=H;y=true};G.prototype.handleManualPaymentReceiptUpdated=function(H){F=H.receiptFbid};G.prototype.handlePaymentMethodConfigured=function(H){A=H};G.prototype.handlePaymentMethodConfirmed=function(H){B=H;this.handleCheckoutEditCompleted()};G.prototype.handlePaymentMethodSelected=function(H){C=H};G.prototype.isAddressFormShown=function(){return!c("P2PAddressStore").getAll(!E).count()||l};G.prototype.isCreditCardFormShown=function(){var H=c("P2PCreditCardStore").getAll(c("MessengerPaymentProductType").MESSENGER_COMMERCE);return!this.isAddressFormShown()&&(!H.length||m)};G.prototype.isPaymentMethodFormShown=function(){var H=!this.isAddressFormShown()&&(!this.getConfirmedPaymentMethod()||n);return H};G.prototype.isAddressEditOptionsShown=function(){return o};G.prototype.isCreditCardEditOptionsShown=function(){return p};G.prototype.isPaymentMethodEditOptionsShown=function(){return q};G.prototype.isEditingPaymentMethod=function(){return this.isPaymentMethodFormShown()||this.isPaymentMethodEditOptionsShown()};G.prototype.getConfirmedPaymentMethod=function(){return B||c("P2PPaymentMethodStore").getPreviousPaymentMethod(this.getInvoiceID())};G.prototype.getConfiguredPaymentMethod=function(){return A};G.prototype.getSelectedPaymentMethod=function(){return C};G.prototype.getAttachedReceiptFbid=function(){return F};G.prototype.getSelectedAddress=function(){__p&&__p();var H=this.getPlatformContext(),I=c("P2PAddressStore").getAll(!E),J=void 0;if(j)return j;if(H&&H.shipping&&H.shipping.selectedShippingAddressID){J=I.find(function(J){return H&&J.id===H.shipping.selectedShippingAddressID});if(J)return J}return I.first()};G.prototype.getSelectedShippingOption=function(){__p&&__p();var H=this.getPlatformContext(),I=H&&H.shipping,J=I&&I.selectedShippingOptionID,K=I&&I.shippingOptions,L=void 0;if(x)return x;if(K&&K.length){L=K.filter(function(L){return L.id===J})[0];if(L)return L}return K&&K[0]};G.prototype.getSelectedCreditCard=function(){var H=c("P2PCreditCardStore").getAll(c("MessengerPaymentProductType").MESSENGER_COMMERCE);return k||H[0]};G.prototype.isAddressFormValid=function(){return r};G.prototype.getAddressFormData=function(){return s};G.prototype.isCreditCardFormValid=function(){return t};G.prototype.getCreditCardFormData=function(){return u};G.prototype.isProcessing=function(){return v};G.prototype.isBuyerProfileFetchComplete=function(){return y};G.prototype.getPlatformContext=function(){if(w)return c("P2PPlatformContextStore").getPlatformContextByOtherUserID(w)};G.prototype.getInvoiceID=function(){return D};G.prototype.getPlaceOrderFormData=function(){var H=this.getPlatformContext(),I=this.getSelectedShippingOption(),J=this.getSelectedAddress(),K=this.getSelectedCreditCard(),L=c("CreditCardFormParam").CREDENTIAL_ID,M={};M[L]=K&&K.getCredentialId();M=babelHelpers["extends"]({},M,{amount:I&&I.rawTotal,platform_context_id:H&&H.id,receiverId:H&&H.sellerID,shippingAddressID:J&&J.id,shippingOptionID:I&&I.id});return M};G.prototype.getBuyerProfileData=function(){if(z)return z;z={};c("P2PAPI").getCurrentUserProfileData()};f.exports=new G()}),null);
__d("P2PEditCreditCardDialog.react",["cx","fbt","CreditCardFormParam","MessengerEnvironment","Link.react","React","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLinkConstants","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PButton.react","P2PText.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l="fbP2PEditCreditCardDialog_learnMoreSentenceID",m=c("React").PropTypes;j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={formData:{},isValid:false,loading:false,requestID:"",saveErrors:null},this.clearSaveErrors=function(){this.setState({saveErrors:null})}.bind(this),this.onSaveClick=function(t){var u={},v=c("P2PAPIUtils").genRequestID();u[c("CreditCardFormParam").CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:true,requestID:v});c("P2PAPI").updateCreditCard(babelHelpers["extends"]({requestID:v},u,this.state.formData))}.bind(this),this.handleOnSaveSuccess=function(t){this.props.onSuccess(t)}.bind(this),this.onCancelClick=function(t){this.props.onCancel()}.bind(this),this.handleOnSaveError=function(t){this.setState({loading:false,saveErrors:t})}.bind(this),this.isSaveDisabled=function(){return!this.state.isValid||this.state.loading}.bind(this),this.isCancelDisabled=function(){return this.state.loading}.bind(this),this.handleValidation=function(t,u){this.setState({isValid:t,formData:u})}.bind(this),this.getPrefilledFormData=function(){var t={};t[c("CreditCardFormParam").CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();t[c("CreditCardFormParam").CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();t[c("CreditCardFormParam").ZIP]=this.props.creditCard.getZipCode();return t}.bind(this),this.handleErrorDialogOKClick=function(){this.clearSaveErrors()}.bind(this),this.onToggle=function(t){if(!t)this.props.onCancel()}.bind(this),p}n.prototype.componentWillReceiveProps=function(o){var p=o.asyncRequestState?o.asyncRequestState[this.state.requestID]:null;if(p){this.setState({requestID:""});if(p.error)this.handleOnSaveError(p.error);else this.handleOnSaveSuccess(p)}};n.prototype.render=function(){var o=void 0,p=this.props.text;if(!p)p=i._("Actualiza la fecha de vencimiento de tu tarjeta que termina en {card numbers}.",[i.param("card numbers",this.props.creditCard.getCreditCardNumber())]);if(this.props.showCancelButton)o=c("React").createElement(c("P2PButton.react"),{use:"default",size:"medium",label:i._("Cancelar"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick});return c("React").createElement(c("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:false,onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},c("React").createElement(c("P2PDialogTitle.react"),null,i._("Actualizar tarjeta de d\u00e9bito")),c("React").createElement(c("P2PDialogBody.react"),null,c("React").createElement(c("P2PText.react"),{className:"_3-96",type:"primary"},p),c("React").createElement(c("P2PCreditCardForm.react"),{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:true,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()}),c("React").createElement(c("P2PText.react"),{className:"_3-8y",id:l,type:"secondary"},i._("Tu informaci\u00f3n de pago se guardar\u00e1 de forma segura. {Learn more about p2p link}",[i.param("Learn more about p2p link",c("React").createElement(c("Link.react"),{"aria-describedby":l,href:c("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},i._("M\u00e1s informaci\u00f3n.")))]))),c("React").createElement(c("P2PDialogFooter.react"),null,o,c("React").createElement(c("P2PButton.react"),{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),c("React").createElement(c("P2PLoadingMask.react"),{visible:this.state.loading}))};n.propTypes={asyncRequestState:m.object.isRequired,creditCard:m.instanceOf(c("P2PCreditCard")).isRequired,onCancel:m.func.isRequired,onSuccess:m.func.isRequired,saveButtonText:m.node,showCancelButton:m.bool};n.defaultProps={saveButtonText:i._("Guardar"),showCancelButton:true,width:c("MessengerEnvironment").messengerui?350:300};f.exports=n}),null);
__d("P2PPasswordProtectionNUXDialog.react",["cx","fbt","MessengerEnvironment","Link.react","P2PAPI","P2PErrorDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionParam","P2PPasswordProtectionStatusTypes","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","emptyFunction"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={saveErrorObject:null,loading:false},this.log=function(s,t){c("P2PLogger").log(s,babelHelpers["extends"]({www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SETTINGS},t))},this.onSaveClick=function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(c("P2PPasswordProtectionStatusTypes").ENABLED);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX)}.bind(this),this.setPasswordProtection=function(s){var t={};t[c("P2PPasswordProtectionParam").STATUS]=s;c("P2PAPI").setPasswordProtectionSetting({formData:t,success:this.handleOnSaveSuccess,error:this.handleOnSaveError})}.bind(this),this.handleOnSaveSuccess=function(){this.setState({loading:false});this.props.onComplete()}.bind(this),this.handleOnSaveError=function(s){this.setState({loading:false,saveErrorObject:s})}.bind(this),this.isSaveButtonDisabled=function(){return this.state.loading}.bind(this),this.isCancelButtonDisabled=function(){return this.state.loading}.bind(this),this.onCancelClick=function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(c("P2PPasswordProtectionStatusTypes").DISABLED);this.log(c("P2PPaymentLoggerEvent").UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX)}.bind(this),this.handleErrorBackClick=function(){this.setState({saveErrorObject:null})}.bind(this),this.handleErrorOKClick=function(){this.setState({saveErrorObject:null});this.props.onComplete()}.bind(this),o}m.prototype.componentWillMount=function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX)};m.prototype.render=function(){if(this.state.saveErrorObject)return c("React").createElement(c("P2PErrorDialog.react"),{allowBack:true,title:i._("Problema al guardar"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject});return c("React").createElement(c("P2PDialog.react"),{className:c("MessengerEnvironment").messengerui?"_-el":"",behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:this.props.width},c("React").createElement(c("P2PDialogTitle.react"),{showCloseButton:false},i._("\u00bfUsar contrase\u00f1a?")),c("React").createElement(c("P2PDialogBody.react"),null,c("React").createElement(c("P2PText.react"),{className:"_5sor",type:"primary"},i._("Para una mayor seguridad, puedes usar tu contrase\u00f1a de Facebook al enviar dinero. Puedes actualizar esta opci\u00f3n en cualquier momento en {link}.",[i.param("link",c("React").createElement(c("Link.react"),{href:c("P2PLinkConstants").settingsWWWURI,target:"_blank"},i._("Configuraci\u00f3n")))]))),c("React").createElement(c("P2PDialogFooter.react"),null,c("React").createElement(c("P2PButton.react"),{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:i._("Ahora no"),onClick:this.onCancelClick,size:"medium",use:"default"}),c("React").createElement(c("P2PButton.react"),{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:i._("Usar contrase\u00f1a"),onClick:this.onSaveClick,size:"medium",use:"confirm"})),c("React").createElement(c("P2PLoadingMask.react"),{visible:this.state.loading}))};m.propTypes={onComplete:l.func};m.defaultProps={onComplete:c("emptyFunction"),width:c("MessengerEnvironment").messengerui?320:300};f.exports=m}),null);
__d("P2PSuccessDialog.react",["fbt","ix","MessengerEnvironment","Image.react","LayerSlowlyFadeOnShow","P2PConfirmationDialog.react","React","emptyFunction"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.getImage=function(){return c("React").createElement(c("Image.react"),{height:62,width:62,src:i("94361")})},o}m.prototype.render=function(){var n=this.getImage();return c("React").createElement(c("P2PConfirmationDialog.react"),{behaviors:babelHelpers["extends"]({LayerSlowlyFadeOnShow:c("LayerSlowlyFadeOnShow")},this.props.behaviors),allowBack:this.props.allowBack,buttonLabel:this.props.buttonLabel,buttonUse:this.props.buttonUse,centered:this.props.centered,image:n,onOKClick:this.props.onOKClick,onSecondaryClick:this.props.onSecondaryClick,onToggle:this.props.onToggle,showCloseButton:this.props.showCloseButton,showSecondaryButton:this.props.showSecondaryButton,secondaryButtonLabel:this.props.secondaryButtonLabel,secondaryButtonUse:this.props.secondaryButtonUse,title:this.props.title,width:this.props.width},this.props.children)};m.propTypes={allowBack:l.bool,buttonLabel:l.node,buttonUse:l.string,onOKClick:l.func,onSecondaryClick:l.func,onToggle:l.func,secondaryButtonLabel:l.node,secondaryButtonUse:l.string,showCloseButton:l.bool,showSecondaryButton:l.bool,title:l.node.isRequired,width:l.number};m.defaultProps={allowBack:false,buttonLabel:h._("Aceptar"),buttonUse:"default",onOKClick:c("emptyFunction"),showCloseButton:false,width:c("MessengerEnvironment").messengerui?350:300};f.exports=m}),null);
__d("P2PCheckoutDialogContainer.react",["fbt","invariant","Arbiter","FBPaymentsCreditCardVerificationDialog_DEPRECATED.react","FBPaymentsMethodType","Link.react","P2PActions","P2PAPI","P2PAPIUtils","P2PAddressStore","P2PCreditCardStore","P2PCheckoutDialog.react","P2PCheckoutStore","P2PDispatcher","P2PEditCreditCardDialog.react","P2PErrorDialog.react","P2PLogger","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPlatformContextShape","P2PSuccessDialog.react","P2PText.react","P2PVerifyCreditCardDialog.react","React","ReactLayeredComponentMixin_DEPRECATED","StoreAndPropBasedStateMixin"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("React").PropTypes,k="fbpay_login_and_pay",l="about:blank",m=c("React").createClass({displayName:"P2PCheckoutDialogContainer",mixins:[c("ReactLayeredComponentMixin_DEPRECATED"),c("StoreAndPropBasedStateMixin")(c("P2PAddressStore"),c("P2PCheckoutStore"),c("P2PCreditCardStore"))],propTypes:{acceptInternationalAddresses:j.bool,asyncPaymentDetails:j.object,onCheckoutSuccess:j.func,onClose:j.func.isRequired,onSeeReceiptClick:j.func,configSelections:j.string,customCheckoutDetails:j.node,paymentMethods:j.array,paymentMethodsFetchError:j.object,paymentProductType:j.string,platformContext:c("P2PPlatformContextShape"),platformContextSaveError:j.object,productItemID:j.string,showAsyncPaymentDetails:j.bool,showTaxField:j.bool,usePaymentMethods:j.bool},getInitialState:function n(){return{creditCardVerificationDialogShown:false,editCreditCardDialogShown:false,openedWindow:null,passwordProtectionNUXShown:false,successDialogShown:false,transferError:null,verifyCreditCardDialogShown:false}},statics:{calculateState:function n(o){return{addresses:c("P2PAddressStore").getAll(!o.acceptInternationalAddresses),addressFormData:c("P2PCheckoutStore").getAddressFormData(),addressFormValid:c("P2PCheckoutStore").isAddressFormValid(),addressSaveErrors:c("P2PAddressStore").getSaveErrors(),buyer:c("P2PCheckoutStore").getBuyerProfileData(),configuredPaymentMethod:c("P2PCheckoutStore").getConfiguredPaymentMethod(),confirmedPaymentMethod:c("P2PCheckoutStore").getConfirmedPaymentMethod(),creditCardAsyncRequestState:c("P2PCreditCardStore").getAsyncRequestState(),creditCardFormData:c("P2PCheckoutStore").getCreditCardFormData(),creditCardFormValid:c("P2PCheckoutStore").isCreditCardFormValid(),creditCards:c("P2PCreditCardStore").getAll(o.paymentProductType),creditCardSaveErrors:c("P2PCreditCardStore").getSaveErrors(),editingPaymentMethod:c("P2PCheckoutStore").isEditingPaymentMethod()&&o.usePaymentMethods,initialDataLoaded:o.platformContext&&(!!o.asyncPaymentDetails||c("P2PAddressStore").isAddressesFetchComplete()&&c("P2PCreditCardStore").isCreditCardsFetchComplete()&&c("P2PCheckoutStore").isBuyerProfileFetchComplete()&&(!o.usePaymentMethods||!!o.paymentMethods)),orderID:c("P2PCheckoutStore").getInvoiceID(),receiptAttached:!!c("P2PCheckoutStore").getAttachedReceiptFbid(),saving:c("P2PCheckoutStore").isProcessing()||c("P2PCreditCardStore").isSaving()||c("P2PAddressStore").isSaving(),selectedAddress:c("P2PCheckoutStore").getSelectedAddress(),selectedCreditCard:c("P2PCheckoutStore").getSelectedCreditCard(),selectedPaymentMethod:c("P2PCheckoutStore").getSelectedPaymentMethod(),selectedShippingOption:c("P2PCheckoutStore").getSelectedShippingOption(),shippingOptions:o.platformContext&&o.platformContext.shipping?o.platformContext.shipping.shippingOptions:null,showAddressForm:c("P2PCheckoutStore").isAddressFormShown(),showCreditCardForm:c("P2PCheckoutStore").isCreditCardFormShown()&&!o.usePaymentMethods,showAddressEditOptions:c("P2PCheckoutStore").isAddressEditOptionsShown(),showCreditCardEditOptions:c("P2PCheckoutStore").isCreditCardEditOptionsShown()&&!o.usePaymentMethods,showPaymentMethodEditOptions:c("P2PCheckoutStore").isPaymentMethodEditOptionsShown()&&o.usePaymentMethods,showPaymentMethodForm:c("P2PCheckoutStore").isPaymentMethodFormShown()&&o.usePaymentMethods}}},_paymentMethodAddCardRequestId:"",componentWillMount:function n(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHECKOUT);c("P2PDispatcher").explicitlyRegisterStores([c("P2PCheckoutStore")])},componentWillUnmount:function n(){if(this._passwordCancelSubscribeToken!==null){c("Arbiter").unsubscribe(this._passwordCancelSubscribeToken);this._passwordCancelSubscribeToken=null}},componentDidUpdate:function n(o,p){this._trackEvents(o,p)},log:function n(o,p){var q=this.props.platformContext,r={};if(q)r=q.product.rawAmount;c("P2PLogger").log(o,babelHelpers["extends"]({www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_CHECKOUT,raw_amount:r.amount,currency:r.currency,object_id:this.props.productItemID},p))},_placeOrderPending:false,_passwordCancelSubscribeToken:null,_passwordProtectionNUXPending:false,handleCancel:function n(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CANCEL);this.props.onClose()},handleSuccess:function n(){var o=arguments.length<=0||arguments[0]===undefined?true:arguments[0];this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_SUCCESS);o&&this.props.onClose()},handleSaveAddress:function n(){this.saveAddress()},closeOpenedWindow:function n(){this.state.openedWindow&&this.state.openedWindow.close()},saveAddress:function n(){c("P2PAPI").addAddress(babelHelpers["extends"]({},this.state.addressFormData,{platformContext:this.props.platformContext,onSuccess:this.handleSaveAddressSuccess,onError:this.handleSaveAddressError}));this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_ADDRESS_DETAILS)},handleSaveAddressSuccess:function n(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_ADD_ADDRESS_SUCCESS)},handleSaveAddressError:function n(o){o=o.errors;this.log(c("P2PPaymentLoggerEvent").UI_ACTN_ADD_ADDRESS_FAIL,{message:o&&o.general?o.general.message:""})},handleSaveCreditCard:function n(){this.saveCreditCard()},saveCreditCard:function n(){c("P2PAPI").addCreditCard(babelHelpers["extends"]({product_type:this.props.paymentProductType},this.state.creditCardFormData,{hasPlatformContext:!!this.props.platformContext,onSuccess:this.handleSaveCreditCardSuccess,onError:this.handleSaveCreditCardError}));this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_CARD_DETAILS)},handleSaveCreditCardSuccess:function n(){if(this._placeOrderPending){this._placeOrderPending=false;this.placeOrder()}this.log(c("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_SUCCESS)},handleSaveCreditCardError:function n(o){o=o.errors;this.log(c("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_FAIL,{message:o&&o.general?o.general.message:""})},handleConfirmPaymentMethod:function n(){var o=this.state.configuredPaymentMethod;switch(o.type){case c("FBPaymentsMethodType").NEW_CREDIT_CARD:var p=c("P2PAPIUtils").genRequestID();this._paymentMethodAddCardRequestId=p;c("P2PAPI").addCreditCard(babelHelpers["extends"]({product_type:this.props.paymentProductType,requestID:p},o.formData,{hasPlatformContext:!!this.props.platformContext,onSuccess:this.handleConfirmPaymentMethodSuccess}));break;case c("FBPaymentsMethodType").GENERIC_CARD:case c("FBPaymentsMethodType").PAY_OVER_COUNTER:case c("FBPaymentsMethodType").MANUAL_TRANSFER:case c("FBPaymentsMethodType").NET_BANKING:this.handleConfirmPaymentMethodSuccess();break}},handleConfirmPaymentMethodSuccess:function n(){var o=this.state.configuredPaymentMethod;switch(o.type){case c("FBPaymentsMethodType").NEW_CREDIT_CARD:this.handleConfirmPaymentMethodAddCardSuccess();break;default:c("P2PActions").checkoutPaymentMethodConfirmed(o)}},handleConfirmPaymentMethodAddCardSuccess:function n(){var o=c("P2PCreditCardStore").getAsyncRequestState(),p=o[this._paymentMethodAddCardRequestId];if(!p)return;var q=c("P2PCreditCardStore").getCreditCardByCredentialID(p.credential_id),r={creditCard:q,type:c("FBPaymentsMethodType").GENERIC_CARD};this._paymentMethodAddCardRequestId="";c("P2PActions").checkoutPaymentMethodConfirmed(r)},handlePlaceOrder:function n(){if(this.props.usePaymentMethods){this.completePaymentMethodCheckout();return}if(this.state.showCreditCardForm){this._placeOrderPending=true;this.saveCreditCard()}else this.placeOrderWithExistingCard()},handleCompleteManualPayment:function n(){var o=this.state.orderID,p=this.props.asyncPaymentDetails&&this.props.asyncPaymentDetails.id;o&&p||i(0);c("P2PAPI").completeReceiptUploadCheckout({onSuccess:function(){this.setState({successDialogShown:true})}.bind(this),onError:function(q){this.setState({transferError:q})}.bind(this),receiptImageID:c("P2PCheckoutStore").getAttachedReceiptFbid(),invoiceID:o,selectedPaymentOptionID:p})},placeOrderWithExistingCard:function n(){__p&&__p();var o=c("P2PCheckoutStore").getSelectedCreditCard();o||i(0);if(!o.getIsVerified()){this.setState({verifyCreditCardDialogShown:true});return}else if(o.isExpired()){this.setState({editCreditCardDialogShown:true});return}this.placeOrder()},placeOrder:function n(){c("P2PActions").checkoutProcessing(true);this.setState({transferError:null});this._passwordCancelSubscribeToken=c("Arbiter").subscribeOnce("PasswordReauthDialogCancelClick",function(){this._passwordCancelSubscribeToken=null;c("P2PActions").checkoutProcessing(false)}.bind(this));c("P2PAPI").createTransaction({error:this.handlePlaceOrderError,formData:c("P2PCheckoutStore").getPlaceOrderFormData(),success:this.handlePlaceOrderSuccess});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CONFIRM)},handlePlaceOrderError:function n(o){c("P2PActions").checkoutProcessing(false);this.setState({transferError:o})},handlePlaceOrderSuccess:function n(o){c("P2PActions").checkoutProcessing(false);var p=o.passwordProtection===c("P2PPasswordProtectionStatusTypes").NOT_SET;if(p)this.setState({passwordProtectionNUXShown:true});else this.handleSuccess()},completePaymentMethodCheckout:function n(){__p&&__p();var o=this.state.confirmedPaymentMethod;switch(o.type){case c("FBPaymentsMethodType").NET_BANKING:case c("FBPaymentsMethodType").PAY_OVER_COUNTER:var p=window.open(l,k);this.setState({openedWindow:p});break;case c("FBPaymentsMethodType").GENERIC_CARD:if(o.creditCard.getCSC())this.completeNMORCheckout({securityCode:o.creditCard.getCSC()});else this.setState({creditCardVerificationDialogShown:true});return}this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CONFIRM);this.completeNMORCheckout()},completeNMORCheckout:function n(o){__p&&__p();var p=this.props.platformContext;p||i(0);var q=this.state.confirmedPaymentMethod;q||i(0);var r=q.type,s=null,t=null;switch(r){case c("FBPaymentsMethodType").GENERIC_CARD:r="cc";t=q.creditCard.getCredentialId();o&&o.securityCode||i(0);break;case c("FBPaymentsMethodType").NET_BANKING:s={bank_code:q.bank.code};break;case c("FBPaymentsMethodType").MANUAL_TRANSFER:s={receipt_image_id:q.receiptFbid,transfer_option_id:q.optionId};break}var u=babelHelpers["extends"]({amount:this.state.selectedShippingOption.rawTotal,currency:p.product.rawAmount.currency,nmorOrderType:this.props.paymentProductType,receiverID:p.sellerID,orderID:this.state.orderID,paymentMethodType:r,paymentMethodData:s,credentialId:t,shippingAddressID:this.state.selectedAddress.id,shippingOptionID:this.state.selectedShippingOption.id,error:this.handleCompletePaymentMethodCheckoutError,success:this.handleCompletePaymentMethodCheckoutSuccess},o);c("P2PActions").checkoutProcessing(true);c("P2PAPI").completeNMORCheckout(u)},handleCreditCardVerificationCancel:function n(){this.setState({creditCardVerificationDialogShown:false})},handleVerifyCreditCardAndCompleteCheckout:function n(o){this.completeNMORCheckout({securityCode:o})},handleCompletePaymentMethodCheckoutError:function n(o){c("P2PActions").checkoutProcessing(false);this.setState({transferError:o});this.closeOpenedWindow()},handleCompletePaymentMethodCheckoutSuccess:function n(o,p){__p&&__p();c("P2PActions").checkoutProcessing(false);this.setState({creditCardVerificationDialogShown:false});var q=this.props.onCheckoutSuccess;q&&q(o,p);var r=this.state.confirmedPaymentMethod;switch(r.type){case c("FBPaymentsMethodType").NET_BANKING:p&&p.net_banking_info||i(0);var s=p.net_banking_info.redirect_url;window.open(s,k);this.handleSuccess();break;case c("FBPaymentsMethodType").PAY_OVER_COUNTER:p&&p.pay_over_counter_info||i(0);var t=p.pay_over_counter_info.instructions_url;window.open(t,k);this.handleSuccess();break;case c("FBPaymentsMethodType").MANUAL_TRANSFER:this.handleSuccess(false);break;default:this.handleSuccess(false);this.setState({successDialogShown:true})}},handleSetAddress:function n(o){var p=this.props.platformContext;p||i(0);c("P2PAPI").setPlatformContextShippingAddress({platformContextID:p.id,shippingAddressID:o})},renderLayers:function n(){__p&&__p();var o={};if(this.props.platformContextSaveError)o.error=c("React").createElement(c("P2PErrorDialog.react"),{title:h._("Problema con la compra"),onOKClick:this.handleCancel,error:this.props.platformContextSaveError});else if(this.props.paymentMethodsFetchError)o.error=c("React").createElement(c("P2PErrorDialog.react"),{title:h._("Se produjo un error"),onOKClick:this.handleCancel,error:h._("No podemos cargar los m\u00e9todos de pago disponibles en este momento. Vuelve a intentarlo m\u00e1s tarde.")});else if(this.state.transferError)o.error=c("React").createElement(c("P2PErrorDialog.react"),{title:h._("Problema con la compra"),onOKClick:this.handleCancel,error:this.state.transferError});else if(this.state.verifyCreditCardDialogShown)o.verificationDialog=c("React").createElement(c("P2PVerifyCreditCardDialog.react"),{creditCard:this.state.selectedCreditCard,asyncRequestState:this.state.creditCardAsyncRequestState,isSending:true,onCancel:function(){this.setState({verifyCreditCardDialogShown:false});c("P2PActions").checkoutProcessing(false)}.bind(this),onSuccess:function(){this.setState({verifyCreditCardDialogShown:false});this.placeOrderWithExistingCard()}.bind(this)});else if(this.state.editCreditCardDialogShown)o.editCreditCardDialog=c("React").createElement(c("P2PEditCreditCardDialog.react"),{asyncRequestState:this.state.creditCardAsyncRequestState,creditCard:this.state.selectedCreditCard,onCancel:function(){this.setState({editCreditCardDialogShown:false});c("P2PActions").checkoutProcessing(false)}.bind(this),onSuccess:function(){this.setState({editCreditCardDialogShown:false});this.placeOrderWithExistingCard()}.bind(this)});return o},render:function n(){__p&&__p();if(this.state.passwordProtectionNUXShown)return c("React").createElement(c("P2PPasswordProtectionNUXDialog.react"),{onComplete:this.handleSuccess});else if(this.state.creditCardVerificationDialogShown){var o=this.state.confirmedPaymentMethod.creditCard,p=c("React").createElement(c("P2PText.react"),{size:"small",type:"secondary"},c("React").createElement(c("Link.react"),{onClick:this.handleCreditCardVerificationCancel,size:"small"},h._("Usar otro m\u00e9todo de pago"))),q=h._("Pagar");return c("React").createElement(c("FBPaymentsCreditCardVerificationDialog_DEPRECATED.react"),{creditCard:o,leftContent:p,loading:this.state.saving,onConfirm:this.handleVerifyCreditCardAndCompleteCheckout,primaryButtonText:q,showCancelButton:false})}else if(this.state.successDialogShown){var r=h._("El proceso de compra est\u00e1 completo. En breve recibir\u00e1s un correo electr\u00f3nico de confirmaci\u00f3n.");if(this.props.asyncPaymentDetails)r=h._("Se envi\u00f3 el comprobante de pago. El vendedor verificar\u00e1 tu pago en breve.");return c("React").createElement(c("P2PSuccessDialog.react"),{buttonLabel:h._("Ver recibo"),buttonUse:"confirm",onOKClick:this.props.onSeeReceiptClick||this.handleSuccess,onToggle:function(){this.handleSuccess()}.bind(this),showCloseButton:true,title:h._("Confirmaci\u00f3n")},c("React").createElement(c("P2PText.react"),{type:"secondary",style:{textAlign:"center"}},r))}return c("React").createElement(c("P2PCheckoutDialog.react"),babelHelpers["extends"]({},this.props,this.state,{onClose:this.handleCancel,onCompleteManualPayment:this.handleCompleteManualPayment,onConfirmSelectedPaymentMethod:this.handleConfirmPaymentMethod,onPlaceOrder:this.handlePlaceOrder,onSaveAddress:this.handleSaveAddress,onSaveCreditCard:this.handleSaveCreditCard,onSetAddress:this.handleSetAddress}))},_trackEvents:function n(o,p){__p&&__p();if(!o.platformContextSaveError&&this.props.platformContextSaveError)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CART_CREATION_FAIL);if(!this.state.initialDataLoaded)return;if(!p.initialDataLoaded&&this.state.initialDataLoaded)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CART_CREATION_SUCCESS);if(!p.showCreditCardForm&&this.state.showCreditCardForm)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_CARD);if(p.showCreditCardForm&&!this.state.showCreditCardForm)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_CARD);if(!p.showCreditCardEditOptions&&this.state.showCreditCardEditOptions)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_CARD);if(!p.showAddressForm&&this.state.showAddressForm)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_ADDRESS);if(p.showAddressForm&&!this.state.showAddressForm)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_ADDRESS);if(!p.showAddressEditOptions&&this.state.showAddressEditOptions)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_ADDRESS);if(!p.verifyCreditCardDialogShown&&this.state.verifyCreditCardDialogShown)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_VERIFY_CSC);if(!p.editCreditCardDialogShown&&this.state.editCreditCardDialogShown)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_EDIT_CARD);if(!p.transferError&&this.state.transferError)this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_FAIL)}});f.exports=m}),null);
__d("P2PMCCartCreationDialogContainer.react",["MessengerPaymentProductType","P2PActions","P2PAPI","P2PCheckoutDialogContainer.react","P2PCheckoutStore","P2PPlatformContextStore","React","StoreAndPropBasedStateMixin"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=c("React").createClass({displayName:"P2PMCCartCreationDialogContainer",mixins:[c("StoreAndPropBasedStateMixin")(c("P2PCheckoutStore"),c("P2PPlatformContextStore"))],propTypes:{configSelections:h.string,productItemID:h.string.isRequired,sellerID:h.string.isRequired},statics:{calculateState:function j(k){return{platformContext:c("P2PCheckoutStore").getPlatformContext(),platformContextSaveError:c("P2PPlatformContextStore").getSaveError(k.productItemID)}}},componentWillMount:function j(){c("P2PAPI").createMCCart({productItemID:this.props.productItemID,sellerID:this.props.sellerID})},handleClose:function j(){c("P2PActions").clearPlatformContextSaveErrors(this.props.productItemID);c("P2PActions").hideDialog()},render:function j(){return c("React").createElement(c("P2PCheckoutDialogContainer.react"),{onClose:this.handleClose,configSelections:this.props.configSelections,paymentProductType:c("MessengerPaymentProductType").MESSENGER_COMMERCE,platformContext:this.state.platformContext,platformContextSaveError:this.state.platformContextSaveError,productItemID:this.props.productItemID})}});f.exports=i}),null);
__d("MNCommercePromotionMercuryShareAttachment.react",["Banzai","MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MessengerAdsWebTypedLogger","MNAdsLoggerEventEnum","MNCommerceCheckoutOrderConfigDialogContainer.react","MNCommerceDialogStateActions","MNCommerceMessageType","MessengerPlatformGenericItemMercuryAttachment.react","MNContentSubscriptionMessageUserEngagementTypedLogger","MNPlatformMessageUserEngagementTypedLogger","P2PActions","P2PMCCartCreationDialogContainer.react","React","StoryAttachmentStyle","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes;function k(n){if(n!==undefined){var o=n.match(/\d+/);if(o!==undefined&&o!==null)return o[0]}return null}function l(n,event){__p&&__p();var o=k(n.props.pageID),p=n.getRetailItem(n.props.attachment.target),q=p&&p.id;if(n.props.mnMessageType==c("MNCommerceMessageType").CONTENT_SUBSCRIPTION){new(c("MNContentSubscriptionMessageUserEngagementTypedLogger"))().setPageID(o).setMessageID(n.props.messageID).setCommerceItemID(q).setName(event).log();switch(event){case"mn_platform_msg_imp":c("Banzai").post("mn_platform_message_imp_setsuna",{page_id:o,item_id:q});break;case"mn_platform_msg_click":c("Banzai").post("mn_platform_message_click_setsuna",{page_id:o,item_id:q});break;default:break}}new(c("MNPlatformMessageUserEngagementTypedLogger"))().setPageID(o).setMessageID(n.props.messageID).setCommerceItemID(q).setName(event).log()}h=babelHelpers.inherits(m,c("React").Component);i=h&&h.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=i.constructor).call.apply(n,[this].concat(q)),this.$MNCommercePromotionMercuryShareAttachment4=function(){__p&&__p();var s=this.props.attachment&&this.props.attachment.target;if(!s)return;var t=this.getRetailItem(s),u=t&&t.id;if(this.props.isSponsored)new(c("MessengerAdsWebTypedLogger"))().setEvent(c("MNAdsLoggerEventEnum").LINK_CLICK_CTA).setIsSponsored(this.props.isSponsored).setItemID(u).setMessageID(this.props.messageID).setPageID(this.props.pageID).log();l(this,"mn_platform_msg_click");var v=this.props.pageID,w=function w(x,y,z){return c("P2PActions").showDialog(c("P2PMCCartCreationDialogContainer.react"),{productItemID:x,sellerID:y,configSelections:z})};c("MNCommerceDialogStateActions").showDialog(c("MNCommerceCheckoutOrderConfigDialogContainer.react"),{onContinue:w,itemID:u,ownerID:v})}.bind(this),o}m.prototype.componentDidMount=function(){l(this,"mn_platform_msg_imp")};m.prototype.render=function(){var n=this.props.attachment&&this.props.attachment.target;if(!n)return c("React").createElement(c("MercuryFallbackShareAttachment.react"),this.props);var o=this.props.attachment&&this.props.attachment.uri,p=this.props.attachment&&this.props.attachment.label,q=this.$MNCommercePromotionMercuryShareAttachment1(),r=this.getRetailItem(n),s=void 0;if(r&&r.call_to_actions&&r.call_to_actions.length>0)s=r.call_to_actions;else s=n.call_to_actions;return c("React").createElement(c("MessengerPlatformGenericItemMercuryAttachment.react"),{callToActions:this.$MNCommercePromotionMercuryShareAttachment2(s),isMediaAttachment:this.$MNCommercePromotionMercuryShareAttachment3(),isSponsored:this.props.isSponsored,isSubattachment:this.props.isSubattachment,itemID:r&&r.id,label:p,location:this.props.location,longestCTAs:this.props.longestCTAs,longestMetaline:this.props.longestMetaline,longestName:this.props.longestName,messageID:this.props.messageID,mnMessageType:this.props.mnMessageType,pageID:this.props.pageID,threadID:this.props.threadID,retailItem:r,url:o,width:this.props.maxWidth,isButtonList:q})};m.prototype.$MNCommercePromotionMercuryShareAttachment2=function(n){__p&&__p();var o=n||[],p=o.map(function(q){var r=q.action_link&&(q.action_link.startsWith("fb-messenger://payments/buy/mc?")||q.action_link.startsWith("fb-messenger://business/commerce/"));if(r){if(c("gkx")("AT4VcZ2n8GFrD7MjVVAjcX0NmvwopB7f803i8mNRrJiQunF1FwYQ1kl6EgxABUzgu-ERWV--QUw6PQC9d4CFCek0"))return babelHelpers["extends"]({onClick:this.$MNCommercePromotionMercuryShareAttachment4},q);return null}else return q}.bind(this));return p.filter(function(q){return q})};m.prototype.$MNCommercePromotionMercuryShareAttachment1=function(){var n=this.props.attachment,o=n&&n.style_list;if(o&&o.length&&o[0]===c("StoryAttachmentStyle").MESSENGER_PLATFORM_BUTTON_LIST)return true;return false};m.prototype.$MNCommercePromotionMercuryShareAttachment3=function(){var n=this.props.attachment,o=n&&n.style_list;if(o&&o.length&&o[0]===c("StoryAttachmentStyle").MESSENGER_PLATFORM_MEDIA_ATTACHMENT)return true;return false};m.prototype.getRetailItem=function(n){var o=this.$MNCommercePromotionMercuryShareAttachment1();if(o)return n;if(n&&n.items)if(n.items.length)return n.items[0];else return null;return n};m.propTypes={attachment:c("MercuryShareAttachmentReactShape"),isSponsored:j.bool,isSubattachment:j.bool,location:j.oneOf(c("MercuryShareAttachmentRenderLocations").getValues()),maxWidth:j.number,messageID:j.string,mnMessageType:j.string,pageID:j.string,threadID:j.string,longestCTAs:j.number,longestMetaline:j.string,longestName:j.string};f.exports=m}),null);
__d("OzBugNub.react",["cx","fbt","Link.react","OzImmutablePureRenderMixin","React","Tooltip","URI"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=1031744366845008,k="Error:\n\nExpected Result:\n\nSteps taken before error occurred:\n",l=c("React").createClass({displayName:"MessengerBugNub",mixins:[c("OzImmutablePureRenderMixin")],render:function m(){var n=new(c("URI"))("/ajax/bugs/report").setQueryData({config_id:j,defaultText:k});return c("React").createElement("div",{className:"_gml"},c("React").createElement(c("Link.react"),babelHelpers["extends"]({href:"#",ajaxify:n,className:"_gmm",rel:"dialog"},c("Tooltip").propsFor(i._("Reportar un error"))),c("React").createElement("span",{className:"_gmn"})))}});f.exports=l}),null);
__d("OzDialogContainer.react",["OzStores","React","Reflux"],(function a(b,c,d,e,f,g){var h=c("OzStores").DialogStore,i=c("React").createClass({displayName:"OzDialogContainer",mixins:[c("Reflux").connect(h,"dialog")],render:function j(){var k=this.state.dialog.dialogClass;if(k){var l=this.state.dialog.dialogProps||{};return c("React").createElement(k,babelHelpers["extends"]({ref:"dialog"},l,{key:"dialog"}))}return null}});f.exports=i}),null);
__d("OzExtensionCheck.react",["cx","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","React","ReloadPage","ShimButton.react","SUIAtlasTheme","SUINotice.react","XUIDialog.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k,l,m=c("React").PropTypes;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;n.prototype.render=function(){"use strict";return c("React").createElement(c("XUIDialog.react"),{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},c("React").createElement("div",{className:"_4eby _2c9g _1-6z"},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,"The Oz Chrome Extension is missing")),c("React").createElement(c("SUINotice.react"),{theme:c("SUIAtlasTheme"),type:"error"},c("React").createElement("div",{className:"_4d80"},"Toto, the oz chrome extension that helps you manage your tabs, and record what was done for each task in the background is missing!",c("React").createElement("strong",null,c("React").createElement(c("ShimButton.react"),{form:"link",onClick:this.props.onInstall}," Click here to install it."))))))};function n(){"use strict";i.apply(this,arguments)}n.propTypes={onInstall:m.func.isRequired};k=babelHelpers.inherits(o,c("React").Component);l=k&&k.prototype;function o(){var p,q;"use strict";for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=l.constructor).call.apply(p,[this].concat(s)),this.$OzExtensionCheck1=function(){window.chrome.webstore.install(undefined,function(u){return c("ReloadPage").now()})},q}o.prototype.componentDidMount=function(){"use strict";var p=!!document.querySelector("#toto-installed");if(p)return;c("OzActions").showDialog(n,{onInstall:this.$OzExtensionCheck1})};o.prototype.render=function(){"use strict";return null};f.exports=o}),null);
__d("OzButton.react",["cx","joinClasses","promiseFinally","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzButton",propTypes:{disabled:i.bool,onClick:i.func,primary:i.bool,tight:i.bool,type:i.oneOf(["button","submit","reset"]),use:i.oneOf(["default","warning","danger"])},getDefaultProps:function k(){return{disabled:false,primary:false,tight:false,type:"button",use:"default"}},getInitialState:function k(){return{loading:false}},render:function k(){var l=this.props,m=l.children,n=l.className,o=l.disabled,p=l.onClick,q=l.primary,r=l.tight,s=l.type,t=l.use,u=babelHelpers.objectWithoutProperties(l,["children","className","disabled","onClick","primary","tight","type","use"]),v=this.state.loading,w=c("joinClasses")(n,"_325k"+(v?" _3e2u":"")+(q?" _325m":"")+(r?" _4wku":"")+(t==="default"?" _325o":"")+(t==="warning"?" _325p":"")+(t==="danger"?" _325q":"")+(o?" _ysb":"")+(!o&&!v?" _4wkv":"")+" _1-hv");return c("React").createElement("button",babelHelpers["extends"]({className:w,disabled:o,onClick:this._handleClick,type:s},u),c("React").createElement("span",{className:"_325r"},m))},_handleClick:function k(l){__p&&__p();var m=this.props,n=m.disabled,o=m.loading,p=m.onClick;if(n||o){l.preventDefault();return}if(!p)return;if(p.length>1){this.setState({loading:true});p(l,this._done);return}var q=p(l);if(q&&q.then){this.setState({loading:true});c("promiseFinally")(q,this._done)}},_done:function k(){if(this.isMounted())this.setState({loading:false})}});f.exports=j}),null);
__d("OzFailed.react",["cx","immutable","OzButton.react","React","ReloadPage"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Iterable,l=c("React").PropTypes;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.prototype.render=function(){"use strict";return c("React").createElement("div",{className:"_30r7"},c("React").createElement("div",{className:"_4rg-"},c("React").createElement("div",null,"Oz couldn't load the following resources:",c("React").createElement("ul",null,this.props.problems.map(function(n,o){return c("React").createElement("li",{key:o},n)})),"Please wait a few seconds, then refresh. If this problem persists for more than a minute or so, contact the oncall."),c("React").createElement("div",{className:"_4rg_"},c("React").createElement(c("OzButton.react"),{primary:true,onClick:c("ReloadPage").now},"Refresh"))))};function m(){"use strict";i.apply(this,arguments)}m.propTypes={problems:l.instanceOf(k)};f.exports=m}),null);
__d("OzHumans",["OzHelpers"],(function a(b,c,d,e,f,g){__p&&__p();var h=6e4,i=45e3,j=-1;function k(s){return s.get("coach-mode?")}function l(s){return s.get("is-coach")}function m(s){return s.get("away?")}function n(s){return s&&!m(s)&&c("OzHelpers").serverNow()-s.get("at",0)<i}function o(s){return n(s)&&s.get("inactive-ms",0)<h}function p(s){return o(s)&&s.get("load",0)<=0&&s.get("team",j)!==j}function q(s){return o(s)&&!k(s)}function r(s){var t=s.filter(q).count(),u=s.reduce(function(v,w){return v+w.get("load",0)},0);return u/t}f.exports={inCoachMode:k,isCoach:l,isAway:m,isPresent:n,isActive:o,isIdle:p,isWorking:q,avgLoad:r}}),null);
__d("OzReps",["OzHelpers"],(function a(b,c,d,e,f,g){__p&&__p();var h=1e3*60*60*8;function i(l){return!l||c("OzHelpers").serverNow()-l.get("updated-at",0)>h}function j(l){var m=l.get("stats");return i(m)?0:m.get("closed-intents",0)}function k(l,m){var n=l.get("team");return m.reduce(function(o,p){return o+(p.get("team")===n?j(p):0)},0)}f.exports={closedIntentCount:j,teamClosedIntentCount:k}}),null);
__d("OzTriSwitch.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(k){var l=k.className,m=k.value,n=k.onClick,o=k.label,p=k.animated,q=babelHelpers.objectWithoutProperties(k,["className","value","onClick","label","animated"]);return c("React").createElement("div",babelHelpers["extends"]({},q,{className:c("joinClasses")(l,"_56de"+(q.reverseColors?" _3tyl":"")+(p?" _56df":"")+(m==="on"?" _56dg":"")+(m==="off"?" _56dh":"")+(m==="neutral"?" _56di":"")),onClick:function(r){function n(s){return r.apply(this,arguments)}n.toString=function(){return r.toString()};return n}(function(r){return n(j[m])}),role:"checkbox",tabIndex:"0"}),c("React").createElement("div",{className:"_56dj",tabIndex:"0"},c("React").createElement("div",{className:"_56dk"})),o?c("React").createElement("span",{className:"_56dn"},o):null)}var j={on:"off",off:"neutral",neutral:"on"};i.toBoolean=function(k){if(k==="neutral")return undefined;if(k==="on")return true;if(k==="off")return false;throw new Error("OzTriSwitch: unknown state "+k)};i.fromBoolean=function(k){return k==null?"neutral":k?"on":"off"};f.exports=i}),null);
__d("OzSwitch.react",["OzImmutablePureRenderMixin","OzTriSwitch.react","React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=c("React").createClass({displayName:"OzSwitch",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{isAnimated:h.bool.isRequired,isOn:h.bool.isRequired,label:h.node.isRequired,onToggle:h.func.isRequired,reverseColors:h.bool},getDefaultProps:function j(){return{isAnimated:false}},render:function j(){var k=this.props,l=k.className,m=k.isAnimated,n=k.isOn,o=k.label,p=k.onToggle;return c("React").createElement(c("OzTriSwitch.react"),{animated:m,className:l,reverseColors:!!this.props.reverseColors,label:o,onClick:function q(){return p(!n)},value:c("OzTriSwitch.react").fromBoolean(n)})}});f.exports=i}),null);
__d("OzReactMetrics",[],(function a(b,c,d,e,f,g){__p&&__p();var h={},i=function i(){return{mountCount:0,mountAvgMs:0,mountTotalMs:0,updateCount:0,updateAvgMs:0,updateTotalMs:0}},j=function j(l,m){if(!h[l])h[l]=i();h[l].mountCount+=1;h[l].mountTotalMs+=m;h[l].mountAvgMs=h[l].mountTotalMs/h[l].mountCount},k=function k(l,m){if(!h[l])h[l]=i();h[l].updateCount+=1;h[l].updateTotalMs+=m;h[l].updateAvgMs=h[l].updateTotalMs/h[l].updateCount};f.exports={metrics:h,updateMount:j,updateUpdate:k}}),null);
__d("OzWrapper.react",["React","OzReactMetrics"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;l.prototype.componentWillMount=function(){"use strict";this.$Comp1=Date.now()};l.prototype.componentDidMount=function(){"use strict";var m=Date.now()-this.$Comp1;c("OzReactMetrics").updateMount(i.displayName,m)};l.prototype.componentWillUpdate=function(){"use strict";this.$Comp2=Date.now()};l.prototype.componentDidUpdate=function(){"use strict";var m=Date.now()-this.$Comp2;c("OzReactMetrics").updateUpdate(i.displayName,m)};l.prototype.render=function(){"use strict";return c("React").createElement(i,babelHelpers["extends"]({},this.props,this.state))};function l(){"use strict";j.apply(this,arguments)}return l}f.exports=h}),null);
__d("OzHeader.react",["cx","OzHelpers","immutable","Layout.react","MessengerButtonReact.bs","OzButton.react","OzConfig","OzHumans","OzReps","OzStores","OzSwitch.react","React","OzWrapper.react","Reflux","ReactRouter","Tooltip"],(function a(b,c,d,e,f,g,h){var i=c("MessengerButtonReact.bs").jsComponent,j=c("immutable").Map,k=c("OzStores").RepStore,l=c("OzStores").HumanStore,m=c("ReactRouter").Link,n=c("React").PropTypes,o=c("React").createClass({displayName:"OzHeader",mixins:[c("Reflux").connect(l,"humans"),c("Reflux").connect(k,"reps"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{coachMode:n.bool.isRequired,rev:n.number.isRequired,version:n.string.isRequired,onAway:n.func.isRequired,onCoachModeToggle:n.func.isRequired,params:n.object.isRequired},contextTypes:{uid:n.string.isRequired,router:n.object.isRequired},render:function q(){var r="/inbox/"+(this.props.params.threadid||""),s=this.state.humans.getIn([this.context.uid,"load"],0),t="Inbox"+(s?" ("+s+")":""),u=this.state.config.get("GK",j());return c("React").createElement(c("Layout.react"),{className:"_2d86"},c("React").createElement("div",{className:"_2d87"},c("React").createElement(m,{to:"/",className:"_2d88"}),this._renderItem(t,r),this._renderItem("Merchants","/merchants"),this._renderItem("Feedback","/feedback"),this._renderItem("Top","/top"),u.get("supervisor")&&this._renderItem("Trainers","/trainers"),u.get("allThreads")&&this._renderItem("All Threads","/all")),c("React").createElement("div",{className:"_j6m"},c("React").createElement(p,{humans:this.state.humans,reps:this.state.reps,uid:this.context.uid})),c("React").createElement(i,{label:"Away",className:"_4s9f",type:"primary",onClick:this.props.onAway}),u.get("supervisor")?c("React").createElement(c("OzSwitch.react"),{className:"_b8c",isAnimated:true,isOn:this.props.coachMode,label:"Coach Mode",onToggle:this.props.onCoachModeToggle}):null)},_renderItem:function q(r,s){return c("React").createElement(m,{activeClassName:"active",className:"_33os",to:s},c("React").createElement("span",null,r))}}),p=c("OzHelpers").pure(function(q){var r=q.reps,s=q.humans,t=q.uid,u=r.get(t,j()),v=c("OzReps").closedIntentCount(u),w=c("OzReps").teamClosedIntentCount(u,r),x=Math.round(c("OzHumans").avgLoad(s)),y=isFinite(x)?x:"N/A",z=s.filter(c("OzHumans").isWorking).count();return c("React").createElement("div",null,c("React").createElement("span",babelHelpers["extends"]({className:"_3fs"},c("Tooltip").propsFor("Your closed intents")),v),c("React").createElement("span",{className:"_4s9g"},"closed by you")," ",c("React").createElement("span",babelHelpers["extends"]({className:"_3fs"},c("Tooltip").propsFor("Closed intents for your entire team")),w),c("React").createElement("span",{className:"_4s9g"},"closed by team"),c("React").createElement("span",{className:"_3fs"},y),c("React").createElement("span",{className:"_4s9g"},"average load"),c("React").createElement("span",{className:"_3fs"},z),c("React").createElement("span",{className:"_4s9g"},z===1?"trainer":"trainers"))});f.exports=c("OzWrapper.react")(o)}),null);
__d("OzLoading.react",["cx","MessengerFlexArea.react","MessengerSpinner.react","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k,l,m=c("React").PropTypes;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;n.prototype.render=function(){"use strict";return c("React").createElement("div",{className:"_30r7"},c("React").createElement(c("MessengerSpinner.react"),{color:this.props.color}),c("React").createElement("div",{className:"_4rg-",style:{marginLeft:"10px"}},this.props.message))};function n(){"use strict";i.apply(this,arguments)}n.propTypes={message:m.node,color:m.oneOf(["grey","blue"])};n.defaultProps={color:"blue"};n.Inline=(l=k=function(){__p&&__p();var o,p;o=babelHelpers.inherits(q,c("React").Component);p=o&&o.prototype;q.prototype.render=function(){"use strict";var r=this.props,s=r.loading,t=babelHelpers.objectWithoutProperties(r,["loading"]);if(!s)return null;return c("React").createElement("div",{className:"_nkb"},c("React").createElement(n,t))};function q(){"use strict";o.apply(this,arguments)}return q}(),k.propTypes={loading:m.bool.isRequired},l);n.Flex=function(){__p&&__p();var o,p;o=babelHelpers.inherits(q,c("React").Component);p=o&&o.prototype;q.prototype.render=function(){"use strict";return c("React").createElement(c("MessengerFlexArea.react"),null,c("React").createElement(n,this.props))};function q(){"use strict";o.apply(this,arguments)}return q}();f.exports=n}),null);
__d("OzDate.react",["cx","formatDate","immutable","joinClasses","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l=c("immutable").fromJS([{start:0,end:7*24*36e5,format:"D g:ia"},{start:7*24*36e5,end:365*24*36e5,format:"M jS, g:ia"},{start:365*24*36e5,end:Infinity,format:"m/d/Y g:ia"}]);i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.formatTimestamp=function(n){"use strict";if(n<Date.now()+24*36e5)return c("formatDate")(new Date(n),{today:"g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});else return c("formatDate")(new Date(n),l.find(function(o){return n>Date.now()+o.get("start")&&n<Date.now()+o.get("end")}).get("format"))};m.prototype.render=function(){"use strict";var n=this.constructor.formatTimestamp(this.props.timestamp);return c("React").createElement("time",{className:c("joinClasses")("_2s4p",this.props.className)},n)};function m(){"use strict";i.apply(this,arguments)}m.propTypes={timestamp:k.number.isRequired};f.exports=m}),null);
__d("OzDraggable.react",["cx","Draggable","joinClasses","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzDraggable",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{getHandle:i.func},componentDidMount:function k(){this._draggable=new(c("Draggable"))(this.refs.root).setUseAbsolute(true).setGutter(15);this._updateHandle()},componentDidUpdate:function k(){this._updateHandle()},_updateHandle:function k(){if(this._handle)this._draggable.removeHandle(this._handle);this._handle=(this.props.getHandle||function(){return this.refs.root}.bind(this))();this._draggable.addHandle(this._handle)},render:function k(){var l=this.props,m=l.children,n=l.className,o=babelHelpers.objectWithoutProperties(l,["children","className"]);return c("React").createElement("div",{className:"_5k4j"},c("React").createElement("div",babelHelpers["extends"]({className:c("joinClasses")("_2c1d",n),ref:"root"},o),m))},componentWillUnmount:function k(){this._draggable&&this._draggable.destroy()}});f.exports=j}),null);
__d("OzDraggableModal.react",["cx","joinClasses","OzDraggable.react","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;k.prototype.render=function(){"use strict";var l=this.props,m=l.children,n=l.className,o=babelHelpers.objectWithoutProperties(l,["children","className"]);return c("React").createElement(c("OzDraggable.react"),babelHelpers["extends"]({className:c("joinClasses")("_5d80",n)},o),m)};function k(){"use strict";i.apply(this,arguments)}f.exports=k}),null);
__d("OzUserImage.react",["cx","joinClasses","Image.react","immutable","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){var i=c("immutable").Map,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzUserImage",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{photo:j.object},render:function l(){var m=c("joinClasses")(this.props.className,"_3c52 _3c53"),n=function n(p){return c("React").createElement(c("Image.react"),{className:m,src:p})},o=this.props.photo||i();return o.getIn(["data","url"])&&n(o.getIn(["data","url"]))||o.get("data")&&n(o.get("mime_type")+","+o.get("data"))||c("React").createElement("span",{className:c("joinClasses")(m,"_3ejm")})}});f.exports=k}),null);
__d("OzSearch.react",["cx","OzAPI","OzHelpers","Image.react","immutable","Keys","OzActions","OzDate.react","OzDraggableModal.react","OzStores","OzUserImage.react","ReactComponentWithPureRenderMixin","React","Reflux","ShimButton.react","XUITextInput.react","OzConfig","debounce"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k,l,m,n=c("immutable").List,o=c("immutable").Map,p=c("React").PropTypes,q=c("OzStores").ActiveThreadStore,r=c("OzStores").ThreadStore,s="Messages",t="Side Bar",u="Users",v="Calendars",w="All",x=[s,t,u,v,w],y=(m={},m[s]="messages",m[t]="side-bar",m[u]="users",m[v]="calendar-event",m[w]="all",m),z=c("React").createClass({displayName:"OzSearch",mixins:[c("ReactComponentWithPureRenderMixin"),c("Reflux").connect(q,"activeThread"),c("Reflux").connect(r,"threads"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],contextTypes:{router:p.object.isRequired},componentWillMount:function L(){this._handleTyping=c("debounce")(this._handleTyping,300,this,true);this.setState({calendarGK:this.state.config.get("GK",o()).get("calendar")})},componentDidMount:function L(){document.addEventListener("keydown",this._handleKBShortcuts);this._unlisten=function(){document.removeEventListener("keydown",this._handleKBShortcuts)}.bind(this);this._focusSearch()},getInitialState:function L(){return{currentTab:s,results:n([]),selected:-1,shown:false,text:"",calendarGK:false}},componentWillUnmount:function L(){this._unlisten()},render:function L(){var M=this.state,N=M.shown,O=M.currentTab,P=M.results,Q=M.selected,R=M.threads;if(!N)return null;else return c("React").createElement(c("OzDraggableModal.react"),{className:"_cxg"},c("React").createElement(c("XUITextInput.react"),{className:"_cxh",placeholder:"Search...",ref:"searchBar",onChange:function(S){return this._handleTyping(S.target.value)}.bind(this)}),c("React").createElement("div",{className:"_cxi"},c("React").createElement(C,{tabs:x,currentTab:O,onClickTab:this._handleChangeTab,calendarGK:this.state.calendarGK}),c("React").createElement(D,{onClick:this._handleSelectResult,results:P,selected:Q,threads:R,calendarGK:this.state.calendarGK})))},_search:function L(){var M=this.state,N=M.text,O=M.currentTab,P=M.activeThread,Q={text:N,type:y[O]};if(O===t||O===s)Q["user-id"]=P.get("threadID");c("OzAPI").search(Q).then(function(R){this.setState({results:R,selected:0})}.bind(this)).done()},_handleTyping:function L(M){this.setState({text:M},this._search)},_handleChangeTab:function L(M){var N=this.state.text;this.setState({currentTab:M},function(O){N.length&&this._search()}.bind(this))},_handleSelectResult:function L(M){__p&&__p();switch(M.get("_type")){case"user":this._handleSelectResultUser(M);break;case"event":switch(M.getIn(["_source","type"])){case"message":case"message-from-page":this._handleSelectResultMessage(M);break;case"send-email":case"receive-email":this._handleSelectResultEmail(M);break;case"calendar-event":this._handleSelectResultCalendarEvent(M);break;default:}break;default:}this.setState({shown:false})},_handleSelectResultUser:function L(M){var N=M.getIn(["_source","user-id"]);this.context.router.push("/inbox/"+N)},_handleSelectResultMessage:function L(M){var N=M.getIn(["_source","user-id"]),O=M.getIn(["_source","timestamp"]);this.context.router.push("/inbox/"+N);this._createTransitionListener(N,O)},_createTransitionListener:function L(M,N){this._transitionListenerId=window.setInterval(function(O){var P=this.context.router.isActive("/inbox/"+M);if(P){c("OzActions").scrollThreadToTimestamp(N);window.clearInterval(this._transitionListenerId)}}.bind(this),100)},_handleSelectResultEmail:function L(M){var N=M.getIn(["_source","user-id"]),O=M.getIn(["_source","intent-id"]);this.context.router.push("/inbox/"+N+"/intent/"+O)},_handleSelectResultCalendarEvent:function L(M){var N=M.getIn(["_source","user-id"]);this.context.router.push("/inbox/"+N)},_toggleShown:function L(){this.setState({shown:!this.state.shown})},_focusSearch:function L(){this.refs.searchBar&&this.refs.searchBar.focusInput()},_handleKBShortcuts:function L(M){__p&&__p();var N=this.state,O=N.results,P=N.selected,Q=N.shown,R=N.calendarGK;if(K(M)||M.which===c("Keys").ESC&&Q){M.preventDefault();this._toggleShown();!Q&&this._focusSearch()}else if(Q)switch(M.which){case c("Keys").DOWN:M.preventDefault();this.setState({selected:Math.min(P+1,B(O,R).count()-1)});break;case c("Keys").UP:M.preventDefault();this.setState({selected:Math.max(P-1,0)});break;case c("Keys").RETURN:M.preventDefault();P&&this._handleSelectResult(B(O,R).get(P));break;case c("Keys").TAB:M.preventDefault();var S=x.indexOf(this.state.currentTab),T=x.length;if(M.getModifierState("Shift")){S=(S-1+T)%T;if(!R&&S===3)S--}else{S++;if(!R&&S===3)S++;S%=T}this._handleChangeTab(x[S]);break}}}),A=function A(L){return function(M){var N=M.get("_type");switch(N){case"user":return true;case"event":var O=M.getIn(["_source","type"]);if(O=="calendar-event"&&!L)return false;return O=="message"||O=="message-from-page"||O=="send-email"||O=="receive-email"||O=="calendar-event";default:return false}}},B=function B(L,M){return L.filter(A(M)).sortBy(function(N){return N.getIn(["_source","timestamp"])}).reverse()};i=babelHelpers.inherits(C,c("React").PureComponent);j=i&&i.prototype;C.prototype.render=function(){"use strict";var L=this.props,M=L.tabs,N=L.currentTab,O=L.onClickTab;return c("React").createElement("div",{className:"_cxj"},n(M).map(function(P){if(!this.props.calendarGK&&P===v)return null;else return c("React").createElement(c("ShimButton.react"),{className:(P===N?"_cxk":"")+" _cxl",key:P,onClick:function Q(R){return O(P)}},P)}.bind(this)).toSeq())};function C(){"use strict";i.apply(this,arguments)}C.propTypes={tabs:p.arrayOf(p.string).isRequired,currentTab:p.string.isRequired,onClickTab:p.func.isRequired,calendarGK:p.bool.isRequired};k=babelHelpers.inherits(D,c("React").PureComponent);l=k&&k.prototype;D.prototype.render=function(){"use strict";__p&&__p();var L=this.props,M=L.onClick,N=L.results,O=L.selected,P=L.threads;return c("React").createElement("div",{className:"_cxm"},B(N,this.props.calendarGK).map(function(Q,R){__p&&__p();switch(Q.get("_type")){case"user":return c("React").createElement(F,{result:Q,selected:O==R,threads:P,onClick:M});case"event":switch(Q.getIn(["_source","type"])){case"message-from-page":if(Q.getIn(["_source","data","attachments"]))return c("React").createElement(H,{result:Q,selected:O==R,threads:P,onClick:M});case"message":return c("React").createElement(G,{result:Q,selected:O==R,threads:P,onClick:M});case"send-email":case"receive-email":return c("React").createElement(I,{result:Q,selected:O==R,threads:P,onClick:M});case"calendar-event":return c("React").createElement(J,{result:Q,selected:O==R,threads:P,onClick:M});default:return null}default:return null}}))};function D(){"use strict";k.apply(this,arguments)}D.propTypes={onClick:p.func,results:p.instanceOf(n),selected:p.number,threads:p.instanceOf(o).isRequired,calendarGK:p.bool.isRequired};var E=c("OzHelpers").pure(function(L){var M=L.image,N=L.text,O=L.selected,P=L.onClick,Q=L.timestamp;return c("React").createElement(c("ShimButton.react"),{className:"_cxn",id:O?"selected":null,onClick:P},M,c("React").createElement("div",{className:"_4fwg"},c("React").createElement("div",{className:"_4fwh"},c("React").createElement("div",{className:"_4fwi"},N)),Q?c("React").createElement(c("OzDate.react"),{className:"_4fwj",timestamp:Q}):c("React").createElement("div",{className:"_4fwk"})))}),F=c("OzHelpers").pure(function(L){var M=L.result,N=L.onClick,O=L.selected,P=L.threads,Q=M.getIn(["_source","user-id"]),R=M.getIn(["_source","user-name"]),S=P.get(Q);if(!S)c("OzAPI").thread(Q);return c("React").createElement(E,{onClick:function T(U){return N(M)},selected:O,image:S?c("React").createElement(c("OzUserImage.react"),{photo:c("OzHelpers").photo(S),className:"_cxp"}):null,text:R})}),G=c("OzHelpers").pure(function(L){var M=L.result,N=L.onClick,O=L.selected,P=L.threads,Q=M.getIn(["_source","user-id"]),R=M.getIn(["_source","data","text"]),S=M.getIn(["_source","type"])==="message",T=P.get(Q);if(S&&!T)c("OzAPI").thread(Q);var U=S?T?c("React").createElement(c("OzUserImage.react"),{photo:c("OzHelpers").photo(T),className:"_cxp"}):null:c("React").createElement(c("Image.react"),{src:"/images/oz/icons/OzMessengerLogo.png",className:"_cxp"});return c("React").createElement(E,{onClick:function V(W){return N(M)},selected:O,image:U,text:R,timestamp:M.getIn(["_source","timestamp"])})}),H=c("OzHelpers").pure(function(L){var M=L.result,N=L.onClick,O=L.selected,P=L.threads,Q=M.getIn(["_source","data","attachments",0,"metadata"]),R=Q.get("name"),S=Q.get("desc"),T=Q.get("thumb_url");return c("React").createElement(E,{onClick:function U(V){return N(M)},selected:O,image:c("React").createElement(c("Image.react"),{src:T,className:"_cxp"}),text:R+" - "+S,timestamp:M.getIn(["_source","timestamp"])})}),I=c("OzHelpers").pure(function(L){var M=L.result,N=L.onClick,O=L.selected,P=L.threads,Q=M.getIn(["_source","data"]),R=Q.get("to"),S=Q.get("subject"),T=(R?"To: "+R.toJS().join(", ")+" - ":"")+S,U=c("React").createElement(c("Image.react"),{src:"/images/nux_icon_gmail.gif",className:"_cxr _cxp"});return c("React").createElement(E,{onClick:function V(W){return N(M)},selected:O,image:U,text:T,timestamp:M.getIn(["_source","timestamp"])})}),J=c("OzHelpers").pure(function(L){var M=L.result,N=L.onClick,O=L.selected,P=L.threads,Q=M.getIn(["_source","user-id"]),R=P.get(Q),S=M.getIn(["_source","data"]),T=new Date(S.get("start")),U=T.toLocaleString("en-US",{timeZoneName:"short"}),V=R?c("React").createElement(c("OzUserImage.react"),{photo:c("OzHelpers").photo(R),className:"_cxp"}):null;return c("React").createElement(E,{onClick:function W(X){return N(M)},selected:O,image:V,text:c("React").createElement("div",null,c("React").createElement("div",{className:"_5u4o"},S.get("title")),c("React").createElement("div",{className:"_5u4p"},U))})});function K(L){return L.getModifierState("Control")&&L.which==83}f.exports=z}),null);
__d("OzSkywalkerBanner.react",["cx","OzHelpers","OzStores","OzImmutablePureRenderMixin","React","Reflux","ReloadPage","ShimButton.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("OzStores").SkywalkerStore,j=c("React").createClass({displayName:"OzSkywalkerBanner",mixins:[c("Reflux").connect(i,"skywalker"),c("OzImmutablePureRenderMixin")],componentDidUpdate:function k(l,m){var n=this.state.skywalker;if(n.get("isStalled")&&n.get("last-receive-ts")){window.clearTimeout(this._timer);this._timer=window.setTimeout(this.forceUpdate.bind(this),1e3)}},componentWillUnmount:function k(){window.clearTimeout(this._timer)},render:function k(){var l=this.state.skywalker,m=l.get("last-receive-ts"),n=m?"in "+Math.round((c("OzHelpers").serverNow()-m)/1e3)+" seconds":"since you opened Oz";return c("React").createElement("div",{className:"_hsr"+(l.get("isStalled")?" _hss":"")},c("React").createElement("span",null,"We haven't received a message from Skywalker ",n,"."," ",c("React").createElement(c("ShimButton.react"),{form:"link",onClick:c("ReloadPage").now},"Refresh!")," "," or terrible things will happen."))}});f.exports=j}),null);
__d("OzSuggestions",["OzHelpers","immutable","OzConstants"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("OzConstants").ATTS,i=c("immutable").List,j=c("immutable").Map;f.exports={toServer:function m(n,o){return n.set("type",h.SUGG).update("data",function(p){return j({name:p.get("title"),description:p.get("description")||"","merchant-name":this.findMerchantName(p.get("merchant"),o),"thumb-url":p.get("images",i()).find(c("OzHelpers").validateURL)||null,"thumb-urls":p.get("images",i()).filter(c("OzHelpers").validateURL),"target-url":p.get("url"),"expiration-time":p.get("expiration-time"),currency:"USD",amount:p.has("price")?k(p.get("price")):null})}.bind(this))},findMerchantName:function m(n,o){var p=o&&n&&o.find(function(q){return(q.get("name-dba")||"").toLowerCase()===n.toLowerCase()});if(p){c("OzHelpers").info("[sugg] found merchant",n,p);return p.get("name-dba")}return null}};function k(m){return Math.round(100*parseFloat(l(m,"$"),10))}function l(m,n){if(!m||!m.startsWith(n))return m;return m.substr(n.length)}}),null);
__d("OzTwilio",["cx","OzHelpers","immutable","Keys","MessengerButtonReact.bs","OzNotify","OzActions","OzConfig","OzDraggableModal.react","OzImmutablePureRenderMixin","React","Reflux","StarsInput.react"],(function a(b,c,d,e,f,aa,ba){__p&&__p();var g,h,i,j,k,l,m,n,o=c("MessengerButtonReact.bs").jsComponent,p=c("immutable").Record,q=c("immutable").Set,r=c("immutable").List,s=c("React").PropTypes,t=c("OzActions").twilio;function u(){__p&&__p();var S=window.Twilio.Device,T=function T(U,V){return function(){c("OzHelpers").info("[twilio] "+U,x.data.toJS());V.apply(undefined,arguments)}};t.setup.listen(function(U){S.setup(U,{rtc:c("OzConfig").getInStaticConfig(["GK","webRTC"]),debug:true})});t.hangUp.listen(function(U){S.disconnectAll();t.endCall()});t.startCall.listen(T("start-call",S.connect));S.ready(t.ready);S.error(function(U){var V=U.message;c("OzNotify").error("VOIP is having issues. "+(V?V:"")+". Please contact the wit oncall");c("OzHelpers").error("[twilio] had an error",U);t.endCall()});S.connect(T("connect",t.connect));S.disconnect(T("disconnect",t.endCall));S.cancel(T("cancel",t.endCall));S.incoming(T("incoming",t.incoming))}u();g=babelHelpers.inherits(v,p({"intent-id":null,tid:null,extension:null}));h=g&&g.prototype;function v(){"use strict";g.apply(this,arguments)}i=babelHelpers.inherits(w,p({from:null,meta:new v(),muted:false,status:"pending",to:null,wasIncoming:null,rating:null,sentDigits:null,sentDigitsBuffer:r(),sentDigitsIntervalId:null}));j=i&&i.prototype;function w(){"use strict";i.apply(this,arguments)}var x=c("Reflux").createStore({init:function S(){this.data=new w();this.listenToMany(t)},getInitialState:function S(){return this.data},onChangeTo:function S(T){this._u(function(U){return U.set("to",T)})},onDialAgain:function S(){this._conn=null;this._u(function(T){return new w({status:"dial",meta:T.get("meta"),from:T.get("from"),to:H(T.get("to"))})})},onConnect:function S(T){this._conn=T},onEndCall:function S(){this._conn=null;this._u(function(T){return T.merge({status:"ended"})})},onIncoming:function S(T){this._conn=T;this._u(function(U){return U.mergeDeep({status:"incoming",to:T.parameters.From,wasIncoming:true})})},onIncomingAccept:function S(){if(this._conn){this._conn.accept();this._u(function(T){return T.merge({status:"in-call"})})}},onIncomingReject:function S(){if(this._conn){this._conn.reject();this._conn=null}this.onEndCall()},onMute:function S(){if(this._conn){this._conn.mute(true);this._u(function(T){return T.set("muted",true)})}},onReady:function S(){this._u(function(T){return new w({status:"ready"})})},_sendDigitsFromBuffer:function S(){__p&&__p();var T=this.data.get("sentDigitsBuffer");if(!T.isEmpty()){this._conn.sendDigits(T.first());this._u(function(V){return V.update("sentDigitsBuffer",function(W){return W.shift()})})}else{var U=this.data.get("sentDigitsIntervalId");clearInterval(U);this._u(function(V){return V.set("sentDigitsIntervalId",null)})}},onSendDigits:function S(T){__p&&__p();if(this._conn){this._u(function(U){return U.update("sentDigits",function(V){return(V||"")+T})});this._u(function(U){return U.update("sentDigitsBuffer",function(V){return V.concat(r(T.split("")))})});if(!Number.isInteger(this.data.get("sentDigitsIntervalId")))this._u(function(U){return U.set("sentDigitsIntervalId",setInterval(this._sendDigitsFromBuffer,1e3))}.bind(this))}},onStartCall:function S(){this._u(function(T){return T.set("status","in-call")})},onUnmute:function S(){if(this._conn){this._conn.mute(false);this._u(function(T){return T.set("muted",false)})}},onUseIntent:function S(T){if(this.data.get("status")!=="ready"){c("OzNotify").error("End your call before starting another one");return}this._u(function(U){return new w({status:"dial",from:T.get("phone-number"),to:U.get("to"),meta:new v({tid:T.get("user-id"),"intent-id":T.get("id"),extension:T.get("phone-extension")})})})},onUpdateIncomingInfo:function S(T){this._u(function(U){return U.merge({meta:new v({tid:T.get("user-id"),"intent-id":T.get("intent-id"),extension:T.get("phone-extension")}),from:T.get("to"),to:T.get("from")})})},onUpdateRating:function S(T){this._u(function(U){return U.set("rating",T)})},_u:function S(T){this.data=T(this.data);this.trigger(this.data)}}),y=c("React").createClass({displayName:"OzTwilio",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(x,"store"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],contextTypes:{router:s.object.isRequired},componentDidMount:function S(){var T=window.setInterval(function(U){this.state.store.get("status")==="in-call"&&c("OzActions").isActive()}.bind(this),5e3);this._cleanup=function(U){return window.clearInterval(T)}},componentDidUpdate:function S(T,U){var V=U.store.get("status"),W=this.state.store.get("status");if(V==="in-call"&&W==="ended")this.setState({paused:true})},componentWillUnmount:function S(){this._cleanup()},render:function S(){var T=this.state,U=T.store,V=T.startedAt,W=T.paused;return c("React").createElement("span",{className:"_221-"},z(U)&&c("React").createElement(A,{startedAt:V,paused:W,onCallStart:this._handleStartCall,onDialAgain:t.dialAgain,onHangUp:this._handleHangUp,onIncomingAccept:this._handleIncomingAccept,onIncomingReject:t.incomingReject,onMute:t.mute,onRatingChange:this._handleRatingChange,onReady:t.ready,onSendDigits:t.sendDigits,onThreadClick:this._handleThreadClick,onToChange:t.changeTo,onUnmute:t.unmute,store:U}))},_handleThreadClick:function S(T){this.context.router.push("/inbox/"+T)},_handleStartCall:function S(){var T=this.state.store;this._startDurationTimer();t.startCall(babelHelpers["extends"]({},T.get("meta").toJS(),{from:T.get("from"),to:H(T.get("to")),page:this.state.config.get("PAGE_ID"),type:"outgoing"}))},_handleIncomingAccept:function S(){this._startDurationTimer();t.incomingAccept()},_startDurationTimer:function S(){this.setState({startedAt:Date.now()});this.setState({paused:false})},_handleHangUp:function S(){t.hangUp();this.setState({paused:true})},_handleRatingChange:function S(T){c("OzHelpers").info("[twilio] rating="+T,this.state.store.toJS());t.updateRating(T)}});function z(S){return q(["dial","in-call","incoming","ended"]).has(S.get("status"))}k=babelHelpers.inherits(A,c("React").Component);l=k&&k.prototype;A.prototype.render=function(){"use strict";return c("React").createElement(c("OzDraggableModal.react"),{className:"_2221",getHandle:function(S){return this.refs.header.refs.header}.bind(this)},c("React").createElement(C,{store:this.props.store,ref:"header"}),c("React").createElement(D,this.props))};function A(){"use strict";k.apply(this,arguments)}m=babelHelpers.inherits(B,c("React").Component);n=m&&m.prototype;function B(){var S,T;"use strict";for(var U=arguments.length,V=Array(U),W=0;W<U;W++)V[W]=arguments[W];return T=(S=n.constructor).call.apply(S,[this].concat(V)),this.state={elapsed:Date.now()-this.props.startedAt},this.$DurationTimer2=function(){this.setState({elapsed:Date.now()-this.props.startedAt})}.bind(this),T}B.prototype.componentDidMount=function(){"use strict";if(!this.props.paused)this.$DurationTimer1=setInterval(this.$DurationTimer2,1e3)};B.prototype.componentWillUnmount=function(){"use strict";clearInterval(this.$DurationTimer1)};B.prototype.componentWillReceiveProps=function(S){"use strict";if(S.paused==this.props.paused)return;S.paused?clearInterval(this.$DurationTimer1):this.$DurationTimer1=setInterval(this.$DurationTimer2,1e3)};B.prototype.render=function(){"use strict";return c("React").createElement("div",{className:"_1su8"},G(this.state.elapsed))};var C=c("OzHelpers").pure(function(S){var T=S.store,U=T.get("status"),V=T.get("wasIncoming")?"Incoming":"Outgoing";return c("React").createElement("h2",{className:"_1su5",ref:"header"},U==="ended"&&V+" Call End"||V+" Phone Call")}),D=c("OzHelpers").pure(function(S){switch(S.store.get("status")){case"dial":return c("React").createElement(E,S);case"in-call":return c("React").createElement(J,S);case"incoming":return c("React").createElement(O,S);case"ended":return c("React").createElement(P,S);default:c("OzHelpers").debug("[twilio] unknown status",S);return null}}),E=c("OzHelpers").pure(function(S){var T=S.store,U=S.onToChange,V=S.onCallStart,W=S.onReady;return c("React").createElement("div",{className:"_3hon"},c("React").createElement(R,{placeholder:"Type a phone number...",value:T.get("to"),onChange:function X(Y){return U(Y.target.value)},onKeyDown:function X(Y){return Y.which===c("Keys").RETURN?F(T)&&V():null}}),c("React").createElement("div",{className:"_1su6"},I(T)),c("React").createElement("div",{className:"_1su7"},c("React").createElement(o,{onClick:W,type:"secondary",label:"Cancel"}),c("React").createElement(o,{disabled:!F(T),onClick:V,type:"primary",label:"Call"})))});function F(S){return S.get("from")&&S.get("to")&&S.get("to").length>=10}var G=function G(S){var T=6e4,U=Math.floor(S/T);S%=T;var V=Math.floor(S/1e3);if(U<10)U="0"+U;if(V<10)V="0"+V;return U+":"+V},H=function H(S){return S.trim().replace(" ","-").replace(/(.)\+/g,"$1-")},I=function I(S){var T=S.getIn(["meta","extension"]);return"My Number: "+c("OzHelpers").parsePhoneNumber(S.get("from"))+" ext. "+T},J=c("OzHelpers").pure(function(S){var T=S.startedAt,U=S.paused,V=S.onHangUp,W=S.onMute,X=S.onSendDigits,Y=S.onThreadClick,Z=S.onUnmute,$=S.store;return c("React").createElement("div",{className:"_2225"},c("React").createElement(B,{startedAt:T,paused:U}),c("React").createElement("div",{className:"_1su9"},c("OzHelpers").parsePhoneNumber($.get("to"))),c("React").createElement(K,{sentDigits:$.get("sentDigits"),onSendDigits:X}),c("React").createElement("div",{className:"_1su6"},$.get("from")?I($):"Searching for our number..."),c("React").createElement("div",{className:"_1su7"},c("React").createElement(N,{tid:$.getIn(["meta","tid"]),onThreadClick:Y}),$.get("muted")?c("React").createElement(o,{onClick:Z,type:"secondary",use:"danger",label:"Unmute"}):c("React").createElement(o,{onClick:W,type:"secondary",use:"default",label:"Mute"}),c("React").createElement(o,{onClick:V,type:"primary",label:"End Call"})))}),K=c("OzHelpers").pure(function(S){var T=S.onSendDigits,U=S.sentDigits;return c("React").createElement("div",null,c("React").createElement(R,{placeholder:"Type numbers using keyboard",value:"",onChange:function V(W){var X=M(W.target.value);X&&T(X)}}),c("React").createElement("div",{className:"_538o"},U))}),L=q(["1","2","3","4","5","6","7","8","9","0","#","*"]);function M(S){return S.split("").filter(function(T){return L.has(T)}).join("")}var N=c("OzHelpers").pure(function(S){var T=S.onThreadClick,U=S.tid;return U?c("React").createElement(o,{onClick:function V(){return T(U)},type:"secondary",label:"Go to Thread"}):null}),O=c("OzHelpers").pure(function(S){var T=S.store,U=S.onIncomingAccept,V=S.onIncomingReject;return c("React").createElement("div",{className:"_2226"},c("React").createElement("div",{className:"_1su9"},c("OzHelpers").parsePhoneNumber(T.get("to"))),c("React").createElement("div",{className:"_1su6"},I(T)),c("React").createElement("div",{className:"_1su7"},c("React").createElement(o,{onClick:V,type:"secondary",label:"Ignore"}),c("React").createElement(o,{onClick:U,type:"primary",label:"Answer"})))}),P=c("OzHelpers").pure(function(S){var T=S.startedAt,U=S.paused,V=S.store,W=S.onHideDialog,X=S.onRatingChange,Y=S.onDialAgain,Z=S.onReady;return c("React").createElement("div",{className:"_5gaw"},c("React").createElement(B,{startedAt:T,paused:U}),c("React").createElement("div",{className:"_1su9"},c("OzHelpers").parsePhoneNumber(V.get("to"))),c("React").createElement("div",{className:"_1su6"},I(V)),c("React").createElement(Q,{rating:V.get("rating"),onRatingChange:X}),c("React").createElement("div",{className:"_1su7"},c("React").createElement(o,{onClick:Y,type:"secondary",label:"New Call"}),c("React").createElement(o,{onClick:Z,type:"primary",label:"Close"})))}),Q=c("OzHelpers").pure(function(S){var T=S.rating,U=S.onRatingChange;return c("React").createElement("div",{className:"_5rvp"},T?c("React").createElement("h3",{className:"_5rvu"},"Thank you for rating!"):c("React").createElement("span",null,c("React").createElement("h3",{className:"_5rvu"},"How would you rate your experience?"),c("React").createElement(c("StarsInput.react"),{large:true,count:0,onClick:U})))}),R=c("OzHelpers").pure(function(S){return c("React").createElement("input",babelHelpers["extends"]({},S,{className:"_1-i0 _2224"}))});f.exports=y}),null);
__d("Oz.react",["cx","OzAPI","OzHelpers","immutable","Layout.react","OzActions","OzBugNub.react","OzConfig","OzDialogContainer.react","OzExtensionCheck.react","OzHeader.react","OzLoading.react","OzFailed.react","OzNotify","OzSearch.react","OzSkywalkerBanner.react","OzStores","OzSuggestions","OzTwilio","OzImmutablePureRenderMixin","React","OzWrapper.react","Reflux","Run","ShimButton.react","XUIDialog.react","XUINotice.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("OzNotify").Component,j=c("OzStores").ActiveThreadStore,k=c("OzStores").MerchantStore,l=c("OzStores").LoadingStore,m=c("OzStores").RepStore,n=c("OzStores").RequirementStore,o=c("OzStores").ThreadStore,p=c("OzStores").WitIntentStore,q=c("React").PropTypes,r=c("immutable").Map,s=2e4,t=6e4,u=5e3,v=100,w=1e3*60*60,x=c("React").createClass({displayName:"OzWrapper",mixins:[c("Reflux").connect(l,"loading")],propTypes:{rev:q.number.isRequired,uid:q.string.isRequired,version:q.string.isRequired,skipToto:q.bool,onUnmount:q.func.isRequired},render:function F(){var G=this.state.loading.valueSeq().some(function(H){return H.get("state")!=="loaded"&&!H.get("skip")});if(G)return c("React").createElement(y,null);return c("React").createElement(z,this.props)}}),y=c("React").createClass({displayName:"AppLoading",mixins:[c("Reflux").connect(c("OzConfig").ConfigStore,"config"),c("Reflux").connect(l,"loading")],render:function F(){return c("React").createElement("div",null,c("React").createElement(i,null),this._renderBody(),c("React").createElement(c("OzBugNub.react"),null))},_renderBody:function F(){var G=this.state.loading,H=G.entrySeq().filter(function(J){var K=J[0],L=J[1];return L.get("state")==="failed"&&!L.get("skip")}).map(function(J){var K=J[0],L=J[1];return K});if(!H.isEmpty())return c("React").createElement(c("OzFailed.react"),{problems:H});var I="Hello "+this.state.config.get("publicName")+"! Oz is connecting...";return c("React").createElement(c("OzLoading.react"),{message:I})}}),z=c("React").createClass({displayName:"Oz",mixins:[c("Reflux").connect(k,"merchants"),c("Reflux").connect(m,"reps"),c("Reflux").connect(p,"witIntents"),c("Reflux").connect(n,"requirements"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{rev:q.number.isRequired,uid:q.string.isRequired,version:q.string.isRequired,skipToto:q.bool,onUnmount:q.func.isRequired},childContextTypes:{uid:q.string.isRequired,merchants:q.instanceOf(r).isRequired,reps:q.instanceOf(r).isRequired,witIntents:q.instanceOf(r).isRequired},getChildContext:function F(){return{uid:this.props.uid,merchants:this.state.merchants,reps:this.state.reps,witIntents:this.state.witIntents}},getInitialState:function F(){return{almostInactive:false,away:false,coachMode:false,fellAsleep:false,inactive:false}},componentDidMount:function F(){__p&&__p();window.addEventListener("message",this._handleMessage);window.postMessage({type:"consolemounted"},"*");this.lastPulseAt=Date.now();var G=c("OzActions").sendPulse.listen(this._handlePulse),H=setInterval(c("OzActions").sendPulse,u);this.lastActiveAt=Date.now();this._isActive=function(L){return c("OzActions").isActive()};window.addEventListener("mousemove",this._isActive);window.addEventListener("keydown",this._isActive);var I=c("OzActions").isActive.listen(function(){this.lastActiveAt=Date.now();if(this.state.almostInactive||this.state.inactive)this.setState({almostInactive:false,inactive:false})}.bind(this));this.lastAwakeAt=Date.now();var J=setInterval(function(L){var M=Date.now();if(M-this.lastAwakeAt>w)this.setState({fellAsleep:true});this.lastAwakeAt=M}.bind(this),v);c("OzActions").updateThreads.preEmit=C.bind(null,this.props.uid);var K=c("OzActions").isInactive.listen(function(L){if(Date.now()-this.lastActiveAt>u)this.setState({almostInactive:false,inactive:true})}.bind(this));this._cleanup=function(){window.removeEventListener("message",this._handleMessage);G();clearInterval(H);clearInterval(J);window.removeEventListener("mousemove",this._isActive);I();K()}.bind(this)},componentWillUnmount:function F(){this._cleanup()},render:function F(){return c("React").createElement(c("Layout.react"),{className:"_3_ps _li",onKeyPress:this._handleKeyPress},c("React").createElement(i,null),!this.props.skipToto&&c("React").createElement(c("OzExtensionCheck.react"),null),this.state.away?c("React").createElement(A,{onClick:this._handleAway,text:"You're currently away.",className:"_1tir"}):this.state.almostInactive?c("React").createElement(B,{lastActiveAt:this.lastActiveAt,onZero:this._handleZero}):this.state.fellAsleep&&!this.state.config.get("devMode")?c("React").createElement(A,{text:"Looks like your computer has gone to sleep. Please refresh the page."}):this.state.inactive?c("React").createElement(A,{text:"You're currently inactive.",className:"_4da6"}):null,c("React").createElement(c("OzSkywalkerBanner.react"),null),c("React").createElement(c("OzHeader.react"),{away:this.state.away,coachMode:!!this.state.coachMode,onAway:this._handleAway,onCoachModeToggle:this._handleCoachModeToggle,rev:this.props.rev,version:this.props.version,reps:this.state.reps,params:this.props.params}),c("React").cloneElement(this.props.children,{witIntents:this.state.witIntents,requirements:this.state.requirements,merchants:this.state.merchants,reps:this.state.reps}),c("React").createElement(c("OzBugNub.react"),null),c("React").createElement(c("OzDialogContainer.react"),null),c("React").createElement(c("OzSearch.react"),null),c("React").createElement(c("OzTwilio"),null))},_handleKeyPress:function F(){c("OzActions").isActive()},_handlePulse:function F(){var G=Date.now(),H=Math.round((G-this.lastPulseAt)/1e3),I=this._buildPulse();c("OzAPI").sendPulse(H,I);E(j.data,o.data);this.lastPulseAt=G;if(!this.state.almostInactive&&!this.state.inactive&&I.get("inactive-ms")>=t-s)this.setState({almostInactive:true})},_handleMessage:function F(G){__p&&__p();if(G.source!==window)return;if(!G.data)return;switch(G.data.type){case"active":c("OzActions").isActive();break;case"recordactivity":var H=j.data,I=G.data.data,J=H.get("threadID");c("OzHelpers").debug("[oz-ext] received activity",I);if(!J){c("OzHelpers").debug("[oz-ext] skipping event, no threadID");return}c("OzAPI").recordActivity(J,I);break;case"bubble":c("OzHelpers").debug("[toto] got bubble",G.data);c("OzActions").addBubble(c("OzSuggestions").toServer(c("immutable").fromJS(G.data),this.state.merchants));break;case"autopilot-data":c("OzHelpers").debug("[toto] got autopilot",G.data);if(G.data)c("OzActions").addAutopilot(c("immutable").fromJS(G.data));break}},_handleAway:function F(G){c("OzAPI").away(!this.state.away).done(function(H){this.setState({away:!!H})}.bind(this))},_handleCoachModeToggle:function F(G){c("OzAPI").coachMode(G).done(function(){this.setState({coachMode:G})}.bind(this))},_handleZero:function F(){this.setState({almostInactive:false,inactive:true})},_buildPulse:function F(G){return D(this.props.uid,j.data,o.data,this.lastActiveAt,this.state.away||G||false,this.state.coachMode)}});function A(F){var G=F.onClick,H=F.text,I=F.className;return c("React").createElement(c("XUIDialog.react"),{width:544,shown:true,layerHideOnBlur:false},c("React").createElement("div",{className:"_1tip"},c("React").createElement("div",{className:I}),c("React").createElement("div",{className:"_1tis"},H),G?c("React").createElement(c("ShimButton.react"),{className:"_1tit _57lt _30yy",form:"link",onClick:G},"I'm back :)"):null))}var B=c("React").createClass({displayName:"OzCountdownDialog",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{lastActiveAt:q.number.isRequired,onZero:q.func.isRequired},getInitialState:function F(){return{countdown:Math.floor((t-(Date.now()-this.props.lastActiveAt))/1e3)}},componentDidMount:function F(){this._interval=setInterval(function(){this.setState({countdown:Math.max(this.state.countdown-1,0)})}.bind(this),1e3)},componentDidUpdate:function F(){if(this.state.countdown===0){clearInterval(this._interval);this.props.onZero()}},componentWillUnmount:function F(){clearInterval(this._interval)},render:function F(){return c("React").createElement(c("XUIDialog.react"),{width:544,shown:true,layerHideOnBlur:false},c("React").createElement("div",{className:"_1tip"},c("React").createElement("div",{className:"_4da6"}),c("React").createElement(c("XUINotice.react"),{use:"warn"},"You'll be inactive (and your threads will be reassigned) in approximately ",this.state.countdown," seconds...")))}});function C(F,G){__p&&__p();var H=o.data;if(H.isEmpty())return;G.filter(function(I){return(c("OzHelpers").isOwner(I,F)||c("OzHelpers").isSubscriber(I,F))&&(I.get("ready")||c("OzHelpers").isUnread(I)||c("OzHelpers").hasPaid(I)||c("OzHelpers").hasReminder(I))}).forEach(function(I){var J=c("OzHelpers").isUnread(I)&&c("OzHelpers").shortDesc(c("OzHelpers").lastUserMessage(I))||c("OzHelpers").hasPaid(I)&&"Payment received."||c("OzHelpers").hasReminder(I)&&"Reminder triggered.";if(!J)return;var K=c("OzHelpers").threadID(I),L=H.getIn([K,"last-event-at"]);if(I.get("last-event-at")===L)return;var M=c("OzHelpers").photo(I),N=M?M.getIn(["data","url"])||M.get("mime_type")+","+M.get("data"):null;c("OzAPI").notifyExtension({action:"show",title:c("OzHelpers").getName(I),desc:J,picture:N,id:c("OzHelpers").threadID(I)})})}function D(F,G,H,I,J,K){__p&&__p();var L=G.get("threadID"),M=L&&H.get(L),N=r();if(L)N=N.merge({tid:L});if(M)N=N.merge({"intent-id":G.get("activeIntent"),"owner-id":M.getIn(["owner","id"]),"user-name":M.getIn(["user-vcard","name"])});if(Number.isFinite(I))N=N.set("inactive-ms",Date.now()-I);N=N.set("load",H.toSeq().filter(function(M){return c("OzHelpers").isOwner(M,F)&&M.get("ready")}).count());N=N.set("away?",J);N=N.set("coach-mode?",K);return N}function E(F,G){var H=F.get("threadID"),I=H&&G.get(H),J=r();if(I)J=J.merge({tid:H,"intent-id":F.get("activeIntent"),"user-vcard":I.get("user-vcard")});window.postMessage({type:"consolepulse",data:J.toJS()},"*")}f.exports=c("OzWrapper.react")(x)}),null);
__d("OzLastEvent.react",["cx","OzHelpers","OzConstants","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){var i=c("OzConstants").AUTHOR_TYPES,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzLastEvent",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{name:j.string.isRequired,lastEvent:j.object.isRequired},render:function l(){var m=this.props.lastEvent,n=c("OzHelpers").authorType(m)===i.USER?this.props.name.split(" ")[0].substr(0,10):"M",o=m.get("text"),p=c("OzHelpers").shortDesc(m)||"did something",q=o&&n+": "+o||n+" "+p;return c("React").createElement("div",{className:"_4-_6 _4-_7",title:q},this._renderText(n,p))},_renderText:function l(m,n){return c("React").createElement("span",null,c("React").createElement("span",{className:"_3ikz"},m,": "),n)}});f.exports=k}),null);
__d("OzStrings",[],(function a(b,c,d,e,f,g){f.exports={NOTREADY_BUTTON:"I'm waiting",IS_NOTREADY:"Currently waiting",READY_BUTTON:"The user is waiting for us!",USER_FILTER_ALL:"All users",USER_FILTER_PUBLIC:"Public only",USER_FILTER_EMPLOYEE:"Employee only",READY_FILTER_ALL:"All threads",READY_FILTER_ATTENTION:"Needs attention",READY_FILTER_WAITING:"I'm waiting"}}),null);
__d("OzThreadLabels.react",["cx","OzHelpers","OzAPI","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","joinClasses","immutable","ReactLayeredComponentMixin_DEPRECATED","OzImmutablePureRenderMixin","React","XUICloseButton.react","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("immutable").OrderedMap,k=c("immutable").List,l=c("React").PropTypes,m=c("React").createClass({displayName:"Label",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{noColor:l.bool,removable:l.bool,shade:l.oneOf(["dark","light"]),thread:l.instanceOf(i).isRequired},getDefaultProps:function A(){return{shade:"dark"}},render:function A(){if(!this.props.shown)return null;return c("React").createElement("div",{className:c("joinClasses")("_2yqb"+(this.props.noColor?" _2yqc":"")+" _2yqd",this.props.className)},this.props.text,this.props.removable&&this.props.onRemove?c("React").createElement(c("XUICloseButton.react"),{className:"_2yqe",onClick:this.props.onRemove,shade:this.props.shade}):c("React").createElement("div",{className:"_4ypj"}))}});function n(A){return c("React").createElement(m,babelHelpers["extends"]({},A,{className:"_2yqi",text:"REMINDER",shown:!c("OzHelpers").urgentReminders(A.thread).isEmpty()}))}function o(A){return c("React").createElement(m,babelHelpers["extends"]({},A,{className:"_2yqj",text:"PAID",shown:!c("OzHelpers").paidReminders(A.thread).isEmpty()}))}function p(A){var B=c("OzHelpers").minAge(A.thread);return c("React").createElement(m,babelHelpers["extends"]({},A,{className:"_2yqm",text:B<18&&"UNDER 18"||B<21&&"UNDER 21",shown:B<21}))}function q(A){return c("React").createElement(m,babelHelpers["extends"]({},A,{className:"_2yql",text:"ENGAGE",shown:c("OzHelpers").hasEngage(A.thread)}))}var r=j({OzVIPLabel:["vip","_2yqf"],OzUrgentLabel:["urgent","_2yqg"],OzAbuserLabel:["abuser","_2yqh"],OzEscalatedLabel:["escalated","_1jce"]}),s=j({OzEmployeeLabel:["employee","_2yqk"]}),t=r.merge(s).map(function(A){var B=A[0],C=A[1];return B}).toSet();function u(A,B,C){return function(D){return c("React").createElement(m,babelHelpers["extends"]({},D,{className:B,text:z(A),shown:c("OzHelpers").hasTag(D.thread,A),onRemove:function E(){return c("OzAPI").deleteTag(c("OzHelpers").threadID(D.thread),A)}}))}}var v=r.map(function(A){return u.apply(undefined,A)}),w=s.map(function(A){return u.apply(undefined,A)});function x(A){var B=A.className,C=A.removable,D=A.addable,E=babelHelpers.objectWithoutProperties(A,["className","removable","addable"]);return c("React").createElement("div",{className:B},w.map(function(F,G){return c("React").createElement(F,babelHelpers["extends"]({key:G},E))}).valueSeq(),c("React").createElement(n,E),v.map(function(F,G){return c("React").createElement(F,babelHelpers["extends"]({key:G,removable:C},E))}).valueSeq(),(E.thread.get("tags")||k()).filterNot(function(F){return t.has(F)}).sort().map(function(F){var G=u(F,"_tch");return G(babelHelpers["extends"]({key:F,removable:C},E))}),c("React").createElement(q,E),c("React").createElement(o,E),D?c("React").createElement(y,{thread:E.thread}):null)}var y=c("React").createClass({displayName:"OzAddLabel",mixins:[c("OzImmutablePureRenderMixin"),c("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{thread:l.instanceOf(i).isRequired},getInitialState:function A(){return{shown:false}},render:function A(){return c("React").createElement("span",{ref:"add"},this._tags().isEmpty()?null:c("React").createElement("button",{className:"_1-hv _2yqb _2yqn _2yqo",onClick:function(){return this.setState({shown:true})}.bind(this)},"+"))},renderLayers:function A(){__p&&__p();var B=this.state.shown;if(!B)return null;var C=this.props.thread;return{contextualDialog:c("React").createElement(c("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:c("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll")},position:"below",shown:B,contextRef:function(){return this.refs.add}.bind(this),onBlur:function(D){return this.setState({shown:false})}.bind(this)},c("React").createElement("div",{className:"_2yqp"},this._tags().map(function(D){var E=D[0],F=D[1];return c("React").createElement("button",{key:E,className:c("joinClasses")(F,"_1-hv _2yqq"),onClick:function(){this.setState({shown:false});c("OzAPI").createTag(c("OzHelpers").threadID(C),E)}.bind(this)},z(E))}.bind(this))))}},_tags:function A(){return r.filterNot(function(B){var C=B[0],D=B[1];return c("OzHelpers").hasTag(this.props.thread,C)}.bind(this)).valueSeq()}});function z(A){return A.split("m_experiment_").join("").toUpperCase()}f.exports={OzLabelList:x,OzUnderageLabel:p}}),null);
__d("OzAllRow.react",["cx","OzStrings","OzHelpers","immutable","OzButton.react","OzConfig","OzConstants","OzDate.react","OzLastEvent.react","OzThreadLabels.react","OzUserImage.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("immutable").List,k=c("OzConstants").AUTHOR_TYPES,l=c("React").PropTypes,m=c("OzThreadLabels.react").OzLabelList,n=c("OzHelpers").pure(function(w){var x=w.thread,y=w.witIntents,z=babelHelpers.objectWithoutProperties(w,["thread","witIntents"]);return c("React").createElement("div",{className:"_-66"},c("React").createElement(t,{width:"220px"},c("React").createElement(o,{thread:x})),c("React").createElement(t,{marginLeft:"10px",width:"250px"},c("React").createElement(p,{thread:x,witIntents:y})),c("React").createElement(t,{marginLeft:"10px",width:"350px"},c("React").createElement(q,{thread:x})),c("React").createElement(t,{marginLeft:"10px",width:"150px"},c("React").createElement(r,{thread:x})),c("React").createElement(t,{margineft:"10px",flex:"1",alignItems:"right"},c("React").createElement(s,babelHelpers["extends"]({thread:x},z))))}),o=c("OzHelpers").pure(function(w){var x=w.thread;return c("React").createElement("div",{className:"_-67"},c("React").createElement(c("OzUserImage.react"),{photo:c("OzHelpers").photo(x)}),c("React").createElement("div",{className:"_-68"},c("React").createElement("h1",{className:"_-69"},c("OzHelpers").getName(x)),c("React").createElement(m,{className:"_-6a",thread:x})))}),p=c("OzHelpers").pure(function(w){var x=w.thread,y=w.witIntents,z=c("OzHelpers").openIntents(x).toSeq().map(function(B){return y.getIn([B.get("wit-intent-uuid"),"name"])}).filter(function(B){return B}).map(function(B){return"Intent: "+B}),A=c("OzHelpers").urgentReminders(x).toSeq().map(function(B){return B.getIn(["body","description"])}).filter(function(B){return B}).map(function(B){return"Reminder: "+B});return c("React").createElement("div",{className:"_-6q"},c("React").createElement("div",{className:"_-6r"},z.concat(A).map(function(B,C){return c("React").createElement("div",{key:C,className:"_4-_7 _-6s"},B)})))}),q=c("OzHelpers").pure(function(w){var x=w.thread;return c("React").createElement("div",{className:"_-6u"},u(x).map(function(y){return c("React").createElement("div",{key:c("OzHelpers").msgID(y),className:"_-6v"+(c("OzHelpers").authorType(y)!==k.USER?" _-6w":"")},c("React").createElement("span",{className:"_4-_7 _-6x"},c("React").createElement(c("OzDate.react"),{timestamp:y.get("timestamp")})),c("React").createElement(c("OzLastEvent.react"),{key:c("OzHelpers").msgID(y),name:c("OzHelpers").getName(x),lastEvent:y}))}))}),r=c("OzHelpers").pure(function(w){var x=w.thread,y=x.getIn(["owner","name"])||"No owner",z=x.getIn(["last-owner","name"]);return c("React").createElement("div",{className:"_-6y"},c("React").createElement("div",{className:"_-6z"},y),z?c("React").createElement("div",{className:"_-6-"},"Last owner: ",z):null)}),s=c("React").createClass({displayName:"Actions",mixins:[c("OzImmutablePureRenderMixin")],contextTypes:{uid:l.string.isRequired},propTypes:{thread:l.instanceOf(i).isRequired,onThreadNotReady:l.func.isRequired,onThreadReady:l.func.isRequired,onThreadRelease:l.func.isRequired,onThreadView:l.func.isRequired},render:function w(){return c("React").createElement("div",{className:"_-6_"},v(babelHelpers["extends"]({},this.props,{uid:this.context.uid})).map(function(x){var y=x.body,z=x.f;return c("React").createElement(c("OzButton.react"),{key:y,onClick:function(A,B){return z(this.props.thread,B,A)}.bind(this)},y)}.bind(this)))}}),t=c("OzHelpers").pure(function(w){var x=w.children,y=babelHelpers.objectWithoutProperties(w,["children"]);return c("React").createElement("div",{className:"_-70",style:y},x)});function u(w){var x=c("OzHelpers").lastEvents(w).groupBy(c("OzHelpers").authorType);return j([x.get(k.USER),x.get(k.TRAINER),x.get(k.BOT)]).toSeq().filter(function(y){return y}).map(function(y){return y.last()}).sortBy(function(y){return y.get("timestamp")})}function v(w){__p&&__p();var x=w.onThreadNotReady,y=w.onThreadReady,z=w.onThreadRelease,A=w.onThreadView,B=w.thread,C=w.uid,D=B,E=c("OzConfig").getInStaticConfig(["GK","supervisor"]),F=[];if(E&&c("OzHelpers").hasOwner(D))F.push({body:"Release",f:z});if(D.get("ready"))F.push({body:c("OzStrings").NOTREADY_BUTTON,f:x});else if(E)F.push({body:c("OzStrings").READY_BUTTON,f:y});if(D.getIn(["owner","id"])!==C&&!c("OzHelpers").isSubscriber(D,C))F.push({body:"View",f:A});return F}f.exports=n}),null);
__d("OzAll.react",["cx","OzStrings","OzAPI","OzHelpers","immutable","MessengerFlexScrollableArea.react","OzActions","OzAllRow.react","OzLoading.react","OzStores","promiseFinally","OzImmutablePureRenderMixin","React","Reflux","XUIButton.react","XUIRadioButtonGroup.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("OzLoading.react").Flex,k=c("OzLoading.react").Inline,l=c("OzStores").QueueFilterStore,m=c("OzStores").ThreadStore,n=c("React").PropTypes,o=c("React").createClass({displayName:"OzAll",mixins:[c("Reflux").connect(l,"filters"),c("Reflux").connect(m,"threads")],contextTypes:{router:n.object.isRequired},getInitialState:function C(){return{clientLimit:y}},componentWillMount:function C(){if(this.state.threads.size<y)this._fetchThreads()},componentDidUpdate:function C(D,E){var F=E.filters.get("all"),G=this.state.filters.get("all");if(!c("immutable").is(F,G))this._fetchThreads()},render:function C(){var D=this._getFilters(),E=D[0],F=D[1],G=this._threads();return c("React").createElement("div",{className:"_3l5z"},c("React").createElement(q,{showTags:E,hideTags:F,onChange:this._handleFilterChange}),c("React").createElement(p,{threads:G,loading:!!w[A(E,F)],clientLimit:this.state.clientLimit,onScrollBottom:this._handleScrollBottom,onThreadNotReady:this._handleThreadNotReady,onThreadReady:this._handleThreadReady,onThreadRelease:this._handleThreadRelease,onThreadView:this._handleThreadView,witIntents:this.props.witIntents}))},_getFilters:function C(){var D=this.state.filters.get("all");return[D.get("showTags"),D.get("hideTags")]},_fetchThreads:function C(){B(this._getFilters())},_threads:function C(){return t(s(this.state.threads),this._getFilters())},_handleFilterChange:function C(D){c("OzActions").updateQueueFilters(i({all:i(D)}));this.setState({clientLimit:y})},_handleScrollBottom:function C(){var D=this.state.clientLimit,E=this._threads(),F=D+y;this.setState({clientLimit:F});E.slice(D,F).size||this._fetchThreads()},_handleThreadNotReady:function C(D,E){c("OzAPI").notready(c("OzHelpers").threadID(D)).done(E,E)},_handleThreadReady:function C(D,E){c("OzAPI").ready(c("OzHelpers").threadID(D)).done(E,E)},_handleThreadRelease:function C(D,E){c("OzAPI").release(c("OzHelpers").threadID(D)).done(E,E)},_handleThreadView:function C(D,E,F){var G=c("OzHelpers").threadID(D),H=c("OzHelpers").hasCmdOrCtrl(F);c("OzAPI").view(G).done(function(I){E();H||this.context.router.push("/inbox/"+G)}.bind(this),E)}}),p=c("React").createClass({displayName:"ThreadList",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{clientLimit:n.number.isRequired,loading:n.bool.isRequired,onScrollBottom:n.func.isRequired,onThreadNotReady:n.func.isRequired,onThreadReady:n.func.isRequired,onThreadRelease:n.func.isRequired,onThreadView:n.func.isRequired,threads:n.instanceOf(i).isRequired,witIntents:n.instanceOf(i).isRequired},render:function C(){var D=this.props,E=D.loading,F=D.threads,G=D.clientLimit;if(E&&!F.count())return c("React").createElement(j,null);return c("React").createElement(c("MessengerFlexScrollableArea.react"),{ref:"scrollable",onScroll:this._handleScroll},c("React").createElement("div",{className:"_3l5-"},F.take(G).map(function(H){return c("React").createElement(c("OzAllRow.react"),{key:c("OzHelpers").threadID(H),thread:H,witIntents:this.props.witIntents,onThreadNotReady:this.props.onThreadNotReady,onThreadReady:this.props.onThreadReady,onThreadRelease:this.props.onThreadRelease,onThreadView:this.props.onThreadView})}.bind(this)).valueSeq()),c("React").createElement(k,{loading:E}))},_handleScroll:function C(){var D=this.refs.scrollable;D&&D.isScrolledToBottom()&&this.props.onScrollBottom()}}),q=c("OzHelpers").pure(function(C){var D,E,F=C.showTags,G=C.hideTags,H=C.onChange,I=function I(J){var K=J.tagName,L=J.value,M=v({tagName:K,value:L,showTags:F,hideTags:G});H(M)};return c("React").createElement("div",{className:"_3l5_"},c("React").createElement(r,{tagName:"employee",value:u("employee",F,G),onChange:I,buttons:(D={},D[u.NEUTRAL]=c("OzStrings").USER_FILTER_ALL,D[u.OFF]=c("OzStrings").USER_FILTER_PUBLIC,D[u.ON]=c("OzStrings").USER_FILTER_EMPLOYEE,D)}),c("React").createElement(r,{tagName:"ready",value:u("ready",F,G),onChange:I,buttons:(E={},E[u.NEUTRAL]=c("OzStrings").READY_FILTER_ALL,E[u.OFF]=c("OzStrings").READY_FILTER_ATTENTION,E[u.ON]=c("OzStrings").READY_FILTER_WAITING,E)}))}),r=c("OzHelpers").pure(function(C){var D=C.tagName,E=C.value,F=C.buttons,G=C.onChange;return c("React").createElement("div",{key:D,className:"_3l60"},c("React").createElement(c("XUIRadioButtonGroup.react"),{selectedValue:E,selectedUse:"confirm",onValueChange:function H(E){G({tagName:D,value:E})}},Object.keys(F).map(function(H){return c("React").createElement(c("XUIButton.react"),{key:H,value:H,label:F[H]})})))});function s(C){return C.sortBy(function(D){return-D.get("last-event-at")})}function t(C,D){var E=D[0],F=D[1];return C.filter(function(G){var H=true;if(E.size)H=c("OzHelpers").hasAllTags(G,E);if(F.size)H=!c("OzHelpers").hasSomeTag(G,F);return H})}var u=function u(C,D,E){return D.has(C)?u.ON:E.has(C)?u.OFF:u.NEUTRAL};u.ON="on";u.OFF="off";u.NEUTRAL="neutral";function v(C){__p&&__p();var D=C.tagName,E=C.value,F=C.showTags,G=C.hideTags,H,I;switch(E){case u.ON:H=F.add(D);I=G.remove(D);break;case u.OFF:H=F.remove(D);I=G.add(D);break;default:H=F.remove(D);I=G.remove(D);break}return{showTags:H,hideTags:I}}var w={},x={},y=20,z=2*y;function A(C,D){var E=C.toJS().join("-"),F=D.toJS().join("-");return"show["+E+"]hide["+F+"]"}function B(C){__p&&__p();var D=C[0],E=C[1],F=A(D,E),G=w[F];c("OzHelpers").debug("[oz-all] fetchThreads",F);if(G){c("OzHelpers").debug("[oz-all] abort fetchthreads : loading",F);return}var H=x[F]||0;w[F]=true;c("promiseFinally")(c("OzAPI").allThreads(D,E,H,z),function(I){return w[F]=false}).done(function(I){return x[F]=H+z})}f.exports=o}),null);
__d("OzExpirationCountdown.react",["cx","relativeTimeString.atlas","OzDate.react","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l=30*1e3;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){__p&&__p();var n,o;"use strict";for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$OzExpirationCountdown2=function(){this.forceUpdate();if(this.isExpired()){clearInterval(this.$OzExpirationCountdown1);this.$OzExpirationCountdown1=null}}.bind(this),this.remainingTime=function(){return this.props.endTime-Date.now()}.bind(this),this.isExpired=function(){return this.props.endTime<=Date.now()}.bind(this),o}m.prototype.componentDidMount=function(){"use strict";this.$OzExpirationCountdown1=setInterval(this.$OzExpirationCountdown2,l)};m.prototype.componentWillReceiveProps=function(){"use strict";this.$OzExpirationCountdown1=this.$OzExpirationCountdown1||setInterval(this.$OzExpirationCountdown2,l)};m.prototype.componentWillUnmount=function(){"use strict";clearInterval(this.$OzExpirationCountdown1)};m.prototype.render=function(){"use strict";var n=this.props.endTime,o=this.isExpired()&&c("React").createElement("span",null,"Expired ",c("React").createElement(c("OzDate.react"),{timestamp:n}))||this.remainingTime()<=60*1e3&&"Expires in less than a minute"||"Expires in "+c("relativeTimeString.atlas")(n,true),p="_3d53"+(this.isExpired()?" _3d54":"")+(!this.isExpired()?" _3d55":"");return c("React").createElement("span",{className:p},o)};m.propTypes={endTime:k.number.isRequired};f.exports=m}),null);
__d("OzMessage.react",["cx","getURLRanges","OzHelpers","formatDate","Image.react","immutable","Link.react","MNCommerceAgentItemSuggestionMercuryShareAttachment.react","MNCommercePromotionMercuryShareAttachment.react","OzExpirationCountdown.react","OzImmutablePureRenderMixin","React","OzWrapper.react","TextWithEntities.react","XStickerAssetController"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("immutable").List,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzMessage",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{message:k.instanceOf(i).isRequired},render:function M(){__p&&__p();var N=this.props.message,O=N.get("attachments")||j(),P=j([N.get("text")&&K(N.get("text"))]).concat(O.map(function(Q){var R=x(Q)&&y(Q)||s(Q)&&t(Q)||E(Q)&&G(F(Q))||D(Q)&&G(Q.get("uri"))||B(Q)&&C(Q)||z(Q)&&A(Q)||u(Q)&&v(Q)||q(Q)&&r(Q)||m(Q)&&p(o(Q.get("metadata")))||n(Q)&&p(c("OzHelpers").uiSuggestion(Q.get("suggestion")))||H(Q)&&I(Q.getIn(["xma","link"]))||Q.get("uri")&&I(Q.get("uri"));if(R)return R;else{c("OzHelpers").error("could not render attachment",Q.toJS(),N.toJS());return L("Oops. We could not render this attachment.")}})).filter(function(Q){return!!Q}).map(function(Q,R){return c("React").createElement("span",{key:R,className:"_15_n"},Q)});if(P.size)return c("React").createElement("span",null,P);else{c("OzHelpers").error("no text or attachments",N.toJS());return L("Oops. We did not get text or attachments.")}}}),m=function m(M){return M.hasIn(["metadata","target_url"])},n=function n(M){return M.has("suggestion")},o=function o(M){if(!i.isMap(M.get("total_cost"))&&M.has("raw_amount"))M=M.set("total_cost",i({amount:+M.get("raw_amount")}));return M.update("target_url",c("OzHelpers").shimURI).toJS()};function p(M){return c("React").createElement("div",{className:"_53qw"},M.expiration_time?c("React").createElement("div",{className:"_4jjz"},c("React").createElement(c("OzExpirationCountdown.react"),{endTime:M.expiration_time*1e3})):null,c("React").createElement("div",{className:"_4jj-"},c("React").createElement(c("MNCommerceAgentItemSuggestionMercuryShareAttachment.react"),{attachment:{target:M}})))}var q=function q(M){return M.get("mime_type")==="oz/business-message"};function r(M){var N=M.get("xma").setIn(["target","call_to_actions"],[]).toJS();return c("React").createElement("div",{className:"_53qw"},c("React").createElement("div",{className:"_4jj-"},c("React").createElement(c("MNCommercePromotionMercuryShareAttachment.react"),{attachment:N})))}var s=function s(M){return M.get("mime_type")==="oz/event"};function t(M){var N=M.get("metadata"),O=function O(Q){return Q?c("formatDate")(Q,"M jS, g:ia"):"[no time]"},P=N.getIn(["place","name"])||N.get("description")||"[no location]";return c("React").createElement("a",{className:"_3is9",href:N.get("url"),target:"_blank"},c("React").createElement("img",{alt:P,className:"_3isa",src:N.get("image_url")}),c("React").createElement("div",{className:"_3isb"},c("React").createElement("div",{className:"_3isc"},N.get("title")||"[no invitation title]"),c("React").createElement("div",null,O(N.get("start"))," \u2014 ",O(N.get("end"))),c("React").createElement("div",null,P)))}var u=function u(M){var N=M.get("metadata");return N&&N.get("location")&&N.get("url")&&N.get("image_url")};function v(M){return G(M.getIn(["metadata","image_url"]),M.getIn(["metadata","url"]))}var w=function w(M){var N=M.get("uri"),O=M.get("sticker_id");if(O)N=c("XStickerAssetController").getURIBuilder().setInt("sticker_id",O).getURI().toString();return N},x=function x(M){return(M.get("sticker_id")||c("OzHelpers").isStickerType(M.get("mime_type")))&&w(M)};function y(M){return c("React").createElement(c("Image.react"),{className:"__vl",src:w(M)})}var z=function z(M){return/video/.test(M.get("mime_type"))&&M.get("uri")};function A(M){return c("React").createElement("video",{controls:true,height:"300",width:"300"},c("React").createElement("source",{src:M.get("uri"),type:M.get("mime_type")}))}var B=function B(M){return/audio/.test(M.get("mime_type"))&&M.get("uri")};function C(M){return c("React").createElement("audio",{className:"_1d86",controls:true},c("React").createElement("source",{src:M.get("uri"),type:M.get("mime_type")}))}var D=function D(M){var N=/blob:/.test(M.get("uri")),O=/\.(jpg|gif|png)/.test(M.get("uri"));return M.get("uri")&&(c("OzHelpers").isImageType(M.get("mime_type"))||N||O)},E=function E(M){return/base64/.test(M.get("mime_type"))&&M.get("data")},F=function F(M){return M.get("mime_type")+","+M.get("data")};function G(M,N){return c("React").createElement("a",{href:N||M,target:"_blank",className:"_4y6l",style:{backgroundImage:"url('"+M+"')"}})}var H=function H(M){return!!M.getIn(["xma","link"])};function I(M){return c("React").createElement("div",{className:"_4y6k"},c("React").createElement("a",{href:M,target:"_blank"},"Attachment Link"))}function J(M,N){return c("React").createElement(c("Link.react"),{target:"_blank",href:c("OzHelpers").shimURI(N.entity.url)},M)}function K(M){return c("React").createElement(c("TextWithEntities.react"),{className:"_4y6k",text:M,interpolator:J,ranges:c("getURLRanges")(M),renderEmoticons:true,renderEmoji:true})}function L(M){return c("React").createElement("div",{className:"_4y6k _5kng"},M)}f.exports=c("OzWrapper.react")(l)}),null);
__d("OzSearchSource",["AbstractSearchSource"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("AbstractSearchSource"));i=h&&h.prototype;function j(k){"use strict";i.constructor.call(this);this.$OzSearchSource1=k}j.prototype.bootstrap=function(){"use strict";return this.$OzSearchSource1({})};j.prototype.suggest=function(k){"use strict";return this.$OzSearchSource1(k)};j.prototype.searchImpl=function(k,l){"use strict";return this.$OzSearchSource1({query:k}).then(function(m){return l(m,k)},function(m){return l([],k)})};f.exports=j}),null);
__d("OzFeedbackDashboard.react",["cx","Promise","OzAPI","OzHelpers","immutable","OzButton.react","OzConfig","OzMessage.react","OzSearchSource","OzImmutablePureRenderMixin","React","Reflux","SearchableDropdownInput.contrib","SearchableEntry","Stars.react","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzFeedbackDashboard",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],contextTypes:{uid:j.string.isRequired,router:j.object.isRequired},getInitialState:function D(){return{messages:i(),authorID:this.context.uid}},componentWillMount:function D(){this._searchSource=new(c("OzSearchSource"))(function(E){var F=(E.query||"").toLowerCase();return new(c("Promise"))(function(G){return G(this.props.reps.valueSeq().map(u).concat([u("autoresponse-bot"),u("survey-bot")]).sortBy(function(H){return H.getTitle()}).filter(function(H){return(H.getTitle()||"").toLowerCase().indexOf(F)>-1}).toJS())}.bind(this))}.bind(this))},componentDidMount:function D(){this._fetchFeedback()},render:function D(){return c("React").createElement("div",{className:"_60f"},this.state.config.getIn(["GK","supervisor"])?c("React").createElement(l,{reps:this.props.reps,authorID:this.state.authorID,searchSource:this._searchSource,onSelect:function(E){return this.setState({messages:i(),activeMessage:null,authorID:E.getUniqueID()},this._fetchFeedback)}.bind(this)}):null,c("React").createElement(m,{messages:this.state.messages}),c("React").createElement(r,{messages:this.state.messages,reps:this.props.reps,activeMessage:this.state.activeMessage||this.state.messages.first(),onMessageClick:function(E){return this.setState({activeMessage:E})}.bind(this),onSeeThreadClick:function(E){return this.context.router.push("/inbox/"+E)}.bind(this)}))},_fetchFeedback:function D(){c("OzAPI").authorFeedback(this.state.authorID).done(function(E){E=E.sortBy(function(F){return-F.get("timestamp")});this.isMounted()&&this.setState({messages:E})}.bind(this))}}),l=c("OzHelpers").pure(function(D){var E=D.reps,F=D.authorID,G=D.searchSource,H=D.onSelect;return c("React").createElement("div",{className:"_5p66"},c("React").createElement("div",{className:"_wa_"},c("React").createElement(c("SearchableDropdownInput.contrib"),{value:u(E.get(F)||F),onSelect:H,placeholder:"Pick a rep",emptySearchResultsText:"No Rep found",searchSource:G})))}),m=c("OzHelpers").pure(function(D){var E=D.messages;return c("React").createElement("div",null,c("React").createElement(o,{messages:E,days:"-7",span:"7"}),c("React").createElement(o,{messages:E,days:"-14",span:"7"}),c("React").createElement(o,{messages:E,days:"-21",span:"7"}),c("React").createElement(o,{messages:E,days:"-30",span:"30"}),c("React").createElement(o,{messages:E,days:"-60",span:"30"}))}),n=c("OzHelpers").pure(function(D){var E=D.day,F=D.span;return c("React").createElement("div",{className:"_24xm"},E+F==0?"LAST "+-E+" DAYS":"FROM "+(E+F)+" TO "+E+" DAYS")}),o=c("OzHelpers").pure(function(D){var E=D.messages,F=D.days,G=D.span,H=parseInt(F,10),I=parseInt(G,10),J=C(E,H,H+I);return c("React").createElement("div",{className:"_wb0"},c("React").createElement(n,{day:H,span:I}),c("React").createElement("div",{className:"_wb2"},c("React").createElement(p,{label:"TONE"},z(J)),c("React").createElement(p,{label:"RESPONSIVENESS"},y(J)),c("React").createElement(p,{label:"EXECUTION"},x(J)),c("React").createElement(p,{label:"CONSOLE"},A(J)),c("React").createElement(q,null,B(J))),c("React").createElement("div",{className:"_3gch"},c("React").createElement(p,{label:"FEEDBACK GIVEN"},J.size)))}),p=c("OzHelpers").pure(function(D){var E=D.label,F=D.children,G=D.variation,H=D.className;return c("React").createElement("div",{className:c("joinClasses")(H,"_wb3")},c("React").createElement("span",{className:"_wb4"},F),c("React").createElement("span",{className:"_wb5"},E))}),q=c("OzHelpers").pure(function(D){var E=D.children;return c("React").createElement(p,{label:"POLICY",className:(E===0?"_wb6":"")+(E>0?" _wb7":"")},E)}),r=c("OzHelpers").pure(function(D){var E=D.messages,F=D.reps,G=D.activeMessage,H=D.onMessageClick,I=D.onSeeThreadClick,J=G&&G.get("reviews"),K=G&&G.get("user-id");return c("React").createElement("div",{className:"_wb8"},c("React").createElement("div",{className:"_wbc"},c("React").createElement("div",{className:"_4fj7"},E.map(function(L){return c("React").createElement("div",{className:"_wbf"+(L===G?" _wbg":""),key:c("OzHelpers").msgID(L),onClick:function M(N){return H(L)},role:"presentation"},c("React").createElement(c("OzMessage.react"),{message:L}))}).valueSeq())),c("React").createElement("div",{className:"_wbh"},c("React").createElement("div",{className:"_wbe"},J?J.map(function(L){return c("React").createElement(s,{key:L.get("id"),rep:F.get(L.get("reviewer-id")),review:L})}).valueSeq():null)),c("React").createElement("div",{className:"_wbi"},K?c("React").createElement(c("OzButton.react"),{onClick:function L(M){return I(K)}},"See Thread"):null))}),s=c("OzHelpers").pure(function(D){var E=D.review,F=D.rep;return c("React").createElement("div",{className:"_wbj"},c("React").createElement("div",{className:"_wbk"},c("React").createElement("h2",{className:"_wbl"},F&&F.get("name")),E.has("tone")?c("React").createElement(t,{label:"Tone"},c("React").createElement(c("Stars.react"),{count:E.get("tone"),max:3,size:"large"})):null,E.has("responsiveness")?c("React").createElement(t,{label:"Responsiveness"},c("React").createElement(c("Stars.react"),{count:E.get("responsiveness"),max:3,size:"large"})):null,E.has("execution")?c("React").createElement(t,{label:"Execution"},c("React").createElement(c("Stars.react"),{count:E.get("execution"),max:3,size:"large"})):null,E.has("followed-policy")?c("React").createElement(t,{label:"Followed Policy?"},c("React").createElement("div",{className:"_wbm"},E.get("followed-policy")?"YES":"NO")):null,E.has("console-proficiency")?c("React").createElement(t,{label:"Console"},c("React").createElement(c("Stars.react"),{count:E.get("console-proficiency"),max:3,size:"large"})):null),c("React").createElement("div",{className:"_wbn"},E.get("body")))}),t=c("OzHelpers").pure(function(D){var E=D.label,F=D.children;return c("React").createElement("div",{className:"_wbo"},F,c("React").createElement("div",{className:"_wbp"},E))});function u(D){var E=function E(F){return new(c("SearchableEntry"))(F)};return D?D.get?E({title:D.get("name"),uniqueID:D.get("fbid")}):E({title:D,uniqueID:D}):null}function v(D,E){return function(F){var G=F.valueSeq().flatMap(function(K){return K.get("reviews")}).filter(function(K){return K&&K.has(D)}),H=G.reduce(function(K,L){var I=K[0],J=K[1];return[I+E,J+L.get(D)]},[0,0]),I=H[0],J=H[1];return I?Math.round(J/I*100)+"%":" "}}function w(D){return function(E){var F=E.valueSeq().flatMap(function(H){return H.get("reviews")}).filter(function(H){return H&&H.has(D)}),G=F.reduce(function(G,H){return G+!H.get(D)},0);return G?G:""}}var x=v("execution",3),y=v("responsiveness",3),z=v("tone",3),A=v("console-proficiency",3),B=w("followed-policy");function C(D,E,F){var G=new Date().getDate(),H=+new Date(Date.now()).setDate(G+E),I=+new Date(Date.now()).setDate(G+F);return D.filter(function(J){var K=+J.get("timestamp");return K>=H&&K<=I})}f.exports=k}),null);
__d("OzInboxThreadRow.react",["cx","OzHelpers","immutable","OzConfig","OzLastEvent.react","OzThreadLabels.react","OzUserImage.react","OzImmutablePureRenderMixin","React","OzWrapper.react","Reflux","Sound","Timestamp.react","Tooltip"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("OzThreadLabels.react").OzLabelList,k=c("React").PropTypes,l=1e3,m=c("React").createClass({displayName:"OzInboxThreadRow",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{thread:k.object.isRequired,locker:k.object.isRequired,selected:k.bool.isRequired,onClick:k.func.isRequired,onUnview:k.func.isRequired,witIntents:k.instanceOf(i).isRequired},contextTypes:{uid:k.string.isRequired},getInitialState:function r(){return{flashing:false,unread:false}},componentWillReceiveProps:function r(s){__p&&__p();var t=s.thread,u=s.selected;if(this.state.config.getIn(["GK","responsiveness"])){if(n(this.props.thread,t)){o(t);this.setState({unread:true,flashing:true});window.clearTimeout(this._flashingTimeout);this._flashingTimeout=window.setTimeout(function(v){return this.setState({flashing:false})}.bind(this),l)}if(u)this.setState({unread:false})}},componentWillUnmount:function r(){window.clearTimeout(this._flashingTimeout)},render:function r(){var s=this.props,t=s.thread,u=s.locker,v=s.selected,w=s.subscribed,x=s.owned,y=s.onUnview,z=c("OzHelpers").getName(t),A=c("OzHelpers").photo(t),B=c("OzHelpers").lastEvents(t).last(),C=!x&&t.get("ui-reassign"),D=c("OzHelpers").hasPaid(t),E=c("OzHelpers").hasReminder(t),F=t.get("locked"),G=F?"Thread locked by "+u.get("name")+"\n       at "+new Date(t.get("locked-at")).toLocaleString():"",H=x&&(t.get("ready")||D||E)&&!F,I=null,J=B&&B.get("timestamp");if(!x){var K=t.get("ui-reassign")?"Reassigned to":"Grabbed by";I=K+" "+c("OzHelpers").nameOrId(t.get("owner"))}var L=this.state.config.getIn(["GK","responsiveness"]),M=this.state.config.getIn(["GK","responsivenessV2"]),N=M?c("OzHelpers").isUnread(t)&&!v:this.state.unread;return c("React").createElement("div",{className:"_2ic2"+(L&&N?" _2ic4":"")+(L&&this.state.flashing?" _5lan":"")+(H?" _2ic3":"")+(E?" _2ic5":"")+(D?" _2ic6":"")+(v?" _2ic7":"")+(C?" _2q4a":""),onClick:this._handleClick,role:"presentation"},c("React").createElement("div",{className:"_2ic8"},c("React").createElement(c("OzUserImage.react"),{photo:A}),w?c("React").createElement("button",{className:"_1-hv _2ic9",onClick:function O(P){return y(t)}}):null),c("React").createElement("div",{className:"_2ica"},!x?c("React").createElement(p,{name:I}):null,c("React").createElement("h1",{className:"_4-_7 _2ice"},z),c("React").createElement(q,{thread:t,witIntents:this.props.witIntents}),c("React").createElement("div",{className:"_2icb"},B?c("React").createElement(c("OzLastEvent.react"),{lastEvent:B,name:z}):null),c("React").createElement("div",{className:"_3lxn"},c("React").createElement(j,{className:"_2icc",thread:t}))),c("React").createElement("div",{className:"_6f"},J?c("React").createElement("div",{className:"_2icf"},c("React").createElement(c("Timestamp.react"),{autoUpdate:true,shorten:true,time:J/1e3})):null,c("React").createElement("div",babelHelpers["extends"]({className:F?"_1hw":""},c("Tooltip").propsFor(G)))))},_handleClick:function r(){this.props.onClick(this.props.thread)}});function n(r,s){return(c("OzHelpers").unreadTs(r)||0)<(c("OzHelpers").unreadTs(s)||0)}c("Sound").init(["audio/ogg","audio/mpeg"]);function o(r){var s=c("OzHelpers").unreadTs(r);c("OzHelpers").debug("[inboxThreadRow] sound for tid "+c("OzHelpers").threadID(r)+", ts "+s);var t=c("OzConfig").ConfigStore.data.getIn(["resources","sound","notifyUnread"],i()).toObject(),u=t.ogg,v=t.mp3;if(s&&(u||v))c("Sound").play([u,v],s,false);else c("OzHelpers").warn("[inboxThreadRow] sounds not loaded")}function p(r){var s=r.name,t=r.lastEvent,u=t&&t.get("timestamp");return c("React").createElement("div",{className:"_2icd"},c("React").createElement("h1",{className:"_4-_7 _2ice"},s),u?c("React").createElement("div",{className:"_2icf"},c("React").createElement(c("Timestamp.react"),{autoUpdate:true,shorten:true,time:u/1e3})):null)}function q(r){var s=r.thread,t=r.witIntents,u=c("OzHelpers").openIntents(s).first(),v=u&&t.getIn([u.get("wit-intent-uuid"),"name"]);return v?c("React").createElement("div",{className:"_2icg"},v):c("React").createElement("span",null)}f.exports=c("OzWrapper.react")(m)}),null);
__d("OzInboxThreadList.react",["cx","OzHelpers","joinClasses","OzInboxThreadRow.react","immutable","OzLoading.react","OzImmutablePureRenderMixin","React","OzWrapper.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("immutable").Map,j=c("immutable").OrderedMap,k=c("React").PropTypes,l=c("OzLoading.react").Inline,m=c("React").createClass({displayName:"OzInboxThreadList",mixins:[c("OzImmutablePureRenderMixin")],contextTypes:{uid:k.string.isRequired},propTypes:{loading:k.bool.isRequired,onThreadClick:k.func.isRequired,onUnview:k.func.isRequired,threadGroups:k.instanceOf(j).isRequired,witIntents:k.instanceOf(i).isRequired,className:k.string,selectedThread:k.string},render:function o(){var p=this.props.threadGroups.some(function(q){return q.count()});return c("React").createElement("div",{className:c("joinClasses")("_36ob",this.props.className)},p?c("React").createElement(l,{key:"l",loading:this.props.loading}):c("React").createElement(n,null),p?this.props.threadGroups.map(this._renderRows).valueSeq():null)},_renderRows:function o(p,q){var r=p.map(function(s){return c("React").createElement(c("OzInboxThreadRow.react"),{key:c("OzHelpers").threadID(s),thread:s,locker:this.props.reps.get(s.get("locker-id"),i()),owned:c("OzHelpers").isOwner(s,this.context.uid),selected:c("OzHelpers").threadID(s)===this.props.selectedThread,subscribed:c("OzHelpers").isSubscriber(s,this.context.uid),onClick:this.props.onThreadClick,onUnview:this.props.onUnview,witIntents:this.props.witIntents})}.bind(this)).valueSeq();return c("React").createElement("span",{className:"_36oc",key:q},r)}});function n(){return c("React").createElement("div",{className:"_725"},"You do not own any threads at the moment.",c("React").createElement("br",null))}f.exports=c("OzWrapper.react")(m)}),null);
__d("OzInboxThreads",["OzHelpers","OzConfig"],(function a(b,c,d,e,f,g){__p&&__p();var h="GRABBED",i="VIEWING",j="PAST";function k(n){return c("OzConfig").ConfigStore.data.getIn(["GK","responsivenessV2"])?Math.max(c("OzHelpers").unreadTs(n)||0,n.get("last-event-at",0)):n.get("last-event-at",0)}function l(n){var o=function o(p){return p.get("locked-at")&&p.get("locker-id")===n};return function(p,q){if(o(p)&&!o(q))return-1;else if(!o(p)&&o(q))return 1;else return c("OzHelpers").compareNums(k(p),k(q))}}var m=c("OzHelpers").memoize(function(n,o){var p=arguments.length<=2||arguments[2]===undefined?"":arguments[2],q=l(o);return n.filter(function(r){var s=c("OzHelpers").isOwner(r,o),t=c("OzHelpers").isLocker(r,o),u=c("OzHelpers").isSubscriber(r,o),v=c("OzHelpers").wasOwner(r,o),w=c("OzHelpers").hasOpenIntents(r);switch(p){case h:return(s||r.get("ui-reassign")&&v)&&(r.get("ready")||w||t);case i:return u;case j:return v||s&&!r.get("ready")&&!w;default:return s||u}}).sort(q)},function(n,o){var p=arguments.length<=2||arguments[2]===undefined?"":arguments[2];return n.hashCode()+o+p},3);f.exports={getInboxThreads:m,OZ_GRABBED_TAB:h,OZ_VIEWING_TAB:i,OZ_PAST_TAB:j}}),null);
__d("OzTabHeader.react",["cx","React"],(function a(b,c,d,e,f,g,h){function i(j){var k=j.tabs,l=j.onChange,m=j.active;return c("React").createElement("div",{className:"_2j6l"},k.map(function(n){var o=n[0],p=n[1];return c("React").createElement("button",{key:p,role:"button",className:"_1-hv _2j6m"+(p===m?" _2j6n":""),onClick:function q(r){return l([o,p])}},o)}))}f.exports=i}),null);
__d("OzInbox.react",["cx","OzAPI","OzHelpers","DataTransfer","immutable","OzActions","OzInboxThreadList.react","OzInboxThreads","OzStores","OzTabHeader.react","ReactComponentWithPureRenderMixin","React","OzWrapper.react","Reflux","promiseFinally"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("immutable").OrderedMap,m=c("immutable").List,n=c("OzStores").HandledEventsStore,o=c("OzStores").HumanStore,p=c("OzStores").ThreadStore,q=c("React").PropTypes,r=c("OzInboxThreads").OZ_GRABBED_TAB,s=c("OzInboxThreads").OZ_VIEWING_TAB,t=c("OzInboxThreads").OZ_PAST_TAB,u=5e3,v=3e4,w=120*1e3,x=r,y=c("React").createClass({displayName:"OzInbox",mixins:[c("ReactComponentWithPureRenderMixin"),c("Reflux").connect(p,"threads"),c("Reflux").connect(o,"humans"),c("Reflux").connect(n,"handledEvents")],contextTypes:{uid:q.string.isRequired,router:q.object.isRequired},getInitialState:function D(){return{activeTab:null,loading:false}},componentDidMount:function D(){__p&&__p();this._fetchThreads();var E=window.setInterval(function(G){this._fetchThreads()}.bind(this),v),F=window.setInterval(function(){var G=this.threads(this._getActiveTab());if(G.some(function(H){return H.get("ui-reassign")}))c("OzActions").clearReassignState()}.bind(this),u);this._cleanup=function(){x=this._getActiveTab();window.clearInterval(F);window.clearInterval(E)}.bind(this)},componentDidUpdate:function D(E,F){var G=this.props.params.threadid;if(!G){var H=this.threads(),I=c("OzStores").ActiveThreadStore.data.get("oldThreadID"),J=H.get(I)||H.first();if(J){c("OzHelpers").info("[ozinbox] search for best thread, found:",J);this.context.router.push("/inbox/"+c("OzHelpers").threadID(J))}}},componentWillUnmount:function D(){this._cleanup()},render:function D(){var E=this._getActiveTab(),F=this.threads(E),G=this.state.humans.getIn([this.context.uid,"load"],0),H=function H(I){return I.preventDefault()};return c("React").createElement("div",{className:"_4b5_",onDragStart:H,onDragEnd:H,onDragOver:H,onDrop:function I(J){H(J);var K=new(c("DataTransfer"))(J.nativeEvent.dataTransfer);c("OzActions").updateComposer({files:K.getFiles()})}},c("React").createElement(z,{threadGroups:B(F,this.context.uid,E),reps:this.props.reps,loading:this.state.loading,activeCount:G,activeTab:E,selectedThread:this.props.params.threadid,onTabChange:this._handleTabChange,onUnview:this._handleUnview,onThreadClick:this._handleThreadClick,witIntents:this.props.witIntents}),this._renderDetails())},_getActiveTab:function D(){var E=this.state.threads.get(this.props.params.threadid);return this.state.activeTab||E&&c("OzHelpers").isOwner(E,this.context.uid)&&r||E&&c("OzHelpers").isSubscriber(E,this.context.uid)&&s||x||r},_handleUnview:function D(E){this._callAPIAndShift("unview",E)},_handleThreadClick:function D(E){c("OzHelpers").info("[inbox/handleThreadClick] clicked on thread",c("OzHelpers").threadID(E));var F=c("OzHelpers").nextTaskForThread(E);this.context.router.push(c("OzHelpers").threadPath({threadid:c("OzHelpers").threadID(E),intentid:F&&F.get("intent-id"),taskid:F&&F.get("id")}))},_handleTabChange:function D(E){var F=E[0],G=E[1];this.setState({activeTab:G})},_callAPIAndShift:function D(E,F){var G=A(this.threads(r),F),H=function(F){c("OzHelpers").info("[inbox/callAPIAndShift] shifting to thread",c("OzHelpers").threadID(F));this.context.router.push("/inbox/"+c("OzHelpers").threadID(F))}.bind(this),I=c("OzAPI")[E](c("OzHelpers").threadID(F));G&&H(G);I.done(null,function(J){c("OzHelpers").error("[inbox] could not shift",J);H(F)})},_renderDetails:function D(){var E=this.props.params.threadid;if(!E&&this.threads().isEmpty())return this._renderFinished();var F=c("OzHelpers").fullThreadData(this.state.threads,this.state.handledEvents,E);if(!F||!this.props.children)return null;return c("React").cloneElement(this.props.children,{thread:F,witIntents:this.props.witIntents,requirements:this.props.requirements,merchants:this.props.merchants,humans:this.state.humans,reps:this.props.reps})},_renderFinished:function D(){return c("React").createElement("div",{className:"_57l3"},c("React").createElement("div",{className:"_57l8"},c("React").createElement("div",{className:"_57lo"}),c("React").createElement("h2",null,"Congrats! You've made a lot of people happy"),c("React").createElement("p",null,"Sit tight, new messages should be coming soon!")))},_fetchThreads:function D(){var E=this.state.loading;if(E)return;this.setState({loading:true});c("promiseFinally")(c("OzAPI").myThreads(),function(F){return this.isMounted()&&this.setState({loading:false})}.bind(this)).done()},threads:function D(E){return c("OzInboxThreads").getInboxThreads(this.state.threads,this.context.uid,E)}});i=babelHelpers.inherits(z,c("React").PureComponent);j=i&&i.prototype;z.prototype.render=function(){"use strict";var D=this.props,E=D.activeTab,F=D.onTabChange,G=D.activeCount,H=babelHelpers.objectWithoutProperties(D,["activeTab","onTabChange","activeCount"]),I=G?"Open ("+G+")":"Open";return c("React").createElement("div",{className:"_4b61"},c("React").createElement("div",{className:"_4cwh"},c("React").createElement(c("OzTabHeader.react"),{active:E,tabs:[[I,r],["Viewing",s],["Closed",t]],onChange:F})),c("React").createElement("div",{className:"_3_cz"},c("React").createElement("div",{className:"_4fj7"},c("React").createElement(c("OzInboxThreadList.react"),babelHelpers["extends"]({className:E===r?"_2sav":""},H)))))};function z(){"use strict";i.apply(this,arguments)}z.propTypes=babelHelpers["extends"]({activeTab:q.oneOf([r,s,t]).isRequired,onTabChange:q.func.isRequired},c("OzInboxThreadList.react").propTypes);function A(D,E){var F=c("OzHelpers").threadID(E),G=D.toList(),H=G.findIndex(function(K){return c("OzHelpers").threadID(K)===F}),I=H-1,J=H+1;if(J<G.count())return G.get(J);else if(I>=0)return G.get(I)}function B(D,E,F){var G;switch(F){case r:return C(D,E,F);default:return l((G={},G[F]=D,G))}}function C(D,E,F){__p&&__p();var G="Needs Attention",H="Up For Grabs",I="Waiting",J=function J(K){var L=c("OzHelpers").isOwner(K,E),M=K.get("ready")||c("OzHelpers").hasPaid(K)||c("OzHelpers").hasReminder(K),N=c("OzHelpers").isLocker(K,E),O=c("OzHelpers").hasOpenIntents(K);return L&&(N||M&&O)?G:M?H:I};return l().withMutations(function(K){K.set(G,[]);K.set(H,[]);K.set(I,[]);D.forEach(function(L){return K.update(J(L),function(M){M.push(L);return M})})}).map(function(K){return m(K)})}f.exports=c("OzWrapper.react")(y)}),null);
__d("StickerContextualDialog.react",["cx","ContextualLayerAutoFlipHorizontal","ReactAbstractContextualDialog","ReactLayer"],(function a(b,c,d,e,f,g,h){"use strict";var i=7,j=c("ReactLayer").createClass(c("ReactAbstractContextualDialog").createSpec({addedBehaviors:[c("ContextualLayerAutoFlipHorizontal")],displayName:"StickerXUIContextualDialog",theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:i,length:16}}}));j.WIDTH={NORMAL:312,WIDE:400};f.exports=j}),null);
__d("ChatStickerButton.react",["cx","fbt","BootloadedComponent.react","JSResource","Link.react","React","StickerContextualDialog.react","StickersActions","StickersStateStore","XUISpinner.react","emptyFunction","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=278;j=babelHelpers.inherits(n,c("React").PureComponent);k=j&&j.prototype;function n(o){__p&&__p();k.constructor.call(this,o);this.$ChatStickerButton1=false;this.renderLayers=function(){if(!this.state.shown)return null;var p=this.props.ContextualDialogClass;return c("React").createElement(p,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link}.bind(this),onBeforeHide:this.$ChatStickerButton5,onBlur:this.$ChatStickerButton3,position:"above",shown:this.state.shown,width:this.props.flyoutWidth,key:"contextualDialog"},c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",{style:{padding:"30px",textAlign:"center"}},c("React").createElement(c("XUISpinner.react"),{size:"large"})),bootloadLoader:c("JSResource")("StickersFlyout.react").__setRef("ChatStickerButton.react"),className:this.props.flyoutClassName,onShown:function(q){if(this.props.onFlyoutShown)this.props.onFlyoutShown(q)}.bind(this),onHidden:function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden()}.bind(this),onEscKeyDown:this.$ChatStickerButton3,onStickerSelect:this.$ChatStickerButton6,onEmoticonSelect:this.$ChatStickerButton7,shown:this.state.shown}))}.bind(this);this.$ChatStickerButton4=function(){this.$ChatStickerButton1=this.state.shown}.bind(this);this.showFlyout=function(p){p&&p.stopPropagation();if(this.$ChatStickerButton1||this.props.disabled){this.$ChatStickerButton1=false;return}c("StickersActions").showStickerFlyout(this.props.threadID)}.bind(this);this.$ChatStickerButton5=function(){if(this.state.shown)this.$ChatStickerButton3()}.bind(this);this.$ChatStickerButton3=function(){c("StickersActions").hideStickerFlyout()};this.$ChatStickerButton6=function(p){this.props.onStickerSelect(p)}.bind(this);this.$ChatStickerButton7=function(p){this.$ChatStickerButton3();this.props.onEmoticonSelect(p)}.bind(this);this.state={shown:!!o.clicked}}n.prototype.componentDidMount=function(){__p&&__p();this.props.onLoad&&this.props.onLoad(this);this.$ChatStickerButton2=c("StickersStateStore").addListener(function(){__p&&__p();var o=c("StickersStateStore").getState();if(o.get("showFlyout")&&o.get("threadID")===this.props.threadID){if(this.$ChatStickerButton1||this.props.disabled){this.$ChatStickerButton1=false;return}this.setState({shown:true})}else{var p=this.props.getInput&&this.props.getInput();p&&p.focus&&p.focus();this.setState({shown:false})}}.bind(this))};n.prototype.componentWillUnmount=function(){if(this.state.shown)this.$ChatStickerButton3();this.$ChatStickerButton2&&this.$ChatStickerButton2.remove()};n.prototype.render=function(){return c("React").createElement("span",null,c("React").createElement(c("Link.react"),{className:c("joinClasses")(this.props.className,this.state.shown?"open":""),href:"#",onClick:this.showFlyout,onMouseDown:this.$ChatStickerButton4,role:"button",title:i._("Elegir un sticker"),ref:"link"}),this.renderLayers())};n.propTypes={className:l.string,clicked:l.bool,ContextualDialogClass:l.func.isRequired,disabled:l.bool,flyoutClassName:l.string,flyoutWidth:l.number,getInput:l.func,onLoad:l.func,onStickerSelect:l.func.isRequired,onEmoticonSelect:l.func.isRequired,onFlyoutShown:l.func,onFlyoutHidden:l.func,threadID:l.string};n.defaultProps={clicked:false,ContextualDialogClass:c("StickerContextualDialog.react"),disabled:false,flyoutWidth:m,onStickerSelect:c("emptyFunction"),onEmoticonSelect:c("emptyFunction")};f.exports=n}),null);
__d("PhotocropConstraintConstants",[],(function a(b,c,d,e,f,g){var h={BOUNDARY:"boundary",SQUARE:"square",WIDE:"wide"};h.getAspectRatioForType=function(i){switch(i){case h.SQUARE:return 1;case h.WIDE:return 16/9;default:return null}};f.exports=h}),null);
__d("PhotocropConstraint",["Vector","PhotocropConstraintConstants","clamp"],(function a(b,c,d,e,f,g){__p&&__p();var h,i,j,k;function l(p){"use strict";this.photocrop=p;this.pos=null}l.prototype.onMouseMove=function(p,q,r){"use strict";var s=p.sub(this.pos);if(q)this.onResize(s,r);else this.onMove(s);this.pos=this.pos.add(s)};l.prototype.onMouseDown=function(p){"use strict";this.pos=p};l.prototype.onResize=function(p,q){"use strict"};l.prototype.onMove=function(p){"use strict";var q=this.photocrop.box,r=this.photocrop.wrapper.offsetWidth,s=this.photocrop.wrapper.offsetHeight;p.x=c("clamp")(p.x,-q.l,r-q.r);p.y=c("clamp")(p.y,-q.t,s-q.b);this.photocrop.box=q.add(p)};h=babelHelpers.inherits(m,l);i=h&&h.prototype;m.prototype.onResize=function(p,q){"use strict";__p&&__p();var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight;switch(q){case"ne":t.r+=p.x=c("clamp")(p.x,t.l+r-t.r,u-t.r);t.t+=p.y=c("clamp")(p.y,-t.t,t.b-s-t.t);break;case"nw":t.l+=p.x=c("clamp")(p.x,-t.l,t.r-r-t.l);t.t+=p.y=c("clamp")(p.y,-t.t,t.b-s-t.t);break;case"se":t.r+=p.x=c("clamp")(p.x,t.l+r-t.r,u-t.r);t.b+=p.y=c("clamp")(p.y,t.t+s-t.b,v-t.b);break;case"sw":t.l+=p.x=c("clamp")(p.x,-t.l,t.r-r-t.l);t.b+=p.y=c("clamp")(p.y,t.t+s-t.b,v-t.b);break}};function m(){"use strict";h.apply(this,arguments)}j=babelHelpers.inherits(n,l);k=j&&j.prototype;n.prototype.setRatio=function(p){"use strict";this.ratio=p;return this};n.prototype.onMouseDown=function(p){"use strict";k.onMouseDown.call(this,p);var q=this.photocrop.box,r=q.r-q.l,s=q.b-q.t;this.displacement=new(c("Vector"))(r,s)};n.prototype.$AspectRatioConstraint1=function(p,q,r,s,t,u){"use strict";__p&&__p();var v,w,x,y,z;v=this.displacement.x/this.displacement.y;w=y=c("clamp")(q,p,r);x=z=c("clamp")(t,s,u);if(v>this.ratio){x=c("clamp")(w/this.ratio,s,u);w=x*this.ratio}else{w=c("clamp")(x*this.ratio,p,r);x=w/this.ratio}return new(c("Vector"))(w,x)};n.prototype.onResize=function(p,q){"use strict";__p&&__p();var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight,w;switch(q){case"ne":this.displacement=this.displacement.add(p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,t.b);t.r=t.l+w.x;t.t=t.b-w.y;break;case"nw":this.displacement=this.displacement.add(-p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,t.b);t.l=t.r-w.x;t.t=t.b-w.y;break;case"se":this.displacement=this.displacement.add(p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,v-t.t);t.r=t.l+w.x;t.b=t.t+w.y;break;case"sw":this.displacement=this.displacement.add(-p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,v-t.t);t.l=t.r-w.x;t.b=t.t+w.y;break}};function n(){"use strict";j.apply(this,arguments)}function o(p,q){var r;switch(q){case c("PhotocropConstraintConstants").BOUNDARY:r=new m(p);break;case c("PhotocropConstraintConstants").WIDE:case c("PhotocropConstraintConstants").SQUARE:r=new n(p).setRatio(c("PhotocropConstraintConstants").getAspectRatioForType(q));break;default:throw Error("unsupported PhotocropConstraint type")}return r}f.exports=o}),null);
__d("Photocrop2",["ArbiterMixin","PhotocropConstraintConstants","CSS","DOM","Event","PhotosConst","Rect","Style","Vector","mixin","PhotocropConstraint"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("mixin")(c("ArbiterMixin")));i=h&&h.prototype;function j(k,l,m){"use strict";__p&&__p();i.constructor.call(this);this.photo=k;var n=this.getPhotoDimensions();if(m)this.imageDimensions=new(c("Vector"))(m.x,m.y);else this.imageDimensions=new(c("Vector"))(n.x,n.y);l.height=l.height||c("PhotosConst").PIC_NORMAL_FBX_SIZE;l.width=l.width||c("PhotosConst").PIC_NORMAL_FBX_SIZE;Object.assign(this,{target:this.photo.parentNode,create_target:false,target_parent:this.photo.parentNode,min_width:c("PhotosConst").PIC_NORMAL_FBX_SIZE,min_height:c("PhotosConst").PIC_NORMAL_FBX_SIZE,center_x:(n.x||l.width)/2,center_y:(n.y||l.height)/2,constraint_type:c("PhotocropConstraintConstants").BOUNDARY},l);this._unscaledMinHeight=this.min_height;this._unscaledMinWidth=this.min_width;this._unscaledHeight=this.height;this._unscaledWidth=this.width;this.setInitialDimensionsAndPos();if(this.create_target){this.target=c("DOM").create("div");c("CSS").addClass(this.target,"stageCropper");this.target_parent.appendChild(this.target)}c("CSS").addClass(this.target,"photocrop");["bg","wrapper","viewport"].forEach(function(o){this[o]=c("DOM").create("div");c("CSS").addClass(this[o],o)}.bind(this));this.highlight=c("DOM").create("img");c("CSS").addClass(this.highlight,"highlight");this.setHighlightSource();c("CSS").addClass(this.wrapper,"photocropWrapper");this.target.appendChild(this.bg);this.target.appendChild(this.wrapper);this.wrapper.appendChild(this.highlight);this.wrapper.appendChild(this.viewport);["ne","nw","sw","se"].forEach(function(o){var p=c("DOM").create("div");c("CSS").addClass(p,o);p.setAttribute("data-cropcorner",o);this.viewport.appendChild(p);c("CSS").addClass(p,"profilePicViewportGrabby")}.bind(this));c("Event").listen(this.viewport,{mousedown:this.mousedown.bind(this),dragstart:c("Event").kill,selectstart:c("Event").kill,click:c("Event").stop});c("Event").listen(document,{mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)});c("Event").listen(window,{resize:this.adjustForResize.bind(this)});this.realignToPictureSize();this.redraw()}j.prototype.setInitialDimensionsAndPos=function(){"use strict";__p&&__p();this._constraint=c("PhotocropConstraint")(this,this.constraint_type);var k=c("PhotocropConstraintConstants").getAspectRatioForType(this.constraint_type),l=this.getPhotoDimensions();if(k){this._unscaledMinHeight=this._unscaledMinWidth/k;this._unscaledHeight=this._unscaledWidth/k}this.setNewRatio();var m=Math.min(this.width,l.x),n=Math.min(this.height,l.y);this.min_width=Math.min(this.min_width,l.x);this.min_height=Math.min(this.min_height,l.y);if(k)if(l.x/l.y>k){n=Math.min(n,l.y);m=n*k;this.min_width=this.min_height*k}else{m=Math.min(m,l.x);n=m/k;this.min_height=this.min_width/k}var o=this.center_x-m/2,p=this.center_y-n/2;this.box=new(c("Rect"))(p,o+m,p+n,o)};j.prototype.getPhotoDimensions=function(){"use strict";return new(c("Vector"))(Math.round(parseFloat(c("Style").get(this.photo,"width"))),Math.round(parseFloat(c("Style").get(this.photo,"height"))))};j.prototype.getPhotoPosition=function(){"use strict";return new(c("Vector"))(this.photo.offsetLeft,this.photo.offsetTop)};j.prototype.setHighlightSource=function(){"use strict";this.highlight.src=this.photo.src};j.prototype.setConstraintType=function(k){"use strict";this.constraint_type=k;this.setInitialDimensionsAndPos();this.adjustForResize()};j.prototype.adjustForResize=function(){"use strict";var k=this.ratio,l=this.setNewRatio(),m=l/k;this.box.t*=m;this.box.l*=m;this.box.b*=m;this.box.r*=m;this.redraw();this.realignToPictureSize()};j.prototype.setNewRatio=function(){"use strict";this.ratio=this.getPhotoDimensions().x/this.imageDimensions.x;this.min_width=this.ratio*this._unscaledMinWidth;this.min_height=this.ratio*this._unscaledMinHeight;this.width=Math.max(1,this.ratio)*this._unscaledWidth;this.height=Math.max(1,this.ratio)*this._unscaledHeight;return this.ratio};j.prototype.realignToPictureSize=function(){"use strict";__p&&__p();var k=this.photo;if(!k)return;var l=this.getPhotoDimensions(),m=this.getPhotoPosition();[this.bg,this.wrapper].forEach(function(n){n.style.width=l.x+"px";n.style.height=l.y+"px";n.style.top=m.y+"px";n.style.left=m.x+"px"})};j.prototype.redraw=function(){"use strict";var k=[this.box.t,this.box.r,this.box.b,this.box.l],l=this.getPhotoDimensions();this.highlight.style.width=l.x+"px";this.highlight.style.height=l.y+"px";this.highlight.style.clip="rect("+k.join("px ")+"px)";this.viewport.style.top=this.box.t+"px";this.viewport.style.left=this.box.l+"px";this.viewport.style.height=this.box.b-this.box.t+"px";this.viewport.style.width=this.box.r-this.box.l+"px"};j.prototype.done=function(k){"use strict";__p&&__p();this.freezeViewport=true;if(!k){[this.bg,this.wrapper].forEach(c("DOM").remove);if(this.create_target){c("DOM").remove(this.target);this.target=null}else c("CSS").removeClass(this.target,"photocrop")}var l=Math.round(this.box.l*(1/this.ratio)),m=Math.round(this.box.t*(1/this.ratio)),n=Math.round(this.box.r*(1/this.ratio)),o=Math.round(this.box.b*(1/this.ratio));this.inform("done",k);return{x:Math.max(l,0),y:Math.max(m,0),width:n-Math.max(l,0),height:o-Math.max(m,0)}};j.prototype.reset=function(){"use strict";this.freezeViewport=false};j.prototype.mousedown=function(k){"use strict";if(this.freezeViewport)return;this.mouseTarget=k.getTarget();this._constraint.onMouseDown(c("Vector").getEventPosition(k));c("CSS").addClass(document.body,"draggingMode");return false};j.prototype.mousemove=function(k){"use strict";if(!this.mouseTarget)return;this._constraint.onMouseMove(c("Vector").getEventPosition(k),this.mouseTarget!==this.viewport,this.mouseTarget.getAttribute("data-cropcorner"));this.redraw();return false};j.prototype.mouseup=function(k){"use strict";this.mouseTarget=null;c("CSS").removeClass(document.body,"draggingMode")};f.exports=j}),null);
__d("OzPhotoCropper.react",["cx","OzHelpers","BasicVector","Photocrop2","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={imageSize:null},this.finalizeCrop=function(r){var s=this.refs.canvas,t=this.$OzPhotoCropper2.done(r),u=t.x,v=t.y,w=t.height,x=t.width;s.width=x;s.height=w;s.getContext("2d").drawImage(this.$OzPhotoCropper1,Math.max(0,u),Math.max(0,v),x,w,0,0,x,w);return c("OzHelpers").blobFromDataURI(s.toDataURL())}.bind(this),n}l.prototype.componentDidMount=function(){"use strict";this.$OzPhotoCropper1=new Image();this.$OzPhotoCropper1.src=this.props.src;this.$OzPhotoCropper1.onload=function(m){var n=new(c("BasicVector"))(this.$OzPhotoCropper1.width,this.$OzPhotoCropper1.height);this.setState({imageSize:n});this.$OzPhotoCropper2=new(c("Photocrop2"))(this.refs.img,{},n)}.bind(this)};l.prototype.componentWillUnmount=function(){"use strict";this.$OzPhotoCropper1=null};l.prototype.render=function(){"use strict";return c("React").createElement("div",{className:"_3x2x"},c("React").createElement("canvas",{ref:"canvas",style:{display:"none"}}),c("React").createElement("img",{src:this.props.src,ref:"img",className:"_3x2y"}))};l.propTypes={src:k.string.isRequired};f.exports=l}),null);
__d("OzAttachmentCropper.react",["OzHelpers","DialogFitHeight","immutable","OzPhotoCropper.react","OzImmutablePureRenderMixin","React","XUIButton.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react"],(function a(b,c,d,e,f,g){var h=c("immutable").Map,i=c("immutable").OrderedMap,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzAttachmentCropper",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{attachment:j.instanceOf(h).isRequired,onSave:j.func.isRequired,onClose:j.func.isRequired},_handleSubmit:function l(){var m=this.props,n=m.attachment,o=m.onSave,p=this.refs.photoCropper.finalizeCrop();o(n.set("ui-blob",p))},render:function l(){return c("React").createElement(c("XUIDialog.react"),{behaviors:{DialogFitHeight:c("DialogFitHeight")},onToggle:this.props.onClose,shown:true,width:900},c("React").createElement(c("XUIDialogTitle.react"),null,c("React").createElement("span",null,"Crop tool")),c("React").createElement(c("XUIDialogBody.react"),null,c("React").createElement(c("OzPhotoCropper.react"),{src:c("OzHelpers").blobURI(this.props.attachment.get("ui-blob")),ref:"photoCropper"})),c("React").createElement(c("XUIDialogFooter.react"),null,c("React").createElement(c("XUIButton.react"),{onClick:this._handleSubmit,label:"Crop"})))}});f.exports=k}),null);
__d("OzAttachmentOverlay.react",["cx","joinClasses","OzLoading.react","OzImmutablePureRenderMixin","React","XUICloseButton.react","XUIEditButton.react"],(function a(b,c,d,e,f,g,h){var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzAttachmentOverlay",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onClick:i.func,onEdit:i.func,onRemove:i.func,loading:i.bool},render:function k(){var l=this.props,m=l.onClick,n=l.onEdit,o=l.onRemove,p=l.loading;return c("React").createElement("div",{className:c("joinClasses")(this.props.className,"_18wc")},p?c("React").createElement(c("OzLoading.react"),null):null,c("React").createElement("div",{className:"_4xe8",onClick:m,role:"presentation"},n?c("React").createElement(c("XUIEditButton.react"),{className:"_1yll",type:"button",size:"medium",title:"Add Image",onClick:this._handleEdit}):null,o?c("React").createElement(c("XUICloseButton.react"),{type:"button",className:"_1ylm",size:"medium",shade:"dark",onClick:this._handleRemove}):null),this.props.children)},_handleEdit:function k(l){l.stopPropagation();this.props.onEdit&&this.props.onEdit()},_handleRemove:function k(l){l.stopPropagation();this.props.onRemove&&this.props.onRemove()}});f.exports=j}),null);
__d("OzBubbleImageSelector.react",["cx","Image.react","immutable","OzAttachmentOverlay.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("immutable").List,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzBubbleImageSelector",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onImageAdd:j.func.isRequired,onImageSelect:j.func.isRequired,selectedURI:j.string,thumbURIs:j.instanceOf(i).isRequired},render:function m(){var n=this.props,o=n.onImageSelect,p=n.selectedURI,q=n.thumbURIs;return c("React").createElement("div",{className:"_1-i2"},q.map(function(r,s){return c("React").createElement(l,{index:s,isSelected:r===p,key:s,onSelect:o,uri:r})}),this._renderAddButton())},_renderAddButton:function m(){return c("React").createElement("button",{type:"button",className:"_1-hv _1-i4",onClick:this.props.onImageAdd},"+")}}),l=c("React").createClass({displayName:"Thumbnail",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{index:j.number.isRequired,isSelected:j.bool.isRequired,uri:j.string.isRequired},render:function m(){return c("React").createElement(c("OzAttachmentOverlay.react"),{className:this.props.isSelected?"_4-8e":"",onClick:this._handleSelect},c("React").createElement(c("Image.react"),{src:this.props.uri,className:"_1-i3",alt:"image thumb"}))},_handleSelect:function m(){this.props.onSelect(this.props.uri)}});f.exports=k}),null);
__d("OzFormPreview.react",["cx","OzHelpers","joinClasses","React","Tooltip"],(function a(b,c,d,e,f,g,h){var i=c("OzHelpers").pure(function(k){var l=k.children;return c("React").createElement("div",{className:"_5bwr"},l)}),j=c("OzHelpers").pure(function(k){var l=k.label,m=k.tip,n=k.children,o=k.className;if(!n)return null;return c("React").createElement("div",{className:c("joinClasses")("_5bws _5bwt",o)},c("React").createElement("div",{className:"_5bwv"},l),c("React").createElement("div",babelHelpers["extends"]({className:"_5bx2"},c("Tooltip").propsFor(m)),n))});i.Row=j;f.exports=i}),null);
__d("OzBubblePreview.react",["cx","OzAPI","OzHelpers","formatDate","AdsCurrencyFormatter","immutable","OzConfig","OzFormPreview.react","OzStores","OzActions","OzConstants","OzImmutablePureRenderMixin","React","Reflux","ShimButton.react","TextWithHighlights.atlas","XUIContextualDialog.react"],(function a(aa,b,ba,ca,c,da,ea){__p&&__p();var d=b("OzConstants").ATTS,e=b("immutable").Map,f=b("immutable").List,g=b("React").PropTypes,h=b("OzFormPreview.react").Row,i=b("OzStores").AutopilotStore,j=b("React").createClass({displayName:"OzBubblePreview",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{bubble:g.instanceOf(e).isRequired,highlight:g.string,meta:g.instanceOf(e),source:g.string},render:function Q(){return F(this.props)?b("React").createElement(o,this.props):b("React").createElement(k,this.props)}}),k=b("OzHelpers").pure(function(Q){var R=Q.bubble,S=Q.highlight,T=null;if(Number.isSafeInteger(R.get("amount")))T=b("AdsCurrencyFormatter").formatCurrencyFullFormat(R.get("currency"),R.get("amount"));return b("React").createElement(A,{thumbURL:R.get("thumb-url")},b("React").createElement(C,{text:R.get("name"),highlight:S}),b("React").createElement(D,null,b("React").createElement(E,{color:"grey",highlight:S},R.get("description")||"No Description")),b("React").createElement(D,null,b("React").createElement(E,null,R.get("merchant-name")||"No Merchant")),b("React").createElement(D,null,b("React").createElement(E,{color:"blue",weight:"bold"},T)))}),l="__overviewTab",m="__hoursTab",n="__moreInfoTab",o=b("React").createClass({displayName:"PlacesPreview",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(i,"autopilot"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{bubble:g.instanceOf(e).isRequired,meta:g.instanceOf(e).isRequired,highlight:g.string},getInitialState:function Q(){return{shown:false,activeTab:l}},_makeOpentableRequest:function Q(R,S){if(!this.state.config.getIn(["GK","openTableAPI"])){var T=M(R);if(T){var U=q(R,S);if(!U)b("OzAPI").requestAutopilot(T.toJS())}}},componentWillMount:function Q(){this._makeOpentableRequest(this.props.meta,this.state.autopilot);window.clearTimeout(this.timeout)},componentWillReceiveProps:function Q(R){var S=R.meta;if(N(S)!==N(this.props.meta))this._makeOpentableRequest(S,this.state.autopilot)},_handleToggle:function Q(R){window.clearTimeout(this.timeout);var S=function(T){return this.setState({shown:R,activeTab:l})}.bind(this);R?S():this.timeout=window.setTimeout(S,100)},render:function Q(){var R=this.props,S=R.bubble,T=R.meta,U=R.highlight,V=this.state,W=V.shown,X=V.activeTab,Y=V.autopilot,Z=V.config;return b("React").createElement("div",{ref:"root",tabIndex:"0",onMouseEnter:function($){return this._handleToggle(true)}.bind(this),onMouseLeave:function($){return this._handleToggle(false)}.bind(this)},b("React").createElement(A,{thumbURL:S.get("thumb-url")},b("React").createElement(C,{text:S.get("name"),highlight:U}),b("React").createElement(p,{rating:T.get("rating")}),b("React").createElement(D,null,b("React").createElement(E,null,T.get("cuisine")),"\xa0",b("React").createElement(E,null,T.get("price"))),b("React").createElement(D,null,b("React").createElement(r,{meta:T,autopilot:Y}))),b("React").createElement(s,babelHelpers["extends"]({activeTab:X,contextRef:function($){return this.refs.root}.bind(this),onTabChange:this._handleTabChange,shown:W,onToggle:this._handleToggle,autopilot:Y,config:Z},this.props)))},_handleTabChange:function Q(R){this.setState({activeTab:R})}}),p=b("OzHelpers").pure(function(Q){var R=Q.rating;return R?b("React").createElement(D,null,b("React").createElement(E,{weight:"500"},R.get("value"),"/",R.get("scale"))," ",b("React").createElement(E,{color:"grey"},R.get("rating-count")?"("+R.get("rating-count")+" reviews)":null)):null}),q=function q(Q,R){var S=M(Q);if(S)if(b("OzConfig").getInStaticConfig(["GK","openTableAPI"]))return S.getIn(["data","times"]);else return R.get(S.getIn(["data","id"]));return null},r=b("OzHelpers").pure(function(Q){var R=Q.meta,S=Q.autopilot,T=M(R);if(!T)return b("React").createElement(E,null,"No OT info");var U=q(R,S);if(!U)return b("React").createElement(E,null,"Checking OT...");if(U.size===0)return b("React").createElement(E,{color:"red"},"No Tables Available!");return b("React").createElement(E,null,"Table at ",K(R,U))}),s=b("OzHelpers").pure(function(Q){var R=Q.activeTab,S=Q.contextRef,T=Q.meta,U=Q.onTabChange,V=Q.onToggle,W=Q.shown,X=babelHelpers.objectWithoutProperties(Q,["activeTab","contextRef","meta","onTabChange","onToggle","shown"]);return b("React").createElement(b("XUIContextualDialog.react"),{contextRef:S,hoverHideDelay:0,position:"above",shown:W,hasActionableContext:true},b("React").createElement("div",{className:"_53qb",onMouseEnter:function Y(Z){return V(true)},onMouseLeave:function Y(Z){return V(false)}},b("React").createElement("div",{className:"_c38"},b("React").createElement(t,babelHelpers["extends"]({meta:T},X)),b("React").createElement(z,{tabs:[["Overview",l],["Hours",m],["More Info",n]],active:R,onChange:U})),b("React").createElement(u,babelHelpers["extends"]({activeTab:R,meta:T},X))))}),t=b("OzHelpers").pure(function(Q){var R=Q.bubble,S=Q.meta,T=Q.highlight;return b("React").createElement("div",{className:"_53qc"},b("React").createElement(B,{url:R.get("thumb-url")}),b("React").createElement("div",{className:"_53qd"},b("React").createElement(C,{text:R.get("name"),highlight:T}),b("React").createElement(p,{rating:S.get("rating")}),b("React").createElement(D,null,b("React").createElement(E,null,S.get("cuisine"))),b("React").createElement(D,null,b("React").createElement(E,null,S.get("price")))))}),u=b("OzHelpers").pure(function(Q){var R=Q.activeTab,S=babelHelpers.objectWithoutProperties(Q,["activeTab"]);return b("React").createElement("div",{className:"_53qe"},R===l&&b("React").createElement(v,S)||R===m&&b("React").createElement(x,S)||R===n&&b("React").createElement(y,S)||null)}),v=b("OzHelpers").pure(function(Q){var R=Q.bubble,S=Q.highlight,T=Q.meta,U=Q.autopilot,V=Q.config,W=(T.getIn(["address","street"],"")+"\n     "+T.getIn(["address","city"],"")+"\n    ").trim();return b("React").createElement(b("OzFormPreview.react"),null,b("React").createElement(h,{label:"Address"},W),b("React").createElement(h,{label:"Phone"},w(R,T)),b("React").createElement(h,{label:"Website"},b("React").createElement("a",{href:R.get("target-url"),target:"_blank",rel:"noopener noreferrer"},"Link")),b("React").createElement(h,{label:"OpenTable"},H(R,T,U)),V.getIn(["GK","yelpLink"])?b("React").createElement(h,{label:"Yelp"},b("React").createElement("a",{href:T.get("yelp-url"),target:"_blank",rel:"noopener noreferrer"},"Link")):null,b("React").createElement(h,{label:"Description"},R.get("description")))}),w=function w(Q,R){var S=R.get("phone");return S?b("React").createElement(E,{weight:"bold"},b("OzHelpers").parsePhoneNumber(S)):null},x=b("OzHelpers").pure(function(Q){var R=Q.meta;return b("React").createElement(b("OzFormPreview.react"),null,J(R.get("hours")||f()).map(function(S,T){return b("React").createElement(h,{key:T,label:T},S)}).valueSeq())}),y=b("OzHelpers").pure(function(Q){__p&&__p();var R,S=Q.bubble,T=Q.meta,U=T.get("payment"),V=T.get("infos");if(U&&U.size||V&&V.size){var R=function(){var W=function W(X){return X[0].toUpperCase()+X.slice(1).toLowerCase()};return{v:b("React").createElement(b("OzFormPreview.react"),null,V.map(function(X,Y){return b("React").createElement(h,{label:W(Y),key:Y},X)}).toList(),U?b("React").createElement(h,{label:"Payments"},U.map(W).toJS().join(", ")):null)}}();if(typeof R==="object")return R.v}else return b("React").createElement("div",null,"No additional info for this place...")}),z=b("OzHelpers").pure(function(Q){var R=Q.tabs,S=Q.onChange,T=Q.active;return b("React").createElement("div",{className:"_c39"},R.map(function(U){var V=U[0],W=U[1],X=W===T?{weight:"bold",color:"blue"}:{color:"grey"};return b("React").createElement("button",{key:W,role:"button",className:"_1-hv",onClick:function Y(Z){return S(W)}},b("React").createElement(E,X,V))}))}),A=b("OzHelpers").pure(function(Q){var R=Q.children,S=Q.thumbURL;return b("React").createElement("div",{className:"_1q15 _5rxk"},b("React").createElement(B,{url:S}),b("React").createElement("div",{className:"_1q17"},R))}),B=b("OzHelpers").pure(function(Q){var R=Q.url;return R?b("React").createElement("div",{className:"_1q16",style:{backgroundImage:"url('"+R+"')"}}):null}),C=b("OzHelpers").pure(function(Q){var R=Q.text,S=Q.highlight;return b("React").createElement(D,null,b("React").createElement(E,{weight:"bold",highlight:S},R||"No Title"))}),D=b("OzHelpers").pure(function(Q){var R=Q.children;return b("React").createElement("div",{className:"_4-_7 _5rxl"},R)}),E=b("OzHelpers").pure(function(Q){var R=Q.children,S=Q.color,T=Q.highlight,U=Q.size,V=Q.weight,W=V===undefined?"normal":V;return R?b("React").createElement("span",{className:"_5rxm"+(U==="large"?" _5rxn":"")+(S==="blue"?" _5ryf":"")+(S==="grey"?" _5ryk":"")+(S==="red"?" _5emd":"")+(S==="green"?" _5emf":""),style:{fontWeight:W}},T?b("React").createElement(b("TextWithHighlights.atlas"),{text:R,highlight:T}):R):null});function F(Q){var R=Q.meta,S=Q.source;return S==="places"&&R}function G(Q,R,S){b("OzActions").selectAIPick(e({type:d.OPENTABLEQR,bubble:Q,meta:R,"ui-body":S.count()>1?"Here are available times for today: "+P(S):"The only available time for today is "+P(S),quickreplies:O(S)}))}function H(Q,R,S){__p&&__p();var T,U=R.get("open-table");if(U){var V,T=function(){var W=q(R,S);if(W)if(W.size===0)V=b("React").createElement(E,{color:"red"},"No tables available!");else V=b("React").createElement(E,null,"Tables available at "+P(W));return{v:b("React").createElement("div",null,b("React").createElement("a",{href:U.get("url"),target:"_blank",rel:"noopener noreferrer"},"Link (",U.get("area"),")"),b("React").createElement("br",null),V,W&&W.size?b("React").createElement("span",null,b("React").createElement("br",null),b("React").createElement(b("ShimButton.react"),{form:"link",onClick:function X(){return G(Q,R,W)}},"Suggest via quickreplies")):null)}}();if(typeof T==="object")return T.v}return null}var I=f(["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"]);function J(Q){__p&&__p();var R=function R(){var W=new Date(b("OzHelpers").serverNow());W.setHours(0,0,0,0);W.setDate(W.getDate()-W.getDay()+1);return+W},S=R(),T=function T(W){return new Date(S+W*60*1e3)},U=function U(W){return b("formatDate")(W,"h:i A",{skipPatternLocalization:true})},V=function V(W){return W.map(U).join(" - ")};return Q.map(function(W){return W.map(T)}).groupBy(function(W){return W.get("start").getDay()}).mapKeys(function(W){return I.get(W)}).map(function(W){return W.map(V).join(", ")})}function K(Q,R){var S=function S(U){var V=U.split(":"),W=V[0],X=V[1];return parseInt(X,10)+parseInt(W,10)*60},T=S(Q.getIn(["open-table","availability","data","hour"]));return L(R.map(function(U){return U.get("hour")}).minBy(function(U){return Math.abs(T-S(U))}))}function L(Q){var R=Q.split(":"),S=R[0],T=R[1];S=parseInt(S,10);if(S===0)return"12:"+T+"AM";else if(S<12)return Q+"AM";else if(S===12)return Q+"PM";else return S-12+":"+T+"PM"}function M(Q){return Q.getIn(["open-table","availability"])}function N(Q){return Q.getIn(["open-table","availability","data","id"])}function O(Q){var R=Q.count()>1?"None of these times work for me":"This time doesn't work for me";return Q.map(function(S){return L(S.get("hour"))}).push(R)}function P(Q){return Q.map(function(R){return L(R.get("hour"))}).toJS().join(", ")}c.exports=j}),null);
__d("OzMerchantDialog.react",["cx","OzHelpers","immutable","Layout.react","MessengerDialog.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","React","ReactDOM","XUIDatePicker.react","XUIError.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("Layout.react").Column,l=c("Layout.react").FillColumn,m=c("React").PropTypes,n=c("immutable").Map,o=c("immutable").Set,p=o(["name-dba","name-legal","website","phone","address","page-id","country","type","owner-name"]),q=n({country:"US"});i=babelHelpers.inherits(r,c("React").Component);j=i&&i.prototype;function r(t){"use strict";j.constructor.call(this,t);s.call(this);var u=t.initialMerchant,v=q.filterNot(function(w,x){return u.get(x)});this.state={inputs:v,errors:n()}}r.prototype.componentDidMount=function(){"use strict";var t=c("ReactDOM").findDOMNode(this.refs["name-dba"]);t&&t.focus()};r.prototype.render=function(){"use strict";return c("React").createElement(c("MessengerDialog.react"),{className:"_18w8",onToggle:this.$OzMerchantDialog1,ref:"dialog",type:"default",width:544},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,this.props.title)),this.$OzMerchantDialog2(),c("React").createElement("div",null,this.$OzMerchantDialog3("Save",this.$OzMerchantDialog4),this.$OzMerchantDialog3("Cancel",c("OzActions").hideDialog)))};r.propTypes={onMerchant:m.func.isRequired,title:m.string,initialMerchant:m.instanceOf(n)};r.defaultProps={title:"Create a merchant",initialMerchant:n()};var s=function s(){__p&&__p();this.$OzMerchantDialog3=function(t,u){return c("React").createElement("button",{onClick:u,className:"_bx0 _3e2t _30yy"},t)};this.$OzMerchantDialog2=function(){return c("React").createElement("div",{className:"_374d _18w9"},this.$OzMerchantDialog5("name-dba","Name *"),this.$OzMerchantDialog5("name-legal","Legal Name"),this.$OzMerchantDialog5("website","Website"),this.$OzMerchantDialog5("phone","Phone"),this.$OzMerchantDialog5("address","Address"),this.$OzMerchantDialog5("page-id","Facebook Page Id"),this.$OzMerchantDialog5("country","Country *"),this.$OzMerchantDialog5("type","Business Type"),this.$OzMerchantDialog5("owner-name","Owner Name"),this.$OzMerchantDialog6("owner-birth-date","Owner Birth Date"))}.bind(this);this.$OzMerchantDialog5=function(t,u){var v=this.props.initialMerchant,w=this.state,x=w.inputs,y=w.errors;return c("React").createElement(c("Layout.react"),{key:t},c("React").createElement(k,{className:"mrm _bx1"},u),c("React").createElement(l,null,c("React").createElement(c("XUIError.react"),{xuiError:y.get(t)||null},c("React").createElement("input",{ref:t,type:"text",className:"_7q5 _bx2",defaultValue:v.get(t),value:x.get(t),onChange:function(z){this.setState({inputs:x.set(t,z.target.value),errors:n()})}.bind(this)}))))}.bind(this);this.$OzMerchantDialog6=function(t,u){var v={},w=this.props.initialMerchant,x=w.get("owner-birth-date");if(x)v.initialTime=x;return c("React").createElement(c("Layout.react"),{key:t},c("React").createElement(k,{className:"mrm _bx1"},u),c("React").createElement(k,null,c("React").createElement(c("XUIDatePicker.react"),babelHelpers["extends"]({ref:t,shouldSetDefaultDate:false},v))))}.bind(this);this.$OzMerchantDialog4=function(){var t=this.$OzMerchantDialog7();if(t){t.id=this.props.initialMerchant.get("id");this.props.onMerchant(t)}}.bind(this);this.$OzMerchantDialog1=function(t){if(!t)c("OzActions").hideDialog()};this.$OzMerchantDialog7=function(){__p&&__p();var t=n(),u=this.props.initialMerchant,v=function(y){var z=this.state.inputs.get(y,undefined);if(z===undefined)return u.get(y);return z||null}.bind(this);t=n(p.map(function(y){return[y,v(y)]})).set("id",u.get("id"));var w=this.refs["owner-birth-date"].state.selectTime;t=t.set("owner-birth-date",w);t=c("OzHelpers").normalizeMerchant(t);var x=c("OzHelpers").validateMerchant(t);this.setState({errors:x});if(!x.isEmpty())return null;return t}.bind(this)};f.exports=r}),null);
__d("OzSetPicURLDialog.react",["cx","getURLRanges","OzHelpers","Image.react","Keys","MessengerDialog.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzImmutablePureRenderMixin","React","ReactDOM"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzSetPicURLDialog",mixins:[c("OzImmutablePureRenderMixin")],PropTypes:{onURL:i.func.isRequired,onEscape:i.func},componentDidMount:function k(){var l=c("ReactDOM").findDOMNode(this.refs.url);l&&l.focus()},getInitialState:function k(){return{errors:[],url:""}},render:function k(){return c("React").createElement(c("MessengerDialog.react"),{className:"_18w8",onToggle:this._handleToggle,ref:"dialog",type:"default",width:544},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,"Enter a URL for your picture")),this._renderImage(),this._renderErrors(),c("React").createElement("div",{className:"_374d _18w9"},c("React").createElement("input",{onChange:this._handleChange,onKeyDown:this._handleKeyDown,ref:"url",type:"text",className:"_7q5",placeholder:"URL to picture"})),c("React").createElement("div",{className:"_18wa"},"Press Enter when you're done."))},_renderImage:function k(){var l=this.state.url,m=this.state.errors||[];if(m.length>0||!l||l.length===0)return null;return c("React").createElement(c("Image.react"),{className:"_24p-",src:l})},_renderErrors:function k(){var l=this.state.errors;if(!l||l.length===0)return null;return c("React").createElement("div",{key:"errors",className:"_1yln"},l.map(function(m){var n=m[0],o=m[1];return c("React").createElement("div",{key:n,className:"_1ylp"},o)}))},_handleChange:function k(l){if(l.target.value.length&&!c("getURLRanges")(l.target.value).length){this.setState({errors:[["invalid_url","You must provide a valid uri"]]});return}var m=l.target.value.length?c("getURLRanges")(l.target.value)[0].entity.url:"";this.setState({errors:[],url:m})},_handleKeyDown:function k(l){__p&&__p();if(l.keyCode===c("Keys").ESC){var m=this.props.onEscape;if(m)m(l);return}var n=this.state.errors||[];if(n.length===0&&l.keyCode===c("Keys").RETURN){l.preventDefault();var o=l.target.value.length?c("getURLRanges")(l.target.value)[0].entity.url:"";this.props.onURL(o)}return},_handleToggle:function k(){c("OzHelpers").debug("[OzSetPicURLDialog] toggled",arguments)}});f.exports=j}),null);
__d("OzBubbleEditor.react",["cx","Promise","OzAPI","getURLRanges","OzHelpers","OzNotify","AdsCurrencyInput_DEPRECATED.react","immutable","Keys","OzActions","OzBubbleImageSelector.react","OzBubblePreview.react","OzConfig","OzMerchantDialog.react","OzSearchSource","OzSetPicURLDialog.react","OzImmutablePureRenderMixin","React","Reflux","SearchableDropdownInput.contrib","SearchableEntry","ShimButton.react","XUICloseButton.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").List,j=c("immutable").Map,k=c("React").PropTypes,l=["thumb-url"],m=["thumb-urls"],n=q("No Merchant"),o=69,p=c("React").createClass({displayName:"OzBubbleEditor",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{merchants:k.instanceOf(j).isRequired,seedBubble:k.instanceOf(j).isRequired,onSave:k.func.isRequired,onClose:k.func.isRequired},getInitialState:function u(){return{newData:j()}},componentWillMount:function u(){this._searchSource=new(c("OzSearchSource"))(function(v){var w=v.query||"",x=this.props.merchants.valueSeq().filter(function(y){return y.get("name-dba").toLowerCase().indexOf(w.toLowerCase())>-1}).map(function(y){return q(y.get("name-dba"))}).take(15).toArray();return c("Promise").resolve(this._data().get("merchant-name")?[n].concat(x):x)}.bind(this))},componentDidMount:function u(){this.focus("Title")},focus:function u(v){this.refs[v]&&this.refs[v].focus&&this.refs[v].focus()},render:function u(){return c("React").createElement("div",{className:"_1-ht"},c("React").createElement("div",{className:"_2zfj"},this._renderSection("Preview",this._renderPreview)),c("React").createElement("form",{className:"_2zfk",onKeyDown:function(v){v.keyCode===c("Keys").ESC&&this.props.onClose(this._bubble())}.bind(this),onSubmit:function(v){v.stopPropagation();v.preventDefault();this._handleSubmit()}.bind(this)},c("React").createElement(c("XUICloseButton.react"),{className:"_1-hu",shade:"dark",size:"medium",onClick:function(v){return this.props.onClose(this._bubble())}.bind(this)}),this._renderSection("Image",this._renderImage),this._renderSection("Title",this._renderInput.bind(this,["name"])),this._renderSection("Description",this._renderDescription),this._renderSection("URL",this._renderInput.bind(this,["target-url"])),this._renderSection("Merchant",this._renderMerchant),this._renderSection("Price",this._renderPrice),this._renderSubmit()))},_bubble:function u(){return this.props.seedBubble.set("data",this._data()).deleteIn(["data","thumb-urls"])},_data:function u(){var v=this.state.newData.updateIn(m,function(w){var x=this.props.seedBubble.getIn(["data"].concat(m));return(x||i()).concat(w)}.bind(this));return this.props.seedBubble.get("data").merge(v)},_handleSubmit:function u(){__p&&__p();var v=this._bubble(),w=v.get("data"),x=[[w.get("name"),"Please enter a title."],[w.get("expires-in")||!w.get("expiration-time"),"Since this bubble is old, please re-enter the expiration time."],[c("OzHelpers").validateURL(w.get("target-url")),'Please enter a valid url. Usually, you need to add "www."'],[c("OzHelpers").validateURL(w.get("thumb-url"))||!w.get("thumb-url"),"Please enter a valid url for your image."],[w.get("merchant-name")||!w.get("amount"),"You need to specify a merchant if you've listed a price."],[w.get("amount")||!w.get("expires-in"),"You need to list a price if you've set an expiration time."]].filter(function(y){var z=y[0],A=y[1];return!z}).map(function(y){var z=y[0],A=y[1];return A});if(x.length){c("OzNotify").error(x[0]);return}this.props.onSave(v.updateIn(["data","target-url"],function(y){return c("getURLRanges")(y)[0].entity.url}))},_handleCreateMerchant:function u(){c("OzActions").showDialog(c("OzMerchantDialog.react"),{onMerchant:function(v){c("OzAPI").createMerchant(v);var w=this.state.newData.set("merchant-name",v.get("name-dba"));this.setState({newData:w});c("OzActions").hideDialog()}.bind(this)})},_handleAddImage:function u(){c("OzActions").showDialog(c("OzSetPicURLDialog.react"),{onEscape:function(v){c("OzActions").hideDialog();this.focus("Title")}.bind(this),onURL:function(v){c("OzActions").hideDialog();this.setState(function(w){return{newData:t(w.newData,v)}});this.focus("Title")}.bind(this)})},_handleSelectImage:function u(v){this.setState(function(w){return{newData:w.newData.setIn(l,v)}})},_renderSubmit:function u(){return c("React").createElement("button",{type:"submit",className:"_1-hv _1-hw"},"DONE")},_renderSection:function u(v,w){return c("React").createElement("div",{className:"_1-hx"},c("React").createElement("div",{className:"_1-hz",onClick:function(x){return this.focus(v)}.bind(this),role:"presentation"},v),c("React").createElement("div",{className:"_1-h-"},w(v)))},_renderPrice:function u(v){var w=this._data(),x=w.get("currency"),y=w.get("amount");return c("React").createElement("div",{className:"_1-h_"},c("React").createElement(c("AdsCurrencyInput_DEPRECATED.react"),{placeholder:"(optional)",currency:x||"USD",value:Number.isSafeInteger(y)?y:null,onDataUpdate:function(y){this.setState({newData:w.set("amount",y)})}.bind(this),eventType:"change"}),this._renderExpiration())},_renderExpiration:function u(){if(!this.state.config.getIn(["GK","expirationDate"]))return null;return c("React").createElement("div",{className:"_51w3"},c("React").createElement("div",{className:"_1-hz"},"Expiration Time:"),c("React").createElement(s,{expiresIn:this._data().get("expires-in"),onChange:function(v){return this.setState({newData:this.state.newData.set("expires-in",v)})}.bind(this)}))},_renderInput:function u(v,w){var x=this.state.newData;return c("React").createElement("input",{ref:w,type:"text",className:"_1-i0 _1-i1",value:this._data().getIn(v),onChange:function(y){return this.setState({newData:x.setIn(v,y.target.value)})}.bind(this)})},_renderImage:function u(){var v=this._data(),w=v.getIn(l),x=r(v,w);return c("React").createElement(c("OzBubbleImageSelector.react"),{onImageAdd:this._handleAddImage,onImageSelect:this._handleSelectImage,selectedURI:w,thumbURIs:x})},_renderMerchant:function u(){var v=this._data(),w=v.get("merchant-name"),x=w?q(w):null;return c("React").createElement("div",{className:"_1-i5"},c("React").createElement("div",{className:"_1-i6"},c("React").createElement(c("SearchableDropdownInput.contrib"),{divClassName:"_1-i7",value:x,onSelect:function(y){var z=y.getUniqueID()===n.getUniqueID()?null:y.getTitle(),A=this.state.newData.set("merchant-name",z);this.setState({newData:A})}.bind(this),emptySearchResultsText:"No merchants found. Click + to add",placeholder:"Pick a Merchant (optional)",searchSource:this._searchSource})),c("React").createElement(c("ShimButton.react"),{className:"_1-hv _4nd4 _1-i8",onClick:this._handleCreateMerchant}))},_renderPreview:function u(){return c("React").createElement(c("OzBubblePreview.react"),{bubble:this._data()})},_renderDescription:function u(){var v=this._data(),w=v.get("description"),x=w&&w.length>o;return c("React").createElement("div",null,c("React").createElement("input",{ref:"description",type:"text",className:"_1-i0 _1-i1",value:w,onChange:function(y){return this.setState({newData:v.set("description",y.target.value)})}.bind(this)}),c("React").createElement("text",{className:x?"_353q":""},o-(w?w.length:0)+" characters left"))}});function q(u){return new(c("SearchableEntry"))({title:u,uniqueID:u})}function r(u,v){return u.getIn(m,i()).toOrderedSet().add(v).toList().filter(function(w){return w})}var s=c("OzHelpers").pure(function(u){var v=u.expiresIn,w=u.onChange,x="_1-i0 _3owv",y=v||j({hours:0,minutes:0}),z=function z(C){return Math.max(+C,0)},A=function A(C){return w(y.merge(j(C)))},B=function B(C,D){return y.get(D)===1?C:C+"s"};return c("React").createElement("div",{className:"_51wb"},c("React").createElement("label",{className:"_1-hz"},c("React").createElement("input",{className:x,onChange:function w(C){return A({hours:z(C.target.value)})},type:"number",value:v?v.get("hours"):null}),B("hour","hours")),c("React").createElement("label",{className:"_1-hz"},c("React").createElement("input",{className:x,onChange:function w(C){return A({minutes:z(C.target.value)})},type:"number",value:v?v.get("minutes"):null}),B("minute","minutes")))});function t(u,v){return u.withMutations(function(u){u.updateIn(m,i(),function(w){return w.push(v)});u.setIn(l,v)})}f.exports=p}),null);
__d("OzComposerAI.react",["cx","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","OzHelpers","joinClasses","immutable","Image.react","LayerHideOnBlur","MessengerSpinner.react","OzBubblePreview.react","OzConfig","OzConstants","OzImmutablePureRenderMixin","React","Reflux","ShimButton.react","TextWithHighlights.atlas","MessengerButtonReact.bs","formatDate","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("MessengerButtonReact.bs").jsComponent,j=c("immutable").Map,k=c("immutable").List,l=c("OzConstants").ATTS,m=c("React").PropTypes,n=c("React").createClass({displayName:"OzComposerAIList",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{filter:m.string,items:m.instanceOf(k).isRequired,onItemClick:m.func.isRequired},getInitialState:function C(){return{}},render:function C(){var D=this.props,E=D.items,F=D.filter,G=D.onItemClick,H={filter:F,onItemClick:G};return!E.isEmpty()&&c("React").createElement("div",{className:"_4285"},E.map(function(I,J){return k.isList(I)?c("React").createElement("div",{key:J,className:"_2961"},I.map(function(K,L){return c("React").createElement(t,babelHelpers["extends"]({key:L,column:L,line:J,item:K},H))})):c("React").createElement(o,babelHelpers["extends"]({key:J,line:J,item:I,onToggleDebug:function(K){return this.setState({debugLine:this.state.debugLine===J?null:J})}.bind(this),debugShown:this.state.debugLine===J},H))}.bind(this)).reverse())}}),o=c("React").createClass({displayName:"ItemRow",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{onToggleDebug:m.func.isRequired,debugShown:m.bool.isRequired},componentDidMount:function C(){if(this.props.item.get("id")&&this.props.item.get("at"))this._timeout=window.setTimeout(function(D){return this._timeout!==null&&this.forceUpdate()}.bind(this),B(this.props.item))},componentWillUnmount:function C(){window.clearTimeout(this._timeout);this._timeout=null},render:function C(){var D=this.props,E=D.item,F=D.line,G=D.onItemClick,H=D.filter,I=j({line:F,column:0}),J=E.get("id"),K=E.get("at"),L=this.state.config.get("debugAI");return c("React").createElement("div",{className:"_2962",onClick:function M(N){N.preventDefault();G(I)},role:"presentation"},A(E)?c("React").createElement(s,{label:"AUTO-SENDING",at:K}):null,c("React").createElement("div",{className:"_58jk",ref:"root"},c("React").createElement("div",{className:"_2964"},c("React").createElement(v,{item:E,filter:H})),c("React").createElement("span",{className:"_58jl"},z(E)?c("React").createElement(i,{type:"secondary",label:"EXECUTING NOW..."}):A(E)?c("React").createElement(i,{type:"secondary",label:"STOP"}):J&&K?c("formatDate")(K/1e3,"g:ia M j"):"\u2318"+E.get("shortcut",F+1),L&&c("React").createElement(r,babelHelpers["extends"]({contextRef:function(M){return this.refs.root}.bind(this)},this.props)))))}});function p(C,D,E,F,G){var H='<span style="color: brown">',I='<span style="color: navy">',J='<span style="color: navy">',K=D||"";if(E)K=K+H+E.replace(/[\": ]/g,"")+"</span>: ";if(F)K=K+(F[0]=='"'?J:I)+F+"</span>";return K+(G||"")}function q(C){var D=/^( *)(\"[\w]+\": )?(\"[^\"]*\"|[\w.+-]*)?([,[{])?$/gm,E={__html:JSON.stringify(C,null,3).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(D,p)};return c("React").createElement("div",{dangerouslySetInnerHTML:E})}var r=c("React").createClass({displayName:"DebugInfo",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onToggleDebug:m.func.isRequired,debugShown:m.bool.isRequired},_handleToggleDebugInfo:function C(event){this.props.onToggleDebug();event.stopPropagation()},render:function C(){var D=this.props,E=D.contextRef,F=D.item,G=D.debugShown,H=F.get("source"),I=F.get("debug");return c("React").createElement("span",null,H?" "+H:"",I?" ":"",I&&c("React").createElement("span",null,c("React").createElement(c("ShimButton.react"),{className:"_5ufb",form:"link",onClick:this._handleToggleDebugInfo}),c("React").createElement(c("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:c("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:c("LayerHideOnBlur")},contextRef:E,hoverHideDelay:0,onBlur:this.props.onToggleDebug,position:"right",shown:G,hasActionableContext:true},c("React").createElement("div",{className:"_5ufd"},q(I.toJS())))))}}),s=c("React").createClass({displayName:"TimeProgress",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{at:m.number.isRequired,label:m.string},componentDidMount:function C(){this._start=Date.now();var D=window.setInterval(function(E){return this.forceUpdate()}.bind(this));this.unlisten=function(E){return window.clearInterval(D,1e3)}},componentWillUnmount:function C(){this.unlisten()},render:function C(){var D=this.props,E=D.at,F=D.label,G=x(this._start,Date.now(),E);return c("React").createElement("div",{className:"_58jn"},c("React").createElement("div",{className:"_16bc",style:{width:G+"%"}}),c("React").createElement("div",{className:"_16bd"},F))}}),t=c("React").createClass({displayName:"ItemColumn",mixins:[c("OzImmutablePureRenderMixin")],componentDidMount:function C(){if(this.props.item.get("id")&&this.props.item.get("at"))this._timeout=window.setTimeout(function(D){return this._timeout!==null&&this.forceUpdate()}.bind(this),B(this.props.item))},componentWillUnmount:function C(){window.clearTimeout(this._timeout);this._timeout=null},render:function C(){var D=this.props,E=D.column,F=D.filter,G=D.item,H=D.line,I=D.onItemClick,J=j({line:H,column:E}),K=G.get("at");return c("React").createElement("div",{className:"_2966",onClick:function L(M){M.preventDefault();I(J)},role:"presentation"},A(G)?c("React").createElement(s,{label:"AUTO-SENDING",at:K}):null,c("React").createElement("div",{className:"_34mx"},z(G)?c("React").createElement(i,{type:"secondary",label:"EXECUTING NOW..."}):A(G)?c("React").createElement(i,{type:"secondary",label:"STOP"}):c("React").createElement("span",null,G.get("id")&&K?c("formatDate")(K/1e3,"g:ia M j"):"")),c("React").createElement(v,{className:"_34mz",item:G,filter:F}))}}),u=c("OzHelpers").pure(function(C){var D=C.images;return c("React").createElement("div",null,D.map(function(E,F){return c("React").createElement(c("Image.react"),{key:F,className:"_1q16",src:E.get("url"),alt:E.get("filename")})}))}),v=c("OzHelpers").pure(function(C){var D=C.filter,E=C.item,F=C.className;switch(E.get("type")){case l.COMMAND:return c("React").createElement(w,{command:E,highlight:D});case l.SURVEY:case"send":case l.TEMPLATE:var G=E.get("ui-body")&&'"'+E.get("ui-body")+'"',H=E.getIn(["data","images"]);return c("React").createElement("div",{className:F},G?c("React").createElement(c("TextWithHighlights.atlas"),{text:G,highlight:D}):null,H?c("React").createElement(u,{images:H}):null);case"suggest":case l.SUGG:return c("React").createElement(c("OzBubblePreview.react"),{bubble:E.get("data"),highlight:D,meta:E.get("meta"),source:E.get("source")});default:c("OzHelpers").debug("[composerai] could not render item",E);return null}}),w=c("OzHelpers").pure(function(C){var D=C.command,E=C.highlight;return c("React").createElement("div",{className:"_2_he"},c("React").createElement("i",{className:c("joinClasses")("_2_hf",D.get("iconCl"))}),c("React").createElement(c("TextWithHighlights.atlas"),{text:D.get("text"),highlight:E}))});function x(C,D,E){var F=D-C,G=E-C;return F>=0&&G>0?Math.min(100,Math.round(F/G*100)):100}var y=1e4;function z(C){return C.get("id")&&C.get("at")&&c("OzHelpers").serverNow()>C.get("at")}function A(C){return C.get("id")&&C.get("at")&&c("OzHelpers").serverNow()+y>C.get("at")}function B(C){var D=500;return A(C)?C.get("at")-c("OzHelpers").serverNow()+D:C.get("at")-y-c("OzHelpers").serverNow()+D}f.exports={OzComposerAIList:n}}),null);
__d("OzListEditor.react",["cx","OzHelpers","joinClasses","immutable","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").List,j=c("immutable").Map,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzListEditor",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{autofocus:k.bool,list:k.instanceOf(i).isRequired,onClose:k.func,onEdit:k.func.isRequired},componentDidMount:function o(){if(this.props.autofocus)this._focus(0)},componentDidUpdate:function o(p){var q=p.list,r=this.props.list.count();q.count()<r&&this._focus(r-1)},_focus:function o(p){this.refs[p]&&this.refs[p].focus()},render:function o(){var p=this.props,q=p.list,r=p.onEdit,s=p.className,t=babelHelpers.objectWithoutProperties(p,["list","onEdit","className"]);return c("React").createElement("div",{className:c("joinClasses")(s,"_42e_")},q.map(function(u,v){return c("React").createElement("div",{key:u.get("key"),className:"_42f5"},c("React").createElement("input",{type:"text",ref:v,className:"_42f6 _1-i0",value:u.get("text"),onBlur:function(w){return this._handleItemBlur(u.get("text"),v,w)}.bind(this),onChange:function(w){return this._handleItemChange(u.get("text"),v,w)}.bind(this),onKeyDown:function(w){return this._handleBackspace(u.get("text"),v,w)}.bind(this)}))}.bind(this)),c("React").createElement("div",{key:"plus",className:"_42f5"},c("React").createElement("button",{ref:"plus",className:"_42f7 _1-hv _30yy",type:"button",onMouseDown:function u(v){return v.preventDefault()},onClick:this._handlePlusClick,onKeyDown:function(u){return this._handleBackspace(null,q.count(),u)}.bind(this)},"+")))},_setText:function o(p,q){this.props.onEdit(this.props.list.setIn([p,"text"],q))},_handlePlusClick:function o(){var p=this.props,q=p.list,r=p.onEdit,s=m(q),t=s===null?q.push(n()):q["delete"](s).push(q.get(s));r(t)},_handleItemBlur:function o(p,q,r){var s=this.props,t=s.list,u=s.onEdit;p.trim()?this._setText(q,p.trim()):t.count()>1&&u(t["delete"](q))},_handleItemChange:function o(p,q,r){this._setText(q,r.target.value)},_handleBackspace:function o(p,q,r){var s=this.props,t=s.list,u=s.onClose;if(r.key==="Backspace"&&!p){r.preventDefault();q>0?this._focus(q-1):t.count()===1?u&&u():this._focus(q+1)}}});function m(o){var p=o.findEntry(function(q){return!q.get("text","").trim()});return p?p[0]:null}function n(){return j({key:c("OzHelpers").uniqId(),text:""})}f.exports=l}),null);
__d("OzTokenizer.react",["cx","Promise","OzHelpers","immutable","OzSearchSource","OzImmutablePureRenderMixin","React","SearchableEntry","XUITokenizer.react","XUITokenizerToken.react","TypeaheadViewItem","TypeaheadViewPropTypes"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("immutable").List,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzTokenizer",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{allTokens:k.instanceOf(j).isRequired,onCreateToken:k.func.isRequired,onDeleteToken:k.func.isRequired,chosenTokens:k.instanceOf(j).isRequired,resultRank:k.func.isRequired,resultFilter:k.func.isRequired,placeholder:k.string.isRequired,autofocus:k.bool,maxTokenTitleLength:k.number.isRequired,dropUp:k.bool,timeline:k.bool},getDefaultProps:function p(){return{allTokens:j(),chosenTokens:j(),resultRank:function q(r){return 0},resultFilter:function q(r,s){return true},maxTokenTitleLength:Number.MAX_SAFE_INTEGER,timeline:false}},getInitialState:function p(){return{q:""}},componentWillMount:function p(){var q=this.props,r=q.allTokens,s=q.chosenTokens,t=q.resultFilter,u=q.resultRank,v=q.maxTokenTitleLength;this._searchSource=new(c("OzSearchSource"))(function(w){var x=w.query;return c("Promise").resolve(m(x,r,s,t,u,v))})},componentDidMount:function p(){if(this.props.autofocus)this.refs.tokenizer.focusInput()},_onAddEntryAttempt:function p(q){var r=this.props,s=r.onCreateToken,t=r.maxTokenTitleLength;if(q.getTitle().length>t)return;this.setState({q:""});s(o(q))},_onDeleteEntryAttempt:function p(q){var r=this.props.onDeleteToken;r(o(q))},_onQueryStringChange:function p(q){var r=q.target.value;if(r.length<=this.props.maxTokenTitleLength)this.setState({q:q.target.value})},render:function p(){var q=this.props,r=q.chosenTokens,s=q.placeholder,t=q.timeline;return c("React").createElement("div",{className:"_2-e2"},c("React").createElement(c("XUITokenizer.react"),{className:"_2-e3"+(t?" _11_w":""),placeholder:s,entries:r.map(n).toJS(),presenter:this._tokenPresenter(),queryString:this.state.q,searchSource:this._searchSource,onRemoveEntryAttempt:this._onDeleteEntryAttempt,onAddEntryAttempt:this._onAddEntryAttempt,onQueryStringChange:this._onQueryStringChange,ref:"tokenizer"}))},_tokenPresenter:function p(){var q=this.props.dropUp,r=c("OzHelpers").pure(function(u){return c("React").createElement(c("XUITokenizerToken.react"),babelHelpers["extends"]({},u,{className:"_2-e5"}))}),s=c("React").createClass({displayName:"OzTypeaheadViewItem",mixins:[c("TypeaheadViewItem").Mixin],propTypes:c("TypeaheadViewItem").propTypes,render:function u(){var v=this.props.highlighted;return c("React").createElement("li",{className:"_2-e7"+(v?" _2-e8":""),"aria-selected":this.props.highlighted,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight,role:this.props.role},this.props.entry.getTitle())}}),t=c("React").createClass({displayName:"OzTypeaheadView",mixins:[c("OzImmutablePureRenderMixin")],propTypes:c("TypeaheadViewPropTypes"),_renderItem:function u(v){var w=v===this.props.highlightedEntry;return c("React").createElement(s,{key:v.getUniqueID(),entry:v,highlighted:w,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight})},render:function u(){var v="_2-e9"+(q?" _2-ea":"")+(!this.props.entries.length?" _599s":"");return c("React").createElement("ul",{className:v,id:this.props.controlleeID,role:this.props.role},this.props.entries.map(this._renderItem))}});return{ViewRenderer:t,TokenRenderer:r,useLayer:false}}});function m(){var p=arguments.length<=0||arguments[0]===undefined?"":arguments[0],q=arguments[1],r=arguments[2],s=arguments[3],t=arguments[4],u=arguments[5];if(!p)return[];var v=q.filter(function(w){return!r.includes(w)}).filter(function(w){return w.get("name").length<=u}).filter(function(w){return s(w,p)}).sortBy(t).map(n).take(10).toList();return v.filter(function(w){return w.getUniqueID()==p}).count()==0?v.push(n(i({name:p,id:p}))).toJS():v.toJS()}function n(p){return new(c("SearchableEntry"))({title:p.get("name"),uniqueID:p.get("id")})}function o(p){return i({id:p.getUniqueID(),name:p.getTitle()})}f.exports=l}),null);
__d("OzTextTokenizer.react",["immutable","OzTokenizer.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("immutable").List,i=c("React").PropTypes,j=c("React").createClass({displayName:"OzTextTokenizer",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{allTokens:i.instanceOf(h).isRequired,onChange:i.func.isRequired,chosenTokens:i.instanceOf(h).isRequired,placeholder:i.string.isRequired,autofocus:i.bool,maxTokenLength:i.number},getDefaultProps:function k(){return{allTokens:h(),chosenTokens:h()}},_commitChangedTokens:function k(l){var m=this.props.onChange;this.setState({q:""});m(l)},_onAddEntryAttempt:function k(l){var m=this.props.chosenTokens;this._commitChangedTokens(m.push(l))},_onDeleteEntryAttempt:function k(l){var m=this.props.chosenTokens,n=m.indexOf(l);this._commitChangedTokens(n>=0?m["delete"](n):m)},render:function k(){var l=this.props,m=l.allTokens,n=l.chosenTokens,o=l.placeholder,p=l.maxTokenLength,q=l.autofocus;return c("React").createElement(c("OzTokenizer.react"),{placeholder:o,allTokens:m,chosenTokens:n,onDeleteToken:this._onDeleteEntryAttempt,onCreateToken:this._onAddEntryAttempt,resultFilter:function r(s,t){return s.get("name").toLowerCase().indexOf(t.toLowerCase())==0},maxTokenTitleLength:p,dropUp:true,autofocus:q})}});f.exports=j}),null);
__d("OzQuickRepliesComposer.react",["cx","immutable","OzTextTokenizer.react","React","XUICloseButton.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("immutable").List,m=c("React").PropTypes,n=l(["Yes","No","Maybe later","7:00am","7:30am","8:00am","8:30am","9:00am","11:00am","11:30am","12:00pm","12:30pm","1:00pm","1:30pm","2:00pm","5:00pm","5:30pm","6:00pm","6:30pm","7:00pm","7:30pm","8:00pm","8:30pm","9:00pm","Italian","Japanese","Steakhouse","American","French","Chinese","Thai","Burmese","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","San Francisco","Menlo Park","Los Angeles","New York","London","Paris","Berlin"]);i=babelHelpers.inherits(o,c("React").Component);j=i&&i.prototype;function o(){var p,q;"use strict";for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.$OzQuickRepliesComposer1=function(u){var v=this.props,w=v.attachment,x=v.onEdit;x(w.set("data",u))}.bind(this),q}o.prototype.render=function(){"use strict";var p=this.props,q=p.attachment,r=p.onRemove;return c("React").createElement("div",{className:"_46s3"},c("React").createElement("div",{className:"_46s4"},c("React").createElement("div",{className:"_46s5"},"Quick Replies"),c("React").createElement(c("XUICloseButton.react"),{onClick:r})),c("React").createElement(c("OzTextTokenizer.react"),{allTokens:n.map(function(s){return k({id:s,name:s})}),onChange:this.$OzQuickRepliesComposer1,chosenTokens:q.get("data")||l(),placeholder:"Add quick replies...",autofocus:true,maxTokenLength:20}))};o.propTypes={attachment:m.instanceOf(k).isRequired,onEdit:m.func.isRequired,onRemove:m.func.isRequired};f.exports=o}),null);
__d("OzComposerAttachments.react",["cx","OzHelpers","Image.react","immutable","MNCommerceAgentItemSuggestionMercuryAttachment.react","OzAttachmentOverlay.react","OzConstants","OzListEditor.react","OzQuickRepliesComposer.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").OrderedMap,j=c("immutable").Map,k=c("immutable").List,l=c("OzConstants").ATTS,m=c("React").PropTypes,n=c("React").createClass({displayName:"OzComposerAttachments",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{attachments:m.instanceOf(i).isRequired,onAttachmentCrop:m.func.isRequired,onBubbleEdit:m.func.isRequired,onQuickRepliesEdit:m.func.isRequired,onRemove:m.func.isRequired},render:function q(){var r=this.props,s=r.attachments,t=r.onAttachmentCrop,u=r.onBubbleEdit,v=r.onQuickRepliesEdit,w=r.onRemove;if(s.isEmpty())return null;return c("React").createElement("div",{className:"_18wb"},s.map(function(x,y){return c("React").createElement(o,{key:y,id:y,attachment:x,onRemove:w,onBubbleEdit:u,onAttachmentCrop:t,onQuickRepliesEdit:v})}).valueSeq())}}),o=c("React").createClass({displayName:"Attachment",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{attachment:m.instanceOf(j).isRequired,id:m.number.isRequired,onAttachmentCrop:m.func.isRequired,onBubbleEdit:m.func.isRequired,onQuickRepliesEdit:m.func.isRequired,onRemove:m.func.isRequired},render:function q(){__p&&__p();var r=this.props,s=r.attachment,t=r.id,u=r.onAttachmentCrop,v=r.onBubbleEdit,w=r.onQuickRepliesEdit,x=r.onRemove;switch(s.get("type")){case l.IMAGE:return c("React").createElement(c("OzAttachmentOverlay.react"),{key:t,onEdit:function y(z){return u(s,t)},onRemove:function y(z){return x(s,t)},loading:s.get("loading")},p(s));case l.SUGG:return c("React").createElement(c("OzAttachmentOverlay.react"),{key:t,onRemove:function y(z){return x(s,t)},onEdit:function y(z){return v(s,t)}},c("React").createElement(c("MNCommerceAgentItemSuggestionMercuryAttachment.react"),{itemSuggestion:c("OzHelpers").uiSuggestion(s.get("data"))}));case l.QUICK_REPLIES:return c("React").createElement(c("OzQuickRepliesComposer.react"),{attachment:s,onEdit:w,onRemove:function y(z){return x(s,t)}});default:return c("React").createElement(c("OzAttachmentOverlay.react"),{key:t},c("React").createElement("span",null,JSON.stringify(s)))}}});function p(q){var r=q.get("ui-blob");if(r&&!c("OzHelpers").isImageType(r.type))return c("React").createElement("p",{className:"_4gpv"},r.name);else{var s=q.get("url")||c("OzHelpers").blobURI(r);return c("React").createElement(c("Image.react"),{className:"_4xee",onClick:function t(u){return window.open(s)},src:s})}}f.exports=n}),null);
__d("OzConfirmDialog.react",["cx","joinClasses","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","OzActions","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").PureComponent);j=i&&i.prototype;l.prototype.render=function(){"use strict";var n=this.props,o=n.body,p=n.className,q=n.confirmLabel,r=n.cancelLabel,s=n.header,t=n.onCancel,u=n.onConfirm,v=n.width,w=babelHelpers.objectWithoutProperties(n,["body","className","confirmLabel","cancelLabel","header","onCancel","onConfirm","width"]);return c("React").createElement(c("MessengerDialog.react"),babelHelpers["extends"]({className:c("joinClasses")("_1vdh",p),onToggle:m(t),width:v||500},w),c("React").createElement(c("MessengerDialogHeader.react"),null,s),c("React").createElement(c("MessengerDialogBody.react"),{className:"_1vdi"},o),c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogButton.react"),{label:r||"Cancel",onClick:m(t),type:"secondary",use:"default"}),c("React").createElement(c("MessengerDialogButton.react"),{className:"autofocus",label:q||"OK",onClick:m(u),ref:"confirm",type:"primary",use:"default"})))};function l(){"use strict";i.apply(this,arguments)}l.propTypes={body:k.node.isRequired,confirmLabel:k.string,cancelLabel:k.string,header:k.string.isRequired,onConfirm:k.func.isRequired,onCancel:k.func,width:k.number};function m(n){return function(o){c("OzActions").hideDialog();n&&n()}}f.exports=l}),null);
__d("OzEditorStateHelpers",["ContentState","OzHelpers","DraftModifier","EditorState","UnicodeUtils"],(function a(b,c,d,e,f,g){__p&&__p();function h(s,t){var u=c("ContentState").createFromText(t),v=c("EditorState").push(s,u,"remove-range");v=c("EditorState").forceSelection(v,v.getSelection());return v}function i(s){var t=s.getCurrentContent().getBlockMap(),u=s.getSelection().getStartKey();return t.get(u)}function j(s,t){return s.getCurrentContent().getPlainText().indexOf(t)>=0}function k(s){var t=q(s,function(u){var v=u.getSelection();if(v.getStartOffset()===0)return r(u,1);var w=i(u).getText().length;return v.merge({anchorOffset:w,focusOffset:0,isBackward:true})},"backward");if(t===s.getCurrentContent())return s;return c("EditorState").push(s,t,"remove-range")}function l(s,t){var u=s.getCurrentContent(),v=i(s).getText(),w=s.getSelection().merge({anchorOffset:0,focusOffset:v.length}),x=c("DraftModifier").replaceText(u,w,t);c("OzHelpers").debug("[replaceLine]",t,v,x.getPlainText());if(x===u)return s;return c("EditorState").push(s,x,"remove-range")}function m(s,t){var u=s.getCurrentContent(),v=c("DraftModifier").insertText(u,u.getSelectionAfter(),t);if(v===u)return s;return c("EditorState").push(s,v,"insert-characters")}function n(s,t){var u=i(s).getText(),v=u.length;if(v===0)return false;t=Math.min(t,v-1);return u[t]}function o(s,t){var u=s.getSelection().merge({focusOffset:t,anchorOffset:t});return c("EditorState").forceSelection(s,u)}function p(s,t){var u=q(s,function(w){var x=w.getSelection(),y=w.getCurrentContent(),z=x.getAnchorKey(),A=x.getAnchorOffset(),B=y.getBlockForKey(z).getText().slice(A-t,A);return r(w,B?c("UnicodeUtils").strlen(B):1)},"backward");if(u===s.getCurrentContent())return s;u=u.set("selectionBefore",s.getSelection());var v=s.getSelection().isCollapsed()?"backspace-character":"remove-range";return c("EditorState").push(s,u,v)}function q(s,t,u){__p&&__p();var v=s.getSelection(),w=s.getCurrentContent(),x=v;if(v.isCollapsed()){if(u==="forward"){if(s.isSelectionAtEndOfContent())return w}else if(s.isSelectionAtStartOfContent())return w;x=t(s);if(x===v)return w}return c("DraftModifier").removeRange(w,x,u)}function r(s,t){__p&&__p();var u=s.getSelection(),v=s.getCurrentContent(),w=u.getStartKey(),x=u.getStartOffset(),y=w,z=0;if(t>x){var A=v.getKeyBefore(w);if(A==null)y=w;else{y=A;var B=v.getBlockForKey(A);z=B.getText().length}}else z=x-t;return u.merge({focusKey:y,focusOffset:z,isBackward:true})}f.exports={append:m,backspaceTimes:p,charAt:n,currentBlock:i,deleteCurrentLine:k,editorStateHas:j,forceCollapsedSelection:o,replaceContentWithText:h,replaceLine:l}}),null);
__d("OzHistory",["invariant","immutable"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").List,j=c("immutable").OrderedMap,k="oz-history",l=10,m=100;function n(){return j(JSON.parse(localStorage.getItem(k)||"{}")).map(function(s){return i(s)})}function o(s){j.isOrderedMap(s)||h(0);return localStorage.setItem(k,JSON.stringify(s))}function p(s){var t=n();if(t.has(s))return;o(t.set(s,[]).takeLast(l))}function q(s){__p&&__p();var t={},u={items:function v(){if(!t.items)t.items=n().get(s);return t.items},persist:function v(w){i.isList(w)||h(0);o(n().set(s,w));t.items=w;u.resetPos()},resetPos:function v(){t.pos=u.items().size},pos:function v(){if(!Number.isSafeInteger(t.pos))u.resetPos();return t.pos},dec:function v(){t.pos=Math.max(u.pos()-1,0)},inc:function v(){t.pos=Math.min(u.pos()+1,u.items().size)},val:function v(){return u.items().get(u.pos())}};return u}function r(s){__p&&__p();p(s);var t=q(s);return{up:function u(){t.dec();return t.val()},down:function u(){t.inc();return t.val()},push:function u(v){var w=t.items();if(!v||w.last()===v)return;t.persist(w.push(v).takeLast(m))}}}f.exports=r}),null);
__d("OzSendLater.react",["cx","OzHelpers","LayerHideOnBlur","MessengerButtonReact.bs","OzDateTimePicker.react","OzImmutablePureRenderMixin","React","Tooltip","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h){var i=c("MessengerButtonReact.bs").jsComponent,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzSendLater",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{numScheduled:j.number.isRequired,onSendLater:j.func.isRequired,onTimeChange:j.func.isRequired,onToggle:j.func.isRequired,shown:j.bool.isRequired,timestamp:j.number,timezone:j.string,disabled:j.bool},render:function l(){var m=this.props,n=m.shown,o=m.disabled,p=m.numScheduled,q=m.onSendLater,r=m.onToggle,s=m.timestamp,t=m.timezone;return c("React").createElement("span",{className:"_40yd"},c("React").createElement("button",babelHelpers["extends"]({ref:"btn",disabled:o,onClick:function u(v){return r(true)}},o?c("Tooltip").propsFor("We can not schedule this message; images are not supported yet"):null,{className:"_1-hv _40ye _30yy"}),c("React").createElement("i",{className:"_40yf"}),p?c("React").createElement("div",{className:"_2ism"},p):null),c("React").createElement(c("XUIContextualDialog.react"),{autoFocus:false,position:"above",contextRef:function(u){return this.refs.btn}.bind(this),className:"_40yg",shown:n,onToggle:r,behaviors:{LayerHideOnBlur:c("LayerHideOnBlur")}},c("React").createElement("div",{className:"_40yg"},c("React").createElement(c("OzDateTimePicker.react"),babelHelpers["extends"]({className:"_40yh",timestamp:s||c("OzHelpers").serverNow(),timezone:t,onChange:this._handleTimeChange},c("OzHelpers").dateRestraints())),c("React").createElement(i,{onClick:q,label:"Send Later",type:"primary"}))))},_handleTimeChange:function l(m){this.props.onTimeChange(m)}});f.exports=k}),null);
__d("OzTypingDots.react",["cx","immutable","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Range,l=c("React").PropTypes,m=3;i=babelHelpers.inherits(n,c("React").PureComponent);j=i&&i.prototype;n.prototype.render=function(){"use strict";var p=this.props,q=p.bouncing,r=p.disabled,s=p.onClick,t=this.props.numDots||m,u="_32p1"+(q&&!r?" _32p2":"")+(r?" _32p3":"")+" _30yy";return c("React").createElement("div",{className:u,onClick:s,role:"presentation"},c("React").createElement("div",{className:"_32p4"},k(0,t).map(function(v){return c("React").createElement(o,{index:v,key:v})})))};function n(){"use strict";i.apply(this,arguments)}n.propTypes={bouncing:l.bool,disabled:l.bool,numDots:l.number,onClick:l.func};function o(p){var q=p.index,r=100*q;return c("React").createElement("div",{className:"_32p5",style:{animationDelay:r+"ms"}})}f.exports=n}),null);
__d("OzUpdateDateTime.react",["immutable","OzHelpers","React"],(function a(b,c,d,e,f,g){__p&&__p();var h,i,j=c("immutable").Map,k=c("React").PropTypes;h=babelHelpers.inherits(l,c("React").Component);i=h&&h.prototype;l.prototype.componentDidMount=function(){"use strict";var m=setInterval(function(){this.forceUpdate()}.bind(this),6e4);this.setState({timer:m})};l.prototype.componentWillUnmount=function(){"use strict";if(this.state.timer)clearInterval(this.state.timer)};l.prototype.render=function(){"use strict";var m=new Date(c("OzHelpers").serverNow()+this.props.timezoneOffset);return c("React").createElement("span",null,m.toLocaleString(this.props.locale,this.props.options.set("timeZone","UTC").toJS()))};function l(){"use strict";h.apply(this,arguments)}l.propTypes={timezoneOffset:k.number.isRequired,locale:k.string.isRequired,options:k.instanceOf(j).isRequired};f.exports=l}),null);
__d("OzComposer.react",["cx","fbt","invariant","Promise","OzAPI","OzEditorStateHelpers","formatDate","getDefaultKeyBinding","getEntityMatcher","getVisibleValueForContentState","OzHelpers","insertEmoticonIntoEditorState","OzNotify","promiseFinally","ChatContentSearchButton.react","ChatStickerButton.react","CompositeDraftDecorator","DraftEditor.react","DraftModifier","EditorState","EmoticonsList","EmoticonSpan.react","FileInput.react","immutable","KeyBindingUtil","Keys","MessengerContextualDialog.react","MercuryConfig","OzActions","OzAttachmentCropper.react","OzBubbleEditor.react","OzComposerAI.react","OzComposerAttachments.react","OzConfig","OzConfirmDialog.react","OzConstants","OzHistory","OzSendLater.react","OzTypingDots.react","OzStores","OzSuggestions","OzUpdateDateTime.react","React","OzWrapper.react","Reflux","SelectionState","Timestamp.react"],(function aa(ba,a,ca,da,b,ea,fa,c,d){__p&&__p();var e=a("OzHistory")("composer-history"),f=a("immutable").Map,g=a("immutable").OrderedMap,h=a("immutable").List,i=a("React").PropTypes,j=a("OzComposerAI.react").OzComposerAIList,k=a("OzConstants").ATTS,l=a("OzConstants").TOKENS,m=a("OzStores").ActiveThreadStore,n=a("OzStores").BubbleStore,o=8*1024*1024,p={CREATE_BUBBLE:"CREATE_BUBBLE",CREATE_REMINDER:"CREATE_REMINDER",CREATE_INTENT:"CREATE_INTENT",CLOSE_INTENT:"CLOSE_INTENT",CLOSE_REMINDER:"CLOSE_REMINDER",ADD_QUICK_REPLIES:"ADD_QUICK_REPLIES"},q=15*60*1e3,ga=4*60*1e3,ha=a("React").createClass({displayName:"OzComposer",mixins:[a("Reflux").connect(n,"bubbles"),a("Reflux").connect(m,"activeThread"),a("Reflux").connect(a("OzConfig").ConfigStore,"config")],propTypes:{thread:i.instanceOf(f).isRequired,merchants:i.instanceOf(f).isRequired,onResize:i.func},contextTypes:{router:i.object.isRequired,uid:i.string.isRequired},getInitialState:function N(){return t(this.props.thread)},componentDidMount:function N(){this._unlistenComposer=a("OzActions").updateComposer.listen(this._onUpdateComposer);this._unlistenAISelect=a("OzActions").selectAIPick.listen(this._handleAISelect);this._cleanup=function(){this._unlistenComposer();this._unlistenAISelect()}.bind(this);this._oldHeight=this.refs.root.offsetHeight},componentWillReceiveProps:function N(O){if(a("OzHelpers").threadID(O.thread)!==a("OzHelpers").threadID(this.props.thread)){u(this.tid(),this.state);this.setState(t(O.thread))}},componentDidUpdate:function N(O,P){window.setTimeout(function(R){var S=this.refs.root&&this.refs.root.offsetHeight;if(S!==this._oldHeight)this.props.onResize&&this.props.onResize();this._oldHeight=S}.bind(this));var Q=a("OzHelpers").threadID(O.thread);Q===this.tid()?ka(this.tid(),P,this.state):a("OzAPI").notTyping(Q)},componentWillUnmount:function N(){u(this.tid(),this.state);this._cleanup();a("OzAPI").notTyping(this.tid())},getValue:function N(){return a("getVisibleValueForContentState")(this.e().getCurrentContent())},focusInput:function N(){this.refs.input.focus()},render:function N(){return a("React").createElement("div",{ref:"root",className:"_5751 _19ib"},this._renderWidgets(),a("React").createElement("div",{className:"_5754"},this._renderSettings(),a("React").createElement("div",{className:"_19id"},this._renderTextEditor()),this._renderActions()))},_renderTextEditor:function N(){return a("React").createElement(a("DraftEditor.react"),{ref:"input",editorState:this.e(),keyBindingFn:this._toKeyCommand,handleKeyCommand:this._handleKeyCommand,handleBeforeInput:this._handleBeforeInput,onChange:this._handleChange,onDownArrow:this._handleDownArrow,onUpArrow:this._handleUpArrow,onTab:this._handleTab,handleReturn:this._handleReturn,onFocus:this._handleFocus,handlePastedFiles:this._handleFiles,handleDroppedFiles:function(O,P){this._handleFiles(P)}.bind(this),placeholder:this.state.sendTyping?c._("Type a message... (\u2318\u21a9 to send)"):c._("Sneakily type a message... (\u2318\u21a9 to exit sneaky mode and send)"),spellCheck:true,textAlignment:"left"})},_handleFocus:function N(){this.setState({isAIOpen:true})},_onUpdateComposer:function N(O){var P=O.text,Q=O.files;P&&this._handleChange(a("OzEditorStateHelpers").append(this.e(),P));Q&&this._handleFiles(Q);this.refs.input.focus()},_validateSend:function N(){var O=this.state.attachments;return new(a("Promise"))(function(P,Q){var R=[[E(this.e().getCurrentContent()).length>0,"You have not filled in all the missing information."],[O.some(function(S){return S.get("loading")}),"Your attachments are still loading. Please wait and send in a bit"],[x(O)&&!this.getValue().trim()&&!O.find(function(S){return S.get("type")===k.SUGG}),"You need to type a message or create a bubble if you want to send quick replies"],[!a("OzHelpers").isOwner(this.t(),this.context.uid),"You do not own this thread. Assign yourself to send messages"]].find(function(S){var T=S[0],U=S[1];return T});R?Q(R[1]):P()}.bind(this))},_sendWith:function N(O,P){__p&&__p();this._validateSend().done(function(Q){__p&&__p();var R=a("OzHelpers").threadID(this.t()),S=this.getValue().trim(),T=this.state.attachments.groupBy(function($){return $.get("type")}),U=D(this.t(),this.state),V=T.get(k.IMAGE,h()).map(function($){return $["delete"]("ui-blob")}).toList(),W=ma(this.state.attachments),X=W&&{"generic-metadata":W},Y=function Y(){return S||!V.isEmpty()?O(babelHelpers["extends"]({tid:R,images:V,text:S,aiusage:U},X)):a("Promise").resolve()},Z=function Z(){return T.get(k.SUGG,h()).reduce(function($,Ga){return a("promiseFinally")($,function(Q){return P(babelHelpers["extends"]({tid:R,suggestion:Ga.get("data"),aiusage:U},X))})},a("Promise").resolve())};a("promiseFinally")(Y(),Z);a("OzAPI").notifyExtension({action:"discard",id:R});this._toHistory();this.setState(babelHelpers["extends"]({},r(this.t()),{editorState:a("OzEditorStateHelpers").replaceContentWithText(this.e(),""),seedBubble:this.state.seedBubble,isAIOpen:this.state.isAIOpen}))}.bind(this),a("OzNotify").error)},_handleMessageSend:function N(){y("send",[z(this.t()),A(this.t(),this.state.activeThread),B(this.getValue().trim())],function(O){return this._sendWith(a("OzAPI").sendMessage,a("OzAPI").suggest)}.bind(this))},_handleSendLater:function N(){__p&&__p();var O=this.state.schedule.timestamp;this.setState({sendTyping:false});if(!O){a("OzNotify").error("You need to pick a time to send later");return}if(O<a("OzHelpers").serverNow()-ga){a("OzNotify").error("This time is in the past. Is the timezone correct?");return}y("schedule",[A(this.t(),this.state.activeThread),B(this.getValue().trim())],function(P){this._sendWith(function(Q){return a("OzAPI").scheduleMessage(babelHelpers["extends"]({},Q,{at:O}))},function(Q){return a("OzAPI").scheduleSuggest(babelHelpers["extends"]({},Q,{at:O}))});this.setState({sendTyping:true})}.bind(this))},_handleReturn:function N(O){if(a("OzHelpers").hasCmdOrCtrl(O)){setTimeout(this._handleMessageSend);return true}return false},_handleFiles:function N(O){__p&&__p();var P=O;if(P.some(function(S){return S.size>=o})){a("OzNotify").error("The file you are trying to add is too large.");return false}if(!P.length)return false;var Q=this.state.attachments.merge(P.map(function(S,T){return[T,f({type:k.IMAGE,"ui-blob":S,loading:true})]}));this.setState({attachments:Q});var R=function R(S){return P.reduce(function(S,T,U){return S["delete"](U)},S)};a("Promise").all(P.map(function(S){return a("OzAPI").upload(f({type:S.type,blob:S}))})).done(function(S){S.every(function(T){return T.get("id")})||d(0);this.setState({attachments:v(R(this.state.attachments),S.map(function(T,U){return T.set("ui-blob",P[U])}))})}.bind(this),function(S){this.setState({attachments:R(this.state.attachments)})}.bind(this));return true},_nonTextSend:function N(O){var P=y("send",[z(this.t()),A(this.t(),this.state.activeThread)],O);return this._validateSend().then(P,a("OzNotify").error)},_handleStickerSelect:function N(O){this._nonTextSend(function(P){a("OzAPI").sendMessage({tid:a("OzHelpers").threadID(this.t()),"sticker-id":O,aiusage:D(this.t(),this.state)})}.bind(this))},_handleContentSearchSelect:function N(O,P){if(O.platformFBID.toString()===a("MercuryConfig").MessengerAppID){this._handleStickerSelect(O.resultID.toString());return}this._nonTextSend(function(Q){a("OzAPI").upload(f({type:"image/url","attribution-app-id":O.platformFBID,"image-url":O.source.url})).done(function(R){return a("OzAPI").sendMessage({tid:a("OzHelpers").threadID(this.t()),images:[R],aiusage:D(this.t(),this.state)})}.bind(this))}.bind(this))},_handleEmoticonSelect:function N(O){var P=a("EmoticonsList").symbols[O];P&&this._handleChange(a("insertEmoticonIntoEditorState")(P,this.state.editorState))},_handleAttRemove:function N(O){this.setState({attachments:this.state.attachments["delete"](O.get("id"))})},_handleBubbleEdit:function N(O){this.setState({seedBubble:O})},_handleBubbleEditorSave:function N(O){this.setState({seedBubble:null,attachments:v(this.state.attachments,[O])},function(P){return this.refs.input.focus()}.bind(this))},_handleBubbleEditorClose:function N(O){var P={seedBubble:null},Q=O.get("id");if(Q)P.attachments=this.state.attachments["delete"](Q);this.setState(P,function(R){return this.refs.input.focus()}.bind(this))},_handleAttachmentCrop:function N(O){this.setState({cropAttachment:O})},_handleAttCropperSave:function N(O){var P=this.state.attachments["delete"](O.get("id"));this.setState({cropAttachment:null,attachments:P},function(Q){this._handleFiles([O.get("ui-blob")]);this.refs.input.focus()}.bind(this))},_handleAttCropperClose:function N(O){this.setState({cropAttachment:null},function(P){return this.refs.input.focus()}.bind(this))},_handleQuickRepliesEdit:function N(O){this.setState({attachments:v(this.state.attachments,[O])})},_handleTypingDotsClick:function N(){this.setState({sendTyping:!this.state.sendTyping})},_renderWidgets:function N(){if(this.state.seedBubble)return a("React").createElement(a("OzBubbleEditor.react"),{merchants:this.props.merchants,seedBubble:this.state.seedBubble,onSave:this._handleBubbleEditorSave,onClose:this._handleBubbleEditorClose});if(this.state.cropAttachment)return a("React").createElement(a("OzAttachmentCropper.react"),{attachment:this.state.cropAttachment,onSave:this._handleAttCropperSave,onClose:this._handleAttCropperClose});return a("React").createElement("div",null,a("React").createElement(j,{filter:this.getValue(),items:this._AIItems(),onItemClick:this._handleAIItemClick}),a("React").createElement(a("OzComposerAttachments.react"),{attachments:this.state.attachments,onRemove:this._handleAttRemove,onBubbleEdit:this._handleBubbleEdit,onAttachmentCrop:this._handleAttachmentCrop,onQuickRepliesEdit:this._handleQuickRepliesEdit}))},_renderSettings:function N(){return a("React").createElement("div",{className:"_41s9"},a("React").createElement(a("OzTypingDots.react"),{disabled:!this.state.sendTyping,onClick:this._handleTypingDotsClick}))},_renderActions:function N(){return a("React").createElement("div",{className:"_575c"},a("React").createElement(a("ChatStickerButton.react"),{className:"_30yy _1v3y",flyoutAlignment:"right",flyoutClassName:"_293j",onStickerSelect:this._handleStickerSelect,onEmoticonSelect:this._handleEmoticonSelect}),a("React").createElement(a("FileInput.react"),{ref:"fileInput",display:"inline-block",containerClassName:"_30yy _41sr",accept:"*/*",multiple:true,onChange:function(O){this._handleFiles([].slice.apply(O.target.files));this.refs.fileInput.getFileInput().clear()}.bind(this)},a("React").createElement("a",{title:"add images",className:"_2e01 _30yy"})),a("React").createElement(a("ChatContentSearchButton.react"),{className:"_yht _30yy _592k",ref:"chatContentSearch",ContextualDialogClass:a("MessengerContextualDialog.react"),flyoutAlignment:"right",flyoutClassName:"_293j",flyoutWidth:285,onStickerSelect:this._handleStickerSelect,getInput:function(){return this.refs.input}.bind(this),getQuery:this.getValue,onSelect:this._handleContentSearchSelect}),a("React").createElement(a("OzSendLater.react"),babelHelpers["extends"]({},this.state.schedule,{numScheduled:this.props.thread.get("events")?this.props.thread.get("events").count():0,onTimeChange:this._handleScheduleTimeChange,onToggle:this._handleScheduleToggle,onSendLater:this._handleSendLater})))},_handleChange:function N(O){this.setState({editorState:O})},_handleDownArrow:function N(O){if(a("OzHelpers").hasCmdOrCtrl(O)&&this.e().isSelectionAtStartOfContent()){this._fromHistory("down");O.preventDefault();return true}},_handleUpArrow:function N(O){if(a("OzHelpers").hasCmdOrCtrl(O)&&this.e().isSelectionAtStartOfContent()){this._fromHistory("up");O.preventDefault();return true}},_handleTab:function N(O){__p&&__p();var P=F(this.e());if(P){this.setState({editorState:a("EditorState").forceSelection(this.e(),P)});O.preventDefault();return true}var Q=C(this._AIItems(),f({line:0,column:0}));if(Q){this._handleAISelect(Q);O.preventDefault();return true}},_toKeyCommand:function N(O){var P=function(){var R=O.keyCode-a("Keys").ZERO;if(this.state.isAIOpen&&R<=this._AIItems().size)return"SELECT-AI-ITEM-"+(R-1)}.bind(this),Q=function(O){return oa(O)&&!x(this.state.attachments)&&this.state.config.getIn(["GK","quickReplies"])}.bind(this);return na(O)&&p.CREATE_BUBBLE||Q(O)&&p.ADD_QUICK_REPLIES||qa(O)&&P()||pa(O)&&"PREFERRED-NAME"||a("getDefaultKeyBinding")(O)},_handleKeyCommand:function N(O,P){__p&&__p();switch(O){case"SELECT-AI-ITEM-0":case"SELECT-AI-ITEM-1":case"SELECT-AI-ITEM-2":case"SELECT-AI-ITEM-3":case"SELECT-AI-ITEM-4":case"SELECT-AI-ITEM-5":case"SELECT-AI-ITEM-6":case"SELECT-AI-ITEM-7":case"SELECT-AI-ITEM-8":case"SELECT-AI-ITEM-9":this._handleAIItemClick(f({line:+O.slice(-1),column:0}));return true;case"PREFERRED-NAME":this._handleChange(a("EditorState").push(P,a("DraftModifier").replaceText(P.getCurrentContent(),P.getSelection(),a("OzHelpers").preferredName(this.t()))));return true;case p.CREATE_BUBBLE:this.setState({seedBubble:la()});return true;case p.ADD_QUICK_REPLIES:this.setState({attachments:v(this.state.attachments,[w()])});return true}return false},_AIItems:function N(O){return va(this.state.isAIOpen,this.props.thread,this.state.attachments,this.state.bubbles,this.props.merchants,this.getValue())},_handleAISelect:function N(O){__p&&__p();this.setState({lastAIPick:O,lastAIGuesses:this.t().get("guesses"),sendTyping:G(O)?false:this.state.sendTyping},function(){__p&&__p();var P=O.get("id");if(G(O)){a("OzAPI").deleteScheduled(a("OzHelpers").threadID(this.t()),P);this._handleScheduleTimeChange({timestamp:O.get("at"),timezone:a("OzHelpers").timezone(this.t())})}switch(O.get("type")){case k.COMMAND:if(!G(O))switch(O.get("action")){case p.CREATE_REMINDER:this._handleCreateReminder(O);break;case p.CLOSE_REMINDER:this._handleCloseReminder(O);break;case p.CREATE_INTENT:this._handleCreateIntent(O);break;case p.CLOSE_INTENT:this._handleCloseIntent(O);break;default:this._handleKeyCommand(O.get("action"))}break;case k.SURVEY:case"send":case k.TEMPLATE:var Q=O.get("f"),R=Q&&Q()||O.get("ui-body"),S=O.getIn(["data","images"]),T=a("OzEditorStateHelpers").replaceLine(this.e(),R+" "),U=F(T);if(R)this._handleChange(U?a("EditorState").forceSelection(T,U):T);if(S)this.setState({attachments:v(this.state.attachments,S.toArray())});break;case"suggest":case k.SUGG:this.setState({seedBubble:O});break;case k.OPENTABLEQR:this.setState({attachments:v(this.state.attachments,[f({data:O.get("bubble")["delete"]("thumb-urls"),meta:O.get("meta"),source:"places",type:k.SUGG}),w(O.get("quickreplies"))])});var V=a("OzEditorStateHelpers").replaceLine(this.e(),O.get("ui-body"));this._handleChange(V);break}}.bind(this));this.focusInput()},_handleAIItemClick:function N(O){this._handleAISelect(C(this._AIItems(),O))},_handleCreateReminder:function N(O){a("OzAPI").createReminder(this.tid(),f({body:O.get("body"),"scheduled-time":O.get("scheduled-time")}))},_handleCloseReminder:function N(O){a("OzAPI").closeReminder(this.tid(),O.get("id")||O.get("reminder-id"),false)},_handleCreateIntent:function N(O){a("OzAPI").createIntent(this.tid(),f({"wit-intent-uuid":O.get("wit-intent-uuid"),name:O.get("name"),metadata:O.get("metadata"),params:O.get("params"),actions:O.get("actions"),notes:O.get("notes"),requirements:O.get("requirements")})).done(function(P){a("OzHelpers").info("[composer/handleCreateIntent] created for:",a("OzHelpers").threadID(P));this.context.router.push(a("OzHelpers").threadPath({threadid:a("OzHelpers").threadID(P),intentid:P.getIn(["intents",-1,"id"])}))}.bind(this))},_handleCloseIntent:function N(O){a("OzAPI").closeIntent(this.tid(),O.get("id"))},_toHistory:function N(){var O=this.state.attachments,P=O.filter(function(R){return R.get("type")===k.SUGG}),Q=this.getValue();e.push(JSON.stringify({bubbles:P,text:Q}))},_fromHistory:function N(O){var P=a("OzHelpers").safeParse(e[O]()),Q=P.bubbles,R=P.text;R&&this._handleChange(a("OzEditorStateHelpers").replaceContentWithText(this.e(),R));Q&&this.setState({attachments:g(Q).mapEntries(function(S){return a("immutable").fromJS(S)}).mapKeys(function(S){return+S})})},_handleScheduleToggle:function N(O){var P=this.state.schedule,Q=P.timestamp||a("OzHelpers").serverNow();P.shown===O?null:this.setState({schedule:babelHelpers["extends"]({},P,{shown:O,timestamp:Q})})},_handleScheduleTimeChange:function N(O){this.setState({schedule:babelHelpers["extends"]({},this.state.schedule,O)})},e:function N(){return this.state.editorState},t:function N(){return this.props.thread},tid:function N(){return a("OzHelpers").threadID(this.t())}});function ia(){var N=new(a("CompositeDraftDecorator"))([{strategy:function O(P,Q){E(P.getText()).map(function(R){return Q.apply(undefined,R)})},component:ua},{strategy:a("getEntityMatcher")(function(O){return O.getType()==="EMOTICON"}),component:a("EmoticonSpan.react")}]);return a("EditorState").createEmpty(N)}function ja(N){return{shown:false,timestamp:null,timezone:a("OzHelpers").timezone(N)}}function r(N){return{attachments:g(),editorState:ia(),sendTyping:true,seedBubble:null,isAIOpen:false,lastAIPick:null,lastAIGuesses:null,schedule:ja(N)}}var s={};function t(N){return s[a("OzHelpers").threadID(N)]||r(N)}function u(N,O){var P=babelHelpers["extends"]({},O);delete P.bubbles;delete P.activeThread;delete P.config;P.isAIOpen=false;s[N]=P}function ka(N,O,P){var Q=O.editorState.getCurrentContent().getPlainText(),R=P.editorState.getCurrentContent().getPlainText();Q!==R&&a("OzHelpers").debug("[composer] changed from",Q,R);if(P.sendTyping){var S=[Q,R].map(function(V){return!!V.length}),T=S[0],U=S[1];!T&&U&&a("OzAPI").typing(N);T&&!U&&a("OzAPI").notTyping(N)}O.sendTyping&&!P.sendTyping&&a("OzAPI").notTyping(N)}function v(N,O){g.isOrderedMap(N)||d(0);Array.isArray(O)||d(0);return N.withMutations(function(P){return O.reduce(function(P,Q){Q=Q.set("id",Q.get("id")||Q.hashCode());return P.set(Q.get("id"),Q)},P)})}function la(){return a("immutable").fromJS({data:{currency:"USD"},type:k.SUGG})}function w(N){return a("immutable").fromJS({type:k.QUICK_REPLIES,data:N?N.map(function(O){return f({id:O,name:O})}):h()})}function x(N){return N.find(function(O){return O.get("type")===k.QUICK_REPLIES})}function ma(N){var O=f(x(N)).get("data",h()).map(function(P){return P.get("name","").trim()}).filter(function(P){return!!P});return O.isEmpty()?null:{agent_quick_replies:O.toArray()}}function y(N,O,P){var Q=h(O).filter(function(R){return!!R});Q.isEmpty()?P():a("OzActions").showDialog(a("OzConfirmDialog.react"),{body:Q.size===1?Q.first():a("React").createElement("ul",null,Q.map(function(R,S){return a("React").createElement("li",{key:S},R)})),confirmLabel:a("OzHelpers").toTitleCase(N),header:"Are you sure you want to "+N+" this message?",onConfirm:P})}function z(N){var O=f({hour:"numeric",minute:"numeric"}),P=N.getIn(["location","timezone-offset"]),Q=a("OzHelpers").preferredName(N),R=a("OzHelpers").lastPresence(N);if(P&&!a("OzHelpers").isDaytime(P)&&R&&a("OzHelpers").serverNow()-R>q)return a("React").createElement("span",null,"It's\xa0",a("React").createElement("strong",null,a("React").createElement(a("OzUpdateDateTime.react"),{locale:"en-US",options:O,timezoneOffset:P||0})),"\xa0at ",Q,"'s last known location and they haven't interacted with us since ",a("React").createElement("strong",null,a("React").createElement(a("Timestamp.react"),{autoUpdate:true,time:R/1e3})),".")}function A(N,O){var P=O.get("activeIntent"),Q=P&&N.get("intents").find(function(R){return R.get("id")===P});if(!Q||Q.get("state")!=="open")return"You should create an intent or select an open one so the AI can learn from what you're sending."}function B(N){var O=h([[/ +/g,function(P){return P.length>1},"a bunch of spaces in a row"],[/^ | $/gm,function(P){return true},"whitespace at the beginning or end of a line"]]).map(function(P){var Q=P[0],R=P[1],S=P[2];return h(N.match(Q)).some(R)&&S}).filter(function(P){return!!P});if(!O.isEmpty())return a("React").createElement("div",null,"Your text contains some weird formatting:",a("React").createElement("ul",null,O.map(function(P,Q){return a("React").createElement("li",{key:Q},P)})))}function na(N){return a("OzHelpers").hasCmdOrCtrl(N)&&N.which===66}function oa(N){return a("OzHelpers").hasCmdOrCtrl(N)&&N.which===191}function pa(N){return N.getModifierState("Control")&&N.which===78}function C(N,O){var P=N.get(O.get("line"));return h.isList(P)?P.get(O.get("column")):P}function qa(N){return a("KeyBindingUtil").hasCommandModifier(N)&&N.keyCode>=a("Keys").ZERO+1&&N.keyCode<=a("Keys").ZERO+9}function D(N,O){var P=O.lastAIPick,Q=O.lastAIGuesses,R=Q||N.get("guesses"),S=a("OzHelpers").openIntents(N).map(function(T){return T.filter(a("OzHelpers").keysIn("name","wit-intent-uuid"))});a("OzHelpers").debug("building ai usage",a("OzHelpers").threadID(N));return f({gold:P,guesses:R,intents:S})}var ra=/(@\[[^\]]+\])/g;function E(N){var O=void 0,P=[];while(O=ra.exec(N))P.push([O.index,O.index+O[0].length]);return P}function sa(N){return"@["+N+"]"}function F(N){var O=N.getCurrentContent().getBlockMap().toSeq().map(function(P){return[P,E(P.getText())[0]]}).find(function(R){var S=R[0],Q=R[1];return!!Q},null,[]),P=O[0],Q=O[1];return P&&Q?ta.apply(undefined,[P.getKey()].concat(Q)):null}function ta(N,O,P){return new(a("SelectionState"))({anchorKey:N,focusKey:N,anchorOffset:O,focusOffset:P,hasFocus:true,isBackward:false})}var ua=a("OzHelpers").pure(function(N){var O=N.offsetKey,P=N.children;return a("React").createElement("span",{"data-offset-key":O,className:"_a5n"},P)});function va(N,O,P,Q,R,S){var T=xa(O,R,S),U=wa(O,T,P,R,Q,S),V=U.groupBy(function(Y){return Y.get("ui-scheduled")?"scheduled":Y.get("type")===k.SUGG?k.SUGG:"rest"}),W=V.get("rest",h()).push(V.get(k.SUGG)).filter(function(Y){return!!Y}),X=V.get("scheduled",h());if(!N)return X.isEmpty()?h():h().push(X);else if(X.isEmpty())return W;else return W.push(X)}function wa(N,O,P,Q,R,S){var T=O.filter(function(W){return W.get("type")==k.SUGG}).take(25),U=O.filter(function(W){return W.get("type")!=k.SUGG}).concat(Fa(N,S)).take(5),V=T.concat(U);return Ca(R,S).takeLast(1).concat(V).concat(Aa(P,S)).concat(ya(N,Q,S))}function xa(N,O,P){__p&&__p();return(N.get("guesses")||h()).flatMap(function(Q){return Q.get("items")||[Q].map(function(R){return R.merge(f({position:Q.get("position"),confidence:Q.get("confidence"),"class":Q.get("class")}))})}).map(function(Q){switch(Q.get("type")){case k.TEMPLATE:var R=K(N,Q.get("body"));return G(Q)||M(R,P)?Q.set("ui-body",R):null;case"bubble":return G(Q)||L(Q.get("data"),P)?a("OzSuggestions").toServer(Q,O):null;case"close-intent":return I(N,Q);case"create-intent":return H(N,Q);case"close-reminder":return J(N,Q);case"reminder":var S=Q.getIn(["body","description"]),T=Q.get("scheduled-time"),U=a("formatDate")(T/1e3,"g:ia M j");return f({type:k.COMMAND,action:p.CREATE_REMINDER,text:"Create Reminder for "+U+': "'+S+'"',iconCl:"_3e_w",body:Q.get("body"),"scheduled-time":T})}}).filter(function(Q){return!!Q})}function G(N){return!!(N.get("id")&&N.get("at"))}function ya(N,O,P){__p&&__p();return(N.get("events")||h()).concat(N.get("scheduled")||h()).toSeq().map(function(Q){__p&&__p();switch(Q.get("type")){case"send":return Q.set("ui-body",Q.getIn(["data","text"]));case"suggest":return Q.set("type",k.SUGG).set("data",Q.getIn(["data","suggestion"])).updateIn(["data","merchant-name"],function(Q){return a("OzSuggestions").findMerchantName(Q,O)});case"create-intent":return H(N,Q.get("data")).set("id",Q.get("id"));case"close-intent":return I(N,Q.get("data")).set("id",Q.get("id"));case"close-reminder":return J(N,Q.get("data")).merge({id:Q.get("id"),at:Q.get("at")});case"create-reminder":return za(N,Q.get("data")).set("id",Q.get("id"));case k.SURVEY:case k.TEMPLATE:return Q.set("ui-body",K(N,Q.getIn(["data","body"])));case"bubble":return a("OzSuggestions").toServer(Q.get("data"),O).setIn(["data","amount"],+Q.getIn(["data","data","price"])).set("id",Q.get("id"));case"send-calendar":return Q.set("type",k.SUGG).set("data",f({name:Q.getIn(["data","title"]),description:a("OzHelpers").toLocaleDate(Q.getIn(["data","start"])),"merchant-name":"Invite bubble"}));default:a("OzHelpers").debug("[oz-scheduled], unk scheduled",Q)}}).filter(function(Q){return!!Q}).map(function(Q){return Q.set("ui-scheduled",true)}).sortBy(function(Q){return Q.get("at")})}function H(N,O){var P=O.get("name");return O.set("type",k.COMMAND).set("action",p.CREATE_INTENT).set("text","Create intent "+P).set("iconCl","_3e_w")}function I(N,O){var P=O.get("id"),Q=N.get("intents").findLast(function(S){return S.get("id")===P}),R=Q?Q.get("alias")||Q.get("name"):O.get("source");return O.set("type",k.COMMAND).set("action",p.CLOSE_INTENT).set("text","Close intent "+R).set("iconCl","_3e_w")}function J(N,O){var P=O.get("id")||O.get("reminder-id"),Q=N.get("reminders").findLast(function(S){return S.get("id")===P}),R=Q?Q.getIn(["body","description"]):O.get("source");return O.set("type",k.COMMAND).set("action",p.CLOSE_REMINDER).set("text","Close reminder "+R).set("iconCl","_3e_w")}function za(N,O){var P=O.getIn(["body","description"]);return O.set("type",k.COMMAND).set("action",p.CREATE_REMINDER).set("text","Create reminder "+P).set("iconCl","_3e_w")}function Aa(N,O){return a("immutable").fromJS([{type:k.COMMAND,action:p.CREATE_BUBBLE,text:"Create Bubble",iconCl:"_3e_w",shortcut:"B"},!x(N)&&Ba()]).filter(function(P){return P&&M(P.get("text"),O)})}function Ba(){if(a("OzConfig").getInStaticConfig(["GK","quickReplies"]))return{type:k.COMMAND,action:p.ADD_QUICK_REPLIES,text:"Add Quick Replies",iconCl:"_3e_w",shortcut:"/"}}function Ca(N,O){var P=N.filter(function(Q){return L(Q,O)});return(P.isEmpty()?N:P).toList()}function K(N,K){if(typeof K==="string")return K;return K&&K.map(function(O){if(typeof O==="string")return O;return Ea(N,O)}).toJS().join("")}function Da(N){var O=N.get("index");return sa(N.get("type")+(O?" "+O:""))}function Ea(N,O){if(O.get("type")===l.USER_FIRST_NAME)return a("OzHelpers").preferredName(N);return Da(O)}function L(N,O){var P=N.get("data",f());return M(P.get("name","")+"\n     "+P.get("description","")+"\n     "+P.get("target-url",""),O)}function M(N,O){return N&&N.toLowerCase().indexOf((O||"").toLowerCase())>-1}function Fa(N,O){__p&&__p();var P=function P(S){return K(N,S[Math.floor(S.length*Math.random())])},Q="\ud83d\udc64",R=h([K(N,a("immutable").fromJS([{type:l.USER_FIRST_NAME}])),[Q+" Who are you?",function(){return P(["My name is M! I'm your personal assistant in Messenger.","My name is M! I'm your personal assistant. I can help you with things like making reservations, finding the perfect gift or planning your next vacation.","My name is M! I'm your personal assistant in Messenger. I'm here to help you do things better and faster.","My name is M! I'm here to help make your life easier."])}],[Q+" What can you do for me?",function(){return P(["I can help you with lots of things, like figuring out where to go to dinner, finding a great gift for someone, or planning your weekend. Just ask!","I can help you with lots of things. Just ask and I'll let you know if it's something I can't do.","In general, I can help you with anything that's not illegal. Just ask and I'll let you know if there's something I can't do."])}],["Sent the wrong info",function(){return"Sorry! It looks like I sent you the wrong info. @[Right info]"}],[Q+" How did you pick this?",function(){return"I look at a variety of things and try to find the info that's best for you. Would you like me to send you some other options?"}],[Q+" What does M stand for?",function(){return P(["M is just my name! ","Just M!","I'm just M, like Messenger."])}],[Q+" Do you have a partnership with X?",function(){return"No, I just try to find the best info for you. Do you want me to send you some other options?"}],["Storing contact info",function(){return P(["Thanks! I'll remember this for next time."])}],["Don't have an opinion",function(){return"I don't have an opinion about that, but...@[point to resources]"}],["Not my area of expertise",function(){return"I'm not a @[lawyer, financial adviser, etc.] so I can't give you @[legal, financial, etc.] advice, but I can do some research for you. "}],[Q+" What's your favorite sticker?",function(){return P(["I can't pick a favorite!","They're all great!","I love all of the stickers equally!"])}],["General redirect",function(){return"I'm not really sure how to answer that, but can I help you with something else?"}],["Bugs redirect",function(){return"You can actually report things like this right from Facebook. Here's how: https://www.facebook.com/help/326603310765065/ "}],["Facebook support redirect",function(){return P(["I'm not an expert, so I'd recommend checking out the Help Center: www.facebook.com/help (http://www.facebook.com/)","I'm not an expert in that, so I'd recommend going here: www.facebook.com/help (http://www.facebook.com/)"])}],[Q+" What languages do you support?",function(){return"Right now I can only chat in English. Sorry for the inconvenience!"}],["Trolling (abusing M/the agents)",function(){return P(["Is there anything I can help you with?","Unfortunately I won't be able to chat with you if you say things like that."])}],["Generic don't support message",function(){return P(["Unfortunately I can't do that. Is there anything else I can help you with?","Unfortunately I can't help you with that. @[Sorry for the inconvenience.] Is there anything else I can do for you?","Unfortunately I can't support this type of request. Is there anything else I can help you with?"])}],[Q+" What are you? Are you human?",function(){return P(["I'm M! I use artificial intelligence, but people help train me to so I'll get better and better over time.","I'm M! I use artificial intelligence, but people help train me."])}],[Q+" What gender are you?",function(){return"I don't have a gender. I'm just M."}],[Q+" How old are you?",function(){return"I don't have an age. Maybe 42?"}],[Q+" Who made you? Where did you come from?",function(){return P(["I was designed by the Messenger Team.","I was created by the Messenger Team."])}],[Q+" What do you look like?",function(){return"That's me in the picture next to this message."}],[Q+" Can you talk or just type?",function(){return"I can send you messages here in Messenger. "}],[Q+" Where do you live?",function(){return"Right here in Messenger."}],[Q+" Can you call/message/email my friend?",function(){return"Unfortunately I can't do that. Is there anything else I can help you with?"}],["Medical redirect",function(){return"Unfortunately I can't support this type of request right now. Is there anything else I can help you with?"}],"I'm a little busier than usual right now. I want to give you my full attention, so I'll get back to you as soon as I can. In the meantime, feel free to send me any extra info about your request.","I'm on it!",["You're welcome.",function(){return P(["You're welcome.","You're welcome! Let me know if there's anything else I can help you with.","You're welcome! Let me know if you need anything else.","You're welcome! Let me know if I can help you with anything else."])}],["Anything else",function(){return P(["Let me know if there's anything else I can help you with.","Let me know if I can help with anything else.","Great! Let me know if there's anything else I can help you with.","Let me know if there's anything else I can help you with today."])}],"How does this look?",["I'm on it",function(){return P(["Sure, I'm on it!","I'll look into that for you.","I'll look into that for you!","I'll do some research."])}],"How can I help you today?","How about this?","Is this what you're looking for?","I'll take care of it!","What email should I use for the invite?","Where should I send the invite?","When would you like to dine and how many people will be joining you?",["Save phone number",P(["Would you like me to save your phone number for future requests?","What phone number would you like me to use for the reservation?"])],"Do you have a price range in mind?","Here are some options:"]).map(function(S){return Array.isArray(S)?f({"ui-body":S[0],type:k.TEMPLATE,f:S[1]}):f({"ui-body":S,type:k.TEMPLATE})}).filter(function(S){return M(S.get("ui-body"),O)});return R}b.exports=a("OzWrapper.react")(ha)}),null);
__d("OzCheckboxInput.react",["cx","invariant","AbstractCheckboxInput.react","OzImmutablePureRenderMixin","React","joinClasses"],(function a(b,c,d,e,f,g,h,i){var j=c("React").createClass({displayName:"OzCheckboxInput",mixins:[c("OzImmutablePureRenderMixin")],render:function k(){return c("React").createElement(c("AbstractCheckboxInput.react"),babelHelpers["extends"]({},this.props,{className:c("joinClasses")(this.props.className,"_55sg _4k1t"),onChange:this._handleChange}))},_handleChange:function k(l){var m=l.target;m instanceof HTMLInputElement||i(0);this.props.onChange&&this.props.onChange(m.checked)}});f.exports=j}),null);
__d("OzMessageFeedbackDialog.react",["cx","invariant","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","InputLabel.react","OzButton.react","OzCheckboxInput.react","React","StarsInput.react","XUIContextualDialog.react","XUIContextualDialogBody.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=["Poor","Average","Great"];j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$OzMessageFeedbackDialog1=function(){var t=this.props.onFollowedPolicyChange;t&&t(true)}.bind(this),this.$OzMessageFeedbackDialog2=function(){var t=this.props.onFollowedPolicyChange;t&&t(false)}.bind(this),this.$OzMessageFeedbackDialog3=function(t){t.target instanceof HTMLTextAreaElement||i(0);this.props.onFeedbackChange(t.target.value)}.bind(this),p}n.prototype.render=function(){return c("React").createElement(c("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:c("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll")},contextRef:this.props.contextRef,shown:true},c("React").createElement(c("XUIContextualDialogBody.react"),{className:"_5dx"},c("React").createElement("div",{className:"_5333"},c("React").createElement("div",{className:"_5334"},c("React").createElement("div",null,c("React").createElement("h3",null,"Tone"),c("React").createElement(c("StarsInput.react"),{count:this.props.toneRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onToneRatingChange,starLabels:m}),c("React").createElement("h3",null,"Execution"),c("React").createElement(c("StarsInput.react"),{count:this.props.executionRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onExecutionRatingChange,starLabels:m}))),c("React").createElement("div",{className:"_5335"},c("React").createElement("div",null,c("React").createElement("h3",null,"Responsiveness"),c("React").createElement(c("StarsInput.react"),{count:this.props.responsivenessRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onResponsivenessRatingChange,starLabels:m}),c("React").createElement("h3",null,"Console"),c("React").createElement(c("StarsInput.react"),{count:this.props.consoleRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onConsoleRatingChange,starLabels:m})))),c("React").createElement("div",null,c("React").createElement("h3",null,"Followed Policy"),c("React").createElement("div",null,c("React").createElement(c("InputLabel.react"),{label:"Yes"},c("React").createElement(c("OzCheckboxInput.react"),{checked:this.props.followedPolicy===true,onChange:this.$OzMessageFeedbackDialog1})),c("React").createElement(c("InputLabel.react"),{label:"No"},c("React").createElement(c("OzCheckboxInput.react"),{checked:this.props.followedPolicy===false,onChange:this.$OzMessageFeedbackDialog2}))),c("React").createElement("h3",null,"Message"),c("React").createElement("div",{className:"_5336"},c("React").createElement("textarea",{maxLength:"2500",value:this.props.feedback,onChange:this.$OzMessageFeedbackDialog3,placeholder:"Give more details here"}))),c("React").createElement("div",{className:"_5dy"},c("React").createElement(c("OzButton.react"),{onClick:this.props.onClose},"Cancel"),c("React").createElement(c("OzButton.react"),{className:"_5dz",onClick:this.props.onSave,primary:true},"Save"))))};n.propTypes={contextRef:l.func.isRequired,executionRating:l.oneOf([0,1,2,3]),followedPolicy:l.bool,onClose:l.func,onExecutionRatingChange:l.func,onFollowedPolicyChange:l.func,onResponsivenessRatingChange:l.func,onConsoleRatingChange:l.func,onSave:l.func,onToneRatingChange:l.func,responsivenessRating:l.oneOf([0,1,2,3]),consoleRating:l.oneOf([0,1,2,3]),toneRating:l.oneOf([0,1,2,3])};f.exports=n}),null);
__d("OzMessageFeedback.react",["cx","joinClasses","immutable","ReactLayeredComponentMixin_DEPRECATED","OzMessageFeedbackDialog.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("React").PropTypes,m="feedback_dialog",n="no_dialog",o=c("React").createClass({displayName:"OzMessageFeedback",mixins:[c("ReactLayeredComponentMixin_DEPRECATED"),c("OzImmutablePureRenderMixin")],propTypes:{message:l.instanceOf(k).isRequired,onSave:l.func.isRequired},getInitialState:function s(){return babelHelpers["extends"]({currentDialog:n},q(this.props.message))},componentWillReceiveProps:function s(t){if(t.message!==this.props.message)this.setState(q(t.message))},render:function s(){var t=this.state.currentDialog,u=r(this.state);return c("React").createElement("div",{className:"_2bxa _2bxb"+(u?" _2bxc":"")+(t!==n?" _2bxd":"")},c("React").createElement(p,{className:"_2bxf",onClick:function(v){return this.setState({currentDialog:m})}.bind(this),isActive:u||t===m,ref:"flag"}))},renderLayers:function s(){switch(this.state.currentDialog){case m:return{contextualDialog:this._renderFeedbackDialog()};default:return null}},_renderFeedbackDialog:function s(){return c("React").createElement(c("OzMessageFeedbackDialog.react"),{contextRef:function(){return this.refs.flag}.bind(this),executionRating:this.state.executionRating,followedPolicy:this.state.followedPolicy,onClose:this._handleDialogClose,onExecutionRatingChange:function(t){this.setState({executionRating:t})}.bind(this),onFollowedPolicyChange:function(t){this.setState({followedPolicy:t})}.bind(this),onResponsivenessRatingChange:function(t){this.setState({responsivenessRating:t})}.bind(this),onSave:this._handleFeedbackSave,onToneRatingChange:function(t){this.setState({toneRating:t})}.bind(this),onConsoleRatingChange:function(t){this.setState({consoleRating:t})}.bind(this),responsivenessRating:this.state.responsivenessRating,toneRating:this.state.toneRating,consoleRating:this.state.consoleRating,feedback:this.state.feedback,onFeedbackChange:function(t){this.setState({feedback:t})}.bind(this)})},_handleFeedbackSave:function s(){this.props.onSave(k({execution:this.state.executionRating,"followed-policy":this.state.followedPolicy,mid:this.props.message.get("mid"),"offline-threading-id":this.props.message.get("offline-threading-id"),responsiveness:this.state.responsivenessRating,tone:this.state.toneRating,feedback:this.state.feedback,"console-proficiency":this.state.consoleRating}));this._handleDialogClose()},_handleDialogClose:function s(){this.setState({currentDialog:n})}});i=babelHelpers.inherits(p,c("React").Component);j=i&&i.prototype;p.prototype.render=function(){"use strict";var s=this.props,t=s.className,u=s.onClick,v=s.isActive;return c("React").createElement("button",{role:"button",className:c("joinClasses")("_1-hv _2bxi"+(v?" _2bxj":""),t),onClick:u})};function p(){"use strict";i.apply(this,arguments)}function q(s){return{executionRating:s.get("execution"),feedback:s.get("feedback"),followedPolicy:s.get("followed-policy"),responsivenessRating:s.get("responsiveness"),toneRating:s.get("tone"),consoleRating:s.get("console-proficiency")}}function r(s){return!!(s.executionRating||s.followedPolicy!==undefined||s.responsivenessRating||s.toneRating||s.consoleRating)}f.exports=o}),null);
__d("OzMessageQuickReplies.react",["cx","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","React","XUICloseButton.react","immutable","XUIContextualDialog.react","XUIContextualDialogBody.react","ReactLayeredComponentMixin_DEPRECATED","OzImmutablePureRenderMixin"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("React").PropTypes,j=c("immutable").Map,k=c("immutable").List,l=c("React").createClass({displayName:"OzMessageQuickReplies",mixins:[c("ReactLayeredComponentMixin_DEPRECATED"),c("OzImmutablePureRenderMixin")],propTypes:{message:i.instanceOf(j).isRequired},getInitialState:function n(){return babelHelpers["extends"]({displayDialog:false},m(this.props.message))},render:function n(){return c("React").createElement("div",{className:"_g8_"},c("React").createElement("button",{className:"_1-hv _g90 _g91",onClick:function(o){return this.setState({displayDialog:!this.state.displayDialog})}.bind(this),ref:"flag"}))},renderLayers:function n(){if(this.state.displayDialog)return{contextualDialog:this._renderQRDialog()};else return null},_renderQRDialog:function n(){return c("React").createElement(c("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:c("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll")},contextRef:function(){return this.refs.flag}.bind(this),shown:true},c("React").createElement(c("XUIContextualDialogBody.react"),null,c("React").createElement("div",{className:"_g92"},c("React").createElement("div",{className:"_g93"},c("React").createElement("ul",null,this.state.quickReplies.map(function(o){return c("React").createElement("li",{key:o},o)}))),c("React").createElement(c("XUICloseButton.react"),{onClick:function(o){return this.setState({displayDialog:false})}.bind(this)}))))}});function m(n){return{quickReplies:n.getIn(["generic-metadata","agent_quick_replies"],k())}}f.exports=l}),null);
__d("OzInboxMessage.react",["cx","OzAPI","OzHelpers","immutable","OzActions","OzConfig","OzConstants","OzMessage.react","OzMessageFeedback.react","OzMessageQuickReplies.react","OzImmutablePureRenderMixin","React","Reflux"],(function a(b,c,d,e,f,g,h){var i=c("immutable").Map,j=c("OzConstants").AUTHOR_TYPES,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzInboxMessage",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{authorType:k.oneOf(c("OzHelpers").values(j)),isActive:k.bool.isRequired,message:k.instanceOf(i).isRequired,threadID:k.string.isRequired},render:function m(){var n=this.props,o=n.message,p=n.authorType,q=n.threadID,r=n.isActive,s=!!o.get("author"),t=c("OzConfig").ConfigStore.data.getIn(["GK","displayQR"])&&!!o.getIn(["generic-metadata","agent_quick_replies"]),u=this.state.config;return c("React").createElement("div",{className:"clearfix _4y6j"+(r?" _4qv0":"")+(p===j.TRAINER?" _2ij4":"")+(p===j.BOT?" _2ij5":"")+(p===j.USER?" _2p0":"")+(u.getIn(["GK","supervisor"])?" _1w52":"")},c("React").createElement("div",{className:"_2pf"},c("React").createElement(c("OzMessage.react"),{message:o}),p===j.USER?c("React").createElement("button",{onClick:function v(){return c("OzActions").intentCreator.toggle(o.get("mid"))},className:"_1-hv _30yy _4nd4 _ftb"}):null),t?c("React").createElement(c("OzMessageQuickReplies.react"),{message:o}):null,s?c("React").createElement(c("OzMessageFeedback.react"),{message:o,onSave:function v(w){return c("OzAPI").updateMessage(q,w)}}):null)}});f.exports=l}),null);
__d("OzInboxMessageGroup.react",["cx","OzHelpers","immutable","OzConfig","OzConstants","OzDate.react","OzInboxMessage.react","OzUserImage.react","OzImmutablePureRenderMixin","React","Reflux","Tooltip"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("React").PropTypes,k=c("OzConstants").AUTHOR_TYPES,l=c("React").createClass({displayName:"OzInboxMessageGroup",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{activeMsgID:j.string,authorID:j.string,authorType:j.oneOf(c("OzHelpers").values(k)),execTime:j.number,intentID:j.number,messages:j.array.isRequired,repNames:j.instanceOf(i).isRequired,thread:j.object.isRequired,timestamp:j.number.isRequired},scrollMessageIntoViewIfNeeded:function n(o){var p=this.refs[o];p?p.scrollIntoViewIfNeeded():c("OzHelpers").error("[inboxgroup] message id "+o+" not in group")},render:function n(){return c("React").createElement("div",{className:"_528w"},this._renderGroup())},_renderGroup:function n(){var o=this.props.authorType,p=k.BOT,q=k.TRAINER,r=k.USER;switch(o){case q:case p:return c("React").createElement("div",{className:(o===p?"_4m3p":"")+(o===q?" _4m3r":"")},this._renderMessages(),this._renderBottomMeta());case r:return c("React").createElement("div",{className:"_4m3u"},c("React").createElement("div",{className:"_2wyu"},this._renderPhoto()),c("React").createElement("div",{className:"_2wyv"},this._renderMessages(),this._renderBottomMeta()));default:c("OzHelpers").error("got unk author type",this.props);return null}},_renderPhoto:function n(){var o=c("OzHelpers").photo(this.props.thread),p=c("OzHelpers").getName(this.props.thread),q=c("OzHelpers").lastPresence(this.props.thread),r=c("OzDate.react").formatTimestamp(q);return c("React").createElement("div",{className:"_528y"},c("React").createElement("span",c("Tooltip").propsFor("Seen by "+p+" at "+r,"left"),c("React").createElement(c("OzUserImage.react"),{photo:o})))},_renderSeen:function n(){return c("React").createElement("div",{className:"_40ue"},this._renderPhoto())},_renderMessages:function n(){var o=this.props,p=o.messages,q=o.authorType,r=o.thread,s=o.activeMsgID;return c("React").createElement("div",{className:"_528z"},p.map(function(t){return c("React").createElement("div",{key:c("OzHelpers").msgID(t),ref:c("OzHelpers").msgID(t)},c("React").createElement(c("OzInboxMessage.react"),{authorType:q,isActive:c("OzHelpers").msgID(t)===s,message:t,threadID:c("OzHelpers").threadID(r)}),t.get("ui-seen")?this._renderSeen():null)}.bind(this)))},_renderBottomMeta:function n(){var o=this.props,p=o.authorID,q=o.execTime,r=o.intentID,s=o.repNames,t=o.thread,u=o.timestamp;return c("React").createElement("div",{className:"_4m3v"},c("React").createElement("div",null,c("React").createElement("span",{className:"_4m3w"},s.get(p)||p||null),c("React").createElement(c("OzDate.react"),{className:"_4m3x",timestamp:u})),this.state.config.getIn(["GK","responsivenessExecTime"])&&r!=null&&q!=null&&c("React").createElement("div",{className:"_5sme"},c("React").createElement("span",c("Tooltip").propsFor(m(c("OzHelpers").intentById(t,r)),"below"),"I")," + ",c("OzHelpers").durationStr(q)))}});function m(){var n=arguments.length<=0||arguments[0]===undefined?i():arguments[0],o=n.get("name"),p=n.get("alias");return p&&o?p+" ("+o+")":p||o||"[unknown intent]"}f.exports=l}),null);
__d("OzInboxMessageList.react",["cx","OzHelpers","immutable","OzConstants","OzInboxMessageGroup.react","OzLoading.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("React").PropTypes,m=c("OzLoading.react").Inline,n=20;i=babelHelpers.inherits(o,c("React").Component);j=i&&i.prototype;function o(){__p&&__p();var u,v;"use strict";for(var w=arguments.length,x=Array(w),y=0;y<w;y++)x[y]=arguments[y];return v=(u=j.constructor).call.apply(u,[this].concat(x)),this.scrollToMessage=function(z){return k(this.refs).find(function(A){return A.props.messages.some(function(B){return c("OzHelpers").msgID(B)===z})}).scrollMessageIntoViewIfNeeded(z)}.bind(this),this.$OzGroupList1=function(z,A){var B=this.props.thread,C=z[0],D=z[z.length-1],E=C.get("sender"),F=C.get("author"),G=C.get("timestamp"),H=D.get("timestamp"),I=D.get("intent-id"),J=D.get("executional-time"),K=E+G;return c("React").createElement(c("OzInboxMessageGroup.react"),{authorID:F,authorType:c("OzHelpers").authorType(C),activeMsgID:this.props.activeMsgID,execTime:J,intentID:I,key:K,messages:z,ref:K,repNames:this.props.repNames,thread:B,timestamp:H})}.bind(this),v}o.prototype.shouldComponentUpdate=function(u,v){"use strict";return!(this.props.activeMsgID===u.activeMsgID&&c("immutable").is(this.props.thread,u.thread)&&c("immutable").is(this.props.repNames,u.repNames)&&c("immutable").is(this.props.messages,u.messages))};o.prototype.render=function(){"use strict";var u=this.props.messages.reduceRight(r.bind(null,this.props.thread),{groupsList:[],nextTimestamp:null}).groupsList.map(this.$OzGroupList1);return c("React").createElement("frag",null,u)};o.propTypes={activeMsgID:l.string,messages:l.instanceOf(k).isRequired,repNames:l.instanceOf(k).isRequired,thread:l.instanceOf(k).isRequired};var p=c("React").createClass({displayName:"OzInboxMessageList",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{activeMsgID:l.string,clientLimit:l.number.isRequired,loading:l.bool.isRequired,messages:l.instanceOf(k).isRequired,onScrollTop:l.func.isRequired,repNames:l.instanceOf(k).isRequired,thread:l.instanceOf(k).isRequired},componentDidMount:function u(){c("OzHelpers").scrollToBottom(this.refs.scrollable)},componentWillUpdate:function u(){this._wasScrolledToBottom=t(this.refs.scrollable);this._originalScrollHeight=this.refs.scrollable.scrollHeight;this._originalScrollTop=this.refs.scrollable.scrollTop;this._originalActiveMsgID=this._visiblyActiveMsgID()},componentDidUpdate:function u(v){__p&&__p();var w=this._visiblyActiveMsgID();if(w&&w!==this._originalActiveMsgID){c("OzHelpers").debug("[messagelist] scrolling to active msg id "+w);this.refs.groupList.scrollToMessage(w)}else if(this._wasScrolledToBottom||s(v.messages,this.props.messages)||c("OzHelpers").threadID(v.thread)!==c("OzHelpers").threadID(this.props.thread)){c("OzHelpers").debug("[messagelist] scrolling bottom");c("OzHelpers").scrollToBottom(this.refs.scrollable)}else{var x=this.refs.scrollable.scrollHeight-this._originalScrollHeight+this._originalScrollTop;this.refs.scrollable.scrollTop=x}},resize:function u(){this.componentDidUpdate(this.props)},_visibleMessages:function u(){var v=this.props,w=v.messages,x=v.clientLimit;return w.takeLast(x)},_visiblyActiveMsgID:function u(){var v=this.props.activeMsgID,w=this._visibleMessages();if(w.some(function(x){return c("OzHelpers").msgID(x)===v}))return v;if(v)c("OzHelpers").debug("[messagelist] msg "+v+" not visible",w.toJS());return null},render:function u(){var v=this.props,w=v.loading,x=v.sending,y=v.thread;return c("React").createElement("div",{onScroll:this._handleScroll,className:"_4fj7",ref:"scrollable"},c("React").createElement(m,{loading:w}),c("React").createElement(o,{activeMsgID:this.props.activeMsgID,thread:y,messages:this._visibleMessages(),ref:"groupList",repNames:this.props.repNames}),c("React").createElement(m,{loading:x}))},_handleScroll:function u(){if(this.refs.scrollable.scrollTop<n)this.props.onScrollTop()}});function q(u,v,w){var x=u.get("timestamp"),y=function y(A){var B=A>=x,C=!w||A<w;return B&&C},z=v.get("last-seen");if(y(z))u=u.set("ui-seen",true);return u}function r(u,v,w){var x=v.groupsList,y=v.nextTimestamp;w=q(w,u,y);var z=w.get("author"),A=w.get("timestamp"),B=c("OzHelpers").authorType(w),C=x[0],D=C&&C[C.length-1],E=D&&D.get("author"),F=D?D.get("timestamp"):Infinity,G=D&&c("OzHelpers").authorType(D);if(E!==z||F-A>6e4||G!==B)x.unshift([w]);else C.unshift(w);return{groupsList:x,nextTimestamp:A}}function s(u,v){var w=u.last(),x=v.last();return x.get("timestamp")>w.get("timestamp")}function t(u){return u.scrollHeight-u.scrollTop===u.clientHeight}f.exports=p}),null);
__d("OzIntentDropdown.react",["cx","Promise","immutable","OzSearchSource","React","SearchableDropdownInput.contrib","SearchableEntry"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("immutable").List,m=c("React").PropTypes;i=babelHelpers.inherits(n,c("React").PureComponent);j=i&&i.prototype;n.prototype.componentWillMount=function(){"use strict";this.$OzIntentDropdown1=new(c("OzSearchSource"))(function(s){var t=s.query;return c("Promise").resolve(o(t,this.props.witIntents))}.bind(this))};n.prototype.componentDidMount=function(){"use strict";var s=this.refs.dropdown;s&&s.focusInput()};n.prototype.render=function(){"use strict";var s=this.props,t=s.onSelect,u=s.selected;return c("React").createElement("div",{className:"_5yeg"},c("React").createElement(c("SearchableDropdownInput.contrib"),{ref:"dropdown",listClassName:"_2sg3",searchSource:this.$OzIntentDropdown1,value:u?r(u):null,onSelect:function v(w){return t(q(w))},placeholder:"Pick Intent",showSelectedSubtitle:false}))};function n(){"use strict";i.apply(this,arguments)}n.propTypes={selected:m.instanceOf(k),witIntents:m.instanceOf(k).isRequired,onSelect:m.func.isRequired};function o(s,t){var u=function u(v){return v.map(r).toArray()};if(!s)return u(t.take(10));return u(p(t,s).take(10))}function p(s,t){var u=function u(w){return(w||"").toLowerCase().indexOf(t)>=0},v=s.groupBy(function(w){return u(w.get("name"))?"with-name":"other"});return(v.get("with-name")||l()).concat((v.get("other")||l()).filter(function(w){return u(w.get("doc"))}))}function q(s){return k({name:s.getTitle(),doc:s.getSubtitle(),id:s.getUniqueID()})}function r(s){return new(c("SearchableEntry"))({title:s.get("name"),subtitle:s.get("doc"),uniqueID:s.get("id")})}f.exports=n}),null);
__d("OzIntentCreator.react",["cx","OzAPI","OzHelpers","immutable","Keys","OzNotify","OzActions","OzDraggable.react","OzIntentDropdown.react","ReactComponentWithPureRenderMixin","React","Reflux"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Record,j=c("immutable").Map,k=c("React").PropTypes,l=i({shown:false,selected:null,mid:null}),m=c("Reflux").createStore({init:function t(){this.data=l();this.listenToMany(c("OzActions").intentCreator)},getInitialState:function t(){return this.data},onSelect:function t(u){this._u(function(v){return v.set("selected",u)})},toggle:function t(u){this._u(function(v){return v.update("shown",function(w){return!w}).set("mid",u)})},clear:function t(){this._u(function(u){return l()})},_u:function t(u){this.data=u(this.data);this.trigger(this.data)}}),n=c("React").createClass({displayName:"OzIntentCreator",mixins:[c("Reflux").connect(m,"store"),c("ReactComponentWithPureRenderMixin")],propTypes:{witIntents:k.instanceOf(j).isRequired,thread:k.instanceOf(j).isRequired},contextTypes:{router:k.object.isRequired},componentDidMount:function t(){document.addEventListener("keydown",this._handleKBShortcuts);this._unlisten=function(){document.removeEventListener("keydown",this._handleKBShortcuts)}.bind(this)},componentWillUnmount:function t(){this._unlisten()},render:function t(){if(!this.state.store.get("shown"))return null;var u=this.props.witIntents;return c("React").createElement(c("OzDraggable.react"),{className:"_1l0z"},c("React").createElement("div",{className:"_1l0-"},c("React").createElement("div",{className:"_1l0_"},c("React").createElement("div",{className:"_1l10"},"Intent"),c("React").createElement("div",{className:"_1l11"},c("React").createElement(c("OzIntentDropdown.react"),{witIntents:u.filterNot(q),selected:this._selected(),onSelect:c("OzActions").intentCreator.select}))),c("React").createElement("div",{className:"_1l14"},c("React").createElement(o,{color:"blue",onClick:this._handleSave},"Save"),c("React").createElement(o,{color:"grey",onClick:c("OzActions").intentCreator.clear},"Cancel"))))},_selected:function t(){var u=this.state.store.get("selected"),v=this.props.thread.get("intent-diag");return u||p(v,this.props.witIntents)},_handleSave:function t(){var u=this._selected(),v=this.props.thread;if(!u){c("OzNotify").error("You need to pick an intent!");return}c("OzActions").intentCreator.clear();c("OzAPI").createIntent(c("OzHelpers").threadID(v),r(u,v.get("intent-diag"),this.state.store.get("mid"))).done(function(w){this.context.router.push(c("OzHelpers").threadPath({threadid:c("OzHelpers").threadID(w),intentid:w.getIn(["intents",-1,"id"])}))}.bind(this))},_handleKBShortcuts:function t(u){var v=this.state.store.get("shown");if(s(u)||u.which===c("Keys").ESC&&v){u.preventDefault();c("OzActions").intentCreator.toggle()}}}),o=c("OzHelpers").pure(function(t){var u=t.color,v=t.children,w=t.onClick;return c("React").createElement("button",{onClick:w,className:"_1-hv _1l1b"+(u==="blue"?" _1l1x":"")+(u==="grey"?" _1l1y":"")},v)});function p(t,u){if(!t)return null;var v=u.get(t.get("wit-intent-uuid"));if(!v||q(v))return null;return v}function q(t){return t.get("name").match(/^dialog_/)}function r(t,u,v){var w=j({name:t.get("name"),"wit-intent-uuid":t.get("id"),mid:v});return u&&w.get("wit-intent-uuid")===u.get("wit-intent-uuid")?w.merge(u):w}function s(t){return t.getModifierState("Control")&&t.which==c("Keys").SPACE}f.exports=n}),null);
__d("OzInboxShow.react",["cx","Promise","OzStrings","OzAPI","OzHelpers","immutable","OzNotify","relativeTimeString.atlas","OzActions","OzButton.react","OzComposer.react","OzConfig","OzConfirmDialog.react","OzConstants","OzInboxMessageList.react","OzIntentCreator.react","OzStores","OzThreadLabels.react","OzUpdateDateTime.react","promiseFinally","OzImmutablePureRenderMixin","React","Reflux","Tooltip"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").List,j=c("immutable").Map,k=c("React").PropTypes,l=c("OzConstants").AUTHOR_TYPES,m=c("OzStores").PendingMessageStateStore,n=c("OzThreadLabels.react").OzLabelList,o=c("OzConfig").ConfigStore,p=c("Reflux").createAction(),q=c("Reflux").createStore({init:function A(){this._data=j();this.listenTo(p,this._onUpdateFetchState)},getInitialState:function A(){return this._data},_onUpdateFetchState:function A(B,C){this._data=this._data.update(B,function(D){return(D||j()).merge(C)});this.trigger(this._data)}}),r="NO_OWNER",s=25,t=25,u=100,v=1e4,w=c("React").createClass({displayName:"OzInboxShow",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(q,"fetchStates"),c("Reflux").connect(m,"pendingMessageState"),c("Reflux").connect(o,"config")],contextTypes:{uid:k.string.isRequired,router:k.object.isRequired},getInitialState:function A(){return z()},componentDidMount:function A(){this._init(this.props);var B=c("OzActions").scrollThreadToTimestamp.listen(this._scrollToTimestamp);this._unlisten=function(){B()}},componentWillReceiveProps:function A(B){if(c("OzHelpers").threadID(B.thread)!==c("OzHelpers").threadID(this.props.thread)){c("OzHelpers").debug("[inboxshow] thread changed");this._init(B)}if(c("OzHelpers").isUnread(B.thread)&&c("OzHelpers").isOwner(B.thread,this.context.uid))c("OzAPI").markRead(c("OzHelpers").threadID(B.thread))},_init:function A(B){this.setState(z(),function(C){if(!B.thread.get("light-thread")&&x(B.thread).size<s)this._fetchMessages()}.bind(this))},componentWillUnmount:function A(){this._unlisten()},render:function A(){var B=this.state,C=B.fetchStates,D=B.pendingMessageState,E=B.clientLimit,F=B.activeMsgID,G=this.props,H=G.reps,I=G.thread,J=G.merchants,K=G.witIntents,L=x(I),M=c("OzHelpers").threadID(I),N=D.get(M,0)>0,O=H.map(function(Q){return Q.get("name")});if(F)c("OzHelpers").debug("[inboxshow] Rendering with active msg id "+F);var P={humans:this.props.humans,onOwnerChange:this._handleOwnerChange,repNames:O,reps:H,requirements:this.props.requirements,thread:I,witIntents:this.props.witIntents};return c("React").createElement("div",{className:"_1x8x"+(c("OzHelpers").hasTag(I,"employee")?" _1yyg":"")+(c("OzHelpers").hasEngage(I)?" _1fi":"")},c("React").createElement(c("OzIntentCreator.react"),{thread:I,witIntents:K}),c("React").createElement("div",{className:"_1x8y"},this._renderHistoryHeader(),c("React").createElement("div",{className:"_1x96"},c("React").createElement(c("OzInboxMessageList.react"),{activeMsgID:F,clientLimit:E,loading:!!C.getIn([M,"loading"]),onScrollTop:this._fetchMessages,messages:L,ref:"messageList",repNames:O,sending:N,thread:I})),c("React").createElement("div",{className:"_237y"},c("React").createElement(c("OzComposer.react"),{merchants:J,onResize:this._handleResize,thread:I}))),c("React").cloneElement(this.props.children,P))},_scrollToTimestamp:function A(B){__p&&__p();var C=c("OzHelpers").threadID(this.props.thread);c("OzHelpers").debug("[inboxshow] received request to scroll to ts "+B);this.setState({activeMsgID:null});this._backloadHistoryUntil(C,B)["catch"](function(D){return c("OzActions").doneScrollingToTimestamp(B,true)}).then(function(D){c("OzActions").doneScrollingToTimestamp(B);if(c("OzHelpers").threadID(this.props.thread)!==C)c("OzHelpers").debug("[inboxshow] aborting scroll because thread changed");else{this.setState({clientLimit:this.state.clientLimit+D.size});var E=D.isEmpty()?x(this.props.thread):D,F=c("OzHelpers").msgID(E.filter(function(G){return c("OzHelpers").authorType(G)===l.USER}).findLast(function(G){return G.get("timestamp")<=B}));this._activateAndScrollToMsg(F)}}.bind(this)).done()},_backloadHistoryUntil:function A(B,C){__p&&__p();var D=function D(H,I){__p&&__p();return c("OzAPI").history(B,H,u).then(function(J){var K=y(J,H);if(K===H||J.isEmpty())throw K;var L=I.merge(J);c("OzHelpers").debug("[inboxshow] got "+L.size+"; dt="+(K-C));var M=J.filter(function(N){return c("OzHelpers").authorType(N)===l.USER});return M.some(function(N){return N.get("timestamp")<=C})?L:D(K,I.merge(J))})},E=this.state.fetchStates.getIn([B,"timestamp"]),F=this._unseenButLoadedMessages(),G=x(this.props.thread).filter(function(H){return c("OzHelpers").authorType(H)===l.USER}).some(function(H){return H.get("timestamp")<=C});if(G){c("OzHelpers").debug("[inboxshow] desired timestamp "+C+" already loaded");return new(c("Promise"))(function(H){return H(F)})}c("OzHelpers").debug("[inboxshow] backloading to ts "+C+" from "+E);return this._withFetchState(B,E,D(E,j())).then(function(H){return H.merge(F).sortBy(function(I){return I.get("timestamp")})})},_activateAndScrollToMsg:function A(B){this.setState({activeMsgID:B},function(C){window.setTimeout(function(){if(this.state.activeMsgID===B){c("OzHelpers").debug("[inboxshow] CLEARING ACTIVE MSG ID");this.setState({activeMsgID:null})}}.bind(this),v)}.bind(this))},_withFetchState:function A(B,C,D){__p&&__p();var E=this.state.fetchStates.get(B,j());if(E.get("loading")||E.get("fetchedAll")){c("OzHelpers").debug("[inboxshow] already loading or at beginning of time");return new(c("Promise"))(function(F){return F()})}c("OzHelpers").debug("[inboxshow] performing load");p(B,j({loading:true}));return c("promiseFinally")(D,function(F){return p(B,j({loading:false}))}).then(function(F){var G=y(F,C||Infinity);c("OzHelpers").debug("[inboxshow] loaded "+F.size+"; ts="+G);p(B,j({fetchedAll:F.isEmpty()||G===C,timestamp:G}));return F})},_unseenButLoadedMessages:function A(){return x(this.props.thread).skipLast(this.state.clientLimit)},_fetchMessages:function A(){var B=c("OzHelpers").threadID(this.props.thread),C=this.state.fetchStates.getIn([B,"timestamp"]);this.setState({clientLimit:this.state.clientLimit+s});if(!this._unseenButLoadedMessages().isEmpty()){c("OzHelpers").debug("[inboxshow] using client cache instead of fetch");return}this._withFetchState(B,C,c("OzAPI").history(B,C,t)).done()},_handleGrab:function A(){c("OzAPI").grab(c("OzHelpers").threadID(this.props.thread))},_handleResize:function A(){this.refs.messageList.resize()},_handleOwnerChange:function A(B){__p&&__p();var C=B.value;if(C&&C!==r){var D=this.props.reps.get(C),E=this.props.thread,F=c("OzHelpers").threadID(E);if(!c("OzHelpers").hasOpenIntents(E)){var G="You must create an intent first";c("OzNotify").warn(G)}else{if(D.get("is-coach")&&!c("OzHelpers").isEscalated(E))c("OzAPI").escalateTo(F,C);else c("OzAPI").assignTo(F,C);if(!D.get("is-coach")&&c("OzHelpers").isEscalated(E)){var H='Please remove the "Escalated" tag to prevent the thread from getting reassigned to a coach';c("OzNotify").warn(H)}}}},_renderHistoryHeader:function A(){var B=this.props.thread,C=c("OzHelpers").threadID(B),D=c("OzHelpers").hasTag(B,"employee")||c("OzHelpers").hasEngage(B)?"light":"dark",E=function E(J,K){return c("React").createElement(c("OzButton.react"),{onClick:K},J)},F=function(J){return function(K){c("OzHelpers").isOwner(B,this.context.uid)?J():c("OzActions").showDialog(c("OzConfirmDialog.react"),{onConfirm:J,body:"You don't own this thread. If you proceed, the user may be forgotten until they message us again.",header:"Are you sure this user doesn't need to be engaged?"})}.bind(this)}.bind(this),G=c("OzHelpers").locationLastSeen(B),H=j({hour:"numeric",minute:"numeric"}),I=(c("OzHelpers").timezone(B)||"location unknown").replace(/_/g," ");return c("React").createElement("div",{className:"_1q4l"},c("React").createElement("div",{className:"_4l-w"},c("React").createElement("h2",{className:"_1q4m"},c("OzHelpers").getName(B)),c("React").createElement("div",{className:"_29x1"},B.getIn(["location","timezone"])?c("React").createElement("span",c("Tooltip").propsFor("at the user's last known location, updated "+c("relativeTimeString.atlas")(+G,true),"below"),c("React").createElement(c("OzUpdateDateTime.react"),{locale:"en-US",options:H,timezoneOffset:B.getIn(["location","timezone-offset"],0)})," ("+I+")"):c("React").createElement("span",null,"(location unknown)"))),c("React").createElement("div",{className:"_1q4n"},c("React").createElement(n,{className:"_1q4o",thread:B,shade:D,removable:true,addable:true}),c("React").createElement("div",{className:"_1q4p"},c("OzHelpers").hasEngage(B)&&E("No need to engage",F(function(J){return c("OzAPI").notready(C)})))))}}),x=c("OzHelpers").memoize(function(A){return A.get("messages").sortBy(function(B){return B.get("timestamp")})},function(A){return A.get("messages").hashCode()});function y(A,B){return A.map(function(C){return C.get("timestamp")}).reduce(function(C,D){return Math.min(C,D)},B)}function z(){return{activeMsgID:null,clientLimit:s}}f.exports=w}),null);
__d("OzMerchantStatus.react",["cx","immutable","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("React").PropTypes;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.prototype.render=function(){"use strict";var n=this.props.merchant,o=n.get("approved"),p=n.get("blacklisted");return c("React").createElement("i",{className:"_4wc0"+(o?" _4wbz":"")+(p?" _4wb-":""),title:o&&"approved"||p&&"blacklisted"})};function m(){"use strict";i.apply(this,arguments)}m.propTypes={merchant:l.instanceOf(k).isRequired};f.exports=m}),null);
__d("OzMerchantRow.react",["cx","OzAPI","OzHelpers","immutable","Layout.react","LeftRight.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","OzButton.react","OzMerchantDialog.react","OzMerchantStatus.react","OzImmutablePureRenderMixin","React","SUIAtlasTheme","SUINotice.react","XUIDialog.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("Layout.react").Column,k=c("Layout.react").FillColumn,l=c("React").PropTypes,m=c("React").createClass({displayName:"DeleteMerchantDialog",propTypes:{merchant:l.object.isRequired,onConfirm:l.func.isRequired},render:function o(){return c("React").createElement(c("XUIDialog.react"),{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},c("React").createElement("div",{className:"_4eby _2c9g"},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,'Delete merchant "'+this.props.merchant.get("name-dba")+'"?')),c("React").createElement(c("SUINotice.react"),{theme:c("SUIAtlasTheme"),type:"error"},c("React").createElement("div",{className:"_4wby"},"This action is irreversible. Are you sure?"),c("React").createElement(c("LeftRight.react"),null,c("React").createElement(c("OzButton.react"),{onClick:c("OzActions").hideDialog},"Cancel"),c("React").createElement(c("OzButton.react"),{onClick:this.props.onConfirm},"Yes, permanently delete this merchant")))))},_handleToggle:function o(p){c("OzHelpers").debug("[merchantdialog] toggle",arguments);if(!p)c("OzActions").hideDialog()}}),n=c("React").createClass({displayName:"OzMerchantRow",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{merchant:l.instanceOf(i).isRequired},render:function o(){var p=this.props.merchant,q=p.get("website"),r=function r(t){return"$"+(t?(t/100).toFixed(2):0)},s=function s(t){return t||0};return c("React").createElement(c("Layout.react"),{className:"_59hd"},c("React").createElement(j,{className:"mrm _728"},c("React").createElement(c("OzMerchantStatus.react"),{merchant:p})),this._renderMerchantInfo("name-dba"),this._renderMerchantInfo("name-legal"),this._renderMerchantInfo("phone"),this._renderMerchantInfo("cumulative-transaction-amount",r),this._renderMerchantInfo("cumulative-transaction-count",s),c("React").createElement(k,{className:"mrm _4wc2 _4wc3"},c("React").createElement("a",{target:"_blank",href:q},q)),this._renderActions())},_renderMerchantInfo:function o(p,q){var r=this.props.merchant,s=r.get(p);if(q)s=q(s);return c("React").createElement(j,{className:"mrm _4wc2 _72a"},s)},_renderActions:function o(){var p=this._getActions();if(!p)return null;var q=p.map(function(r){var s=r.f,t=r.body;return c("React").createElement(c("OzButton.react"),{key:t,onClick:s},t)});return c("React").createElement(j,{className:"mrm _6w4"},q)},_getActions:function o(){var p=[],q=this.props.merchant;p.push({body:"Edit",f:this._handleMerchantEdit()});p.push({body:"Delete",f:this._handleMerchantDelete()});if(q.get("blacklisted")===true)p.push({body:"Whitelist",f:this._handleMerchantBlacklist(false)});else p.push({body:"Blacklist",f:this._handleMerchantBlacklist(true)});return p},_handleMerchantEdit:function o(){return function(p,q){var r=this.props.merchant;c("OzActions").showDialog(c("OzMerchantDialog.react"),{initialMerchant:r,title:"Edit merchant "+r.get("name-dba"),onMerchant:function s(r){c("OzAPI").editMerchant(r);c("OzActions").hideDialog()}});q()}.bind(this)},_handleMerchantBlacklist:function o(p){return function(q,r){var s=this.props.merchant;c("OzAPI").editMerchant(i({id:s.get("id"),blacklisted:p}));r()}.bind(this)},_handleMerchantDelete:function o(){return function(p,q){var r=this.props.merchant;c("OzActions").showDialog(m,{merchant:this.props.merchant,onConfirm:function s(){c("OzAPI").deleteMerchant(i({id:r.get("id")})).then(c("OzActions").hideDialog)}});q()}.bind(this)}});f.exports=n}),null);
__d("OzMerchants.react",["cx","OzAPI","immutable","Layout.react","MessengerFlexScrollableArea.react","OzActions","OzButton.react","OzMerchantDialog.react","OzMerchantRow.react","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("Layout.react").Column,l=c("Layout.react").FillColumn,m=c("immutable").Map,n=c("React").PropTypes;i=babelHelpers.inherits(o,c("React").Component);j=i&&i.prototype;function o(){__p&&__p();var p,q;"use strict";for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.state={slice:25},this.$OzMerchants4=function(){c("OzActions").showDialog(c("OzMerchantDialog.react"),{onMerchant:function u(v){c("OzAPI").createMerchant(v);c("OzActions").hideDialog()}})},this.$OzMerchants2=function(){return c("React").createElement(c("Layout.react"),{className:"_726"},c("React").createElement(k,{className:"mrm _727 _728"},"Status"),this.$OzMerchants5("Name"),this.$OzMerchants5("Legal Name"),this.$OzMerchants5("Phone"),this.$OzMerchants5("Transaction total"),this.$OzMerchants5("Transaction count"),c("React").createElement(l,{className:"mrm _727"},"Website"),c("React").createElement(k,{className:"mrm _729"},c("React").createElement(c("OzButton.react"),{onClick:this.$OzMerchants4},"New merchant")))}.bind(this),this.$OzMerchants5=function(u){return c("React").createElement(k,{className:"mrm _727 _72a"},u)},this.$OzMerchants3=function(){var u=this.props.merchants.sortBy(function(v){return v.get("name-dba","").toLowerCase()}).toSeq().take(this.state.slice).map(function(v){return c("React").createElement(c("OzMerchantRow.react"),{key:v.get("name-dba"),merchant:v})}).valueSeq();return c("React").createElement(c("MessengerFlexScrollableArea.react"),{className:"_72b",onScroll:this.$OzMerchants6,ref:"scrollable"},u)}.bind(this),this.$OzMerchants1=function(){return c("React").createElement("div",null,"No merchants to show")},this.$OzMerchants6=function(){if(this.refs.scrollable.isScrolledToBottom())this.setState(function(u){return{slice:u.slice+25}})}.bind(this),q}o.prototype.render=function(){"use strict";if(this.props.merchants.isEmpty())return this.$OzMerchants1();return c("React").createElement(c("Layout.react"),null,c("React").createElement(l,null,this.$OzMerchants2(),this.$OzMerchants3()))};f.exports=o}),null);
__d("OzPerformance",["OzHelpers","OzStores","immutable","OzAPI","OzAJAX","OzReactMetrics"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("immutable").Map,i=1e3*60,j=function j(){if(!window.performance||!window.performance.memory)return h({});var p=window.performance.memory,q=p.totalJSHeapSize,r=p.usedJSHeapSize,s=Math.round(100*r/q);return h({totalHeap:q,usedHeap:r,percent:s})},k=function k(){var p=Object.keys(c("OzStores")).map(function(r){return c("OzStores")[r]}),q=p.map(function(r){return r.metrics&&r.metrics()});return q.reduce(function(r,s){return r.merge(s)},h())},l=function l(){var p=c("OzAPI").metrics,q=p.getIn(["realtime","updated-thread-fetch-thread"],0),r=p.getIn(["realtime","updated-thread"],1),s=Math.round(100*q/r),t=p.getIn(["realtime","thread-metrics-update-thread"],0),u=p.getIn(["realtime","thread-metrics"],1),v=Math.round(100*t/u);return p.setIn(["realtime","percent-fetched"],s).setIn(["realtime","percent-metrics-stored"],v)},m=function m(){c("OzHelpers").info("[perf]",{memory:j().toJS(),stores:k().toJS(),api:l().toJS(),react:c("OzReactMetrics").metrics,ajax:c("OzAJAX").metrics})},n,o=function o(){n=window.setInterval(m,i)};f.exports={init:o,timer:n}}),null);
__d("ozFormatTime",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=3600,i=60;function j(k){__p&&__p();var l=Math.floor(k/h);k%=h;var m=Math.floor(k/i);k%=i;var n=Math.round(k),o="";if(l)o+=l+"h ";if(m)o+=m+"m ";if(n)o+=n+"s";return o}f.exports=j}),null);
__d("OzEventShow.react",["cx","OzAPI","OzHelpers","immutable","OzActions","OzDate.react","ozFormatTime","OzImmutablePureRenderMixin","React","ShimButton.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzEventShow",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{activeIntent:j.instanceOf(i).isRequired,event:j.instanceOf(i).isRequired},render:function q(){var event=this.props.event;switch(event.get("type")){case"send-email":case"receive-email":return c("React").createElement(m,{event:event,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply});case"send-calendar":return c("React").createElement(l,{invite:event.get("data")});case"completed-call":return c("React").createElement(n,{event:event,onCallPlay:this._handleCallPlay,onCallBack:this._handleCallBack});default:return c("React").createElement("div",null,"'Not supported yet'")}},_handleEmailView:function q(r){c("OzActions").emailComposer.add(babelHelpers["extends"]({},c("OzHelpers").eventToEmail(r),{disabled:true}))},_handleEmailReply:function q(r){c("OzActions").emailComposer.add(c("OzHelpers").eventToEmail(c("OzHelpers").reEmail(r)))},_handleCallPlay:function q(r){return c("OzAPI").everstoreURI(r).then(function(s){return window.open(s)})},_handleCallBack:function q(r){c("OzActions").twilio.changeTo(r.getIn(["data","remote-phone"]));c("OzActions").twilio.useIntent(this.props.activeIntent)}}),l=c("OzHelpers").pure(function(q){var r=q.invite;return c("React").createElement("div",{className:"_1h7p"},c("React").createElement("div",{className:"_1h7q"}),c("React").createElement("div",{className:"_1h7v _p44"},c("React").createElement("span",{className:"_1h7r"},r.get("title"))),c("React").createElement(o,{label:"Location",row:r.get("location")||"n/a"}),c("React").createElement(o,{label:"Start",row:c("React").createElement(c("OzDate.react"),{timestamp:r.get("start")})}),c("React").createElement(o,{label:"End",row:c("React").createElement(c("OzDate.react"),{timestamp:r.get("end")})}))},"Invite"),m=c("OzHelpers").pure(function(q){var event=q.event,r=q.onEmailView,s=q.onEmailReply,t=event.get("type")==="send-email",u=event.get("data"),v="Email "+(t?"to "+u.get("to").join(", "):"from "+u.get("from"));return c("React").createElement("div",{className:"_1h7p"},c("React").createElement("div",{className:"_1h7q"}),c("React").createElement("div",{className:"_1h7v _p44"},c("React").createElement("span",{className:"_1h7r"},v)),c("React").createElement(o,{label:"Subject",row:u.get("subject","[No subject]")}),c("OzHelpers").nonempty(u.get("cc"))?c("React").createElement(o,{label:"C.C.",row:u.get("cc").join(", ")}):null,c("OzHelpers").nonempty(u.get("bcc"))?c("React").createElement(o,{label:"B.C.C.",row:u.get("bcc").join(", ")}):null,c("React").createElement(o,{label:"Sent",row:c("React").createElement(c("OzDate.react"),{timestamp:u.get("sent-at")})}),c("React").createElement(p,{actions:c("immutable").fromJS([["View",function(w){r(t?event:c("OzHelpers").switchRecip(event))}],["Reply",function(w){s(t?event:c("OzHelpers").switchRecip(event))}]])}))},"Email"),n=c("OzHelpers").pure(function(q){var event=q.event,r=q.onCallPlay,s=q.onCallBack,t=event.get("data"),u={"in":"Call from ",out:"Call to ",voicemail:"Voicemail from "}[t.get("direction")],v=c("OzHelpers").parsePhoneNumber(t.get("remote-phone")),w=t.get("RecordingDuration"),x=t.get("recording-ev-handle"),y=x?[["Call Back",function(z){return s(event)}],["Play Voicemail",function(z){return r(x)}]]:[["Call Back",function(z){return s(event)}]];return c("React").createElement("div",{className:"_1h7p"},c("React").createElement("div",{className:"_1h7q"}),c("React").createElement("div",{className:"_1h7v _p44"},c("React").createElement("span",{className:"_1h7r"},u+v)),c("React").createElement(o,{label:"Date",row:c("React").createElement(c("OzDate.react"),{timestamp:event.get("timestamp")})}),c("React").createElement(o,{label:"Duration",row:c("ozFormatTime")(w)}),c("React").createElement(p,{actions:c("immutable").fromJS(y)}))},"Call"),o=c("OzHelpers").pure(function(q){var r=q.label,s=q.row;return c("React").createElement("div",{className:"_1h7v"},c("React").createElement("div",{className:"_1h7w"},r),c("React").createElement("div",{className:"_1h7y"},s))},"Row"),p=c("OzHelpers").pure(function(q){var r=q.actions;return c("React").createElement("div",{className:"_1h7t"},r.map(function(s){return c("React").createElement(c("ShimButton.react"),{className:"_47yc",key:s.first(),onClick:s.last()},s.first())}))},"ActionRow");f.exports=k}),null);
__d("OzFeedbackCloseDialog.react",["cx","invariant","ix","OzHelpers","relativeTimeString.atlas","Image.react","immutable","MessengerDialog.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","OzBubblePreview.react","OzConfig","OzDate.react","OzFormPreview.react","React","ReactDOM","Reflux","TextAreaWithLineLimit.react","XUIButton.react","XUIRadioButtonGroup.react","XUISingleSelector.react"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m=c("React").PropTypes,n=c("immutable").List,o=c("immutable").Map,p=c("immutable").OrderedMap,q=c("immutable").Set,r=c("OzFormPreview.react").Row,s="fulfilled",t="unfulfilled",u="deleted",v="completed",w="out-of-scope",x="not-completed-user-cancel",y="not-completed-user-wish-na",z="not-completed-other",A="delete-irrelevant",B="good",C="no-need",D="opportunity",E=p((k={},k[v]="Request Successfully Completed",k[w]="Request Out of Scope",k[x]="Request Not Completed: User Changed Their Mind",k[y]="Request Not Completed: User Wish N/A",k[z]="Request Not Completed: Other Reason",k[A]="Delete: Irrelevant Intent",k)),F=p({"POL-LEGAL-FINANCIAL-MEDICAL":"1- Provide legal, financial, medical, or professional advice or services","POL-INSURANCE":"2- Purchase insurance or provide quotes","POL-PERSONAL-ACCOUNTS":"3- Access personal accounts that require logins","POL-CREATIVE-CONTENT":"4- Develop creative content","POL-AUTHENTICATE":"5- Authenticate goods or services","POL-NEGOTIATE":"6- Negotiate pricing or trade of products or services","POL-FB-VIOLATION":"7- Activity violating FB's Statement of Rights and Responsibilities","POL-TOBACCO-FIREARMS-ADULT":"8- Action violating FB/3rd party terms: tobacco, firearms, adult products/services, etc","POL-FOREIGN-PURCHASE":"9- Facilitate foreign purchases","POL-DONATION":"10- Make donations or contributions in a customer's name","POL-MEDICAL-SEARCH-APPOINTMENT":"11- Search for medical products or make medical appointments","POL-TRAVEL-UNDERAGED-SOLO":"12- Book travel for persons under the age of 18 unless purchased by a user who is the parent or legal guardian"}),G=o({flight_request:"Did you book the flight?",restaurant:"Did you book the restaurant?",restaurant_bar:"Did you book the restaurant?",ticket_purchase:"Did you buy the ticket?",movie_concert_show:"Did you buy the ticket?"}),H="Objective_None",I=o({restaurant:"M has finished working on your restaurant request.",restaurant_bar:"M has finished working on your restaurant request.",ticket_purchase:"M has finished working on your ticket request.",movie_concert_show:"M has finished working on your ticket request.",flight_request:"M has finished working on your air-travel request."}),J="option-not-presented",K="really-bad-experience",L="other",M=p((l={},l[K]="Very bad experience; sending the survey would make it worse",l[L]="Other",l)),N=function N(T){return T.map(function(U,V){return c("React").createElement(c("XUISingleSelector.react").Option,{key:U,value:V},U)}).toList()};function O(T){switch(T){case v:return s;case w:case x:case y:case z:return t;case A:return u;default:return undefined}}function P(T,U){var V=G.get(U.get("name"),H);return T===v&&V!==H}var Q=c("React").createClass({displayName:"OzFeedbackCloseDialog",mixins:[c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{onFeedbackDone:m.func.isRequired,title:m.string,intent:m.instanceOf(o).isRequired,scheduleds:m.instanceOf(n).isRequired},getDefaultProps:function T(){return{title:"Before closing, please tell us how well M did"}},getInitialState:function T(){return{feedback:o({"close-state":"fulfilled","close-sub-state":v,"objective-reached":null,"not-completed-other":"","user-happy":0,"was-fast":true,"policy-value":F.keySeq().first(),"automation-value":B,"automation-opportunity":"","was-bug":false,"did-not-send-survey-reason":this._shouldAllowSendSurvey()?K:J}),willSendSurvey:this._shouldAllowSendSurvey(),scheduledsToCancel:q()}},_onCloseChange:function T(U){var V=this.props.intent;this.setState({feedback:this.state.feedback.set("close-state",O(U.value)).set("close-sub-state",U.value).set("objective-reached",P(U.value,V))})},_onPolicyChange:function T(U){this.setState(function(V){var W=V.feedback;return{feedback:W.setIn(["policy-value"],U.value)}})},_onReasonForNotSendingSurveyChange:function T(U){this.setState(function(V){var W=V.feedback;return{feedback:W.setIn(["did-not-send-survey-reason"],U.value)}})},_makeOnChangeHandler:function T(U){return function(V){this.setState(function(W){var X=W.feedback;return{feedback:X.set(U,V)}})}.bind(this)},componentDidMount:function T(){var U=this.refs["selector_close-sub-state"]?c("ReactDOM").findDOMNode(this.refs["selector_close-sub-state"].refs.button):null;U&&U.focus()},render:function T(){var U=this.state.scheduledsToCancel&&this.state.scheduledsToCancel.count(),V=!U&&"Close Intent"||U===1&&"Close Intent and Delete 1 Scheduled Send"||"Close Intent and Delete "+U+" Scheduled Sends";return c("React").createElement(c("MessengerDialog.react"),{onToggle:this._handleToggle,ref:"dialog",type:"default",width:544},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogTitle.react"),null,this.props.title)),this._renderFields(),this._renderOptions(),this._renderTimeWarning(),c("React").createElement("div",{className:"_4k_x"},this._renderDialogAction(V,this._handleSave),this._renderDialogAction("Cancel",c("OzActions").hideDialog)))},_renderTimeWarning:function T(){var U=this.props.intent,V=U.getIn(["params","datetime"]),W=V&&V.first()&&V.first().get("value")&&V.first().get("value").endsWith("07:00:00.000Z");return W?c("React").createElement("div",{className:"_581n"},"The time set in this intent is 12am, and the AI might schedule some messages around that time. Are you sure you set the time correctly?"):null},_renderDialogAction:function T(U,V){return c("React").createElement(c("XUIButton.react"),{onClick:V,className:"_42hl",label:U})},_renderFields:function T(){var U=this.props.intent,V=this.state.feedback,W=G.get(U.get("name"),H);return c("React").createElement("div",{className:"_42hk"},c("React").createElement(r,{label:U.get("name")},c("React").createElement("div",{className:"_8o2"},c("React").createElement("span",null,"Intent opened ",c("OzDate.react").formatTimestamp(U.get("created-at"))),c("React").createElement("br",null),c("React").createElement("span",null,c("relativeTimeString.atlas")(U.get("created-at"))))),c("React").createElement(r,{label:"Why are you closing this intent?"},c("React").createElement(c("XUISingleSelector.react"),{className:"_8o2",maxwidth:300,name:"selector_close-sub-state",ref:"selector_close-sub-state",onChange:this._onCloseChange,value:V.get("close-sub-state")},N(E))),V.get("close-sub-state")===v&&W!==H&&c("React").createElement(r,{label:W},c("React").createElement(c("XUIRadioButtonGroup.react"),{selectedValue:V.get("objective-reached"),onValueChange:this._makeOnChangeHandler("objective-reached"),selectedUse:"confirm",className:"_8o2"},c("React").createElement(c("XUIButton.react"),{value:true,label:"Yes"}),c("React").createElement(c("XUIButton.react"),{value:false,label:"No"}))),V.get("close-sub-state")===w&&c("React").createElement(r,{label:"What policy did the request violate?"},c("React").createElement(c("XUISingleSelector.react"),{maxwidth:1e3,name:"selector_policy-value",size:"large",onChange:this._onPolicyChange,value:V.get("policy-value"),className:"_8o2"},N(F))),V.get("close-sub-state")===z&&c("React").createElement(r,{label:"What was your reason?"},c("React").createElement(c("TextAreaWithLineLimit.react"),{value:V.get("not-completed-other"),onChange:this._makeOnChangeHandler("not-completed-other")})),c("React").createElement(r,{label:"How did the user seem?"},c("React").createElement(c("XUIRadioButtonGroup.react"),{className:"_8o2",selectedValue:V.get("user-happy"),onValueChange:this._makeOnChangeHandler("user-happy"),selectedUse:"confirm"},c("React").createElement(c("XUIButton.react"),{image:c("React").createElement(c("Image.react"),{src:j("40052"),title:"User loved it!"}),label:"User loved it!",labelIsHidden:true,value:4}),c("React").createElement(c("XUIButton.react"),{image:c("React").createElement(c("Image.react"),{src:j("40076"),title:"User was happy"}),label:"User was happy",labelIsHidden:true,value:3}),c("React").createElement(c("XUIButton.react"),{image:c("React").createElement(c("Image.react"),{src:j("40085"),title:"User was meh"}),label:"User was meh",labelIsHidden:true,value:2}),c("React").createElement(c("XUIButton.react"),{image:c("React").createElement(c("Image.react"),{src:j("40042"),title:"User was unhappy"}),label:"User was unhappy",labelIsHidden:true,value:1}),c("React").createElement(c("XUIButton.react"),{image:c("React").createElement(c("Image.react"),{src:j("316462"),title:"No Feedback"}),label:"No Feedback",labelIsHidden:true,value:0}))),c("React").createElement(r,{label:"Did the request go smoothly?"},c("React").createElement(c("XUIRadioButtonGroup.react"),{selectedValue:V.get("was-fast"),onValueChange:this._makeOnChangeHandler("was-fast"),selectedUse:"confirm",className:"_8o2"},c("React").createElement(c("XUIButton.react"),{value:true,label:"Yes: No Bugs and Good Automation"}),c("React").createElement(c("XUIButton.react"),{value:false,label:"No: I have something to report"}))),!V.get("was-fast")&&c("React").createElement(r,{label:"Did a bug affect your work on this request?"},c("React").createElement(c("XUIRadioButtonGroup.react"),{className:"_8o2",selectedValue:V.get("was-bug"),onValueChange:this._makeOnChangeHandler("was-bug"),selectedUse:"confirm"},c("React").createElement(c("XUIButton.react"),{value:false,label:"No"}),c("React").createElement(c("XUIButton.react"),{value:true,label:"Yes"}))),!V.get("was-fast")&&V.get("was-bug")&&c("React").createElement("div",{className:"_4k_y"},"Please"," ",c("React").createElement("a",{href:"https://our.intern.facebook.com/intern/tasks/?q=732683726825240",target:"_blank"},"create a task")," or use the bugnub. Your feedback helps us make this product great!"),!V.get("was-fast")&&c("React").createElement(r,{label:"Did AI help?",tooltip:"i.e. auto sends, scheduled sends, bubble suggestions, ..."},c("React").createElement(c("XUIRadioButtonGroup.react"),{className:"_8o2",selectedValue:V.get("automation-value"),onValueChange:this._makeOnChangeHandler("automation-value"),selectedUse:"confirm"},c("React").createElement(c("XUIButton.react"),{value:C,label:"There was no need"}),c("React").createElement(c("XUIButton.react"),{value:B,label:"Yes, perfectly"}),c("React").createElement(c("XUIButton.react"),{value:D,label:"Could have been better"}))),!V.get("was-fast")&&V.get("automation-value")==D&&c("React").createElement("div",null,c("React").createElement("div",{className:"_4k_y"},"You can provide some feedback here or post in the"," ",c("React").createElement("a",{href:"https://www.facebook.com/groups/880028888735948/",target:"_blank"},"Feedback Group"),"."),c("React").createElement(r,{label:"How could the AI be improved?"},c("React").createElement(c("TextAreaWithLineLimit.react"),{value:V.get("automation-opportunity"),onChange:this._makeOnChangeHandler("automation-opportunity")}))))},_renderOptions:function T(){var U=this.props.intent,V=this.state.feedback;return c("React").createElement("div",null,this._shouldAllowSendSurvey()&&c("React").createElement("div",{className:"_10-h"},c("React").createElement("input",{type:"checkbox",checked:this.state.willSendSurvey,onChange:this._handleToggleSendSurvey}),c("React").createElement("div",{className:"_10-i"},"Send survey and completion message to user:",c("React").createElement("br",null),c("React").createElement("span",{className:"_10-j"},'"',I.get(U.get("name")),'"'))),this._shouldAllowSendSurvey()&&!this.state.willSendSurvey&&c("React").createElement("div",{className:"_10-h"},c("React").createElement(r,{label:"Why have you decided not to send the survey?"},c("React").createElement(c("XUISingleSelector.react"),{className:"_8o2",maxwidth:400,onChange:this._onReasonForNotSendingSurveyChange,value:V.get("did-not-send-survey-reason")},N(M)))),this.state.config.getIn(["GK","cancelRestaurant"])&&this._perhapsDisplayScheduleds())},_handleSave:function T(){this.props.onFeedbackDone(this.props.intent,this._sanitizeFeedback(this.state.feedback.toJS()),this.state.willSendSurvey,this.state.scheduledsToCancel);c("OzActions").hideDialog()},_sanitizeFeedback:function T(U){__p&&__p();if(U["close-state"]!==s)U["objective-reached"]=false;if(U["close-sub-state"]!==w)U["policy-value"]="";if(U["close-sub-state"]!==z)U["not-completed-other"]="";if(U["was-fast"]){U["was-bug"]=false;U["automation-value"]=B}if(U["automation-value"]!==D)U["automation-opportunity"]="";return U},_handleToggle:function T(U){if(!U)c("OzActions").hideDialog()},_shouldAllowSendSurvey:function T(){return I.has(this.props.intent.get("name"))},_handleToggleSendSurvey:function T(U){this.setState({willSendSurvey:!this.state.willSendSurvey})},_handleScheduledItemClick:function T(U){o.isMap(U)||i(0);this.setState(function(V){var W=V.scheduledsToCancel;return{scheduledsToCancel:W.has(U)?W.remove(U):W.add(U)}})},_perhapsDisplayScheduleds:function T(){var U=this.props,V=U.intent,W=U.scheduleds,X={restaurant:"request_type",restaurant_bar:"request_type",appointment:"appt_action"}[V.get("name")],Y=X&&V.getIn(["params",X,0,"value"]);if(q(["restaurant","restaurant_bar","appointment"]).has(V.get("name"))&&Y==="cancel"&&!W.isEmpty())return c("React").createElement("div",{className:"_10-h"},c("React").createElement("div",{className:"_10-i"},"Do you need to cancel any scheduled sends?"),c("React").createElement("div",{className:"_5c03"},c("React").createElement("div",{className:"_5c04"},W.map(function(Z,$){return c("React").createElement(R,{key:$,item:Z,isPendingCancel:this.state.scheduledsToCancel.has(Z),onClick:this._handleScheduledItemClick})}.bind(this)))));return null}});function R(T){var U=T.item,V=T.onClick,W=T.isPendingCancel,X=function(Y){switch(U.get("type")){case"send":var Z=U.getIn(["data","text"]),$=U.getIn(["data","images"]);return c("React").createElement("div",{className:"_5c05"},Z&&'"'+Z+'"',$&&c("React").createElement(S,{images:$}));case"suggest":return c("React").createElement("div",{className:"_5c05"},c("React").createElement(c("OzBubblePreview.react"),{bubble:U.getIn(["data","suggestion"]),meta:U.get("meta"),source:U.get("source")}));default:c("OzHelpers").debug("[feedbackCloseDialog] could not render scheduled item",U);return null}}();return c("React").createElement("div",{className:"_5c06"+(W?" _5c07":""),onClick:function Y(Z){return V(U)},role:"presentation"},c("React").createElement("div",{className:"_5c11"}),c("React").createElement("div",{className:"_5c12"},c("OzDate.react").formatTimestamp(U.get("at"))),X)}function S(T){var U=T.images;return c("React").createElement("div",{className:"_5c4_"},U.map(function(V,W){return c("React").createElement(c("Image.react"),{key:W,className:"_1q16",src:V.get("url"),alt:V.get("filename")})}))}f.exports=Q}),null);
__d("OzReminderTaskEditor.react",["cx","InputLabel_DEPRECATED.react","InputLabelLabel_DEPRECATED.react","OzConstants","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","DatePickerRestraints","OzHelpers","immutable","InputLabel.react","ReactLayeredComponentMixin_DEPRECATED","LayerHideOnBlur","MessengerButtonReact.bs","React","XUIContextualDialog.react","XUIDateTimePicker.react","XUIError.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("OzConstants").REMINDERS,j=c("MessengerButtonReact.bs").jsComponent,k=c("immutable").Map,l=c("immutable").Set,m=c("React").PropTypes,n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],o=c("immutable").fromJS({traffic:{label:"Include traffic update",params:[{name:"origin",placeholder:"Origin address",err:"What is the origin address?"},{name:"destination",placeholder:"Destination address",err:"What is the destination address?"}]},weather:{label:"Include weather forecast",params:[{name:"location",placeholder:"City",err:"What city is the forecast for?"},{name:"metric",placeholder:"Celsius or Fahrenheit",err:"You need to set Celsius or Fahrenheit"}]}}),p=c("OzHelpers").pure(function(s){var t=s.action,u=s.errors,v=s.onToggle,w=s.onUpdate,x=s.task,y=!!x.getIn(["data","actions",t]);return c("React").createElement("div",null,c("React").createElement(c("InputLabel_DEPRECATED.react"),null,c("React").createElement("input",{type:"checkbox",checked:y,onChange:function z(A){return v(A,x,t)}}),c("React").createElement(c("InputLabelLabel_DEPRECATED.react"),null,o.getIn([t,"label"]))),y&&c("React").createElement("div",null,o.getIn([t,"params"]).map(function(z){var A=z.get("name"),B=["data","actions",t,A],C=x.getIn(B);return c("React").createElement(c("XUIError.react"),{key:t+"-"+A,xuiError:u.getIn([t,A])},c("React").createElement("input",{type:z.get("type","text"),className:"_wbw",placeholder:z.get("placeholder"),value:C,onChange:function D(E){return w(E,B)}}))}).valueSeq()))}),q=c("OzHelpers").pure(function(s){var t=s.task,u=s.errors,v=s.onToggle,w=s.onUpdate;return c("React").createElement("div",null,c("React").createElement("h3",{className:"_17f0"},"Actions"),o.keySeq().map(function(x){return c("React").createElement(p,{key:x,action:x,task:t,errors:u,onToggle:v,onUpdate:w})}).valueSeq())}),r=c("React").createClass({displayName:"OzReminderTaskEditor",mixins:[c("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{onSave:m.func.isRequired,seedTask:m.instanceOf(k),layered:m.bool,location:m.instanceOf(k).isRequired},getInitialState:function s(){return{shown:false,task:this.props.seedTask||k({type:"reminder",state:"waiting"}),errors:k()}},componentWillReceiveProps:function s(t){if(!c("immutable").is(t.seedTask,this.props.seedTask))this.setState({task:t.seedTask,errors:k()})},_renderBody:function s(){var t=this.state,u=t.task,v=t.errors,w=this.props.location,x=l(u.getIn(["schedule","repeat-condition","days"]));return c("React").createElement("ul",{className:"_3ssq"},c("React").createElement("div",{className:"_wbu"},c("React").createElement(c("XUIDateTimePicker.react"),babelHelpers["extends"]({xuiError:v.get("scheduled-time"),className:"_wbv",date:new Date(u.get("start-at",c("OzHelpers").serverNow())),allowDuplicateDateSelection:true,onChange:function(y){this.setState({task:c("OzHelpers").updateInWhen(u.set("start-at",+y).set("deadline",+y),["schedule"],function(z){return z.set("start-at",+y)})})}.bind(this)},c("OzHelpers").dateRestraints())),c("React").createElement(c("XUIError.react"),{xuiError:v.get("description")},c("React").createElement("input",{ref:"input",className:"_wbw",placeholder:"Describe the Reminder",value:u.getIn(["data","description"]),onChange:function(y){this.setState({task:u.setIn(["data","description"],y.target.value)})}.bind(this)})),c("React").createElement("h3",{className:"_17f0"},"Recurrence"),n.map(function(y,z){var A=z+1;return c("React").createElement(c("InputLabel.react"),{key:z,label:y},c("React").createElement("input",{type:"checkbox",checked:x.has(A),onChange:function(B){var C=B.target.checked?x.add(A):x["delete"](A);this.setState({task:u.set("schedule",k({"start-at":u.get("start-at"),frequency:"weekly",timezone:w.get("timezone"),"timezone-offset":w.get("timezone-offset"),"repeat-condition":k({spacing:1,days:C.toList()})}))})}.bind(this)}))}.bind(this)),c("React").createElement(q,{task:u,errors:v,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),c("React").createElement("div",{className:"_wbz"},c("React").createElement(j,{label:this.props.seedTask?"Update Reminder":"Add Reminder",disabled:this.state.saving,onClick:this._handleSave,type:"primary"}))))},render:function s(){if(this.props.layered){var t=c("React").Children.only(this.props.children);return c("React").cloneElement(t,{onClick:function(u){return this.setState({shown:!this.state.shown})}.bind(this)})}return this._renderBody()},renderLayers:function s(){var t=this.state.shown;if(!t)return null;return{contextualDialog:c("React").createElement(c("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:c("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:c("LayerHideOnBlur")},position:"below",shown:t,contextRef:function(){return this}.bind(this),onToggle:function(u){return this.setState({shown:u})}.bind(this)},this._renderBody())}},_handleActionToggle:function s(t,u,v){var w=t.target.checked?u.setIn(["data","actions"],k([[v,k()]])):u.deleteIn(["data","actions"]);this.setState({task:w})},_handleActionUpdate:function s(t,u){this.setState({task:this.state.task.setIn(u,t.target.value)})},_handleSave:function s(){__p&&__p();var t=this.state.task,u=t.get("start-at"),v=function v(y){return!!t.getIn(["actions",y])},w=k(),x=c("OzHelpers").dateRestraints().dateRestraints;if(!u)w=w.set("scheduled-time","When would you like the reminder?");else if(u<c("OzHelpers").serverNow()+60*1e3)w=w.set("scheduled-time","Reminders should be in the future!");else if(!c("DatePickerRestraints").isValidDate(new Date(u),x))w=w.set("scheduled-time","Reminder is outside of the "+i.RANGE_IN_YEARS+" year range");if(!t.getIn(["data","description"]))w=w.set("description","What is the reminder about?");w=o.reduce(function(w,y,z){if(v(z))w=y.get("params").reduce(function(w,A){return t.getIn(["data","actions",z,A.get("name")])?w:w.setIn([z,A.get("name")],A.get("err"))},w);return w},w);this.setState({errors:w});if(w.size)return;this.setState({saving:true},function(y){this.props.onSave(t).then(function(y){if(this.props.layered)this.setState({shown:false,saving:false})}.bind(this))["catch"](function(z){return this.setState({saving:false})}.bind(this))}.bind(this))}});f.exports=r}),null);
__d("OzIntentActions.react",["cx","Promise","OzAPI","OzHelpers","Image.react","immutable","joinClasses","OzActions","OzConfig","OzDraggable.react","OzReminderTaskEditor.react","OzImmutablePureRenderMixin","React","Reflux","XUICloseButton.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").Map,l=c("React").PropTypes,m=5*6e4,n=10*6e4,o=c("React").createClass({displayName:"OzIntentActions",propTypes:{intent:l.instanceOf(k).isRequired,location:l.instanceOf(k).isRequired,userEmail:l.string},mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],contextTypes:{router:l.object.isRequired},getInitialState:function r(){return{reminderShown:false}},render:function r(){var s=this.state.config,t=s.get("display-tasks")||s.getIn(["GK","timeline"]);return c("React").createElement("div",{className:c("joinClasses")("_x-r",this.props.className)},c("React").createElement("div",{className:(t?"_2p6s":"")+(!t?" _ukm":""),style:this.props.timelineGK?{borderTop:"none"}:null},t?[["mail",this._handleEmail],["call",this._handleCall],["calendar",this._handleInvite],["todo",this._handleTask]].map(function(u){var v=u[0],w=u[1];return c("React").createElement("button",{key:v,className:"_1-hv _2p6t",onClick:w},c("React").createElement(c("Image.react"),{className:"_2p6u",id:v,src:"/images/oz/intent/"+v+"-2x.png"}))}):[["call",this._handleCall],["email",this._handleEmail],["invite",this._handleInvite]].map(function(u){var v=u[0],w=u[1];return c("React").createElement("button",{key:v,className:"_1-hv _ukn",onClick:w},v)})),this.state.reminderShown&&t?c("React").createElement(p,{onClose:this._handleCloseReminderTask,onCreate:this._handleCreateReminderTask,location:this.props.location}):null)},_handleTask:function r(){var s=this.props.intent,t=s.get("id"),u=s.get("user-id"),v=k({deadline:c("OzHelpers").serverNow()+n+m,"intent-id":t,"start-at":c("OzHelpers").serverNow()+n,state:"waiting",type:"reminder",data:{description:""}});c("OzAPI").createTask(u,v).then(function(w){this.context.router.push(c("OzHelpers").threadPath({threadid:u,intentid:t,taskid:w}))}.bind(this)).done()},_handleCreateReminderTask:function r(s){var t=this.props.intent;return c("OzAPI").createTask(t.get("user-id"),s.set("intent-id",t.get("id"))).then(function(u){return this.setState({reminderShown:false})}.bind(this))},_handleCloseReminderTask:function r(){this.setState({reminderShown:false})},_handleEmail:function r(){var s=this.props.intent;c("OzActions").emailComposer.add({intentId:s.get("id"),from:s.get("email-address")})},_handleInvite:function r(){c("OzActions").inviteComposer.create(this.props.intent.get("id"),this.props.userEmail,this.props.location.get("timezone"))},_handleCall:function r(){q(this.props.intent).done(function(s){return c("OzActions").twilio.useIntent(s)})}});i=babelHelpers.inherits(p,c("React").Component);j=i&&i.prototype;p.prototype.render=function(){"use strict";var r=this.props,s=r.onClose,t=r.onCreate,u=r.location;return c("React").createElement(c("OzDraggable.react"),{className:"_2jc4"},c("React").createElement("div",{className:"_2jc5"},"Reminder",c("React").createElement(c("XUICloseButton.react"),{onClick:s})),c("React").createElement(c("OzReminderTaskEditor.react"),{onSave:t,location:u}))};function p(){"use strict";i.apply(this,arguments)}p.propTypes={onClose:l.func.isRequired,onCreate:l.func.isRequired};function q(r){var s=r.get("phone-number");return s?c("Promise").resolve(r):c("OzAPI").addPhoneNumber(r.get("user-id"),r.get("id")).then(function(t){return r.merge(t)})}f.exports=o}),null);
__d("OzIntentParams.react",["cx","React"],(function a(b,c,d,e,f,g,h){"use strict";var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){return c("React").createElement("div",{className:"_3-ue"},this.props.children)};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("OzIntentParamsAbstractField.react",["cx","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){return c("React").createElement("div",{className:"_5nij"+(!this.props.hasValue?" _2ez0":"")},this.props.label?c("React").createElement("label",{className:"_2230 ellipsis"},this.props.label):null,c("React").createElement("div",{className:"_2ulp"},c("React").Children.only(this.props.children)))};function l(){i.apply(this,arguments)}l.propTypes={hasValue:k.bool,label:k.string};f.exports=l}),null);
__d("OzIntentParamsTextField.react",["invariant","AbstractTextArea.react","DOMQuery","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React","ReactDOM","TextAreaControl"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzIntentParamsTextField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:i.string,onAsk:i.func,onChange:i.func,question:i.string,value:i.string.isRequired},_control:null,componentDidMount:function k(){var l=c("DOMQuery").find(c("ReactDOM").findDOMNode(this),"textarea");this._control=new(c("TextAreaControl"))(l);this._control.setAutogrow(true);this._control.onupdate()},componentDidUpdate:function k(l,m){if(l.value!==this.props.value)this._control.onupdate()},render:function k(){return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:!!this.props.value,onAsk:this.props.onAsk,question:this.props.question},c("React").createElement(c("AbstractTextArea.react"),{onChange:this._handleChange,placeholder:this.props.label,value:this.props.value}))},_handleChange:function k(l){var m=l.target;m instanceof HTMLTextAreaElement||h(0);this.props.onChange&&this.props.onChange(m.value)}});f.exports=j}),null);
__d("OzRequirementTokenizer.react",["immutable","OzImmutablePureRenderMixin","React","OzTokenizer.react"],(function a(b,c,d,e,f,g){var h=c("immutable").Map,i=c("immutable").List,j=c("React").PropTypes,k=c("React").createClass({displayName:"OzRequirementTokenizer",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{allRequirements:j.instanceOf(h).isRequired,onDeleteRequirement:j.func.isRequired,onCreateRequirement:j.func.isRequired,selectedRequirements:j.instanceOf(i),placeholder:j.string.isRequired,timeline:j.bool},getDefaultProps:function l(){return{timeline:false}},_requirementSort:function l(m){var n=this.props.witIntentUUID,o=m.get("wit-intent-uuids").has(n)?1e5:0;return-(o+m.get("used-count",0))},render:function l(){var m=this.props,n=m.allRequirements,o=m.selectedRequirements,p=m.placeholder,q=m.onDeleteRequirement,r=m.onCreateRequirement,s=m.timeline;return c("React").createElement(c("OzTokenizer.react"),{placeholder:p,allTokens:n.toList(),chosenTokens:o,onDeleteToken:q,onCreateToken:r,resultRank:this._requirementSort,resultFilter:function t(u,v){return u.get("name").toLowerCase().indexOf(v.toLowerCase())>=0},timeline:s})}});f.exports=k}),null);
__d("OzTimestampScrolling.react",["cx","OzActions","React","Tooltip"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l=3e3;i=babelHelpers.inherits(m,c("React").PureComponent);j=i&&i.prototype;function m(){var n,o;"use strict";for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={state:null},this.$OzTimestampScrolling2=function(){this.setState({state:"loading"});c("OzActions").scrollThreadToTimestamp(this.props.timestamp)}.bind(this),o}m.prototype.componentDidMount=function(){"use strict";this.$OzTimestampScrolling1=c("OzActions").doneScrollingToTimestamp.listen(function(n,o){if(this.props.timestamp===n)if(o)this.setState({state:"error"},function(p){window.setTimeout(function(p){this.setState({state:null})}.bind(this),l)}.bind(this));else this.setState({state:null})}.bind(this))};m.prototype.componentWillUnmount=function(){"use strict";this.$OzTimestampScrolling1()};m.prototype.render=function(){"use strict";var n="_1e3l"+(!this.state.state?" _1y5w":"")+(this.state.state==="loading"?" _1y5x":"")+(this.state.state==="error"?" _1y5y":"");return c("React").createElement("span",{className:n,onClick:this.$OzTimestampScrolling2,role:"presentation"},this.props.children)};m.propTypes={timestamp:k.number.isRequired};f.exports=m}),null);
__d("OzSidebarItemHeader.react",["cx","fbt","OzHelpers","Keys","OzCheckboxInput.react","OzConfig","OzDate.react","OzTimestampScrolling.react","OzImmutablePureRenderMixin","React","Reflux","Tooltip","XUIAbstractGlyphButton.react","XUICloseButton.react","FBButtonMenuCombo.react","OzButton.react","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("FBButtonMenuCombo.react").Item,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzSidebarItemHeader",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{alias:k.string,closedAt:k.number,createdAt:k.number,creator:k.string,intentId:k.number,isBlocked:k.bool,isClosed:k.bool.isRequired,isExpanded:k.bool,label:k.string,onCancel:k.func,onChangeAlias:k.func,onIsExpandedToggle:k.func,onToggle:k.func,skipScrollToTimestamp:k.bool,subtitle:k.node,timelineGK:k.bool,title:k.string.isRequired},getDefaultProps:function n(){return{timelineGK:false}},getInitialState:function n(){return{isEditing:false}},render:function n(){var o=this.props,p=o.alias,q=o.className,r=o.closedAt,s=o.createdAt,t=o.intentId,u=o.isBlocked,v=o.isClosed,w=o.isExpanded,x=o.label,y=o.onCancel,z=o.onIsExpandedToggle,A=o.onToggle,B=o.skipScrollToTimestamp,C=o.subtitle,D=o.timelineGK,E=o.title,F=v?r:s,G=this.state.config.getIn(["GK","timeline"]),H=t&&G?{color:"white"}:{},I=t&&G?{background:c("OzHelpers").color(t)}:{};return c("React").createElement("div",{className:c("joinClasses")(q,"_31gu"+(w?" _31gx":"")+(u?" _27qc":"")+(v&&!D?" _31gy":""))},A?c("React").createElement(c("OzCheckboxInput.react"),{checked:v,className:"_31gz",onChange:A}):null,c("React").createElement("div",{className:"_31g-"},c("React").createElement("div",null,c("React").createElement("span",null,F?B?c("React").createElement(c("OzDate.react"),{className:"_56sd",timestamp:F}):c("React").createElement(c("OzTimestampScrolling.react"),{timestamp:F},c("React").createElement(c("OzDate.react"),{className:"_56sd",timestamp:F})):null),c("React").createElement(m,{alias:p,isBlocked:u,isEditing:this.state.isEditing,name:E,onChange:this._handleChangeAlias,onStartEditing:this._handleStartEditing,onCancelEditing:this._handleCancelEditing}),x?c("React").createElement("span",{className:"_5o4m"},x):null),c("React").createElement("span",{className:"_31h0"},C)),c("React").createElement("div",{className:"_3_41"},this.props.children,z?c("React").createElement(c("XUIAbstractGlyphButton.react"),{className:"_31h1",label:i._("Ampliar"),labelIsHidden:true,onClick:z}):null,y&&c("React").createElement(c("XUICloseButton.react"),{onClick:y})))},_handleStartEditing:function n(){this.props.onChangeAlias&&this.setState({isEditing:true})},_handleCancelEditing:function n(){this.setState({isEditing:false})},_handleChangeAlias:function n(o){var p=this.props.onChangeAlias;if(o.which===c("Keys").RETURN){p&&p(o.target.value);this.setState({isEditing:false})}}}),m=c("OzHelpers").pure(function(n){var o=n.name,p=n.isBlocked,q=n.isEditing,r=n.alias,s=n.onChange,t=n.onStartEditing,u=n.onCancelEditing,v=n.style;return q?c("React").createElement("textarea",{className:"_31g_ _1p0b",style:v,onKeyDown:s,placeholder:o,defaultValue:r,onBlur:u,ref:function w(x){if(x){x.focus();c("OzHelpers").moveCursorToInputEnd(x)}}}):c("React").createElement("span",babelHelpers["extends"]({className:"_31g_"+(p?" _7ok":""),style:v,onClick:t},c("Tooltip").propsFor(r?o:null)),r||o)});f.exports=l}),null);
__d("OzGenericIntent.react",["ix","cx","Promise","OzAPI","fbglyph","OzHelpers","promiseFinally","Image.react","immutable","MessengerButtonReact.bs","OzButton.react","OzConfig","OzFormPreview.react","OzIntentActions.react","OzIntentParams.react","OzRequirementTokenizer.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","Reflux","OzIntentParamsTextField.react","Tooltip","OzDate.react","OzTimestampScrolling.react","URI","XUISingleSelector.react","Stars.react","OzActions","OzFeedbackCloseDialog.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("MessengerButtonReact.bs").jsComponent,k=c("immutable").List,l=c("immutable").Map,m=c("immutable").Set,n=c("React").PropTypes,o=c("OzFormPreview.react").Row,p=c("XUISingleSelector.react").Option,q=c("OzHelpers").pure(function(B){var C=B.meta,D=C&&C.get("send-survey",false);if(D){var E=C.get("rating3")||"-1",F=parseInt(E,10);return c("React").createElement("div",{className:"_40k2"+(F===1?" _40k3":"")+(F===0?" _40k4":"")},F===0?c("React").createElement("span",{title:"User says M is not done"},"Not Done"):c("React").createElement(c("Stars.react"),{count:F,max:3,size:"small",title:C.get("user-feedback")}))}else{var G=C&&C.getIn(["feedback","did-not-send-survey-reason"]);return c("React").createElement("div",{className:"_40k2"},c("React").createElement("span",null,G==="option-not-presented"?c("React").createElement("span",{title:"Not relevant"},"N/A"):G==="really-bad-experience"&&c("React").createElement("span",{className:"_40k3",title:"Survey not sent because of really bad ux"},"Bad")))}}),r=c("React").createClass({displayName:"OzGenericIntent",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{intent:n.instanceOf(l).isRequired,location:n.instanceOf(l).isRequired,notes:n.string.isRequired,onChangeAlias:n.func.isRequired,onClose:n.func.isRequired,onNotesChange:n.func.isRequired,onOpen:n.func.isRequired,onIsBlockedToggle:n.func.isRequired,onTriggerAI:n.func.isRequired,requirements:n.instanceOf(l).isRequired,onCreateRequirement:n.func,onDeleteRequirement:n.func,repNames:n.instanceOf(l).isRequired,userEmail:n.string,thread:n.instanceOf(l).isRequired,timelineGK:n.bool},render:function B(){var C=this.props,D=C.intent,E=C.repNames,F=C.timelineGK,G=c("OzHelpers").isDeleted(D);if(G)return c("React").createElement("span",null);var H=D.get("creator-fbid"),I=E.get(H,H),J=D.get("blocked"),K=c("OzHelpers").intentName(D);return c("React").createElement("div",{className:"_37lt"},c("React").createElement(c("OzSidebarItemHeader.react"),{alias:D.get("alias"),className:(!F?"_a2q":"")+(F?" _37lv":""),intentId:D.get("id"),isClosed:c("OzHelpers").isClosedIntent(D),onClose:this._handleClose,closeState:D.get("state"),isBlocked:J,onChangeAlias:this._handleChangeAlias,onFeedback:this._handleIntentFeedback,onToggle:this._handleToggle,onTriggerAI:this.props.onTriggerAI,timelineGK:F,title:K,creator:I},this._renderTriggerAI()),this._renderBody())},_renderTriggerAI:function B(){var C=h("140058"),D=h("112825"),E=this.state.config.getIn(["GK","timeline"])?C:D;return c("React").createElement(c("OzButton.react"),babelHelpers["extends"]({tight:true,onClick:this.props.onTriggerAI},c("Tooltip").propsFor("Rerun the AI for this intent")),c("React").createElement(c("Image.react"),{src:E}))},_renderBody:function B(){var C=this.props,D=C.intent,E=C.repNames,F=C.userEmail,G=C.location,H=C.thread,I=C.timelineGK,J=C.children,K=D.get("creator-fbid"),L=K===c("OzConfig").getStaticConfig("PAGE_ID")?"Bot":K,M="Created by "+E.get(K,L);return c("React").createElement("div",null,!I?c("React").createElement(c("OzIntentActions.react"),{intent:D,userEmail:F,location:G}):null,c("React").createElement("div",{className:"_1x_z"},c("React").createElement(c("OzFormPreview.react"),null,c("React").createElement(o,{label:"Status",className:"_10sn"},c("React").createElement(t,{intent:D,thread:H})),c("React").createElement(o,{label:"Created",tip:M,className:"_10sn"},u(D.get("created-at"))),c("React").createElement(o,{label:"Closed",className:"_10sn"},u(D.get("closed-at"))),c("React").createElement(o,{label:"Assigned Bot",className:"_10sn"},D.get("assigned-bot")||"None"))),c("React").createElement("div",{className:"_10sn"},J.length?c("React").createElement(c("OzIntentParams.react"),null,J):null,c("React").createElement("div",{className:"_2qn_"},this.state.config.getIn(["GK","bookOnOpenTableButton"])&&x(D)?this._renderOpenTableButton():null,this.state.config.getIn(["GK","scriptRestaurantClose"])&&x(D)?this._renderAutomationTrigger():null)),c("React").createElement("div",{className:"_1x-e _10sn"},c("React").createElement(c("OzRequirementTokenizer.react"),{allRequirements:this.props.requirements,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,selectedRequirements:D.get("requirements"),placeholder:"Add a requirement/tag..."})),c("React").createElement(c("OzIntentParams.react"),null,c("React").createElement("div",{className:"_19ny"},c("React").createElement(c("OzIntentParamsTextField.react"),{label:"Add notes about this intent...",onChange:this.props.onNotesChange,value:this.props.notes}))),I?c("React").createElement(c("OzIntentActions.react"),{intent:D,userEmail:F,location:G,timelineGK:I}):null)},_renderOpenTableButton:function B(){var C=this.props,D=C.thread,E=C.intent,F=y(D,E),G=z(F);if(!this.state.config.getIn(["GK","openTableAPI"]))return c("React").createElement(j,{className:(!(G&&G.length>0)?"_2qo0":"")+" _2qo1",onClick:this._handleOpenTableClick,type:"primary",label:"Book on OT"});else{var H=E.getIn(["params","request_type"],k()).first();if(!H||H.get("value")!=="reservation")return null;var I=A(E),J=!I.isEmpty()?"Missing fields: "+I.join(", "):"Book on OpenTable, schedule autosends, and send invite";return c("React").createElement(j,{className:(!I.isEmpty()?"_2qo0":"")+" _2qo1",onClick:this._handleOpenTableClick,type:"primary",label:"Book on OT via API",title:J})}},_renderAutomationTrigger:function B(){var C=this.props.intent,D=C.getIn(["params","request_type"],k()).first();if(!D||D.get("value")!=="reservation")return null;var E=A(C),F=!E.isEmpty()?"Missing fields: "+E.join(", "):"Send confirmation message, schedule autosends, and send invite";return c("React").createElement(j,{className:(!E.isEmpty()?"_2qo0":"")+" _2qo1",onClick:this._handleAutomationClick,type:"primary",label:"Run close automation",title:F})},_handleAutomationClick:function B(C){var D=this.props,E=D.thread,F=D.intent,G=c("OzHelpers").threadID(E),H=F.get("id"),I="close-restaurant",J=c("OzHelpers").getRequirement(F,I),K=J?c("OzAPI").deleteIntentRequirement(G,H,J.get("id")):c("Promise").resolve();return K.then(function(){return c("OzAPI").createIntentRequirement(G,H,I)})},_handleOpenTableClick:function B(C){var D=this.props,E=D.thread,F=D.intent,G=y(E,F);if(G.has("opentable-url"))if(this.state.config.getIn(["GK","openTableAPI"])&&G.has("ts")&&G.has("rid")&&G.has("party-size"))c("OzAPI").bookOpenTable(c("OzHelpers").threadID(E),F.get("id"),G.get("rid"),G.get("ts"),G.get("party-size"));else{var H=z(G);if(H.length)window.open(H,"_blank").focus()}},_handleChangeAlias:function B(C){var D=this.props,E=D.intent,F=D.onChangeAlias;F&&F(E,C)},_handleOpen:function B(){var C=this.props,D=C.intent,E=C.onOpen;E(D.get("id"))},_handleClose:function B(C){var D=this.props,E=D.intent,F=D.onClose;F(E.get("id"),C)},_handleIsBlockedToggle:function B(){var C=this.props,D=C.intent,E=C.onIsBlockedToggle;E(D)},_handleCreateRequirement:function B(C){var D=this.props,E=D.intent,F=D.onCreateRequirement;if(F)F(E.get("id"),C.get("name"))},_handleDeleteRequirement:function B(C){var D=this.props,E=D.intent,F=D.onDeleteRequirement;if(F)F(E.get("id"),C.get("id"))}}),s=["Active","Waiting","Closed"],t=c("React").createClass({displayName:"StatusDropdown",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{intent:n.instanceOf(l).isRequired,thread:n.instanceOf(l).isRequired},getInitialState:function B(){return{sem:0}},render:function B(){var C=this.props.intent,D=w(C),E=v(C).set("rating3",D.rating3).set("user-feedback",D.feedback);return c("React").createElement("div",null,c("React").createElement(c("XUISingleSelector.react"),{maxHeight:240,onChange:this._handleChange,value:this._value(),disabled:this.state.sem!==0},s.map(function(F){return c("React").createElement(p,{key:F,value:F},F)})),c("React").createElement(q,{meta:E}))},_value:function B(){var C=this.props.intent;return c("OzHelpers").isBlockedIntent(C)&&"Waiting"||c("OzHelpers").isClosedIntent(C)&&"Closed"||"Active"},_handleChange:function B(C){var D=C.value;switch(D){case"Active":this._handleOpen();break;case"Waiting":this._handleWaiting();break;case"Closed":this._handleIntentFeedback();break;default:c("OzHelpers").debug("[unknown intent state]")}},_sem:function B(C){var D=function(E){return this.setState(function(F){return{sem:F.sem+E}})}.bind(this);D(1);c("promiseFinally")(C,function(E){return D(-1)})},_handleOpen:function B(){var C=this.props.intent;this._sem(c("OzAPI").openIntent(C.get("user-id"),C.get("id")))},_handleWaiting:function B(){var C=this.props.intent;this._sem(c("OzAPI").blockIntent(C.get("user-id"),C.get("id")))},_handleIntentFeedback:function B(){var C=this.props,D=C.intent,E=C.thread,F=E.get("events",k()).filter(function(G){return m(["send","suggest"]).has(G.get("type"))&&G.get("at",0)>c("OzHelpers").serverNow()}).sortBy(function(G){return G.get("at")});c("OzActions").showDialog(c("OzFeedbackCloseDialog.react"),{intent:D,scheduleds:F,title:"Close Intent",onFeedbackDone:function(D,G,H,I){var J=G["close-state"];I&&I.map(function(K){return c("OzAPI").deleteScheduled(c("OzHelpers").threadID(E),K.get("id"))});this._sem(c("OzAPI").closeIntent(D.get("user-id"),D.get("id"),J,G,H));c("OzActions").hideDialog()}.bind(this)})}});function u(B){return B?c("React").createElement(c("OzTimestampScrolling.react"),{timestamp:B},c("React").createElement(c("OzDate.react"),{timestamp:B})):null}function v(B){return(B.get("events",k()).filter(function(C){return C.get("type")==="close-intent"}).maxBy(function(C){return C.get("timestamp")})||l()).get("data",l())}function w(B){var C=(B.get("events",k()).filter(function(D){return D&&D.getIn(["data","action"])==="intent_survey"}).last()||l()).getIn(["data","metadata"],"{}");return JSON.parse(C)}function x(B){var C=B.getIn(["metadata","category"]);return C==="restaurant"}function y(B,C){__p&&__p();var D=l(),E=B.get("guesses",k()).filter(function(P){return P.get("class")==="suggestions"}).first(),F=E?E.get("items",k()).filter(function(P){return P.get("type")==="bubble"}):k();if(F.count()>0){var G=F.first().get("meta",l()),H=G.getIn(["open-table","url"]),I=G.getIn(["open-table","rid"]);D=D.set("rid",I);if(H&&H.length>0){D=D.set("opentable-url",H);var J=C.get("params",l()),K=J.get("datetime",k()).first(),L=K?K.get("value",""):"";if(L.length>0){var M=new Date(L).getTime();D=D.set("ts",M)}var N=J.get("people_number",k()).first(),O=N?N.get("value",0):0;if(O>0)D=D.set("party-size",O)}}return D}function z(B){__p&&__p();var C=B.get("opentable-url");if(C&&C.length>0){var D=new(c("URI"))(C),E=B.get("ts");if(E){var F=new Date().getTimezoneOffset()*6e4,G=new Date(E-F).toISOString().slice(0,-1);D.addQueryData("dateTime",G)}var H=B.get("party-size",0);if(H>0)D.addQueryData("covers",H);return D.toString()}return""}function A(B){var C=k(["datetime","location","people_number","restaurant_name","place_id"]);return C.filterNot(function(D){return B.getIn(["params",D])})}f.exports=r}),null);
__d("OzIntentParamsDateTimeField.react",["immutable","OzDateTimePicker.react","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=c("immutable").Map,j=c("React").createClass({displayName:"OzIntentParamsDateTimeField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:h.string,location:h.instanceOf(i).isRequired,onChange:h.func,value:h.instanceOf(Date)},getInitialState:function k(){return{timezone:this.props.location.get("timezone")}},render:function k(){return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:!!this.props.value,label:this.props.label},c("React").createElement(c("OzDateTimePicker.react"),{datePlaceholder:this.props.label,layout:"three-line",onChange:this._handleChange,showTimezoneName:false,timestamp:this.props.value&&this.props.value.getTime(),timezone:this.state.timezone}))},_handleChange:function k(l){var m=l.timezone,n=l.timestamp;this.props.onChange(new Date(n));this.setState({timezone:m})}});f.exports=j}),null);
__d("OzIntentParamsEnumField.react",["immutable","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React","XUISingleSelector.react"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("immutable").List,i=c("immutable").OrderedSet,j=c("React").PropTypes,k=c("XUISingleSelector.react").Option,l=c("React").createClass({displayName:"OzIntentParamsEnumField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:j.string,onChange:j.func,onSave:j.func,placeholder:j.string,values:j.arrayOf(j.string).isRequired,value:j.string},getInitialState:function m(){return{value:this.props.value||""}},render:function m(){var n=(this.state.value?i(this.props.values).add(this.state.value).toList():h(this.props.values)).map(function(o){return c("React").createElement(k,{key:o,value:o},o)}).unshift(c("React").createElement(k,{key:this.props.placeholder,value:""},this.props.placeholder));return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:!!this.state.value,label:this.props.label},c("React").createElement(c("XUISingleSelector.react"),{maxHeight:240,onChange:this._handleChange,value:this.state.value},n))},_handleChange:function m(n){this.props.onChange&&this.props.onChange(n.value);this.setState({value:n.value},this._save)},_save:function m(){if(this.props.onSave)this.props.onSave(this.state.value)}});f.exports=l}),null);
__d("OzIntentParamsNumberField.react",["cx","FBNumberInput.react","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzIntentParamsNumberField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:i.string,onChange:i.func,placeholder:i.string,value:i.number},render:function k(){return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:this.props.value!=null,label:this.props.label},c("React").createElement(c("FBNumberInput.react"),{className:"_3dag",onValueChange:this.props.onChange,placeholder:this.props.placeholder,value:this.props.value}))}});f.exports=j}),null);
__d("OzLocationSearchSource",["WebAsyncSearchSource"],(function a(b,c,d,e,f,g){var h={allow_places:true,include_likes:false,include_subtext:true,include_address:1,limit:5,map_height:null,map_width:null,render_map:false,use_searchable_entries:true,use_unicorn:true},i=new(c("WebAsyncSearchSource"))({bootstrapRequests:[{uri:"/ajax/places/typeahead",data:h}],getAllForEmptyQuery:true,queryRequests:[{uri:"/ajax/places/typeahead",data:babelHelpers["extends"]({},h,{hide_geo:true})}]});i.search("",function(j){});f.exports=i}),null);
__d("OzPlaceField.react",["cx","joinClasses","immutable","OzConfig","OzLocationSearchSource","ReactComponentWithPureRenderMixin","React","Reflux","SearchableEntry","XUIError.react","XUITypeahead.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("React").PropTypes,j=c("immutable").Map,k=c("React").createClass({displayName:"OzPlaceField",mixins:[c("ReactComponentWithPureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:babelHelpers["extends"]({disabled:i.bool,onQueryStringChange:i.func.isRequired,onSelect:i.func.isRequired,placeholder:i.string,queryString:i.string,selectedEntry:i.instanceOf(j)},c("XUIError.react").PropTypes),getDefaultProps:function n(){return{disabled:false,placeholder:"Place"}},render:function n(){var o=this.props,p=o.className,q=o.disabled,r=o.onQueryStringChange,s=o.onSelect,t=o.placeholder,u=o.queryString,v=o.selectedEntry,w=c("joinClasses")("_44sp"+(q?" _44sq":""),p);return c("React").createElement(c("XUITypeahead.react"),{className:w,disabled:q,onChange:function x(y){return r(y.target.value)},onSelectAttempt:function x(y){return s(l(y))},placeholder:t,queryString:u,searchSource:c("OzLocationSearchSource"),selectedEntry:v&&v.get("id")&&v.get("name")?m(v):null,showEntriesOnFocus:true,tallInput:false,xuiErrorPosition:"left"})}});function l(n){return j({id:+n.getUniqueID(),name:n.getTitle(),description:n.getSubtitle(),photo:n.getPhoto()})}function m(n){return new(c("SearchableEntry"))({title:n.get("name"),subtitle:n.get("description"),uniqueID:n.get("id"),photo:n.get("photo")})}f.exports=k}),null);
__d("OzIntentParamsPlaceField.react",["OzIntentParamsAbstractField.react","OzPlaceField.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=c("React").createClass({displayName:"OzIntentParamsPlaceField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:h.string,onChange:h.func,onSave:h.func,placeholder:h.string,value:h.oneOfType([h.string,h.object])},render:function j(){var k=this.props,l=k.value,m=k.label,n=k.onChange,o=k.placeholder,p=l?typeof l==="string"?l:l.get("name")||"":"";return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:!!l,label:m},c("React").createElement(c("OzPlaceField.react"),{onQueryStringChange:n,onSelect:n,placeholder:o,queryString:p,selectedEntry:typeof l==="object"?l:null}))}});f.exports=i}),null);
__d("OzIntentParamsPriceRangeField.react",["cx","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=[1,2,3,4],k=c("React").createClass({displayName:"OzIntentParamsPriceRangeField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:i.string,onChange:i.func,value:i.oneOf(j)},render:function l(){var m=this.props.value;return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:!!m,label:this.props.label},c("React").createElement("span",{className:"_8l3"},j.map(function(n){return c("React").createElement("span",{className:"_8l4"+(m&&n<=m?" _8l6":""),key:n,onClick:function(o){return this._handleDollarClick(o,n)}.bind(this),role:"presentation"},"$")}.bind(this))))},_handleDollarClick:function l(m,n){m.preventDefault();var o=this.props.value==n?null:n;this.props.onChange&&this.props.onChange(o)}});f.exports=k}),null);
__d("OzIntentParamsStringField.react",["invariant","AbstractTextInput.react","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React","debounce"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"OzIntentParamsStringField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{label:i.string,onChange:i.func,onSave:i.func,placeholder:i.string,value:i.string},getInitialState:function k(){return{value:this.props.value||""}},componentWillMount:function k(){this._save=c("debounce")(this._save,750,this,true)},render:function k(){return c("React").createElement(c("OzIntentParamsAbstractField.react"),{hasValue:!!this.state.value,label:this.props.label},c("React").createElement(c("AbstractTextInput.react"),{onChange:this._handleChange,placeholder:this.props.placeholder,type:"text",value:this.state.value}))},_handleChange:function k(l){var m=l.target;m instanceof HTMLInputElement||h(0);this.props.onChange&&this.props.onChange(m.value);this.setState({value:m.value},this._save)},_save:function k(){if(this.props.onSave)this.props.onSave(this.state.value)}});f.exports=j}),null);
__d("OzIntentFactoryHelpers",["immutable","React","OzIntentParamsStringField.react","OzIntentParamsNumberField.react","OzIntentParamsPriceRangeField.react","OzIntentParamsEnumField.react","OzIntentParamsDateTimeField.react","OzIntentParamsPlaceField.react"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("immutable").Map,i={makeStateUpdater:function l(m){return function(n){var o;this._setStateAndSave((o={},o[m]=n,o))}},makeStateExtractor:function l(m){__p&&__p();return function(n){__p&&__p();var o=n.get("params")||h(),p={};for(var q=m,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var t;if(r){if(s>=q.length)break;t=q[s++]}else{s=q.next();if(s.done)break;t=s.value}var u=t,v=u.name,w=u.type,x=j(o,v);switch(w){case"string":case"enum":p[v]=""+(x||"");break;case"number":case"pricerange":p[v]=+x||null;break;case"datetime":p[v]=x&&new Date(x);break;case"place":var y=j(o,"place_id");p[v]=h({id:y,name:x});break}}return babelHelpers["extends"]({},p,{notes:n.get("notes")||""})}},makeParamsUpdater:function l(m){__p&&__p();return function(n,o){__p&&__p();return(n||h()).withMutations(function(n){__p&&__p();for(var p=m,q=Array.isArray(p),r=0,p=q?p:p[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var s;if(q){if(r>=p.length)break;s=p[r++]}else{r=p.next();if(r.done)break;s=r.value}var t=s,u=t.name,v=t.type;switch(v){case"datetime":var w=o[u],x=w?{value:w.toISOString(),grain:"minute"}:undefined;k(n,u,x);break;case"place":var y=o[u];if(typeof y==="object"){k(n,"place_id",{value:y.get("id")});k(n,u,{value:y.get("name")})}else{k(n,"place_id",{value:null});k(n,u,{value:y})}break;default:k(n,u,{value:o[u]});break}}})}},makeFieldRenderer:function l(m){return function(n){return m.map(function(o){var p=o.label,q=o.name,r=o.placeholder,s=o.type,t=o.values,u=i.getFieldComponent(s);return c("React").createElement(u,{key:q,label:p,location:n,onChange:this._changeHandlers.get(q),placeholder:r||p,value:this.state[q],values:t})}.bind(this))}},getFieldComponent:function l(m){switch(m){case"string":return c("OzIntentParamsStringField.react");case"number":return c("OzIntentParamsNumberField.react");case"pricerange":return c("OzIntentParamsPriceRangeField.react");case"enum":return c("OzIntentParamsEnumField.react");case"datetime":return c("OzIntentParamsDateTimeField.react");case"place":return c("OzIntentParamsPlaceField.react");default:throw new Error("OzIntentFactoryHelpers: Unknown field type "+m+".")}}};function j(l,m){var n=l.get(m);if(n&&!n.isEmpty())return n.first().get("value");return null}function k(l,m,n){l.set(m,c("immutable").fromJS([n]))}f.exports=i}),null);
__d("OzIntentSchemas",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={get:function M(N,O){__p&&__p();var P=O.getIn(["GK","scriptRestaurantClose"]);switch(N){case"restaurant":case"restaurant_bar":return P?k:j;case"reminder":return l;case"appointment":case"nonmedical_appointment":return m;case"local_search":return n;case"good_purchase":return o;case"customer_service":case"customer_service_general":return p;case"weather_forecast":return q;case"hotel_and_accommodation":return r;case"activities_things_to_do":return s;case"ticket_purchase":case"movie_concert_show":return t;case"food_purchase":return u;case"utility":return v;case"book_car_transportation":case"vehicle_service":return w;case"traffic":return x;case"navigation":return y;case"flight_request":return z;case"stocks":return A;case"moviebot_search_movie":return B;case"moviebot_search_screening_event":return C;case"moviebot_buy_ticket":return D;case"moviebot_search_review":return E;case"moviebot_watch_trailer":return F;case"moviebot_provide_slot_value":return G;case"moviebot_reject":return H;case"moviebot_accept":return I;case"moviebot_greeting":return J;case"moviebot_help":return K;case"moviebot_other":return L;default:return i}}},i={name:"Generic",fields:[]},j={name:"Restaurant",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","confirm","change","info","location","option"]},{type:"string",name:"restaurant_name",label:"Name",placeholder:"Restaurant Name"},{type:"string",name:"restaurant_cuisine",label:"Cuisine"},{type:"string",name:"location",label:"Location"},{type:"number",name:"people_number",label:"Guests",placeholder:"Number of guests"},{type:"pricerange",name:"amount_of_money",label:"Price Range"},{type:"datetime",name:"datetime",label:"Date/Time"}]},k={name:"Restaurant",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","confirm","change","info","location","option"]},{type:"place",name:"restaurant_name",label:"Name",placeholder:"Restaurant Name"},{type:"string",name:"restaurant_cuisine",label:"Cuisine"},{type:"string",name:"location",label:"Location"},{type:"number",name:"people_number",label:"Guests",placeholder:"Number of guests"},{type:"pricerange",name:"amount_of_money",label:"Price Range"},{type:"datetime",name:"datetime",label:"Date/Time"}]},l={name:"reminder",fields:[{type:"datetime",name:"datetime",label:"Reminder Time"},{type:"string",name:"reminder",label:"About"}]},m={name:"NonMedicalAppt",fields:[{type:"enum",name:"appt_action",label:"Action",placeholder:"Pick one...",values:["availability","cancel","move","confirm","book"]},{type:"string",name:"appt_type",label:"Appt Type",placeholder:"Type of appointment"},{type:"string",name:"location",label:"Location",placeholder:"Location of appointment"},{type:"datetime",name:"datetime",label:"Datetime",placeholder:"Date and time of the appointment"},{type:"string",name:"local_search_query",label:"Name",placeholder:"Name of the place"}]},n={name:"LocalSearch",fields:[{type:"string",name:"local_query",label:"Query",placeholder:"Search query like yoga class..."},{type:"string",name:"location",label:"Location",placeholder:""},{type:"string",name:"local_name",label:"Name",placeholder:"Name of the place or business..."},{type:"datetime",name:"datetime",label:"Datetime",placeholder:""}]},o={name:"GoodPurchase",fields:[{type:"string",name:"good",label:"Good",placeholder:""},{type:"string",name:"provider",label:"Merchant",placeholder:""},{type:"string",name:"amount_of_money",label:"Price"},{type:"number",name:"good_number",label:"Items #",placeholder:"Number of Items"},{type:"string",name:"location",label:"Location",placeholder:""}]},p={name:"CustomerService",fields:[{type:"string",name:"provider",label:"Merchant"},{type:"string",name:"order_number",label:"Order #"}]},q={name:"Weather",fields:[{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Datetime"},{type:"string",name:"weather_type",label:"Type of forecast",placeholder:"temperature, snow, tide..."},{type:"string",name:"temperature_metric",label:"Metric",placeholder:"Celsius or Fahrenheit"}]},r={name:"Hotel",fields:[{type:"enum",name:"hotel_query_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","contact","extend","receipt"]},{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Check in",placeholder:"Date and time of the appointment"},{type:"number",name:"night_number",label:"Nights #",placeholder:"Number of Nights"},{type:"number",name:"people",label:"People",placeholder:"Number of Guests"},{type:"string",name:"amount_of_money",label:"Price"},{type:"string",name:"hotel_name",label:"Hotel Name"}]},s={name:"Activities",fields:[{type:"string",name:"reservation_type",label:"Activity"},{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Datetime"},{type:"string",name:"amount_of_money",label:"Price"},{type:"number",name:"people_number",label:"People",placeholder:"Number of People"}]},t={name:"Tickets",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","info","location","option","price","receipt","time","schedule"]},{type:"string",name:"event_type",label:"Type",placeholder:"Movie, show, concert..."},{type:"string",name:"event",label:"Name"},{type:"string",name:"event_venue",label:"Venue"},{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Datetime"},{type:"string",name:"amount_of_money",label:"Price"},{type:"number",name:"people_number",label:"Tickets #",placeholder:"Number of Tickets"}]},u={name:"FoodPurchase",fields:[{type:"string",name:"order",label:"Order",placeholder:""},{type:"string",name:"food_type",label:"Food Type",placeholder:""},{type:"string",name:"food_place",label:"Place"},{type:"enum",name:"delivery_type",label:"Delivery",placeholder:"Pick one...",values:["deliver","takeout"]},{type:"string",name:"location",label:"Location",placeholder:""},{type:"datetime",name:"datetime",label:"Datetime"}]},v={name:"Utility",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","info","location","option","price","receipt","time","schedule"]},{type:"string",name:"utility_provider",label:"Name",placeholder:"Name of the utility company"},{type:"string",name:"location",label:"Location",placeholder:""},{type:"string",name:"account_nbr",label:"Account #",placeholder:""}]},w={name:"Vehicle",fields:[{type:"enum",name:"hotel_query_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","info","location","option","price","receipt","time","schedule"]},{type:"string",name:"from",label:"From"},{type:"string",name:"to",label:"To"},{type:"datetime",name:"datetime",label:"Datetime",placeholder:"Date and time of the ride"},{type:"string",name:"car_type",label:"Car Type",placeholder:"Type of car (limo, uber, lift...)"},{type:"string",name:"people_number",label:"People",placeholder:"Number of Guests"},{type:"string",name:"vehicle_provider",label:"Rental Name",placeholder:"Car rental name like Hertz, Avis.."}]},x={name:"Traffic",fields:[{type:"string",name:"from",label:"Starting Point"},{type:"string",name:"to",label:"Destination"},{type:"datetime",name:"datetime",label:"Date/Time",placeholder:"Intended departure time (not supported by automation)"}]},y={name:"Navigation",fields:[{type:"string",name:"from",label:"Starting Point"},{type:"string",name:"to",label:"Destination"},{type:"datetime",name:"datetime",label:"Date/Time",placeholder:"Intended departure time (not supported by automation)"}]},z={name:"flight_request",fields:[{type:"enum",name:"flight_query_type",label:"Action",placeholder:"Pick one...",values:["book","price","upgrade","flight_status","cancel","change"]},{type:"string",name:"from",label:"From"},{type:"string",name:"to",label:"To"},{type:"datetime",name:"departure",label:"Departure"},{type:"datetime",name:"arrival",label:"Arrival"},{type:"string",name:"carrier",label:"Carrier"},{type:"string",name:"reference",label:"Reference #"},{type:"string",name:"passenger_num",label:"Passenger #"}]},A={name:"stocks",fields:[{type:"string",name:"stock_symbol_list",label:"Stocks",placeholder:"Comma separated list of symbols"}]},B={name:"moviebot_search_movie",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"},{type:"string",name:"age_rating_text",label:"age_rating - text",placeholder:"Part of message with age_rating"},{type:"string",name:"age_rating_entity",label:"age_rating - entity",placeholder:"age_rating referred to"},{type:"string",name:"genre_text",label:"genre - text",placeholder:"Part of message with genre"},{type:"string",name:"genre_entity",label:"genre - entity",placeholder:"genre referred to"}]},C={name:"moviebot_search_screening_event",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"}]},D={name:"moviebot_buy_ticket",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"ticket_count_text",label:"ticket_count - text",placeholder:"Part of message with ticket_count"},{type:"string",name:"ticket_count_entity",label:"ticket_count - entity",placeholder:"ticket_count referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"}]},E={name:"moviebot_search_review",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"}]},F={name:"moviebot_watch_trailer",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"}]},G={name:"moviebot_provide_slot_value",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"ticket_count_text",label:"ticket_count - text",placeholder:"Part of message with ticket_count"},{type:"string",name:"ticket_count_entity",label:"ticket_count - entity",placeholder:"ticket_count referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"},{type:"string",name:"age_rating_text",label:"age_rating - text",placeholder:"Part of message with age_rating"},{type:"string",name:"age_rating_entity",label:"age_rating - entity",placeholder:"age_rating referred to"}]},H={name:"moviebot_reject",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},I={name:"moviebot_accept",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},J={name:"moviebot_greeting",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},K={name:"moviebot_help",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},L={name:"moviebot_other",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"ticket_count_text",label:"ticket_count - text",placeholder:"Part of message with ticket_count"},{type:"string",name:"ticket_count_entity",label:"ticket_count - entity",placeholder:"ticket_count referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"},{type:"string",name:"age_rating_text",label:"age_rating - text",placeholder:"Part of message with age_rating"},{type:"string",name:"age_rating_entity",label:"age_rating - entity",placeholder:"age_rating referred to"},{type:"string",name:"genre_text",label:"genre - text",placeholder:"Part of message with genre"},{type:"string",name:"genre_entity",label:"genre - entity",placeholder:"genre referred to"}]};f.exports=h}),null);
__d("OzIntentFactory",["immutable","Map","OzAPI","OzGenericIntent.react","OzIntentFactoryHelpers","OzIntentSchemas","OzImmutablePureRenderMixin","React","debounce"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("React").PropTypes,i=new(c("Map"))(),j={get:function l(m,n){var o=c("OzIntentSchemas").get(m,n);if(!i.has(m))i.set(m,k(o));return i.get(m)}};function k(l){__p&&__p();var m=c("immutable").Map,n=l.name,o=l.fields,p=1e4,q=c("OzIntentFactoryHelpers").makeStateExtractor(o),r=c("OzIntentFactoryHelpers").makeFieldRenderer(o),s=c("OzIntentFactoryHelpers").makeParamsUpdater(o);return c("React").createClass({displayName:"Oz"+n+"DynamicIntent",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{intent:h.instanceOf(m).isRequired,location:h.instanceOf(m).isRequired,onChangeAlias:h.func.isRequired,onClose:h.func.isRequired,onOpen:h.func.isRequired,onIsBlockedToggle:h.func.isRequired,onTriggerAI:h.func.isRequired,requirements:h.instanceOf(m).isRequired,repNames:h.instanceOf(m).isRequired,onCreateRequirement:h.func,onDeleteRequirement:h.func,thread:h.instanceOf(m).isRequired,userEmail:h.string},getInitialState:function t(){return babelHelpers["extends"]({isEditing:false},q(this.props.intent))},componentWillMount:function t(){__p&&__p();this._saveIntent=c("debounce")(this._saveIntent,500,this,true);this._changeHandlers=m().withMutations(function(u){__p&&__p();for(var v=o,w=Array.isArray(v),x=0,v=w?v:v[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var y;if(w){if(x>=v.length)break;y=v[x++]}else{x=v.next();if(x.done)break;y=x.value}var z=y;u.set(z.name,c("OzIntentFactoryHelpers").makeStateUpdater(z.name).bind(this))}}.bind(this))},componentWillReceiveProps:function t(u){var v=this.state.isEditing;if(c("immutable").is(u.intent,this.props.intent)||v)return;this.setState(q(u.intent))},componentWillUnmount:function t(){window.clearTimeout(this._editingTimeout)},render:function t(){return c("React").createElement(c("OzGenericIntent.react"),babelHelpers["extends"]({},this.props,{notes:this.state.notes,onNotesChange:this._handleNotesChange}),this._renderFields(this.props.location))},_renderFields:r,_handleNotesChange:function t(u){this._setStateAndSave({notes:u})},_saveIntent:function t(){var u=this.props.intent;c("OzAPI").editIntent(u.get("user-id"),m({id:u.get("id"),params:s(u.get("params"),this.state),notes:this.state.notes}))},_setStateAndSave:function t(u){window.clearTimeout(this._editingTimeout);this.setState(babelHelpers["extends"]({isEditing:true},u),this._saveIntent);this._editingTimeout=window.setTimeout(function(v){return this.setState({isEditing:false})}.bind(this),p)}})}f.exports=j}),null);
__d("OzIntent.react",["OzAPI","OzHelpers","immutable","OzIntentFactory","OzImmutablePureRenderMixin","React","Reflux","OzConfig","OzWrapper.react"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("immutable").Map,i=c("React").PropTypes,j=c("React").createClass({displayName:"OzIntent",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{intent:i.instanceOf(h).isRequired,requirements:i.instanceOf(h).isRequired,repNames:i.instanceOf(h).isRequired,location:i.instanceOf(h).isRequired,thread:i.instanceOf(h).isRequired},render:function k(){var l=this.props,m=l.intent,n=l.intentMeta,o=l.location,p=l.repNames,q=l.requirements,r=l.thread,s=l.timelineGK,t=c("OzIntentFactory").get(c("OzHelpers").intentName(m),this.state.config);return c("React").createElement(t,{key:m.get("id"),intent:m,intentMeta:n,onChangeAlias:this._handleChangeAlias,onClose:this._handleClose,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,onOpen:this._handleOpen,onIsBlockedToggle:this._handleIsBlockedToggle,onTriggerAI:this._handleTriggerAI,repNames:p,requirements:q,location:o,thread:r,timelineGK:s})},_handleClose:function k(l,m,n){c("OzAPI").closeIntent(c("OzHelpers").threadID(this.props.thread),l,m,n)},_handleOpen:function k(l){c("OzAPI").openIntent(c("OzHelpers").threadID(this.props.thread),l)},_handleDeleteRequirement:function k(l,m){c("OzAPI").deleteIntentRequirement(c("OzHelpers").threadID(this.props.thread),l,m)},_handleCreateRequirement:function k(l,m){c("OzAPI").createIntentRequirement(c("OzHelpers").threadID(this.props.thread),l,m)},_handleChangeAlias:function k(l,m){c("OzAPI").editIntent(l.get("user-id"),h({id:l.get("id"),alias:m}))},_handleIsBlockedToggle:function k(l){l.get("blocked")?c("OzAPI").unblockIntent(c("OzHelpers").threadID(this.props.thread),l.get("id")):c("OzAPI").blockIntent(c("OzHelpers").threadID(this.props.thread),l.get("id"))},_handleTriggerAI:function k(l,m){var n=this.props.intent;c("OzAPI").triggerAIForIntent(n.get("user-id"),n.get("id"));window.setTimeout(m,2500)}});f.exports=c("OzWrapper.react")(j)}),null);
__d("OzIntentEvents.react",["cx","OzAPI","OzHelpers","ozFormatTime","immutable","OzConfig","OzDate.react","OzTimestampScrolling.react","React","Reflux","Tooltip","OzActions"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("immutable").List,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzIntentEvents",mixins:[c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{intent:k.instanceOf(i).isRequired},render:function z(){var A=this.props.intent,B=(A.get("events")||j()).toList(),C=B.filter(function(G){return G.get("type")==="completed-call"}),D=B.filter(function(G){return G.get("type")==="send-email"||G.get("type")==="receive-email"}),E=B.filter(function(G){return G.get("type")==="send-calendar"}),F=B.filter(function(G){return G.get("type")==="book-reservation"&&G.getIn(["data","confirmation-number"])});return c("React").createElement("div",{className:"_4h0y"},c("React").createElement(s,{header:"Calls",events:C,onCallPlay:p}),c("React").createElement(s,{header:"Emails",events:D}),c("React").createElement(s,{header:"Invites",events:E}),c("React").createElement(s,{header:"Reservations",events:F}))}}),m=function m(z){c("OzActions").emailComposer.add(babelHelpers["extends"]({},c("OzHelpers").eventToEmail(z),{disabled:true}))},n=function n(z){c("OzActions").emailComposer.add(c("OzHelpers").eventToEmail(c("OzHelpers").reEmail(z)))},o=function o(z){c("OzActions").inviteComposer.add(c("OzHelpers").eventToInvite(z))},p=function p(z){return c("OzAPI").everstoreURI(z).then(function(A){return window.open(A)})},q=function q(z){window.open(z.getIn(["data","opentable-listing","url"]))},r=function r(z){return-z.get("id")},s=c("OzHelpers").pure(function(z){var A=z.header,B=z.events;return B&&!B.isEmpty()?c("React").createElement("details",{open:true},c("React").createElement("summary",{className:"_177e _3_lv"},A,"... (",B.count(),")"),c("React").createElement("div",{className:"_4h0z"},B.map(function(event){return c("React").createElement(t,{orderBy:r,event:event,key:event.get("id")})}))):null}),t=c("OzHelpers").pure(function(z){__p&&__p();var event=z.event,A=z.orderBy,B=event.get("data");switch(event.get("type")){case"send-email":return c("React").createElement(y,{order:A(event),sign:"@",subtitle:B.get("subject"),actions:[["VIEW",function(F){return m(event)}],["REPLY",function(F){return n(event)}]]},c("React").createElement(v,{data:B,type:"to"}));case"receive-email":return c("React").createElement(y,{order:A(event),sign:"@",subtitle:B.get("subject"),actions:[["VIEW",function(F){return m(c("OzHelpers").switchRecip(event))}],["REPLY",function(F){return n(c("OzHelpers").switchRecip(event))}]]},c("React").createElement(v,{data:B,type:"from"}));case"send-calendar":return c("React").createElement(y,{order:A(event),sign:"@",subtitle:B.get("title"),timestamp:B.get("start"),actions:[["VIEW",function(F){return o(event)}]]},c("React").createElement(w,{data:B}));case"completed-call":return c("React").createElement(x,{event:event,onCallPlay:p,orderBy:A});case"book-reservation":var C=new Date(B.get("ts")),D=c("OzHelpers").toLocaleDate(C)+" at "+c("OzHelpers").toLocaleTime(C),E="Table for "+B.get("covers")+" on "+D;return c("React").createElement(y,{order:A(event),sign:"",subtitle:E,event:event,actions:[["VIEW",function(F){return q(event)}]]});default:return null}}),u=function u(z){if(!z)return j();if(typeof z.join==="function")return z;return j([z])},v=c("OzHelpers").pure(function(z){var A=z.data,B=z.type,C=(B==="to"?"Sent":"Received")+" at "+c("OzHelpers").toLocaleTime(A.get("sent-at"))+" on "+c("OzHelpers").toLocaleDate(A.get("sent-at")),D=B==="from"?A.get("from"):u(A.get("to")).join(", "),E=B==="to"?"To":"From";return c("React").createElement("span",c("Tooltip").propsFor(C),E," ",c("React").createElement("strong",null,D))}),w=c("OzHelpers").pure(function(z){var A=z.data,B="Sent at "+c("OzHelpers").toLocaleTime(A.get("sent-at"))+" on "+c("OzHelpers").toLocaleDate(A.get("sent-at"));return c("React").createElement("span",c("Tooltip").propsFor(B),c("React").createElement("strong",null,u(A.get("to")).join(", ")||null))}),x=c("OzHelpers").pure(function(z){var event=z.event,A=z.onCallPlay,B=z.orderBy,C=event.get("data"),D={"in":"Call from",out:"Call to",voicemail:"Voicemail from"}[C.get("direction")],E=c("OzHelpers").parsePhoneNumber(C.get("remote-phone")),F=C.get("RecordingDuration"),G=C.get("recording-ev-handle"),H=G?[["PLAY",function(I){return A(G)}]]:[];return c("React").createElement(y,{order:B(event),sign:"#",subtitle:c("ozFormatTime")(+F),timestamp:event.get("timestamp"),actions:H},c("React").createElement("span",null,D," ",c("React").createElement("strong",null,E)))}),y=c("OzHelpers").pure(function(z){var A=z.sign,B=z.children,C=z.subtitle,D=z.actions,E=z.timestamp,F=z.order;return c("React").createElement("div",{className:"_25js",style:{order:F}},c("React").createElement("div",{className:"_4h12"},A),c("React").createElement("div",{className:"_4h18"},c("React").createElement("div",null,B),c("React").createElement("div",null,C,C&&E?c("React").createElement("span",null," \u2014 "):null,E?c("React").createElement(c("OzTimestampScrolling.react"),{timestamp:E},c("React").createElement(c("OzDate.react"),{timestamp:E,className:"_3_lw"})):null)),c("React").createElement("div",{className:"_4h19"},D.map(function(G,H){var I=G[0],J=G[1];return c("React").createElement("div",{key:H},c("React").createElement("button",{key:H,className:"_1-hv _30yy _4h1a",onClick:J},I))})))});f.exports={OzIntentEvents:l,EventContainer:t}}),null);
__d("OzIntentList.react",["cx","OzHelpers","immutable","OzIntentEvents.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","OzWrapper.react","ReactDOM","ReactRouter"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("OzIntentEvents.react").OzIntentEvents,j=c("React").PropTypes,k=c("ReactRouter").Link,l=c("React").createClass({displayName:"OzIntentList",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{activeIntentId:j.number,intents:j.instanceOf(c("immutable").List).isRequired,timelineGK:j.bool},componentDidMount:function n(){var o=c("ReactDOM").findDOMNode(this.refs[this.props.activeIntentId]);o&&o.scrollIntoViewIfNeeded()},componentDidUpdate:function n(o){var p=this.props,q=p.activeIntentId,r=p.isHistory,s=c("ReactDOM").findDOMNode(this.refs[q]);if(s&&(o.activeIntentId!==q||o.isHistory!==r))s.scrollIntoViewIfNeeded()},render:function n(){return c("React").createElement("div",null,this.props.intents.map(this._renderIntent))},_renderIntent:function n(o){var p=o.get("id"),q=this.props,r=q.activeIntentId,s=q.timelineGK,t=r===p;return c("React").createElement(m,{ref:p,key:p,intent:o,isExpanded:t,timelineGK:s})}}),m=c("OzHelpers").pure(function(n){var o=n.intent,p=n.isExpanded,q=n.timelineGK;return c("React").createElement("div",null,c("React").createElement(k,{className:"_qsr",to:c("OzHelpers").threadPath({threadid:o.get("user-id"),intentid:o.get("id")})},c("React").createElement(c("OzSidebarItemHeader.react"),{alias:o.get("alias"),className:"_qsu"+(p?" _qsv":""),closedAt:o.get("closed-at"),closeState:o.get("state"),createdAt:o.get("created-at"),isBlocked:o.get("blocked"),isClosed:c("OzHelpers").isClosedIntent(o),label:c("OzHelpers").isOpenIntent(o)&&o.get("assigned-bot")?"BOT":null,skipScrollToTimestamp:true,title:c("OzHelpers").intentName(o),timelineGK:q})),p&&c("React").createElement(i,{intent:o}))});f.exports=c("OzWrapper.react")(l)}),null);
__d("OzIntentTabs.react",["cx","OzHelpers","immutable","OzImmutablePureRenderMixin","React","ReactRouter"],(function a(b,c,d,e,f,g,h){var i=c("ReactRouter").Link,j=c("immutable").List,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzIntentTabs",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{intents:k.instanceOf(j).isRequired,tasks:k.instanceOf(j).isRequired,threadId:k.string.isRequired,activeIntentId:k.number},render:function n(){var o=this.props,p=o.activeIntentId,q=o.intents,r=o.tasks,s=o.threadId;return c("React").createElement("div",{className:"_27fz"},c("React").createElement(i,{className:"_27f-"+(!p?" _27f_":""),to:c("OzHelpers").threadPath({threadid:s})},"All tasks"),q.map(function(t){return c("React").createElement(m,{key:t.get("id"),intent:t,tasks:r,activeIntentId:p})}))}}),m=c("OzHelpers").pure(function(n){var o=n.intent,p=n.activeIntentId,q=n.tasks,r=o.get("id")===p,s=c("OzHelpers").isBlockedIntent(o),t=c("OzHelpers").isClosedIntent(o),u=c("OzHelpers").nextTaskForIntent(o,q);return c("React").createElement(i,{className:"_27f-"+(r?" _27f_":"")+(s||t?" _xpo":""),to:c("OzHelpers").threadPath({threadid:o.get("user-id"),intentid:o.get("id"),taskid:u&&u.get("id")})},o.get("alias",o.get("name")))});f.exports=l}),null);
__d("OzReminderNotesField.react",["OzIntentParamsTextField.react","OzImmutablePureRenderMixin","React","debounce"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i=c("React").createClass({displayName:"OzReminderNotesField",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{seedNotes:h.string,onSave:h.func.isRequired},getInitialState:function j(){return{notes:this.props.seedNotes||""}},componentWillMount:function j(){this._save=c("debounce")(this._save,750,this,true)},render:function j(){return c("React").createElement(c("OzIntentParamsTextField.react"),{label:"Add notes about this reminder...",onChange:this._handleChange,value:this.state.notes})},_handleChange:function j(k){this.setState({notes:k},this._save)},_save:function j(){this.props.onSave(this.state.notes)}});f.exports=i}),null);
__d("OzReminderTask.react",["cx","OzAPI","OzHelpers","immutable","OzIntentParamsAbstractField.react","OzIntentParamsStringField.react","OzReminderTaskEditor.react","OzReminderNotesField.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","ReactRouter","formatDate"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("immutable").Map,j=c("React").PropTypes,k=c("ReactRouter").Link,l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m=c("React").createClass({displayName:"OzReminderTask",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{task:j.instanceOf(i).isRequired,repNames:j.instanceOf(i).isRequired,location:j.instanceOf(i).isRequired},render:function o(){var p=this.props,q=p.task,r=p.repNames,s=p.location,t=q.getIn(["data","description"]),u=c("OzHelpers").isUrgentTask(q),v=q.getIn(["data","suggestion"]),w=c("OzHelpers").isClosedTask(q),x=q.get("from"),y=r.get(x,x);return c("React").createElement("div",{className:"_wc0"+(u?" _wc2":"")+(c("OzHelpers").isPaidTask(q)?" _3d-l":"")+(w?" _3d-m":"")},c("React").createElement(c("OzSidebarItemHeader.react"),{className:"_1k8u",creator:y,isClosed:w,isExpanded:true,onToggle:this._handleToggle,onCancel:this._handleCancel,title:t||n(v)},u?c("React").createElement("button",{className:"_1-hv _260v _260w",alt:"Snooze",onClick:this._handleSnooze}):null,!w?c("React").createElement(c("OzReminderTaskEditor.react"),{layered:true,onSave:this._handleEdit,seedTask:q,location:s},c("React").createElement("a",{className:"_260y"},c("React").createElement("i",{className:"_5x82"}))):null),this._renderBody())},_renderBody:function o(){var p=this.props.task,q=p.getIn(["schedule","repeat-condition","days"]),r=c("OzHelpers").threadPath({threadid:p.get("user-id"),intentid:p.get("intent-id")}),s=p.get("state")==="waiting"?"Fires on":"Fired on";return c("React").createElement("div",{className:"_wc3"},c("React").createElement("div",{className:"_1k8v _3-ue"},c("React").createElement(k,{to:r},c("React").createElement("span",null,"Go to intent")),this._renderPayment(p),c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:s},c("React").createElement("span",null,c("formatDate")(new Date(p.get("start-at")),"M jS, g:ia"))),c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Due"},c("React").createElement("span",null,c("formatDate")(new Date(p.get("deadline")),"M jS, g:ia"))),q&&!q.isEmpty()?c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Recurs"},c("React").createElement("span",null,q.size===7?"Every Day":q.sort().map(function(t){return l[t%7]}).toArray().join(" "))):null,c("React").createElement(c("OzReminderNotesField.react"),{seedNotes:p.getIn(["data","notes"])||p.getIn(["data","description"]),onSave:this._handleNotesSave})))},_renderPayment:function o(p){var q=p.getIn(["data","suggestion"]);if(!q)return null;var r=p.getIn(["data","credit-card"]),s=q.get("name");return c("React").createElement("div",null,c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Link"},c("React").createElement("div",{className:"_3d-q"},c("React").createElement("a",{className:"_3d-r",target:"_blank",href:q.get("target-url"),title:q.get("description")},"Click here to view ",s),r?c("React").createElement("a",{className:"_3d-s",href:"#",title:"Show credit card information",onClick:this._handlePaymentLinkClick}):null)),c("React").createElement(c("OzIntentParamsStringField.react"),{label:"Confirmation #",onSave:this._handleItemNumberSave,placeholder:"Confirmation number",value:p.getIn(["data","item-number"])||""}))},_handleNotesSave:function o(p){this._handleEdit(this.props.task.setIn(["data","notes"],p))},_handleItemNumberSave:function o(p){this._handleEdit(this.props.task.setIn(["data","item-number"],p))},_handleToggle:function o(){var p=this.props.task;c("OzHelpers").isClosedTask(p)?this._handleOpen(p):this._handleComplete(p)},_handleComplete:function o(p){c("OzAPI").completeTask(p.get("user-id"),p)},_handleCancel:function o(){var p=this.props.task;c("OzAPI").cancelTask(p.get("user-id"),p)},_handleEdit:function o(p){return c("OzAPI").editTask(p.get("user-id"),p)},_handleOpen:function o(p){c("OzAPI").openTask(p.get("user-id"),p)},_handleSnooze:function o(){var p=this.props.task,q=c("OzHelpers").serverNow()+1e3*60*10;c("OzAPI").editTask(p.get("user-id"),p.set("deadline",q))},_handlePaymentLinkClick:function o(p){var q=this.props.task.getIn(["data","credit-card"]);if(!q)return;var r=this.props.task.getIn(["data","suggestion","amount"])/100,s=q.get("number"),t=q.get("cvv"),u=q.get("month"),v=q.get("year"),w=q.get("zip"),x="https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/mastercard-128.png";c("OzAPI").notifyExtension({action:"show",title:"Temporary Credit Card Information",desc:"Amount: $"+r+" Number: "+s+" cvv: "+t+" zip: "+w,html:"Amount: $"+r+"<br/>\n      Number: "+s+"<br/>\n      CVV: "+t+"<br/>\n      Month: "+u+"<br/>\n      Year: "+v,id:s,timeout:0,picture:x})}});function n(o){if(!o)return null;var p=o.get("amount")/100,q=o.get("name");return"User paid $"+p+" for "+q}f.exports=m}),null);
__d("OzReminderTasks.react",["cx","OzAPI","OzHelpers","immutable","OzSidebarItemHeader.react","OzStores","OzImmutablePureRenderMixin","React","ReactCSSTransitionGroup","ReactRouter","Reflux"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("OzStores").ActiveThreadStore,j=c("ReactRouter").Link,k=c("immutable").List,l=c("immutable").Map,m=c("React").PropTypes,n=c("React").createClass({displayName:"OzReminderTasks",propTypes:{isHistory:m.bool,repNames:m.instanceOf(l).isRequired,thread:m.object.isRequired},mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(i,"activeThread")],render:function q(){return c("React").createElement("div",{className:"_1x92"},c("React").createElement("h2",{className:"_1x93"},"Reminders for thread"),this._renderTasks())},_handleCreate:function q(r){c("OzAPI").createTask(c("OzHelpers").threadID(this.props.thread),r)},_handleClose:function q(r){c("OzAPI").completeTask(c("OzHelpers").threadID(this.props.thread),r)},_handleEdit:function q(r){return c("OzAPI").editTask(c("OzHelpers").threadID(this.props.thread),r)},_handleOpen:function q(r){c("OzAPI").editTask(c("OzHelpers").threadID(this.props.thread),l({id:r.get("id"),state:"dispatched"}))},_handleSnooze:function q(r){c("OzAPI").editTask(c("OzHelpers").threadID(this.props.thread),l({id:r.get("id"),deadline:c("OzHelpers").serverNow()+1e3*60*5}))},_renderTasks:function q(){var r=this.props,s=r.isHistory,t=r.repNames,u=r.thread,v=this.state.activeThread.get("activeTask"),w=c("OzHelpers").threadID(u),x=u.get("tasks",k()).filter(function(y){return y.get("type")==="reminder"&&(s?c("OzHelpers").isClosedTask(y):!c("OzHelpers").isClosedTask(y))}).toSeq().sortBy(function(y){return y.get("deadline")}).map(function(y){return c("React").createElement(o,{key:y.get("id"),task:y,isExpanded:y.get("id")===v,repNames:t})});return c("React").createElement("div",{key:w+"-"+!!s,className:"_wc7"},c("React").createElement(c("ReactCSSTransitionGroup"),{transitionName:"oz-fade-in-out",transitionEnterTimeout:300,transitionLeaveTimeout:300},x))}}),o=c("OzHelpers").pure(function(q){var r=q.task,s=q.isExpanded,t=q.repNames,u=r.getIn(["data","description"]),v=c("OzHelpers").isClosedTask(r),w=r.get("from"),x=t.get(w,w),y=r.getIn(["data","suggestion"]);return c("React").createElement(j,{className:"_qsr _wc0"+(c("OzHelpers").isUrgentTask(r)?" _wc2":"")+(c("OzHelpers").isPaidTask(r)?" _3d-l":"")+(v?" _3d-m":""),to:c("OzHelpers").threadPath({threadid:r.get("user-id"),intentid:r.get("intent-id"),taskid:r.get("id")})},c("React").createElement(c("OzSidebarItemHeader.react"),{className:"_1k8u"+(s?" _qsv":""),creator:x,isClosed:v,isExpanded:s,title:u||p(y)||"[No Title]"}))});function p(q){if(!q)return null;var r=q.get("amount")/100,s=q.get("name");return"User paid $"+r+" for "+s}f.exports=n}),null);
__d("OzReminderEditor.react",["cx","InputLabel_DEPRECATED.react","InputLabelLabel_DEPRECATED.react","OzConstants","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","DatePickerRestraints","OzHelpers","immutable","InputLabel.react","ReactLayeredComponentMixin_DEPRECATED","LayerHideOnBlur","MessengerButtonReact.bs","OzDateTimePicker.react","React","XUIContextualDialog.react","XUIError.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("OzConstants").REMINDERS,j=c("MessengerButtonReact.bs").jsComponent,k=c("immutable").Map,l=c("immutable").Set,m=c("React").PropTypes,n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],o=c("immutable").fromJS({traffic:{label:"Include traffic update",params:[{name:"origin",placeholder:"Origin address",err:"What is the origin address?"},{name:"destination",placeholder:"Destination address",err:"What is the destination address?"}]},weather:{label:"Include weather forecast",params:[{name:"location",placeholder:"City",err:"What city is the forecast for?"},{name:"metric",placeholder:"Celsius or Fahrenheit",err:"You need to set Celsius or Fahrenheit"}]}}),p=c("OzHelpers").pure(function(s){var t=s.action,u=s.errors,v=s.onToggle,w=s.onUpdate,x=s.reminder,y=!!x.getIn(["actions",t]);return c("React").createElement("div",null,c("React").createElement(c("InputLabel_DEPRECATED.react"),{className:"_2_xq"},c("React").createElement("input",{type:"checkbox",checked:y,onChange:function z(A){return v(A,x,t)}}),c("React").createElement(c("InputLabelLabel_DEPRECATED.react"),null,o.getIn([t,"label"]))),y&&c("React").createElement("div",null,o.getIn([t,"params"]).map(function(z){var A=z.get("name"),B=["actions",t,A];return c("React").createElement("div",{key:t+"-"+A},c("React").createElement(c("XUIError.react"),{xuiError:u.getIn([t,A])},c("React").createElement("input",{type:z.get("type","text"),className:"_2_xr",placeholder:z.get("placeholder"),value:x.getIn(B),onChange:function C(D){return w(D,B)}})))}).valueSeq()))}),q=c("OzHelpers").pure(function(s){var t=s.reminder,u=s.errors,v=s.onToggle,w=s.onUpdate;return c("React").createElement("div",null,c("React").createElement("h3",{className:"_17f0"},"Actions"),o.keySeq().map(function(x){return c("React").createElement(p,{key:x,action:x,reminder:t,errors:u,onToggle:v,onUpdate:w})}).valueSeq())}),r=c("React").createClass({displayName:"OzReminderEditor",mixins:[c("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{onSave:m.func.isRequired,seedReminder:m.instanceOf(k),timezone:m.string},getInitialState:function s(){return{shown:false,reminder:this.props.seedReminder||k(),timezone:this.props.timezone,errors:k()}},componentWillReceiveProps:function s(t){if(!c("immutable").is(t.seedReminder,this.props.seedReminder))this.setState({reminder:t.seedReminder,errors:k()})},render:function s(){var t=c("React").Children.only(this.props.children);return c("React").cloneElement(t,{onClick:function(u){return this.setState({shown:!this.state.shown})}.bind(this)})},renderLayers:function s(){__p&&__p();var t=this.state,u=t.shown,v=t.reminder,w=t.errors;if(!u)return null;var x=l(v.get("days"));return{contextualDialog:c("React").createElement(c("XUIContextualDialog.react"),{autoFocus:false,behaviors:{ContextualLayerAutoFlip:c("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:c("LayerHideOnBlur")},position:"below",shown:u,contextRef:function(){return this}.bind(this),onToggle:function(y){return this.setState({shown:y})}.bind(this)},c("React").createElement("ul",{className:"_3ssq"},c("React").createElement("div",{className:"_wbu"},c("React").createElement(c("OzDateTimePicker.react"),babelHelpers["extends"]({xuiError:w.get("scheduled-time"),className:"_wbv",showTimezoneName:false,timestamp:v.get("scheduled-time",c("OzHelpers").serverNow()),timezone:this.state.timezone,onChange:function(y){var z=y.timestamp,A=y.timezone;this.setState({reminder:v.set("scheduled-time",+z),timezone:A})}.bind(this)},c("OzHelpers").dateRestraints())),c("React").createElement(c("XUIError.react"),{xuiError:w.get("description")},c("React").createElement("input",{ref:"input",className:"_wbw",placeholder:"Describe the Reminder",value:v.getIn(["body","description"]),onChange:function(y){this.setState({reminder:v.setIn(["body","description"],y.target.value)})}.bind(this)})),c("React").createElement("h3",{className:"_17f0"},"Recurrence"),n.map(function(y,z){var A=z+1;return c("React").createElement(c("InputLabel.react"),{className:"_2_xq",key:z,label:y},c("React").createElement("input",{type:"checkbox",checked:x.has(A),onChange:function(B){var C=B.target.checked?x.add(A):x["delete"](A);this.setState({reminder:v.set("days",C.toList())})}.bind(this)}))}.bind(this)),c("React").createElement(q,{reminder:v,errors:w,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),c("React").createElement("div",{className:"_wbz"},c("React").createElement(j,{label:this.props.seedReminder?"Update Reminder":"Add Reminder",onClick:this._handleSave,type:"primary"})))))}},_handleActionToggle:function s(t,u,v){var w=t.target.checked?u.set("actions",k([[v,k()]])):u["delete"]("actions");this.setState({reminder:w})},_handleActionUpdate:function s(t,u){this.setState({reminder:this.state.reminder.setIn(u,t.target.value)})},_handleSave:function s(){__p&&__p();var t=this.state.reminder,u=t.get("scheduled-time"),v=function v(y){return!!t.getIn(["actions",y])},w=k(),x=c("OzHelpers").dateRestraints().dateRestraints;if(!u)w=w.set("scheduled-time","When would you like the reminder?");else if(u<c("OzHelpers").serverNow()+60*1e3)w=w.set("scheduled-time","Reminders should be in the future!");else if(!c("DatePickerRestraints").isValidDate(new Date(u),x))w=w.set("scheduled-time","Reminder is outside of the "+i.RANGE_IN_YEARS+" year range");if(!t.getIn(["body","description"]))w=w.set("description","What is the reminder about?");w=o.reduce(function(w,y,z){if(v(z))w=y.get("params").reduce(function(w,A){return t.getIn(["actions",z,A.get("name")])?w:w.setIn([z,A.get("name")],A.get("err"))},w);return w},w);this.setState({errors:w});if(w.size)return;this.setState({reminder:k(),shown:false},function(y){return this.props.onSave(t)}.bind(this))}});f.exports=r}),null);
__d("OzReminder.react",["cx","invariant","OzAPI","OzHelpers","Event","immutable","OzIntentParamsAbstractField.react","OzIntentParamsStringField.react","OzReminderEditor.react","OzReminderNotesField.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","XUICloseButton.react","formatDate"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("immutable").List,k=c("immutable").Map,l=c("React").PropTypes,m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=c("React").createClass({displayName:"OzReminder",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onClose:l.func.isRequired,onEdit:l.func.isRequired,onOpen:l.func.isRequired,onSnooze:l.func.isRequired,reminder:l.instanceOf(k).isRequired,repNames:l.instanceOf(k).isRequired,timezone:l.string},getInitialState:function p(){return{isExpanded:c("OzHelpers").isUrgentReminder(this.props.reminder)}},componentWillReceiveProps:function p(q){if(q.reminder.get("id")===this.props.reminder.get("id")&&c("OzHelpers").isUrgentReminder(q.reminder)&&!c("OzHelpers").isUrgentReminder(this.props.reminder))this.setState({isExpanded:true})},render:function p(){var q=this.props,r=q.onEdit,s=q.onSnooze,t=q.reminder,u=q.repNames,v=q.timezone,w=t.getIn(["body","description"]),x=c("OzHelpers").isUrgentReminder(t),y=t.getIn(["body","suggestion"]),z=t.get("state")==="closed",A=t.get("creator-fbid"),B=u.get(A,A);return c("React").createElement("div",{className:"_wc0"+(x?" _wc2":"")+(c("OzHelpers").isPaidReminder(t)?" _3d-l":"")+(z?" _3d-m":"")},c("React").createElement(c("OzSidebarItemHeader.react"),{className:"_1k8u",creator:B,isClosed:z,isExpanded:this.state.isExpanded,onIsExpandedToggle:this._handleIsExpandedToggle,onToggle:this._handleToggle,subtitle:c("OzHelpers").isSnoozedReminder(t)?"(snoozed)":null,title:w||o(y)||"[No Title]"},x?c("React").createElement("button",{className:"_1-hv _260v _260w",alt:"Snooze",onClick:function C(D){return s(t)}}):null,c("React").createElement(c("OzReminderEditor.react"),{onSave:r,seedReminder:t,timezone:v},c("React").createElement("a",{className:"_260y"},c("React").createElement("i",{className:"_5x82"})))),this._renderBody())},_renderBody:function p(){if(!this.state.isExpanded)return null;var q=this.props.reminder,r=q.get("scheduled-time"),s=q.get("last-fired"),t=q.get("state")==="closed",u=c("OzHelpers").isUrgentReminder(q),v=q.get("state")==="snoozed"&&s||r>c("OzHelpers").serverNow()&&r,w=(u||t)&&s,x=q.get("days");return c("React").createElement("div",{className:"_wc3"},c("React").createElement("div",{className:"_1k8v _3-ue"},this._renderPayment(q),w?c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Fired On"},c("React").createElement("span",null,c("formatDate")(new Date(w),"M jS, g:ia"))):null,v?c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Will Fire On"},c("React").createElement("span",null,c("formatDate")(new Date(v),"M jS, g:ia"))):null,x&&!x.isEmpty()?c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Recurs"},c("React").createElement("span",null,x.size===7?"Every Day":x.sort().map(function(y){return m[y%7]}).toArray().join(" "))):null,c("React").createElement(c("OzReminderNotesField.react"),{seedNotes:q.get("notes")||q.getIn(["body","description"]),onSave:this._handleNotesSave})))},_renderPayment:function p(q){var r=q.getIn(["body","suggestion"]);if(!r)return null;var s=q.getIn(["body","credit-card"]),t=r.get("name");return c("React").createElement("div",null,c("React").createElement(c("OzIntentParamsAbstractField.react"),{label:"Link"},c("React").createElement("div",{className:"_3d-q"},c("React").createElement("a",{className:"_3d-r",target:"_blank",href:r.get("target-url"),title:r.get("description")},"Click here to view ",t),s?c("React").createElement("a",{className:"_3d-s",href:"#",title:"Show credit card information",onClick:this._handlePaymentLinkClick}):null)),c("React").createElement(c("OzIntentParamsStringField.react"),{label:"Confirmation #",onSave:this._handleItemNumberSave,placeholder:"Confirmation number",value:q.getIn(["body","item-number"])||""}))},_handleIsExpandedToggle:function p(){this.setState({isExpanded:!this.state.isExpanded})},_handleNotesSave:function p(q){this.props.onEdit(this.props.reminder.set("notes",q))},_handleItemNumberSave:function p(q){this.props.onEdit(this.props.reminder.setIn(["body","item-number"],q))},_handleToggle:function p(q){var r=this.props,s=r.onClose,t=r.onOpen,u=r.reminder;q?s(u):t(u)},_handlePaymentLinkClick:function p(q){var r=this.props.reminder.getIn(["body","credit-card"]);if(!r)return;var s=this.props.reminder.getIn(["body","suggestion","amount"])/100,t=r.get("number"),u=r.get("cvv"),v=r.get("month"),w=r.get("year"),x=r.get("zip");c("OzAPI").notifyExtension({action:"show",title:"Temporary Credit Card Information",desc:"Amount: $"+s+" Number: "+t+" cvv: "+u+" zip: "+x,html:"Amount: $"+s+"<br/>\n      Number: "+t+"<br/>\n      CVV: "+u+"<br/>\n      Month: "+v+"<br/>\n      Year: "+w,id:t,timeout:0,picture:"https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/mastercard-128.png"})}});function o(p){if(!p)return null;var q=p.get("amount")/100,r=p.get("name");return"User paid $"+q+" for "+r}f.exports=n}),null);
__d("OzReminders.react",["cx","OzAPI","OzHelpers","immutable","OzReminder.react","OzReminderEditor.react","React","OzWrapper.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("immutable").List,l=c("immutable").Map,m=c("React").PropTypes;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;function n(){__p&&__p();var o,p;"use strict";for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.$OzReminders2=function(t){c("OzAPI").createReminder(c("OzHelpers").threadID(this.props.thread),t)}.bind(this),this.$OzReminders3=function(t){c("OzAPI").closeReminder(c("OzHelpers").threadID(this.props.thread),t.get("id"),!!t.get("days")&&t.get("state")==="pending")}.bind(this),this.$OzReminders4=function(t){c("OzAPI").editReminder(c("OzHelpers").threadID(this.props.thread),t)}.bind(this),this.$OzReminders5=function(t){c("OzAPI").editReminder(c("OzHelpers").threadID(this.props.thread),t.set("state","pending"))}.bind(this),this.$OzReminders6=function(t){c("OzAPI").snoozeReminder(c("OzHelpers").threadID(this.props.thread),t.get("id"))}.bind(this),this.$OzReminders1=function(){var t=this.props,u=t.isHistory,v=t.repNames,w=t.thread,x=c("OzHelpers").threadID(w),y=w.get("reminders",k()).sortBy(function(z){return z.get("last-fired")||z.get("scheduled-time")}).toSeq().filter(function(z){return u?z.get("state")==="closed":z.get("state")!=="closed"}).map(function(z){return c("React").createElement(c("OzReminder.react"),{key:z.get("id"),onClose:this.$OzReminders3,onEdit:this.$OzReminders4,onOpen:this.$OzReminders5,onSnooze:this.$OzReminders6,reminder:z,repNames:v,timezone:c("OzHelpers").timezone(w)})}.bind(this));return c("React").createElement("div",{key:x+"-"+!!u,className:"_wc7"},y)}.bind(this),p}n.prototype.render=function(){"use strict";return c("React").createElement("div",{className:"_1x92"},c("React").createElement("h2",{className:"_1x93"},"Reminders"),this.$OzReminders1(),!this.props.isHistory?c("React").createElement(c("OzReminderEditor.react"),{onSave:this.$OzReminders2,timezone:c("OzHelpers").timezone(this.props.thread)},c("React").createElement("a",{className:"_59jg"},c("React").createElement("div",{className:"_4nd4"}),c("React").createElement("span",{className:"_59jh"},"Add a reminder..."))):null)};n.propTypes={isHistory:m.bool,repNames:m.instanceOf(l).isRequired,thread:m.object.isRequired};f.exports=c("OzWrapper.react")(n)}),null);
/**
 * License: https://www.facebook.com/legal/license/P3C0VXaDCqJ/
 */
__d("CajaHTMLSanitizer",[],(function aa(ba,ca,da,ea,fa,ga){__p&&__p();var ha=1,ia=2,ja=4,ka=8,la=16,ma=64,na=128,oa=512,pa=1024,qa=function(){var d=[["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],["all-scroll","col-resize","crosshair","default","e-resize","hand","help","move","n-resize","ne-resize","no-drop","not-allowed","nw-resize","pointer","progress","row-resize","s-resize","se-resize","sw-resize","text","vertical-text","w-resize","wait"],["armenian","decimal","decimal-leading-zero","disc","georgian","lower-alpha","lower-greek","lower-latin","lower-roman","square","upper-alpha","upper-latin","upper-roman"],["100","200","300","400","500","600","700","800","900","bold","bolder","lighter"],["block-level","inline-level","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],["condensed","expanded","extra-condensed","extra-expanded","narrower","semi-condensed","semi-expanded","ultra-condensed","ultra-expanded","wider"],["inherit","inline","inline-block","inline-box","inline-flex","inline-grid","inline-list-item","inline-stack","inline-table","run-in"],["behind","center-left","center-right","far-left","far-right","left-side","leftwards","right-side","rightwards"],["large","larger","small","smaller","x-large","x-small","xx-large","xx-small"],["dashed","dotted","double","groove","outset","ridge","solid"],["ease","ease-in","ease-in-out","ease-out","linear","step-end","step-start"],["at","closest-corner","closest-side","ellipse","farthest-corner","farthest-side"],["baseline","middle","sub","super","text-bottom","text-top"],["caption","icon","menu","message-box","small-caption","status-bar"],["fast","faster","slow","slower","x-fast","x-slow"],["above","below","higher","level","lower"],["cursive","fantasy","monospace","sans-serif","serif"],["loud","silent","soft","x-loud","x-soft"],["no-repeat","repeat-x","repeat-y","round","space"],["blink","line-through","overline","underline"],["block","flex","grid","table"],["high","low","x-high","x-low"],["nowrap","pre","pre-line","pre-wrap"],["absolute","relative","static"],["alternate","alternate-reverse","reverse"],["border-box","content-box","padding-box"],["capitalize","lowercase","uppercase"],["child","female","male"],["=","opacity"],["backwards","forwards"],["bidi-override","embed"],["bottom","top"],["break-all","keep-all"],["clip","ellipsis"],["contain","cover"],["continuous","digits"],["end","start"],["flat","preserve-3d"],["hide","show"],["horizontal","vertical"],["inside","outside"],["italic","oblique"],["left","right"],["ltr","rtl"],["no-content","no-display"],["paused","running"],["suppress","unrestricted"],["thick","thin"],[","],["/"],["all"],["always"],["auto"],["avoid"],["both"],["break-word"],["center"],["circle"],["code"],["collapse"],["contents"],["fixed"],["hidden"],["infinite"],["inset"],["invert"],["justify"],["list-item"],["local"],["medium"],["mix"],["none"],["normal"],["once"],["repeat"],["scroll"],["separate"],["small-caps"],["spell-out"],["to"],["visible"]],e={animation:{cssPropBits:517,cssLitGroup:[d[10],d[24],d[29],d[45],d[48],d[54],d[63],d[71],d[72]],cssFns:["cubic-bezier()","steps()"]},"animation-delay":{cssPropBits:5,cssLitGroup:[d[48]],cssFns:[]},"animation-direction":{cssPropBits:0,cssLitGroup:[d[24],d[48],d[72]],cssFns:[]},"animation-duration":"animation-delay","animation-fill-mode":{cssPropBits:0,cssLitGroup:[d[29],d[48],d[54],d[71]],cssFns:[]},"animation-iteration-count":{cssPropBits:5,cssLitGroup:[d[48],d[63]],cssFns:[]},"animation-name":{cssPropBits:512,cssLitGroup:[d[48],d[71]],cssFns:[]},"animation-play-state":{cssPropBits:0,cssLitGroup:[d[45],d[48]],cssFns:[]},"animation-timing-function":{cssPropBits:0,cssLitGroup:[d[10],d[48]],cssFns:["cubic-bezier()","steps()"]},appearance:{cssPropBits:0,cssLitGroup:[d[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[d[7],d[42],d[56]],cssFns:[]},"backface-visibility":{cssPropBits:0,cssLitGroup:[d[59],d[62],d[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[d[0],d[18],d[25],d[31],d[34],d[42],d[48],d[49],d[52],d[56],d[61],d[68],d[71],d[74],d[75]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","rgb()","rgba()"]},"background-attachment":{cssPropBits:0,cssLitGroup:[d[48],d[61],d[68],d[75]],cssFns:[]},"background-color":{cssPropBits:2,cssLitGroup:[d[0]],cssFns:["rgb()","rgba()"]},"background-image":{cssPropBits:16,cssLitGroup:[d[48],d[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"background-position":{cssPropBits:5,cssLitGroup:[d[31],d[42],d[48],d[56]],cssFns:[]},"background-repeat":{cssPropBits:0,cssLitGroup:[d[18],d[48],d[74]],cssFns:[]},"background-size":{cssPropBits:5,cssLitGroup:[d[34],d[48],d[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[d[0],d[9],d[47],d[62],d[64],d[69],d[71]],cssFns:["rgb()","rgba()"]},"border-bottom":"border","border-bottom-color":"background-color","border-bottom-left-radius":{cssPropBits:5,cssFns:[]},"border-bottom-right-radius":"border-bottom-left-radius","border-bottom-style":{cssPropBits:0,cssLitGroup:[d[9],d[62],d[64],d[71]],cssFns:[]},"border-bottom-width":{cssPropBits:5,cssLitGroup:[d[47],d[69]],cssFns:[]},"border-collapse":{cssPropBits:0,cssLitGroup:[d[59],d[76]],cssFns:[]},"border-color":"background-color","border-left":"border","border-left-color":"background-color","border-left-style":"border-bottom-style","border-left-width":"border-bottom-width","border-radius":{cssPropBits:5,cssLitGroup:[d[49]],cssFns:[]},"border-right":"border","border-right-color":"background-color","border-right-style":"border-bottom-style","border-right-width":"border-bottom-width","border-spacing":"border-bottom-left-radius","border-style":"border-bottom-style","border-top":"border","border-top-color":"background-color","border-top-left-radius":"border-bottom-left-radius","border-top-right-radius":"border-bottom-left-radius","border-top-style":"border-bottom-style","border-top-width":"border-bottom-width","border-width":"border-bottom-width",bottom:{cssPropBits:5,cssLitGroup:[d[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[d[60],d[71],d[72]],cssFns:[]},"box-shadow":{cssPropBits:7,cssLitGroup:[d[0],d[48],d[64],d[71]],cssFns:["rgb()","rgba()"]},"box-sizing":{cssPropBits:0,cssLitGroup:[d[25]],cssFns:[]},"caption-side":{cssPropBits:0,cssLitGroup:[d[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[d[42],d[54],d[71]],cssFns:[]},clip:{cssPropBits:0,cssLitGroup:[d[52]],cssFns:["rect()"]},color:"background-color",content:{cssPropBits:8,cssLitGroup:[d[71],d[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[d[71]],cssFns:[]},"cue-after":"cue","cue-before":"cue",cursor:{cssPropBits:16,cssLitGroup:[d[1],d[48],d[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[d[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[d[4],d[6],d[20],d[52],d[67],d[71]],cssFns:[]},"display-extras":{cssPropBits:0,cssLitGroup:[d[67],d[71]],cssFns:[]},"display-inside":{cssPropBits:0,cssLitGroup:[d[20],d[52]],cssFns:[]},"display-outside":{cssPropBits:0,cssLitGroup:[d[4],d[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[d[15]],cssFns:[]},"empty-cells":{cssPropBits:0,cssLitGroup:[d[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:["alpha()"]},"float":{cssPropBits:0,cssLitGroup:[d[42],d[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[d[3],d[8],d[13],d[16],d[41],d[48],d[49],d[69],d[72],d[77]],cssFns:[]},"font-family":{cssPropBits:72,cssLitGroup:[d[16],d[48]],cssFns:[]},"font-size":{cssPropBits:1,cssLitGroup:[d[8],d[69]],cssFns:[]},"font-stretch":{cssPropBits:0,cssLitGroup:[d[5],d[72]],cssFns:[]},"font-style":{cssPropBits:0,cssLitGroup:[d[41],d[72]],cssFns:[]},"font-variant":{cssPropBits:0,cssLitGroup:[d[72],d[77]],cssFns:[]},"font-weight":{cssPropBits:0,cssLitGroup:[d[3],d[72]],cssFns:[]},height:"bottom",left:"bottom","letter-spacing":{cssPropBits:5,cssLitGroup:[d[72]],cssFns:[]},"line-height":{cssPropBits:1,cssLitGroup:[d[72]],cssFns:[]},"list-style":{cssPropBits:16,cssLitGroup:[d[2],d[40],d[57],d[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-image":{cssPropBits:16,cssLitGroup:[d[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-position":{cssPropBits:0,cssLitGroup:[d[40]],cssFns:[]},"list-style-type":{cssPropBits:0,cssLitGroup:[d[2],d[57],d[71]],cssFns:[]},margin:"bottom","margin-bottom":"bottom","margin-left":"bottom","margin-right":"bottom","margin-top":"bottom","max-height":{cssPropBits:1,cssLitGroup:[d[52],d[71]],cssFns:[]},"max-width":"max-height","min-height":{cssPropBits:1,cssLitGroup:[d[52]],cssFns:[]},"min-width":"min-height",opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[d[0],d[9],d[47],d[62],d[64],d[65],d[69],d[71]],cssFns:["rgb()","rgba()"]},"outline-color":{cssPropBits:2,cssLitGroup:[d[0],d[65]],cssFns:["rgb()","rgba()"]},"outline-style":"border-bottom-style","outline-width":"border-bottom-width",overflow:{cssPropBits:0,cssLitGroup:[d[52],d[62],d[75],d[80]],cssFns:[]},"overflow-wrap":{cssPropBits:0,cssLitGroup:[d[55],d[72]],cssFns:[]},"overflow-x":{cssPropBits:0,cssLitGroup:[d[44],d[52],d[62],d[75],d[80]],cssFns:[]},"overflow-y":"overflow-x",padding:"opacity","padding-bottom":"opacity","padding-left":"opacity","padding-right":"opacity","padding-top":"opacity","page-break-after":{cssPropBits:0,cssLitGroup:[d[42],d[51],d[52],d[53]],cssFns:[]},"page-break-before":"page-break-after","page-break-inside":{cssPropBits:0,cssLitGroup:[d[52],d[53]],cssFns:[]},pause:"border-bottom-left-radius","pause-after":"border-bottom-left-radius","pause-before":"border-bottom-left-radius",perspective:{cssPropBits:5,cssLitGroup:[d[71]],cssFns:[]},"perspective-origin":{cssPropBits:5,cssLitGroup:[d[31],d[42],d[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[d[21],d[69]],cssFns:[]},"pitch-range":"border-bottom-left-radius","play-during":{cssPropBits:16,cssLitGroup:[d[52],d[70],d[71],d[74]],cssFns:[]},position:{cssPropBits:0,cssLitGroup:[d[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[d[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[d[39],d[54],d[71]],cssFns:[]},richness:"border-bottom-left-radius",right:"bottom",speak:{cssPropBits:0,cssLitGroup:[d[71],d[72],d[78]],cssFns:[]},"speak-header":{cssPropBits:0,cssLitGroup:[d[51],d[73]],cssFns:[]},"speak-numeral":{cssPropBits:0,cssLitGroup:[d[35]],cssFns:[]},"speak-punctuation":{cssPropBits:0,cssLitGroup:[d[58],d[71]],cssFns:[]},"speech-rate":{cssPropBits:5,cssLitGroup:[d[14],d[69]],cssFns:[]},stress:"border-bottom-left-radius","table-layout":{cssPropBits:0,cssLitGroup:[d[52],d[61]],cssFns:[]},"text-align":{cssPropBits:0,cssLitGroup:[d[42],d[56],d[66]],cssFns:[]},"text-decoration":{cssPropBits:0,cssLitGroup:[d[19],d[71]],cssFns:[]},"text-indent":"border-bottom-left-radius","text-overflow":{cssPropBits:8,cssLitGroup:[d[33]],cssFns:[]},"text-shadow":"box-shadow","text-transform":{cssPropBits:0,cssLitGroup:[d[26],d[71]],cssFns:[]},"text-wrap":{cssPropBits:0,cssLitGroup:[d[46],d[71],d[72]],cssFns:[]},top:"bottom",transform:{cssPropBits:0,cssLitGroup:[d[71]],cssFns:["matrix()","perspective()","rotate()","rotate3d()","rotatex()","rotatey()","rotatez()","scale()","scale3d()","scalex()","scaley()","scalez()","skew()","skewx()","skewy()","translate()","translate3d()","translatex()","translatey()","translatez()"]},"transform-origin":"perspective-origin","transform-style":{cssPropBits:0,cssLitGroup:[d[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[d[10],d[48],d[50],d[71]],cssFns:["cubic-bezier()","steps()"]},"transition-delay":"animation-delay","transition-duration":"animation-delay","transition-property":{cssPropBits:1024,cssLitGroup:[d[48],d[50]],cssFns:[]},"transition-timing-function":"animation-timing-function","unicode-bidi":{cssPropBits:0,cssLitGroup:[d[30],d[72]],cssFns:[]},"vertical-align":{cssPropBits:5,cssLitGroup:[d[12],d[31]],cssFns:[]},visibility:"backface-visibility","voice-family":{cssPropBits:8,cssLitGroup:[d[27],d[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[d[17],d[69]],cssFns:[]},"white-space":{cssPropBits:0,cssLitGroup:[d[22],d[72]],cssFns:[]},width:"min-height","word-break":{cssPropBits:0,cssLitGroup:[d[32],d[72]],cssFns:[]},"word-spacing":"letter-spacing","word-wrap":"overflow-wrap","z-index":"bottom",zoom:"line-height","cubic-bezier()":"animation-delay","steps()":{cssPropBits:5,cssLitGroup:[d[36],d[48]],cssFns:[]},"image()":{cssPropBits:18,cssLitGroup:[d[0],d[48]],cssFns:["rgb()","rgba()"]},"linear-gradient()":{cssPropBits:7,cssLitGroup:[d[0],d[31],d[42],d[48],d[79]],cssFns:["rgb()","rgba()"]},"radial-gradient()":{cssPropBits:7,cssLitGroup:[d[0],d[11],d[31],d[42],d[48],d[56],d[57]],cssFns:["rgb()","rgba()"]},"repeating-linear-gradient()":"linear-gradient()","repeating-radial-gradient()":"radial-gradient()","rgb()":{cssPropBits:1,cssLitGroup:[d[48]],cssFns:[]},"rgba()":"rgb()","rect()":{cssPropBits:5,cssLitGroup:[d[48],d[52]],cssFns:[]},"alpha()":{cssPropBits:1,cssLitGroup:[d[28]],cssFns:[]},"matrix()":"animation-delay","perspective()":"border-bottom-left-radius","rotate()":"border-bottom-left-radius","rotate3d()":"animation-delay","rotatex()":"border-bottom-left-radius","rotatey()":"border-bottom-left-radius","rotatez()":"border-bottom-left-radius","scale()":"animation-delay","scale3d()":"animation-delay","scalex()":"border-bottom-left-radius","scaley()":"border-bottom-left-radius","scalez()":"border-bottom-left-radius","skew()":"animation-delay","skewx()":"border-bottom-left-radius","skewy()":"border-bottom-left-radius","translate()":"animation-delay","translate3d()":"animation-delay","translatex()":"border-bottom-left-radius","translatey()":"border-bottom-left-radius","translatez()":"border-bottom-left-radius"};for(var f in e)if("string"===typeof e[f]&&Object.hasOwnProperty.call(e,f))e[f]=e[e[f]];return e}();if(typeof window!=="undefined")window.cssSchema=qa;var ra,sa;(function(){__p&&__p();function d(Q){var R=parseInt(Q.substring(1),16);if(R>65535)return R-=65536,String.fromCharCode(55296+(R>>10),56320+(R&1023));else if(R==R)return String.fromCharCode(R);else if(Q[1]<" ")return"";else return Q[1]}function e(Q,R){return'"'+Q.replace(/[\u0000-\u001f\\\"<>]/g,R)+'"'}function f(Q){return h[Q]||(h[Q]="\\"+Q.charCodeAt(0).toString(16)+" ")}function g(Q){return Ca[Q]||(Ca[Q]=(Q<"\x10"?"%0":"%")+Q.charCodeAt(0).toString(16))}var h={"\\":"\\\\"},Ca={"\\":"%5c"},Da="[\\t\\n\\f ]",i=Da+"*",j="[\\n\\f]",k="[\\ud800-\\udbff][\\udc00-\\udfff]",l="[\\u0080-\\ud7ff\\ue000-\\ufffd]|"+k,m="[0-9a-fA-F]{1,6}"+Da+"?",n="\\\\"+m,o="(?:"+m+"|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|"+k+")",p="\\\\"+o,q="(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|"+l+"|"+p+")",r="[^'\"\\n\\f\\\\]|\\\\[\\s\\S]",s="\"(?:'|"+r+')*"|\'(?:"|'+r+")*'",t="[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)",u="(?:[a-zA-Z_]|"+l+"|"+p+")",v="(?:[a-zA-Z0-9_-]|"+l+"|"+p+")",w=v+"+",x="-?"+u+v+"*",y="@"+x,z="#"+w,A=t,B="(?:@?-?"+u+"|#)"+v+"*",C=t+"%",D=t+x,E=t+"(?:%|"+x+")?",a="url[(]"+i+"(?:"+s+"|"+q+"*)"+i+"[)]",F="U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?",G="<!--",Ea="-->",H=Da+"+",I="/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)",Fa="(?!url[(])"+x+"[(]",Ga="~=",J="[|]=",K="[^]=",L="[$]=",Ha="[*]=",M="[~|^$*]=",N="[^\"'\\\\/]|/(?![/*])",O="\\uFEFF",Ia=new RegExp([O,F,a,Fa,B,s,E,G,Ea,H,I,M,N].join("|"),"gi"),Ja=new RegExp("\\\\(?:"+o+"|"+j+")","g"),P=new RegExp("^url\\("+i+"[\"']?|[\"']?"+i+"\\)$","gi");sa=function(Q){return Q.replace(Ja,d)};ra=function(Q){__p&&__p();Q=("\uffff"+Q).replace(/^\uffff/,"");Q=Q.replace(/\r\n?/g,"\n");var R=Q.match(Ia)||[],S=0,T=" ";for(var U=0,V=R.length;U<V;++U){var W=sa(R[U]),X=W.length,Y=W.charCodeAt(0);W=Y=='"'.charCodeAt(0)||Y=="'".charCodeAt(0)?e(W.substring(1,X-1),f):Y=="/".charCodeAt(0)&&X>1||W=="\\"||W==Ea||W==G||W=="\ufeff"||Y<=" ".charCodeAt(0)?" ":/url\(/i.test(W)?"url("+e(W.replace(P,""),g)+")":W;if(T!=W||W!=" ")R[S++]=T=W}R.length=S;return R}})();if(typeof window!=="undefined"){window.lexCss=ra;window.decodeCss=sa}var a=function(){__p&&__p();function d(q){var r=(""+q).match(n);if(!r)return null;return new a(m(r[1]),m(r[2]),m(r[3]),m(r[4]),m(r[5]),m(r[6]),m(r[7]))}function e(q,r,s,t,u,v,w){var x=new a(g(q,o),g(r,o),f(s),t>0?t.toString():null,g(u,p),null,f(w));if(v)if("string"===typeof v)x.setRawQuery(v.replace(/[^?&=0-9A-Za-z_\-~.%]/g,h));else x.setAllParameters(v);return x}function f(q){if("string"==typeof q)return encodeURIComponent(q);return null}function g(q,r){if("string"==typeof q)return encodeURI(q).replace(r,h);return null}function h(q){var r=q.charCodeAt(0);return"%"+"0123456789ABCDEF".charAt(r>>4&15)+"0123456789ABCDEF".charAt(r&15)}function Ca(q){return q.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/")}var Da=new RegExp("(/|^)(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)/\\.\\.(?:/|$)"),i=new RegExp(Da),j=/^(?:\.\.\/)*(?:\.\.$)?/;function k(q){if(q===null)return null;var r=Ca(q),s=i;for(var t;(t=r.replace(s,"$1"))!=r;r=t);return r}function l(q,r){__p&&__p();var s=q.clone(),t=r.hasScheme();if(t)s.setRawScheme(r.getRawScheme());else t=r.hasCredentials();if(t)s.setRawCredentials(r.getRawCredentials());else t=r.hasDomain();if(t)s.setRawDomain(r.getRawDomain());else t=r.hasPort();var u=r.getRawPath(),v=k(u);if(t){s.setPort(r.getPort());v=v&&v.replace(j,"")}else{t=!!u;if(t){if(v.charCodeAt(0)!==47){var w=k(s.getRawPath()||"").replace(j,""),x=w.lastIndexOf("/")+1;v=k((x?w.substring(0,x):"")+k(u)).replace(j,"")}}else{v=v&&v.replace(j,"");if(v!==u)s.setRawPath(v)}}if(t)s.setRawPath(v);else t=r.hasQuery();if(t)s.setRawQuery(r.getRawQuery());else t=r.hasFragment();if(t)s.setRawFragment(r.getRawFragment());return s}function a(q,r,s,t,u,v,w){this.scheme_=q;this.credentials_=r;this.domain_=s;this.port_=t;this.path_=u;this.query_=v;this.fragment_=w;this.paramCache_=null}a.prototype.toString=function(){__p&&__p();var q=[];if(null!==this.scheme_)q.push(this.scheme_,":");if(null!==this.domain_){q.push("//");if(null!==this.credentials_)q.push(this.credentials_,"@");q.push(this.domain_);if(null!==this.port_)q.push(":",this.port_.toString())}if(null!==this.path_)q.push(this.path_);if(null!==this.query_)q.push("?",this.query_);if(null!==this.fragment_)q.push("#",this.fragment_);return q.join("")};a.prototype.clone=function(){return new a(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_)};a.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase()};a.prototype.getRawScheme=function(){return this.scheme_};a.prototype.setScheme=function(q){this.scheme_=g(q,o);return this};a.prototype.setRawScheme=function(q){this.scheme_=q?q:null;return this};a.prototype.hasScheme=function(){return null!==this.scheme_};a.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_)};a.prototype.getRawCredentials=function(){return this.credentials_};a.prototype.setCredentials=function(q){this.credentials_=g(q,o);return this};a.prototype.setRawCredentials=function(q){this.credentials_=q?q:null;return this};a.prototype.hasCredentials=function(){return null!==this.credentials_};a.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_)};a.prototype.getRawDomain=function(){return this.domain_};a.prototype.setDomain=function(q){return this.setRawDomain(q&&encodeURIComponent(q))};a.prototype.setRawDomain=function(q){this.domain_=q?q:null;return this.setRawPath(this.path_)};a.prototype.hasDomain=function(){return null!==this.domain_};a.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_)};a.prototype.setPort=function(q){if(q){q=Number(q);if(q!==(q&65535))throw new Error("Bad port number "+q);this.port_=""+q}else this.port_=null;return this};a.prototype.hasPort=function(){return null!==this.port_};a.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_)};a.prototype.getRawPath=function(){return this.path_};a.prototype.setPath=function(q){return this.setRawPath(g(q,p))};a.prototype.setRawPath=function(q){if(q){q=String(q);this.path_=!this.domain_||/^\//.test(q)?q:"/"+q}else this.path_=null;return this};a.prototype.hasPath=function(){return null!==this.path_};a.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g," ")};a.prototype.getRawQuery=function(){return this.query_};a.prototype.setQuery=function(q){this.paramCache_=null;this.query_=f(q);return this};a.prototype.setRawQuery=function(q){this.paramCache_=null;this.query_=q?q:null;return this};a.prototype.hasQuery=function(){return null!==this.query_};a.prototype.setAllParameters=function(q){__p&&__p();if(typeof q==="object")if(!(q instanceof Array)&&(q instanceof Object||Object.prototype.toString.call(q)!=="[object Array]")){var r=[],s=-1;for(var t in q){var u=q[t];if("string"===typeof u){r[++s]=t;r[++s]=u}}q=r}this.paramCache_=null;var v=[],w="";for(var x=0;x<q.length;){var t=q[x++],u=q[x++];v.push(w,encodeURIComponent(t.toString()));w="&";if(u)v.push("=",encodeURIComponent(u.toString()))}this.query_=v.join("");return this};a.prototype.checkParameterCache_=function(){__p&&__p();if(!this.paramCache_){var q=this.query_;if(!q)this.paramCache_=[];else{var r=q.split(/[&\?]/),s=[],t=-1;for(var u=0;u<r.length;++u){var v=r[u].match(/^([^=]*)(?:=(.*))?$/);s[++t]=decodeURIComponent(v[1]).replace(/\+/g," ");s[++t]=decodeURIComponent(v[2]||"").replace(/\+/g," ")}this.paramCache_=s}}};a.prototype.setParameterValues=function(q,r){__p&&__p();if(typeof r==="string")r=[r];this.checkParameterCache_();var s=0,t=this.paramCache_,u=[];for(var v=0,w=0;v<t.length;v+=2)if(q===t[v]){if(s<r.length)u.push(q,r[s++])}else u.push(t[v],t[v+1]);while(s<r.length)u.push(q,r[s++]);this.setAllParameters(u);return this};a.prototype.removeParameter=function(q){return this.setParameterValues(q,[])};a.prototype.getAllParameters=function(){this.checkParameterCache_();return this.paramCache_.slice(0,this.paramCache_.length)};a.prototype.getParameterValues=function(q){this.checkParameterCache_();var r=[];for(var s=0;s<this.paramCache_.length;s+=2)if(q===this.paramCache_[s])r.push(this.paramCache_[s+1]);return r};a.prototype.getParameterMap=function(q){this.checkParameterCache_();var r={};for(var s=0;s<this.paramCache_.length;s+=2){var t=this.paramCache_[s++],u=this.paramCache_[s++];if(!(t in r))r[t]=[u];else r[t].push(u)}return r};a.prototype.getParameterValue=function(q){this.checkParameterCache_();for(var r=0;r<this.paramCache_.length;r+=2)if(q===this.paramCache_[r])return this.paramCache_[r+1];return null};a.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_)};a.prototype.getRawFragment=function(){return this.fragment_};a.prototype.setFragment=function(q){this.fragment_=q?encodeURIComponent(q):null;return this};a.prototype.setRawFragment=function(q){this.fragment_=q?q:null;return this};a.prototype.hasFragment=function(){return null!==this.fragment_};function m(q){return"string"==typeof q&&q.length>0?q:null}var n=new RegExp("^(?:([^:/?#]+):)?(?://(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),o=/[#\/\?@]/g,p=/[\#\?]/g;a.parse=d;a.create=e;a.resolve=l;a.collapse_dots=k;a.utils={mimeTypeOf:function(q){var r=d(q);if(/\.html$/.test(r.getPath()))return"text/html";else return"application/javascript"},resolve:function(q,r){if(q)return l(d(q),d(r)).toString();else return""+r}};return a}();typeof window!=="undefined";var ta=undefined,ua=undefined,va=undefined,wa=undefined,xa=undefined;(function(){__p&&__p();var d='url("about:blank")',e=/[\n\f\r\"\'()*<>]/g,f={"\n":"%0a","\f":"%0c","\r":"%0d",'"':"%22","'":"%27","(":"%28",")":"%29","*":"%2a","<":"%3c",">":"%3e"};function g(n){if("string"===typeof n)return'url("'+n.replace(e,h)+'")';else return d}function h(n){return f[n]}var Ca=new RegExp("^(?:([^:/?# ]+):)?"),Da=/^(?:https?|mailto)$/i;function i(n,o){if(n)return a.utils.resolve(n,o);return o}function j(n,o,p){if(!p)return null;var q=(""+n).match(Ca);if(q&&(!q[1]||Da.test(q[1])))return p(n,o);else return null}function k(n){return n.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,"")}ta=function(){__p&&__p();function n(p){var q={};for(var r=p.length;--r>=0;){var s=p[r];for(var t=s.length;--t>=0;)q[s[t]]=o}return q}var o={};return function p(q,r,s,t,u){__p&&__p();var v=k(q),w=qa[v];if(!w||"object"!==typeof w){r.length=0;return}var x=w.cssPropBits;function y(r,K){__p&&__p();var L=1,Fa=K+1,Ha=r.length;while(Fa<Ha&&L){var E=r[Fa++];L+=E===")"?-1:/^[^"']*\($/.test(E)}if(!L){var M=r[K].toLowerCase(),N=k(M),O=r.splice(K,Fa-K,""),Ia=w.cssFns;for(var C=0,Ja=Ia.length;C<Ja;++C)if(Ia[C].substring(0,N.length)==N){O[0]=O[O.length-1]="";p(Ia[C],O,s,t);return M+O.join(" ")+")"}}return""}var z=x&(la|ma),A=x&(oa|pa),B=NaN,C=0,D=0;for(;C<r.length;++C){var E=r[C].toLowerCase(),F=E.charCodeAt(0),G,Ea,H,I,Fa,Ga,J;E=F===" ".charCodeAt(0)?"":F==='"'.charCodeAt(0)?z===la?s?g(j(i(t,sa(r[C].substring(1,E.length-1))),v,s)):"":x&ka&&!(z&z-1)?E:"":E==="inherit"?E:(Ga=w.cssLitGroup,J=Ga?w.cssLitMap||(w.cssLitMap=n(Ga)):o,J[k(E)]===o)?E:F==="#".charCodeAt(0)&&/^#(?:[0-9a-f]{3}){1,2}$/.test(E)?x&ia?E:"":"0".charCodeAt(0)<=F&&F<="9".charCodeAt(0)?x&ha?E:"":(G=E.charCodeAt(1),Ea=E.charCodeAt(2),H="0".charCodeAt(0)<=G&&G<="9".charCodeAt(0),I="0".charCodeAt(0)<=Ea&&Ea<="9".charCodeAt(0),F==="+".charCodeAt(0)&&(H||G===".".charCodeAt(0)&&I))?x&ha?(H?"":"0")+E.substring(1):"":F==="-".charCodeAt(0)&&(H||G===".".charCodeAt(0)&&I)?x&ja?(H?"-":"-0")+E.substring(1):x&ha?"0":"":F===".".charCodeAt(0)&&H?x&ha?"0"+E:"":'url("'===E.substring(0,5)?s&&x&la?g(j(i(t,r[C].substring(5,E.length-2)),v,s)):"":E.charAt(E.length-1)==="("?y(r,C):A&&/^-?[a-z_][\w\-]*$/.test(E)&&!/__$/.test(E)?u&&A===oa?r[C]+u:A===pa&&qa[E]&&"number"===typeof qa[E].cssPropBits?E:"":/^\w+$/.test(E)&&z===ma&&x&ka?B+1===D?(r[B]=r[B].substring(0,r[B].length-1)+" "+E+'"',E=""):(B=D,'"'+E+'"'):"";if(E)r[D++]=E}if(D===1&&r[0]===d)D=0;r.length=D}}();var l=new RegExp("^(active|after|before|blank|checked|default|disabled|drop|empty|enabled|first|first-child|first-letter|first-line|first-of-type|fullscreen|focus|hover|in-range|indeterminate|invalid|last-child|last-of-type|left|link|only-child|only-of-type|optional|out-of-range|placeholder-shown|read-only|read-write|required|right|root|scope|user-error|valid|visited)$"),m={};m[">"]=m["+"]=m["~"]=m;ua=function(n,o,p){__p&&__p();var q=o.containerClass,r=o.idSuffix,s=o.tagPolicy,t=[],u=0,v,w=0,x;for(v=0;v<n.length;++v){x=n[v];if(x=="("||x=="["?(++w,true):x==")"||x=="]"?(w&&--w,true):!(n[v]==" "&&(w||m[n[v-1]]===m||m[n[v+1]]===m)))n[u++]=n[v]}n.length=u;var y=n.length,z=0;for(v=0;v<y;++v)if(n[v]===","){if(!A(z,v))return null;z=v+1}if(!A(z,y))return null;function A(z,B){__p&&__p();if(n[z]===" ")++z;if(B-1!==z&&n[B]===" ")--B;var C=[],D=z,E=true;for(var v=z;E&&v<B;++v){var x=n[v];if(m[x]===m||x===" ")if(!F(D,v,x))E=false;else D=v+1}if(!F(D,B,""))E=false;function F(z,B,Ea){__p&&__p();var H,I,Fa,Ga,x,E=true;H="";if(z<B){x=n[z];if(x==="*"){++z;H=x}else if(/^[a-zA-Z]/.test(x)){var J=s(x.toLowerCase(),[]);if(J){if("tagName"in J)x=J.tagName;++z;H=x}}}I="";Fa="";Ga="";for(;E&&z<B;++z){x=n[z];if(x.charAt(0)==="#")if(/^#_|__$|[^\w#:\-]/.test(x))E=false;else I+=x+r;else if(x===".")if(++z<B&&/^[0-9A-Za-z:_\-]+$/.test(x=n[z])&&!/^_|__$/.test(x))I+="."+x;else E=false;else if(z+1<B&&n[z]==="["){++z;var K=n[z++].toLowerCase(),L=b.ATTRIBS[H+"::"+K];if(L!==+L)L=b.ATTRIBS["*::"+K];var Ha;if(o.virtualizeAttrName){Ha=o.virtualizeAttrName(H,K);if(typeof Ha!=="string"){E=false;Ha=K}if(E&&L!==+L)L=b.atype.NONE}else{Ha=K;if(L!==+L)E=false}var M="",N="",O=false;if(/^[~^$*|]?=$/.test(n[z])){M=n[z++];N=n[z++];if(/^[0-9A-Za-z:_\-]+$/.test(N))N='"'+N+'"';else if(N==="]"){N='""';--z}if(!/^"([^\"\\]|\\.)*"$/.test(N))E=false;O=n[z]==="i";if(O)++z}if(n[z]!=="]"){++z;E=false}switch(L){case b.atype.CLASSES:case b.atype.LOCAL_NAME:case b.atype.NONE:break;case b.atype.GLOBAL_NAME:case b.atype.ID:case b.atype.IDREF:if((M==="="||M==="~="||M==="$=")&&N!='""'&&!O)N='"'+N.substring(1,N.length-1)+r+'"';else if(!(M==="|="||M===""))E=false;break;case b.atype.URI:case b.atype.URI_FRAGMENT:if(M!=="")E=false;break;default:E=false}if(E)Fa+="["+Ha.replace(/[^\w-]/g,"\\$&")+M+N+(O?" i]":"]")}else if(z<B&&n[z]===":"){x=n[++z];if(l.test(x))Ga+=":"+x;else break}else break}if(z!==B)E=false;if(E){var Ia=(H+I).replace(/[^ .*#\w-]/g,"\\$&")+Fa+Ga+Ea;if(Ia)C.push(Ia)}return E}if(E){if(C.length){var G=C.join("");if(q!==null)G="."+q+" "+G;t.push(G)}return true}else return!p||p(n.slice(z,B))}return t};(function(){__p&&__p();var n="(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)",o="(?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script)",p="(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)",q="-?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?"+p+"?))",r="\\( "+o+" (?:: "+q+" )?\\)",s="(?:(?:(?:(?:only|not) )?"+n+"|"+r+")(?: and ?"+r+")*)",t=/^\w/,u=new RegExp("^"+s+"(?: , "+s+")*$","i");xa=function(v){__p&&__p();v=v.slice();var w=v.length,x=0;for(var y=0;y<w;++y){var z=v[y];if(z!=" ")v[x++]=z}v.length=x;var A=v.join(" ");A=!A.length?"":!u.test(A)?"not all":t.test(A)?A:"not all , "+A;return A}})();(function(){__p&&__p();function n(p){__p&&__p();var q=/^\s*["]([^"]*)["]\s*$/,r=/^\s*[']([^']*)[']\s*$/,s=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/,t=/^\s*url\s*[(][']([^']*)['][)]\s*$/,u=/^\s*url\s*[(]([^)]*)[)]\s*$/,v;if(v=q.exec(p))return v[1];else if(v=r.exec(p))return v[1];else if(v=s.exec(p))return v[1];else if(v=t.exec(p))return v[1];else if(v=u.exec(p))return v[1];return null}function o(p,q,r,s,t,u,v){__p&&__p();var w=void 0,x=v||[0],y=[],z=false;ya(q,{startStylesheet:function(){w=[]},endStylesheet:function(){},startAtrule:function(B,C){__p&&__p();if(z)B=null;else if(B==="@media")w.push("@media"," ",xa(C));else if(B==="@keyframes"||B==="@-webkit-keyframes"){var D=C[0];if(C.length===1&&!/__$|[^\w\-]/.test(D)){w.push(B," ",D+r.idSuffix);B="@keyframes"}else B=null}else if(B==="@import"&&C.length>0){B=null;if("function"===typeof u){var E=xa(C.slice(1));if(E!=="not all"){++x[0];var F=[];w.push(F);var G=j(i(p,n(C[0])),function(Ea){var H=o(G,Ea.html,r,s,t,u,x);--x[0];var I=E?{toString:function(){return"@media "+E+" {"+H.result+"}"}}:H.result;F[0]=I;u(I,!!x[0])},t)}}else if(window.console)window.console.log("@import "+C.join(" ")+" elided")}z=!B;y.push(B)},endAtrule:function(){y.pop();if(!z)w.push(";");A()},startBlock:function(){if(!z)w.push("{")},endBlock:function(){if(!z){w.push("}");z=true}},startRuleset:function(B){__p&&__p();if(!z){var C=void 0;if(y[y.length-1]==="@keyframes"){C=B.join(" ").match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i);z=!C;if(C)C=C[0].replace(/ +/g,"")}else{var D=ua(B,r);if(!D||!D.length)z=true;else C=D.join(", ")}if(!z)w.push(C,"{")}y.push(null)},endRuleset:function(){y.pop();if(!z)w.push("}");A()},declaration:function(B,C){__p&&__p();if(!z){var D=false,E=C.length;if(E>=2&&C[E-2]==="!"&&C[E-1].toLowerCase()==="important"){D=true;C.length-=2}ta(B,C,s,p,r.idSuffix);if(C.length)w.push(B,":",C.join(" "),D?" !important;":";")}}});function A(){z=y.length&&y[y.length-1]===null}return{result:{toString:function(){return w.join("")}},moreToCome:!!x[0]}}va=function(p,q,r,s){return o(p,q,r,s,undefined,undefined).result.toString()};wa=function(p,q,r,s,t,u){return o(p,q,r,s,t,u)}})()})();if(typeof window!=="undefined"){window.sanitizeCssProperty=ta;window.sanitizeCssSelectorList=ua;window.sanitizeStylesheet=va;window.sanitizeMediaQuery=xa}if("I".toLowerCase()!=="i")throw"I/i problem";var ya,za;(function(){__p&&__p();ya=function(j,k){var l=ra(j);if(k.startStylesheet)k.startStylesheet();for(var m=0,n=l.length;m<n;)m=l[m]===" "?m+1:d(l,m,n,k);if(k.endStylesheet)k.endStylesheet()};function d(j,k,l,m){if(k<l){var n=j[k];if(n.charAt(0)==="@")return e(j,k,l,m,true);else return g(j,k,l,m)}else return k}function e(j,k,l,m,n){__p&&__p();var o=k++;while(k<l&&j[k]!=="{"&&j[k]!==";")++k;if(k<l&&(n||j[k]===";")){var p=o+1,q=k;if(p<l&&j[p]===" ")++p;if(q>p&&j[q-1]===" ")--q;if(m.startAtrule)m.startAtrule(j[o].toLowerCase(),j.slice(p,q));k=j[k]==="{"?f(j,k,l,m):k+1;if(m.endAtrule)m.endAtrule()}return k}function f(j,k,l,m){__p&&__p();++k;if(m.startBlock)m.startBlock();while(k<l){var n=j[k].charAt(0);if(n=="}"){++k;break}if(n===" "||n===";")k=k+1;else if(n==="@")k=e(j,k,l,m,false);else if(n==="{")k=f(j,k,l,m);else k=g(j,k,l,m)}if(m.endBlock)m.endBlock();return k}function g(j,k,l,m){__p&&__p();var n=k,o=h(j,k,l,true);if(o<0){o=~o;return o===n?o+1:o}var p=j[o];if(p!=="{")return o===n?o+1:o;k=o+1;if(o>n&&j[o-1]===" ")--o;if(m.startRuleset)m.startRuleset(j.slice(n,o));while(k<l){p=j[k];if(p==="}"){++k;break}if(p===" ")k=k+1;else k=i(j,k,l,m)}if(m.endRuleset)m.endRuleset();return k}function h(j,k,l,m){__p&&__p();var n=k,o,p=[],q=-1;for(;k<l;++k){o=j[k].charAt(0);if(o==="["||o==="(")p[++q]=o;else if(o==="]"&&p[q]==="["||o===")"&&p[q]==="(")--q;else if(o==="{"||o==="}"||o===";"||o==="@"||o===":"&&!m)break}if(q>=0)k=~(k+1);return k}var Ca=/^-?[a-z]/i;function Da(j,k,l){while(k<l&&j[k]!==";"&&j[k]!=="}")++k;return k<l&&j[k]===";"?k+1:k}function i(j,k,l,m){__p&&__p();var n=j[k++];if(!Ca.test(n))return Da(j,k,l);var o;if(k<l&&j[k]===" ")++k;if(k==l||j[k]!==":")return Da(j,k,l);++k;if(k<l&&j[k]===" ")++k;var p=k,q=h(j,k,l,false);if(q<0)q=~q;else{var r=[],s=0;for(var t=p;t<q;++t){o=j[t];if(o!==" ")r[s++]=o}if(q<l){do{o=j[q];if(o===";"||o==="}")break;s=0}while(++q<l);if(o===";")++q}if(s&&m.declaration)m.declaration(n.toLowerCase(),r)}return q}za=function(j,k){var l=ra(j);for(var m=0,n=l.length;m<n;)m=l[m]!==" "?i(l,m,n,k):m+1}})();if(typeof window!=="undefined"){window.parseCssStylesheet=ya;window.parseCssDeclarations=za}var b={};b.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13};b.atype=b.atype;b.ATTRIBS={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onerror":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::ontouchcancel":2,"*::ontouchend":2,"*::ontouchenter":2,"*::ontouchleave":2,"*::ontouchmove":2,"*::ontouchstart":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::tabindex":0,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,"audio::muted":0,"audio::preload":0,"audio::src":1,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::pattern":0,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::optimum":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,"textarea::rows":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::src":1,"video::width":0};b.ATTRIBS=b.ATTRIBS;b.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256};b.eflags=b.eflags;b.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,"var":0,video:0,wbr:2};b.ELEMENTS=b.ELEMENTS;b.ELEMENT_DOM_INTERFACES={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement","var":"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"};b.ELEMENT_DOM_INTERFACES=b.ELEMENT_DOM_INTERFACES;b.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};b.ueffects=b.ueffects;b.URIEFFECTS={"a::href":2,"area::href":2,"audio::src":1,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1,"video::src":1};b.URIEFFECTS=b.URIEFFECTS;b.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0};b.ltypes=b.ltypes;b.LOADERTYPES={"a::href":2,"area::href":2,"audio::src":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1,"video::src":2};b.LOADERTYPES=b.LOADERTYPES;if(typeof window!=="undefined")window.html4=b;if("I".toLowerCase()!=="i")throw"I/i problem";var Aa={};Aa.TagPolicyDecision;Aa.TagPolicy;var c=function(b){__p&&__p();var za,ta,qa;if("undefined"!==typeof window){za=window.parseCssDeclarations;ta=window.sanitizeCssProperty;qa=window.cssSchema}var d={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:"\xa0"},e=/^#(\d+)$/,f=/^#x([0-9A-Fa-f]+)$/,g=/^[A-Za-z][A-za-z0-9]+$/,h="undefined"!==typeof window&&window.document?window.document.createElement("textarea"):null;function Ca(P){__p&&__p();if(d.hasOwnProperty(P))return d[P];var Q=P.match(e);if(Q)return String.fromCharCode(parseInt(Q[1],10));else if(!!(Q=P.match(f)))return String.fromCharCode(parseInt(Q[1],16));else if(h&&g.test(P)){h.innerHTML="&"+P+";";var R=h.textContent;d[P]=R;return R}else return"&"+P+";"}function Da(P,Q){return Ca(Q)}var i=/\0/g;function j(P){return P.replace(i,"")}var k=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,l=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/;function m(P){return P.replace(k,Da)}var n=/&/g,o=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,p=/[<]/g,q=/>/g,r=/\"/g;function s(P){return(""+P).replace(n,"&amp;").replace(p,"&lt;").replace(q,"&gt;").replace(r,"&#34;")}function t(P){return P.replace(o,"&amp;$1").replace(p,"&lt;").replace(q,"&gt;")}var u=new RegExp("^\\s*([-.:\\w]+)(?:\\s*(=)\\s*((\")[^\"]*(\"|$)|(')[^']*('|$)|(?=[a-z][-\\w]*\\s*=)|[^\"'\\s]*))?","i"),v="a,b".split(/(,)/).length===3,w=b.eflags.CDATA|b.eflags.RCDATA;function x(P){var Q={cdata:P.cdata||P.cdata,comment:P.comment||P.comment,endDoc:P.endDoc||P.endDoc,endTag:P.endTag||P.endTag,pcdata:P.pcdata||P.pcdata,rcdata:P.rcdata||P.rcdata,startDoc:P.startDoc||P.startDoc,startTag:P.startTag||P.startTag};return function(R,S){return z(R,Q,S)}}var y={};function z(P,Q,R){var S,T,U,V=C(P),W={noMoreGT:false,noMoreEndComments:false};B(Q,V,0,W,R)}function A(P,Q,R,S,T){return function(){B(P,Q,R,S,T)}}function B(P,Q,R,S,T){__p&&__p();try{if(P.startDoc&&R==0)P.startDoc(T);var U,V,W;for(var X=R,Y=Q.length;X<Y;){var Z=Q[X++],$=Q[X];switch(Z){case"&":if(l.test($)){if(P.pcdata)P.pcdata("&"+$,T,y,A(P,Q,X,S,T));X++}else if(P.pcdata)P.pcdata("&amp;",T,y,A(P,Q,X,S,T));break;case"</":if(U=/^([-\w:]+)[^\'\"]*/.exec($))if(U[0].length===$.length&&Q[X+1]===">"){X+=2;W=U[1].toLowerCase();if(P.endTag)P.endTag(W,T,y,A(P,Q,X,S,T))}else X=D(Q,X,P,T,y,S);else if(P.pcdata)P.pcdata("&lt;/",T,y,A(P,Q,X,S,T));break;case"<":if(U=/^([-\w:]+)\s*\/?/.exec($))if(U[0].length===$.length&&Q[X+1]===">"){X+=2;W=U[1].toLowerCase();if(P.startTag)P.startTag(W,[],T,y,A(P,Q,X,S,T));var Ka=b.ELEMENTS[W];if(Ka&w){var La={name:W,next:X,eflags:Ka};X=G(Q,La,P,T,y,S)}}else X=E(Q,X,P,T,y,S);else if(P.pcdata)P.pcdata("&lt;",T,y,A(P,Q,X,S,T));break;case"<!--":if(!S.noMoreEndComments){for(V=X+1;V<Y;V++)if(Q[V]===">"&&/--$/.test(Q[V-1]))break;if(V<Y){if(P.comment){var Ma=Q.slice(X,V).join("");P.comment(Ma.substr(0,Ma.length-2),T,y,A(P,Q,V+1,S,T))}X=V+1}else S.noMoreEndComments=true}if(S.noMoreEndComments)if(P.pcdata)P.pcdata("&lt;!--",T,y,A(P,Q,X,S,T));break;case"<!":if(!/^\w/.test($)){if(P.pcdata)P.pcdata("&lt;!",T,y,A(P,Q,X,S,T))}else{if(!S.noMoreGT){for(V=X+1;V<Y;V++)if(Q[V]===">")break;if(V<Y)X=V+1;else S.noMoreGT=true}if(S.noMoreGT)if(P.pcdata)P.pcdata("&lt;!",T,y,A(P,Q,X,S,T))}break;case"<?":if(!S.noMoreGT){for(V=X+1;V<Y;V++)if(Q[V]===">")break;if(V<Y)X=V+1;else S.noMoreGT=true}if(S.noMoreGT)if(P.pcdata)P.pcdata("&lt;?",T,y,A(P,Q,X,S,T));break;case">":if(P.pcdata)P.pcdata("&gt;",T,y,A(P,Q,X,S,T));break;case"":break;default:if(P.pcdata)P.pcdata(Z,T,y,A(P,Q,X,S,T));break}}if(P.endDoc)P.endDoc(T)}catch(Na){if(Na!==y)throw Na}}function C(P){__p&&__p();var Q=/(<\/|<\!--|<[!?]|[&<>])/g;P+="";if(v)return P.split(Q);else{var R=[],S=0,T;while((T=Q.exec(P))!==null){R.push(P.substring(S,T.index));R.push(T[0]);S=T.index+T[0].length}R.push(P.substring(S));return R}}function D(P,Q,R,S,y,T){var U=Ea(P,Q);if(!U)return P.length;if(R.endTag)R.endTag(U.name,S,y,A(R,P,Q,T,S));return U.next}function E(P,Q,R,S,y,T){var U=Ea(P,Q);if(!U)return P.length;if(R.startTag)R.startTag(U.name,U.attrs,S,y,A(R,P,U.next,T,S));if(U.eflags&w)return G(P,U,R,S,y,T);else return U.next}var F={};function G(P,Q,R,S,y,T){__p&&__p();var U=P.length;if(!F.hasOwnProperty(Q.name))F[Q.name]=new RegExp("^"+Q.name+"(?:[\\s\\/]|$)","i");var V=F[Q.name],W=Q.next,X=Q.next+1;for(;X<U;X++)if(P[X-1]==="</"&&V.test(P[X]))break;if(X<U)X-=1;var Y=P.slice(W,X).join("");if(Q.eflags&b.eflags.CDATA){if(R.cdata)R.cdata(Y,S,y,A(R,P,X,T,S))}else if(Q.eflags&b.eflags.RCDATA){if(R.rcdata)R.rcdata(t(Y),S,y,A(R,P,X,T,S))}else throw new Error("bug");return X}function Ea(P,Q){__p&&__p();var R=/^([-\w:]+)/.exec(P[Q]),S={};S.name=R[1].toLowerCase();S.eflags=b.ELEMENTS[S.name];var T=P[Q].substr(R[0].length),U=Q+1,V=P.length;for(;U<V;U++){if(P[U]===">")break;T+=P[U]}if(V<=U)return void 0;var W=[];while(T!==""){R=u.exec(T);if(!R)T=T.replace(/^[\s\S][^a-z\s]*/,"");else if(R[4]&&!R[5]||R[6]&&!R[7]){var X=R[4]||R[6],Y=false,Z=[T,P[U++]];for(;U<V;U++){if(Y){if(P[U]===">")break}else if(0<=P[U].indexOf(X))Y=true;Z.push(P[U])}if(V<=U)break;T=Z.join("");continue}else{var $=R[1].toLowerCase(),Ka=R[2]?H(R[3]):"";W.push($,Ka);T=T.substr(R[0].length)}}S.attrs=W;S.next=U+1;return S}function H(P){var Q=P.charCodeAt(0);if(Q===34||Q===39)P=P.substr(1,P.length-2);return m(j(P))}function I(P){__p&&__p();var Q,R,S=function(T,U){if(!R)U.push(T)};return x({startDoc:function(T){Q=[];R=false},startTag:function(T,U,V){__p&&__p();if(R)return;if(!b.ELEMENTS.hasOwnProperty(T))return;var W=b.ELEMENTS[T];if(W&b.eflags.FOLDABLE)return;var X=P(T,U);if(!X){R=!(W&b.eflags.EMPTY);return}else if(typeof X!=="object")throw new Error("tagPolicy did not return object (old API?)");if("attribs"in X)U=X.attribs;else throw new Error("tagPolicy gave no attribs");var Y,Z;if("tagName"in X){Z=X.tagName;Y=b.ELEMENTS[Z]}else{Z=T;Y=W}if(W&b.eflags.OPTIONAL_ENDTAG){var $=Q[Q.length-1];if($&&$.orig===T&&($.rep!==Z||T!==Z))V.push("</",$.rep,">")}if(!(W&b.eflags.EMPTY))Q.push({orig:T,rep:Z});V.push("<",Z);for(var Ka=0,La=U.length;Ka<La;Ka+=2){var Ma=U[Ka],Na=U[Ka+1];if(Na!==null&&Na!==void 0)V.push(" ",Ma,'="',s(Na),'"')}V.push(">");if(W&b.eflags.EMPTY&&!(Y&b.eflags.EMPTY))V.push("</",Z,">")},endTag:function(T,U){__p&&__p();if(R){R=false;return}if(!b.ELEMENTS.hasOwnProperty(T))return;var V=b.ELEMENTS[T];if(!(V&(b.eflags.EMPTY|b.eflags.FOLDABLE))){var W;if(V&b.eflags.OPTIONAL_ENDTAG)for(W=Q.length;--W>=0;){var X=Q[W].orig;if(X===T)break;if(!(b.ELEMENTS[X]&b.eflags.OPTIONAL_ENDTAG))return}else for(W=Q.length;--W>=0;)if(Q[W].orig===T)break;if(W<0)return;for(var Y=Q.length;--Y>W;){var Z=Q[Y].rep;if(!(b.ELEMENTS[Z]&b.eflags.OPTIONAL_ENDTAG))U.push("</",Z,">")}if(W<Q.length)T=Q[W].rep;Q.length=W;U.push("</",T,">")}},pcdata:S,rcdata:S,cdata:S,endDoc:function(T){for(;Q.length;Q.length--)T.push("</",Q[Q.length-1].rep,">")}})}var Fa=/^(?:https?|mailto)$/i;function Ga(P,Q,R,S,T){__p&&__p();if(!T)return null;try{var U=a.parse(""+P);if(U)if(!U.hasScheme()||Fa.test(U.getScheme())){var V=T(U,Q,R,S);return V?V.toString():null}}catch(W){return null}return null}function J(P,Q,R,S,T){__p&&__p();if(!R)P(Q+" removed",{change:"removed",tagName:Q});if(S!==T){var U="changed";if(S&&!T)U="removed";else if(!S&&T)U="added";P(Q+"."+R+" "+U,{change:U,tagName:Q,attribName:R,oldValue:S,newValue:T})}}function K(P,Q,R){var S;S=Q+"::"+R;if(P.hasOwnProperty(S))return P[S];S="*::"+R;if(P.hasOwnProperty(S))return P[S];return void 0}function L(P,Q){return K(b.ATTRIBS,P,Q)}function Ha(P,Q){return K(b.LOADERTYPES,P,Q)}function M(P,Q){return K(b.URIEFFECTS,P,Q)}function N(P,Q,R,S,T){__p&&__p();for(var U=0;U<Q.length;U+=2){var V=Q[U],W=Q[U+1],X=W,Y=null,Z;if((Z=P+"::"+V,b.ATTRIBS.hasOwnProperty(Z))||(Z="*::"+V,b.ATTRIBS.hasOwnProperty(Z)))Y=b.ATTRIBS[Z];if(Y!==null)switch(Y){case b.atype.NONE:break;case b.atype.SCRIPT:W=null;if(T)J(T,P,V,X,W);break;case b.atype.STYLE:if("undefined"===typeof za){W=null;if(T)J(T,P,V,X,W);break}var $=[];za(W,{declaration:function(Ka,La){var Ma=Ka.toLowerCase();ta(Ma,La,R?function(Na){return Ga(Na,b.ueffects.SAME_DOCUMENT,b.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:Ma},R)}:null);if(La.length)$.push(Ma+": "+La.join(" "))}});W=$.length>0?$.join(" ; "):null;if(T)J(T,P,V,X,W);break;case b.atype.ID:case b.atype.IDREF:case b.atype.IDREFS:case b.atype.GLOBAL_NAME:case b.atype.LOCAL_NAME:case b.atype.CLASSES:W=S?S(W):W;if(T)J(T,P,V,X,W);break;case b.atype.URI:W=Ga(W,M(P,V),Ha(P,V),{TYPE:"MARKUP",XML_ATTR:V,XML_TAG:P},R);if(T)J(T,P,V,X,W);break;case b.atype.URI_FRAGMENT:if(W&&"#"===W.charAt(0)){W=W.substring(1);W=S?S(W):W;if(W!==null&&W!==void 0)W="#"+W}else W=null;if(T)J(T,P,V,X,W);break;default:W=null;if(T)J(T,P,V,X,W);break}else{W=null;if(T)J(T,P,V,X,W)}Q[U+1]=W}return Q}function O(P,Q,R,S){__p&&__p();return function(T,U){__p&&__p();var V=true;if(S){V=false;S.forEach(function(W){if(T==W)V=true})}if(!(b.ELEMENTS[T]&b.eflags.UNSAFE)&&V)return{attribs:N(T,U,P,Q,R)};else if(R)J(R,T,undefined,undefined,undefined)}}function Ia(P,Q){var R=[];I(Q)(P,R);return R.join("")}function Ja(P,Q,R,S,T){var U=O(Q,R,S,T);return Ia(P,U)}var c={};c.escapeAttrib=c.escapeAttrib=s;c.makeHtmlSanitizer=c.makeHtmlSanitizer=I;c.makeSaxParser=c.makeSaxParser=x;c.makeTagPolicy=c.makeTagPolicy=O;c.normalizeRCData=c.normalizeRCData=t;c.sanitize=c.sanitize=Ja;c.sanitizeAttribs=c.sanitizeAttribs=N;c.sanitizeWithPolicy=c.sanitizeWithPolicy=Ia;c.unescapeEntities=c.unescapeEntities=m;return c}(b),Ba=c.sanitize;if(typeof window!=="undefined"){window.html=c;window.html_sanitize=Ba}fa.exports=c}),null);
__d("OzTaskComposers.react",["cx","OzHelpers","OzAPI","CajaHTMLSanitizer","CIWebmailValidator","DraftEditor.react","EditorState","ContentState","FileInput.react","immutable","OzNotify","OzActions","OzDateTimePicker.react","OzDraggableModal.react","OzPlaceField.react","promiseFinally","OzImmutablePureRenderMixin","React","Reflux","XUICloseButton.react","XUIError.react"],(function aa(ba,a,ca,da,b,ea,fa){__p&&__p();var c,d,e,f,g=a("CIWebmailValidator").isValidEmail,h=a("immutable").Map,i=a("immutable").List,j=a("immutable").Record,k=a("React").PropTypes,l={intentId:null,id:null,type:null,errors:h(),disabled:false,sending:false},m=["to"],n=["from"],o=["cc"],p=["bcc"],q=["body",0,"body","contents"],r=a("immutable").fromJS([{"content-type":"text/plain; charset=UTF-8",body:{contents:""}}]),s=a("immutable").fromJS({to:"",cc:"",bcc:"",from:"",subject:"",body:r}),t=j(babelHelpers["extends"]({},l,{email:s,uploadSem:0})),u=a("Reflux").createStore({init:function H(){this._offlineId=0;this.data=h();this.listenToMany(a("OzActions").emailComposer)},getInitialState:function H(){return this.data},onUpdate:function H(I){this._u(function(J){return J.set(I.get("id"),I)})},onDelete:function H(I){this._u(function(J){return J["delete"](I)})},onAdd:function H(){var I=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],J=new t(I).update("id",function(K){return K||this._offlineId++}.bind(this)).updateIn(["email","from"],function(K){return I.from||(i.isList(K)?K.first():K)}).update("email",ma);this._u(function(K){return K.set(J.get("id"),J)})},_u:function H(I){this.data=I(this.data);this.trigger(this.data)}}),v=a("React").createClass({displayName:"EmailContainer",mixins:[a("OzImmutablePureRenderMixin")],propTypes:{emailState:k.instanceOf(t).isRequired},render:function H(){var I=this.props.emailState;return a("React").createElement(w,{email:I.get("email"),errors:I.get("errors"),disabled:I.get("disabled"),sending:I.get("sending"),onClose:this._handleClose,onChange:this._handleChange,onSend:this._handleSend,onUpload:this._handleUpload,onAttOpen:this._handleAttOpen})},_handleClose:function H(){a("OzActions").emailComposer["delete"](this.props.emailState.get("id"))},_handleChange:function H(I){a("OzActions").emailComposer.update(this.props.emailState.set("email",I))},_handleSend:function H(){__p&&__p();var I=this.props.emailState,J=I.get("email"),K=[[J.getIn(m),"Please specify a destination email address"],[J.get("subject"),"Please write a subject"],[J.getIn(q),"Please write a message"],[I.get("uploadSem")===0,"Your attachments are still uploading"]].find(function(N){var O=N[0],P=N[1];return!O});if(K){a("OzNotify").error(K[1]);return}var L=na(J).set("intent-id",I.get("intentId")),M=h({to:m,cc:o,bcc:p}).map(function(N){return B(L.getIn(N))}).filter(function(N){return N});if(!M.isEmpty()){a("OzActions").emailComposer.update(I.set("errors",M));return}a("OzActions").emailComposer.update(I.set("sending",true));a("OzAPI").sendEmail(L,I.get("intentId")).then(function(N){a("OzActions").emailComposer["delete"](I.get("id"))})["catch"](function(N){a("OzActions").emailComposer.update(I.set("sending",false))})},_handleAttOpen:function H(I){var J=I.getIn(["body","everstore-handle"]);a("OzAPI").everstoreURI(J).done(function(K){return window.open(K)})},_handleUpload:function H(I){__p&&__p();var J=function(L){return a("OzActions").emailComposer.update(this.props.emailState.update("uploadSem",function(J){return J+L}))}.bind(this);J(1);var K=a("OzAPI").everstoreUpload(h({blob:I})).then(function(L){return la(L,I)}).then(function(L){a("OzActions").emailComposer.update(this.props.emailState.updateIn(["email","body"],function(M){return M.push(L)}))}.bind(this));a("promiseFinally")(K,function(L){return J(-1)})}});c=babelHelpers.inherits(w,a("React").Component);d=c&&c.prototype;function w(H){"use strict";d.constructor.call(this,H);var I=function I(J){return a("EditorState").createWithContent(a("ContentState").createFromText(H.email.getIn(J)||""))};this.state={showCC:false,showBCC:false,inputEditorStates:{from:I(n),to:I(m),cc:I(o),bcc:I(p),subject:I(["subject"])}}}w.prototype.componentDidMount=function(){"use strict";var H=["to","subject"].find(function(I){var J=this.state.inputEditorStates[I];return J&&!J.getCurrentContent().getPlainText().length}.bind(this)),I=this.refs[H||"body"];I&&I.focus()};w.prototype.render=function(){"use strict";__p&&__p();var H=this.props,I=H.email,J=H.errors,K=H.onClose,L=H.onUpload,M=H.onAttOpen,N=H.onChange,O=H.onSend,P=H.disabled,Q=H.sending,R=this.state.showCC||P&&I.getIn(o),S=this.state.showBCC||P&&I.getIn(p),T=function(W,X,Y){return a("React").createElement(y,{error:J.get(X),editorState:this.state.inputEditorStates[X],disabled:P||Q,placeholder:W,ref:X,onChange:function(Z){var $;this.setState({inputEditorStates:babelHelpers["extends"]({},this.state.inputEditorStates,($={},$[X]=Z,$))});var sa=Z.getCurrentContent().getPlainText();N(I.setIn(Y,sa))}.bind(this)})}.bind(this),U=A(I,"text/plain");if(U==-1)U=0;var V=["body",U,"body","contents"];return a("React").createElement(a("OzDraggableModal.react"),{className:"_4h1d",getHandle:function(W){return this.refs.header}.bind(this)},a("React").createElement("div",null,a("React").createElement("div",{className:"_4h1e",ref:"header"},a("React").createElement(a("XUICloseButton.react"),{onClick:K})),a("React").createElement(y,{editorState:this.state.inputEditorStates.from,disabled:true,onChange:function W(X){return null}}),a("React").createElement("div",{className:"_1jg2"},T("To","to",m),!R&&!(P||Q)?a("React").createElement("button",{tabIndex:"-1",className:"_1jg3",onClick:function(W){return this.setState({showCC:true})}.bind(this)},"CC"):null,!S&&!(P||Q)?a("React").createElement("button",{tabIndex:"-1",className:"_1jg3",onClick:function(W){return this.setState({showBCC:true})}.bind(this)},"BCC"):null),R?T("Cc","cc",o):null,S?T("Bcc","bcc",p):null,T("Subject","subject",["subject"]),P?a("React").createElement(x,{email:I}):a("React").createElement("textarea",{disabled:P||Q,placeholder:"Write your masterpiece",ref:"body",className:"_1-i0 _4h1j",value:I.getIn(V),onChange:function W(X){return N(I.setIn(V,X.target.value))}}),a("React").createElement(ga,{email:I,onChange:N,onAttOpen:M}),P?null:a("React").createElement("div",{className:"_5l1v"},a("React").createElement("button",{onClick:O,disabled:Q,className:"_1-hv _30yy _n8p"},Q?"Sending...":"Send"),a("React").createElement(a("FileInput.react"),{ref:"fileInput",onChange:function(W){L(W.target.files[0]);this.refs.fileInput.getFileInput().clear()}.bind(this)},a("React").createElement("a",{title:"add images",className:"_5l1w _30yy"})))))};w.propTypes={onClose:k.func.isRequired,onSend:k.func,disabled:k.bool,sending:k.bool,email:k.instanceOf(h).isRequired,errors:k.instanceOf(h),onChange:k.func.isRequired,onUpload:k.func.isRequired,onAttOpen:k.func.isRequired};var x=a("OzHelpers").pure(function(H){var I=H.email,J=ia(I,"text/html","text/plain"),K=J.getIn(["body","contents"]);return a("React").createElement("div",{className:"_3x40"},ka(J)?a("React").createElement("div",{style:{whiteSpace:"pre-wrap"}},K):a("React").createElement(z,{html:K}))}),y=a("React").createClass({displayName:"EmailInput",propTypes:{disabled:k.bool,editorState:k.instanceOf(a("EditorState")).isRequired,error:k.string,onChange:k.func,placeholder:k.string},defaultProps:{disabled:false,error:null,onChange:function H(){},placeholder:null},focus:function H(){this.refs.editor.focus()},render:function H(){return a("React").createElement(a("XUIError.react"),{xuiError:this.props.error,xuiErrorPosition:"left"},a("React").createElement("div",{className:"_1-i0 _4h1i",onClick:this.focus,role:"presentation"},a("React").createElement(a("DraftEditor.react"),{editorState:this.props.editorState,ref:"editor",onChange:this.props.onChange,placeholder:this.props.placeholder,readOnly:this.props.disabled})))}}),z=a("OzHelpers").pure(function(H){var I=H.html,J=babelHelpers.objectWithoutProperties(H,["html"]);return a("React").createElement("div",babelHelpers["extends"]({},J,{dangerouslySetInnerHTML:{__html:a("CajaHTMLSanitizer").sanitize(I,function(K){return K})}}))}),ga=a("OzHelpers").pure(function(H){var I=H.email,J=H.onAttOpen,K=H.onChange,L=I.get("body").map(function(M,N){return ja(M)?null:a("React").createElement(ha,{key:N,part:M,onClick:function O(P){return J(M)},onRemove:function O(P){return K(I.update("body",function(Q){return Q["delete"](N)}))}})}).filter(function(M){return!!M});return L.isEmpty()?null:a("React").createElement("div",{className:"_5l1-"},L)}),ha=a("OzHelpers").pure(function(H){var I=H.part,J=H.onClick,K=H.onRemove;return a("React").createElement("div",{className:"_5l26"},a("React").createElement("button",{className:"_1-hv",onClick:J},I.getIn(["body","filename"])),a("React").createElement(a("XUICloseButton.react"),{onClick:K}))});function ia(H){for(var I=arguments.length,J=Array(I>1?I-1:0),K=1;K<I;K++)J[K-1]=arguments[K];var L=J.map(function(M){return A(H,M)}).find(function(L){return L>-1});return Number.isSafeInteger(L)?H.getIn(["body",L]):r.first()}function A(H,I){return H.get("body").findIndex(function(J){return J.get("content-type").indexOf(I)>-1})}function ja(H){var I=H.get("content-type");return I&&I.indexOf("text/plain")>-1||I.indexOf("text/html")>-1}function ka(H){return H.get("content-type").indexOf("text/plain")>-1}function B(H){H=i(H);var I=H.filterNot(g);return I.isEmpty()?null:"Invalid email address(es): "+I.join(", ")+"."}function la(H,I){return a("immutable").fromJS({"content-type":I.type,body:{"everstore-handle":H,filename:I.name}})}function ma(H){return H.updateIn(m,C).updateIn(o,C).updateIn(p,C)}function na(H){return H.updateIn(m,D).updateIn(o,D).updateIn(p,D)}function C(H){return H&&H.join(", ")}function D(H){return H?H.split(/[, ]/).filter(function(I){return I.length}):[]}var E=a("immutable").fromJS({title:"",description:"",start:null,startTimezone:"",end:null,endTimezone:"",location:"",to:""}),F=j(babelHelpers["extends"]({},l,{invite:E})),oa=a("Reflux").createStore({init:function H(){this._offlineId=0;this.data=h();this.listenToMany(a("OzActions").inviteComposer)},getInitialState:function H(){return this.data},onUpdate:function H(I){this._u(function(J){return J.set(I.get("id"),I)})},onDelete:function H(I){this._u(function(J){return J["delete"](I)})},onAdd:function H(){var I=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],J=new F(I).update("id",function(K){return K||this._offlineId++}.bind(this)).updateIn(["invite","to"],C);this._u(function(K){return K.set(J.get("id"),J)})},onCreate:function H(I,J,K){var L=new F({intentId:I,invite:qa(J,K),id:this._offlineId++});this._u(function(M){return M.set(L.get("id"),L)})},_u:function H(I){this.data=I(this.data);this.trigger(this.data)}}),pa=a("React").createClass({displayName:"InviteContainer",mixins:[a("OzImmutablePureRenderMixin")],propTypes:{inviteState:k.instanceOf(F).isRequired},render:function H(){var I=this.props.inviteState;return a("React").createElement(G,{disabled:I.get("disabled"),sending:I.get("sending"),initialTimezone:I.get("timezone"),invite:I.get("invite"),errors:I.get("errors"),onChange:this._handleChange,onClose:this._handleClose,onSend:this._handleSend})},_handleChange:function H(I){a("OzActions").inviteComposer.update(this.props.inviteState.set("invite",I))},_handleClose:function H(){a("OzActions").inviteComposer["delete"](this.props.inviteState.get("id"))},_handleSend:function H(){__p&&__p();var I=this.props.inviteState,J=I.get("invite"),K=J.get("selectedPlace"),L=[[J.get("to")||K,"Please click on a location in the dropdown or enter an email address"],[J.get("title"),"Please choose a title"],[J.get("start"),"Please select a start time"],[J.get("end"),"Please select an end time"],[J.get("end")>=J.get("start"),"Event must start before it ends"]].find(function(O){var P=O[0],Q=O[1];return!P});if(L){a("OzNotify").error(L[1]);return}var M=K?J["delete"]("selectedPlace").set("intent-id",I.get("intentId"))["delete"]("to")["delete"]("description").set("place-id",K.get("id")):J["delete"]("selectedPlace").set("intent-id",I.get("intentId")).update("to",D),N=h({to:"to"}).map(function(O){return B(M.get(O))}).filter(function(O){return O});if(!N.isEmpty()){a("OzActions").inviteComposer.update(I.set("errors",N));return}a("OzActions").inviteComposer.update(I.set("sending",true));a("OzAPI").sendInvite(M,I.get("intentId")).then(function(O){a("OzActions").inviteComposer["delete"](I.get("id"))})["catch"](function(O){a("OzActions").inviteComposer.update(I.set("sending",false))})}});e=babelHelpers.inherits(G,a("React").Component);f=e&&e.prototype;G.prototype.componentDidMount=function(){"use strict";var H=["title","description","location","to"].map(function(I){return this.refs[I]}.bind(this)).find(function(H){return H&&!H.value});H&&H.focus()};G.prototype.render=function(){"use strict";__p&&__p();var H=this.props,I=H.disabled,J=H.sending,K=H.invite,L=H.errors,M=H.onClose,N=H.onChange,O=H.onSend,P=function P(T,U){return a("React").createElement(a("XUIError.react"),{xuiError:L.get(U),xuiErrorPosition:"left"},a("React").createElement("input",{type:"text",className:"_1-i0 _4h1i",disabled:I||J,placeholder:T,ref:U,value:K.get(U),onChange:function V(W){return N(K.set(U,W.target.value))}}))},Q=function Q(T,U){return a("React").createElement("div",null,T+":",a("React").createElement(a("OzDateTimePicker.react"),babelHelpers["extends"]({className:"_pto",layout:"two-line",timestamp:K.get(U)||a("OzHelpers").serverNow(),timezone:K.get(U+"Timezone"),disabled:I||J,onChange:function V(W){var X=W.timestamp,Y=W.timezone;return N(K.set(U,+X).set(U+"Timezone",Y))}},a("OzHelpers").dateRestraints())))},R=function R(T,U,V){return a("React").createElement(a("OzPlaceField.react"),{className:"_1-i0 _n8q",disabled:I||J,onQueryStringChange:function W(X){N(K["delete"](V).set(U,X))},onSelect:function W(X){N(K.set(V,X).set(U,X.get("name")))},placeholder:T,queryString:K.get(U),selectedEntry:K.get(V),xuiError:L.get(U)||L.get(V)})},S=!!K.get("selectedPlace")||!!K.get("place-id");return a("React").createElement(a("OzDraggableModal.react"),{className:"_ptp"},a("React").createElement("div",{className:"_ptq"},"Calendar Invite",a("React").createElement(a("XUICloseButton.react"),{onClick:M})),P("Title","title"),S||P("Description","description"),R("Location...","location","selectedPlace"),S||P("Email to...","to"),Q("Start Time","start"),Q("End Time","end"),I?null:a("React").createElement("div",{className:"_5l1v"},a("React").createElement("button",{onClick:O,disabled:J,className:"_1-hv _30yy _n8p"},J?"Sending...":S?"Send Bubble":"Send Email")))};function G(){"use strict";e.apply(this,arguments)}G.propTypes={invite:k.instanceOf(h).isRequired,errors:k.instanceOf(h),onClose:k.func.isRequired,onChange:k.func.isRequired,onSend:k.func.isRequired,disabled:k.bool,sending:k.bool};function qa(){var H=arguments.length<=0||arguments[0]===undefined?"":arguments[0],I=arguments.length<=1||arguments[1]===undefined?"":arguments[1];return E.set("start",a("OzHelpers").serverNow()).set("startTimezone",I).set("end",a("OzHelpers").serverNow()).set("endTimezone",I).set("to",H)}var ra=a("React").createClass({displayName:"OzTaskComposers",mixins:[a("OzImmutablePureRenderMixin"),a("Reflux").connect(u,"emails"),a("Reflux").connect(oa,"invites")],propTypes:{intent:k.instanceOf(h).isRequired},render:function H(){var I=function(L){return L.get("intentId")==this.props.intent.get("id")}.bind(this),J=this.state.emails.filter(I),K=this.state.invites.filter(I);return a("React").createElement("span",null,J.map(function(L){return a("React").createElement(v,{key:L.get("id"),emailState:L})}).valueSeq(),K.map(function(L){return a("React").createElement(pa,{key:L.get("id"),inviteState:L})}).valueSeq())}});b.exports=ra}),null);
__d("OzTaskActionEditor.react",["cx","OzHelpers","immutable","InputLabel_DEPRECATED.react","InputLabelLabel_DEPRECATED.react","MessengerButtonReact.bs","OzImmutablePureRenderMixin","React","XUIError.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("MessengerButtonReact.bs").jsComponent,j=c("immutable").Map,k=c("React").PropTypes,l=c("immutable").fromJS({traffic:{label:"Include traffic update",params:[{name:"origin",placeholder:"Origin address",err:"What is the origin address?"},{name:"destination",placeholder:"Destination address",err:"What is the destination address?"}]},weather:{label:"Include weather forecast",params:[{name:"location",placeholder:"City",err:"What city is the forecast for?"},{name:"metric",placeholder:"Celsius or Fahrenheit",err:"You need to set Celsius or Fahrenheit"}]}}),m=c("OzHelpers").pure(function(o){var p=o.action,q=o.errors,r=o.onToggle,s=o.onUpdate,t=o.actions,u=!!t.get(p);return c("React").createElement("div",null,c("React").createElement(c("InputLabel_DEPRECATED.react"),null,c("React").createElement("input",{type:"checkbox",checked:u,onChange:function v(w){return r(w,p)}}),c("React").createElement(c("InputLabelLabel_DEPRECATED.react"),null,l.getIn([p,"label"]))),u&&c("React").createElement("div",null,l.getIn([p,"params"]).map(function(v){var w=v.get("name"),x=[p,w],y=t.getIn(x);return c("React").createElement(c("XUIError.react"),{key:p+"-"+w,xuiError:q.getIn([p,w])},c("React").createElement("input",{type:v.get("type","text"),className:"_wbw",placeholder:v.get("placeholder"),value:y,onChange:function z(A){return s(A,x)}}))}).valueSeq()))}),n=c("React").createClass({displayName:"OzTaskActionEditor",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{task:k.instanceOf(j).isRequired,onSelectAction:k.func.isRequired},getInitialState:function o(){return{errors:j(),actions:this.props.task.getIn(["data","actions"],j())}},render:function o(){return c("React").createElement("div",{className:"_3zsp"},l.keySeq().map(function(p){return c("React").createElement(m,{key:p,action:p,actions:this.state.actions,errors:this.state.errors,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate})}.bind(this)).valueSeq(),c("React").createElement(i,{onClick:this._handleSaveActions,label:"Set Actions",type:"primary"}))},_handleActionToggle:function o(p,q){var r=p.target.checked?j([[q,j()]]):j();this.setState({actions:r})},_handleActionUpdate:function o(p,q){this.setState({actions:this.state.actions.setIn(q,p.target.value)})},_handleSaveActions:function o(){var p=this.props.onSelectAction,q=this.state.actions,r=this._findErrors();if(r.count())this.setState({errors:r});else p(q)},_findErrors:function o(){var p=this.state.actions,q=function q(r){return!!p.get(r)};return l.reduce(function(r,s,t){if(q(t))r=s.get("params").reduce(function(r,u){return p.getIn([t,u.get("name")])?r:r.setIn([t,u.get("name")],u.get("err"))},r);return r},j())}});f.exports=n}),null);
__d("OzTaskShow.react",["cx","debounce","getActiveElement","OzHelpers","immutable","InputLabel.react","Keys","LayerHideOnBlur","MessengerButtonReact.bs","OzNotify","OzActions","OzConfirmDialog.react","OzDate.react","OzDateTimePicker.react","OzTaskActionEditor.react","OzImmutablePureRenderMixin","React","ShimButton.react","XUIContextualDialog.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("MessengerButtonReact.bs").jsComponent,j=c("immutable").Map,k=c("immutable").List,l=c("immutable").Set,m=c("React").PropTypes,n=1e3,o=c("React").createClass({displayName:"OzTaskShow",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{location:m.instanceOf(j).isRequired,onCancel:m.func.isRequired,onComplete:m.func.isRequired,onOpen:m.func.isRequired,onSave:m.func.isRequired,task:m.instanceOf(j).isRequired},render:function x(){var y=this.props,z=y.task,A=y.location,B=y.onCancel,C=y.onComplete,D=y.onOpen;return c("React").createElement("div",{className:"_1h7p"},c("React").createElement("div",{className:"_1h7q"}),c("React").createElement(p,{task:z,onChangeDescription:this._handleChangeDescription}),c("React").createElement(w,{task:z,onChangeNotes:this._handleChangeNotes}),c("React").createElement(r,{task:z,location:A,onSelectDeadline:this._handleSelectDeadline}),c("React").createElement(s,{task:z,onChangeDuration:this._handleChangeDuration}),c("React").createElement(v,{task:z,onChangeActions:this._handleChangeActions}),c("React").createElement(u,{task:z,onChangeRecur:this._handleChangeRecur}),c("React").createElement(q,{task:z,onCancelTask:B,onOpenTask:D,onCompleteTask:C}))},_handleChangeDescription:function x(y){var z=this.props,A=z.onSave,B=z.task;A(B.setIn(["data","description"],y))},_handleSelectDeadline:function x(y){var z=this.props,A=z.onSave,B=z.task,C=y-B.get("deadline");A(B.set("deadline",y).update("start-at",function(D){return D+C}))},_handleChangeDuration:function x(y){var z=this.props,A=z.onSave,B=z.task;if(y<0)c("OzNotify").warn("Duration must be greater than 0");else A(B.set("start-at",B.get("deadline")-y*6e4))},_handleChangeRecur:function x(y){var z=this.props,A=z.onSave,B=z.task,C=z.location;A(B.set("schedule",j({"start-at":B.get("start-at"),frequency:"weekly",timezone:C.get("timezone"),"timezone-offset":C.get("timezone-offset"),"repeat-condition":j({spacing:1,days:y.toList()})})))},_handleChangeActions:function x(y){var z=this.props,A=z.onSave,B=z.task;A(B.setIn(["data","actions"],y))},_handleChangeNotes:function x(y){var z=this.props,A=z.onSave,B=z.task;A(B.setIn(["data","notes"],y))}}),p=c("React").createClass({displayName:"OzTaskShowDescription",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onChangeDescription:m.func.isRequired,task:m.instanceOf(j).isRequired},componentDidMount:function x(){if(!this.props.task.getIn(["data","description"]))this.setState({editing:true})},getInitialState:function x(){return{editing:false}},render:function x(){var y=this.props.task,z=(y.get("state")==="completed"?"[Closed] ":"")+(y.getIn(["data","description"],"").length?y.getIn(["data","description"]):"untitled task");return c("React").createElement("div",{className:"_1h7v _p44"},this.state.editing?c("React").createElement("textarea",{className:"_1h7r _1h7s",placeholder:"untitled task",defaultValue:y.getIn(["data","description"]),onBlur:function(A){return this.setState({editing:false})}.bind(this),onKeyDown:this._handleKeydown,ref:function A(B){if(B){B.focus();c("OzHelpers").moveCursorToInputEnd(B)}}}):c("React").createElement(c("ShimButton.react"),{className:"_1h7r",inline:true,onClick:function(A){return this.setState({editing:true})}.bind(this)},z))},_handleKeydown:function x(y){var z=this.props.onChangeDescription;switch(y.which){case c("Keys").RETURN:case c("Keys").TAB:z(y.target.value);case c("Keys").ESC:this.setState({editing:false})}}}),q=c("React").createClass({displayName:"OzTaskShowStateSelector",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onCancelTask:m.func.isRequired,onCompleteTask:m.func.isRequired,onOpenTask:m.func.isRequired,task:m.instanceOf(j).isRequired},_maybeConfirmCancel:function x(){var y=this.props,z=y.task,A=y.onCancelTask;if(z.has("schedule"))c("OzActions").showDialog(c("OzConfirmDialog.react"),{onConfirm:function B(C){return A(z,true)},onCancel:function B(C){return A(z,false)},body:"This is a recurring task. Do you want to delete just this instance or all future occurrences also?",header:"Delete Recurring Task",confirmLabel:"Delete Future Tasks",cancelLabel:"Only This One"});else A(z,false)},render:function x(){var y=this.props,z=y.onCancelTask,A=y.onCompleteTask,B=y.onOpenTask,C=y.task;return c("React").createElement("div",{className:"_1h7t"},c("React").createElement(c("ShimButton.react"),{className:"_47xm",onClick:this._maybeConfirmCancel},"Delete"),C.get("state")==="completed"?c("React").createElement(c("ShimButton.react"),{className:"_47yc",onClick:function D(E){return B(C)}},"Reopen task"):c("React").createElement(c("ShimButton.react"),{className:"_47yd",onClick:function D(E){return A(C)}},"Mark complete"))}}),r=c("React").createClass({displayName:"OzTaskShowDeadlineSelector",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onSelectDeadline:m.func.isRequired,location:m.instanceOf(j).isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return{editing:false}},render:function x(){var y=this.props,z=y.task,A=y.location;return c("React").createElement("div",{className:"_1h7v"},c("React").createElement("div",{className:"_1h7w"},"Due"),c("React").createElement("div",{className:"_1h7y"},this.state.editing?c("React").createElement("div",{className:"_1h7z"},c("React").createElement(c("OzDateTimePicker.react"),{className:"_1xh-",layout:"three-line",showTimezoneName:false,timestamp:this.state.timestamp||Date.now(),timezone:this.state.timezone||A.get("timezone"),onChange:function(B){return this.setState(B)}.bind(this)}),c("React").createElement("div",{className:"_1xh_"},c("React").createElement(c("ShimButton.react"),{className:"_1h7-",onClick:this._handleSelectDeadline},"\u2713"),c("React").createElement(c("ShimButton.react"),{className:"_1h7_",onClick:this._handleCancel},"\u2715"))):c("React").createElement(c("ShimButton.react"),{className:"_1h80",onClick:this._handleStartEditing},c("React").createElement(c("OzDate.react"),{timestamp:z.get("deadline")}))))},_handleSelectDeadline:function x(){this.props.onSelectDeadline(this.state.timestamp);this.setState({editing:false})},_handleStartEditing:function x(){this.setState({editing:true,timestamp:this.props.task.get("deadline")})},_handleCancel:function x(){this.setState({editing:false})}}),s=c("React").createClass({displayName:"OzTaskShowDuration",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onChangeDuration:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return{editing:false}},render:function x(){return c("React").createElement("div",{className:"_1h7v"},c("React").createElement("div",{className:"_1h7w"},"Duration (min)"),c("React").createElement("div",{className:"_1h7y"},this.state.editing?c("React").createElement("textarea",{className:"_1h81 _1h7s",defaultValue:this._getDuration(),onBlur:function(y){return this.setState({editing:false})}.bind(this),onKeyDown:this._handleKeydown,ref:function y(z){if(z){z.focus();c("OzHelpers").moveCursorToInputEnd(z)}}}):c("React").createElement(c("ShimButton.react"),{className:"_1h81",inline:true,onClick:function(y){return this.setState({editing:true})}.bind(this)},this._getDuration())))},_getDuration:function x(){var y=this.props.task;return Math.round((y.get("deadline")-y.get("start-at"))/6e4)},_handleKeydown:function x(y){var z=this.props.onChangeDuration;if(y.which===c("Keys").RETURN){z(y.target.value);this.setState({editing:false})}}}),t=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],u=c("React").createClass({displayName:"OzTaskShowRecurSelector",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onChangeRecur:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return{editing:false,daysSet:l()}},componentWillMount:function x(){var y=this.props.task;this.setState({daysSet:l(y.getIn(["schedule","repeat-condition","days"]))})},render:function x(){__p&&__p();var y=this.props.task,z=this.state,A=z.editing,B=z.daysSet,C=y.getIn(["schedule","repeat-condition","days"],k()).map(function(D){return t[D-1]}).join(", ");return c("React").createElement("div",{className:"_1h7v"},c("React").createElement("div",{className:"_1h7w"},"Recurrence"),c("React").createElement("div",{className:"_1h7y"},c("React").createElement("span",{onClick:function(D){return this.setState({editing:true})}.bind(this),ref:"setSpan",role:"button",tabIndex:"0"},C.length?C:"Set Recurrence..."),c("React").createElement(c("XUIContextualDialog.react"),{position:"above",contextRef:function(D){return this.refs.setSpan}.bind(this),className:"_3zsp",shown:A,onToggle:function(D){return this.setState({editing:D})}.bind(this),behaviors:{LayerHideOnBlur:c("LayerHideOnBlur")}},c("React").createElement("div",{className:"_3zsp"},t.map(function(D,E){var F=E+1;return c("React").createElement(c("InputLabel.react"),{key:E,label:D},c("React").createElement("input",{type:"checkbox",checked:B.has(F),onChange:function(G){var H=G.target.checked?B.add(F):B["delete"](F);this.setState({daysSet:H})}.bind(this)}))}.bind(this)),c("React").createElement(i,{onClick:this._handleChangeRecur,label:"Set Recurrence",type:"primary"})))))},_handleChangeRecur:function x(){this.props.onChangeRecur(this.state.daysSet);this.setState({editing:false})}}),v=c("React").createClass({displayName:"OzTaskShowActionSelector",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onChangeActions:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return{editing:false}},render:function x(){var y=this.props.task,z=this.state.editing,A=y.getIn(["data","actions"],j()).keySeq().join(", ");return c("React").createElement("div",{className:"_1h7v"},c("React").createElement("div",{className:"_1h7w"},"Actions"),c("React").createElement("div",{className:"_1h7y"},c("React").createElement("span",{onClick:function(B){return this.setState({editing:true})}.bind(this),ref:"setSpan",role:"button",tabIndex:"0"},A.length?A:"Set Actions..."),c("React").createElement(c("XUIContextualDialog.react"),{position:"above",contextRef:function(B){return this.refs.setSpan}.bind(this),className:"_3zsp",shown:z,onToggle:function(B){return this.setState({editing:B})}.bind(this),behaviors:{LayerHideOnBlur:c("LayerHideOnBlur")}},c("React").createElement(c("OzTaskActionEditor.react"),{task:y,onSelectAction:this._handleSelectAction}))))},_handleSelectAction:function x(y){this.props.onChangeActions(y);this.setState({editing:false})}}),w=c("React").createClass({displayName:"OzTaskShowNotes",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onChangeNotes:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return{editedText:this.props.task.getIn(["data","notes"],"")}},componentWillReceiveProps:function x(y){var z=y.task.get(["data","notes"]),A=c("getActiveElement")()===this.refs.textarea;if(z!==this.props.task.get(["data","notes"])&&!A)this.setState({editedText:z})},componentWillMount:function x(){this._save=c("debounce")(this._save,n,this,true)},render:function x(){return c("React").createElement("div",{className:"_1h7v"},c("React").createElement("textarea",{className:"_1h83 _1h7s",placeholder:"Add a note...",ref:"textarea",value:this.state.editedText,onChange:this._handleChange}))},_handleChange:function x(){var y=this.refs.textarea.value;this.setState({editedText:y},this._save)},_save:function x(){this.props.onChangeNotes(this.state.editedText)}});f.exports=o}),null);
__d("OzCalendarEvent.react",["cx","Image.react","LineClamp.react","React","Tooltip","formatDate","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l="_2erb",m=6e4;i=babelHelpers.inherits(n,c("React").Component);j=i&&i.prototype;function n(){__p&&__p();var o,p;"use strict";for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={mouseDown:false},this.$OzCalendarEvent1=function(t,u){return{backgroundColor:"rgb(1, 136, 245)",backgroundImage:"repeating-linear-gradient(-45deg,rgba(70, 130, 200, 0.8),rgba(70, 130, 200, 0.8) 10px,rgba(70, 130, 200, 0.5) 10px,rgba(70, 130, 200, 0.5) 20px)"}},this.$OzCalendarEvent2=function(){this.setState({mouseDown:true})}.bind(this),this.$OzCalendarEvent3=function(){this.setState({mouseDown:false})}.bind(this),this.$OzCalendarEvent4=function(){var t=this.props;return function(u){if(this.state.mouseDown){if(this.props.onInitiateDrag&&this.props.draggable)this.props.onInitiateDrag(t,u);this.setState({mouseDown:false})}}.bind(this)}.bind(this),this.$OzCalendarEvent5=function(){if(!this.props.animation)return null;return c("React").createElement("div",{className:"_2ere",style:this.$OzCalendarEvent1(this.props.shade,this.props.tentative)})}.bind(this),p}n.prototype.render=function(){"use strict";__p&&__p();var o=Math.floor((this.props.height-12)/14)-1,p=Math.max(0,this.props.endTime-this.props.startTime),q=Math.round(p/m),r=q<15,s=q===15,t="_2erb"+(this.props.selected?" _2erf":"")+(this.props.tentative?" _2erg":"")+(s?" _2erh":"")+(r?" _2erk":""),u=[];if(this.props.icons)for(var v=0;v<this.props.icons.length;v++){var w=this.props.icons[v],x=w[0],y=w[1],z=c("React").createElement(c("Image.react"),{className:"_2erl",src:x,key:v,"aria-label":y,"data-hover":"tooltip","data-tooltip-content":y});u.push(z)}var A=c("React").createElement("div",null,u),B=null,C=null;if(this.props.showTime){var D=null,E=null;if(!this.props.isAllDayEvent){D=c("formatDate")(new Date(this.props.startTime),"g:ia");E="-"+c("formatDate")(new Date(this.props.endTime),"g:ia")}else D="All day";C=D+E;B=c("React").createElement("span",{className:"_2erm"},D)}var F=C+"\n"+this.props.title+"\n"+this.props.location,G=null;if(o>0)G=c("React").createElement(c("LineClamp.react"),{disableNative:true,lineHeight:14,className:"_2ero",lines:o},this.props.subTitle);var H=this.props.draggable?{onMouseDown:this.$OzCalendarEvent2,onMouseUp:this.$OzCalendarEvent3,onMouseMove:this.$OzCalendarEvent4()}:{},I=this.props.hasOutline?"_2ers":"";return c("React").createElement("div",babelHelpers["extends"]({},this.props,H,{className:c("joinClasses")("_2ert",I),title:"",onClick:this.props.onEventClicked}),this.$OzCalendarEvent5(),c("React").createElement("div",{className:c("joinClasses")(this.props.className,t),style:this.$OzCalendarEvent1(this.props.shade,this.props.tentative)},A,c("React").createElement("div",{className:"_2eru"},c("React").createElement("span",babelHelpers["extends"]({className:"_2erv"+(r?" _2erw":"")},c("Tooltip").propsFor(this.props.hasTooltip?F:null)),B,this.props.title),G)))};n.propTypes={startTime:k.number.isRequired,endTime:k.number.isRequired,title:k.oneOfType([k.string,k.object]),location:k.string,shade:k.string.isRequired,icons:k.array,hasOutline:k.bool,hasTooltip:k.bool,height:k.number.isRequired,selected:k.bool.isRequired,tentative:k.bool,onEventClicked:k.func.isRequired,onInitiateDrag:k.func,draggable:k.bool,subTitle:k.oneOfType([k.string,k.object]),isAllDayEvent:k.bool,showTime:k.bool};n.defaultProps={showTime:true,draggable:false};n.EVENT_CLASS_NAME=l;f.exports=n}),null);
__d("OzCalendarUtils",["DateConsts","immutable"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("DateConsts").MIN_PER_HOUR*c("DateConsts").SEC_PER_MIN*c("DateConsts").MS_PER_SEC,i=c("DateConsts").HOUR_PER_DAY*h,j=7;function k(y,z){return q(y).toDateString()===q(z).toDateString()}function l(y,z){var A=new Date(y);A.setDate(A.getDate()+z);return A.getTime()}function m(y,z){var A=new Date(y),B=new Date(z),C=Date.UTC(A.getFullYear(),A.getMonth(),A.getDate()),D=Date.UTC(B.getFullYear(),B.getMonth(),B.getDate());return Math.floor((D-C)/i)}function n(y){__p&&__p();var z=arguments.length<=1||arguments[1]===undefined?1:arguments[1];if(z===null)z=1;var A=new Date(y);A.setHours(0);A.setMinutes(0);A.setSeconds(0);A.setMilliseconds(0);var B=A.getDay()-z;if(B<0)B+=7;return l(A.getTime(),-B)}function o(y){var z=arguments.length<=1||arguments[1]===undefined?1:arguments[1];return new Date(n(y.getTime(),z))}function p(y,z){return n(y.getTime())===n(z.getTime())}function q(y){var z=new Date(y),A=new Date(z.getFullYear(),z.getMonth(),z.getDate());return A}function r(y,z){var A=new Date(y);A.setDate(A.getDate()+z);return A}function s(y,z){var A=arguments.length<=2||arguments[2]===undefined?1:arguments[2],B=[],C=0,D=new Date(n(y,A));do{var E=r(D,C),F=r(D,C+7);B.push(E);C+=7}while(F.getTime()<z);return B}function t(y,z){var A=[],B=0;if(y>z)return A;do{var C=r(y,B),D=r(y,B+1);A.push(C);B+=1}while(D.getTime()<=z);return A}function u(event){return x.datesFrameToDays(x.timestampToDateOnly(event.props.startTime),x.timestampToDateOnly(event.props.endTime))}function v(event,y,z){var A=q(event.props.startTime),B=q(event.props.endTime),C=q(y),D=l(q(z).getTime(),1);return x.datesFrameToDays(new Date(Math.max(A,C)),new Date(Math.min(B,D)))}function w(y,z,A){__p&&__p();var B=c("immutable").Map(),w=c("immutable").Map();y.concat().sort(function(C,D){return C.props.startTime-D.props.startTime}).forEach(function(event){__p&&__p();var C=c("immutable").List(v(event,z,A)),D=0;while(true){var E=C.every(function(F){return!B.get(F,c("immutable").Set()).has(D)});if(E){w=w.set(event.key,D);B=C.reduce(function(F,G){return F.update(G,c("immutable").Set(),function(H){return H.add(D)})},B);break}D++}});return w}var x={MS_IN_HOUR:h,DAY_IN_WEEK:j,datesEqual:k,compareWeeks:p,datesFrameToDays:t,timeFrameToWeeks:s,getWeekStartDate:o,addDaysToTimestamp:l,getDayDifference:m,getWeekStartTimestamp:n,timestampToDateOnly:q,getShiftedDate:r,slotsByEventKey:w,daysOfEvent:u,daysOfEventInRange:v};f.exports=x}),null);
__d("OzFlexBox.react",["cx","invariant","DOM","React","joinClasses"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;m.prototype.render=function(){"use strict";var p="_4o6j"+(this.props.direction&&m.VERTICAL?" _4o6k":"")+(this.props.direction&&m.REVERSE?" _4o6l":"");return c("React").createElement("div",babelHelpers["extends"]({},this.props,{className:c("joinClasses")(this.props.className,p)}),c("React").Children.map(this.props.children,n,this))};function m(){"use strict";j.apply(this,arguments)}m.VERTICAL=1;m.REVERSE=2;function n(p){if(!p)return null;var q=this.props.direction&&m.VERTICAL,r=p.props,s=r.boxFlex,t=r.boxSize,u=r.boxMinSize,v=r.boxMaxSize;!(s&&t)||i(0);var w={WebkitBoxFlex:s,WebkitFlex:s,MozFlex:s,flex:s,width:q?null:t,height:q?t:null,minWidth:q?null:u,minHeight:q?u:null,maxWidth:q?null:v,maxHeight:q?v:null};return c("React").createElement("div",{style:w,className:"_4o6m"},p)}function o(){__p&&__p();if(l!==undefined)return l;var p=c("DOM").create("div");p.style.display="-webkit-flex";if(p.style.display==="-webkit-flex")return l=false;p.style.display="-moz-flex";if(p.style.display==="-moz-flex")return l=false;p.style.display="flex";if(p.style.display==="flex")return l=false;return l=true}m.isLolzyFlex=o;f.exports=m}),null);
__d("OzCalendarMonthly.react",["cx","OzFlexBox.react","DateConsts","DateStrings","OzCalendarUtils","Link.react","React","ReactDOM","ResizeListener","ScrollableArea.react","getElementPosition","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={selectedEventKey:null,currentTime:new Date(),dayHeight:null},this.$OzCalendarMonthly1=null,this.$OzCalendarMonthly2=27,this.$OzCalendarMonthly3=20,this.$OzCalendarMonthly4=22,this.$OzCalendarMonthly5=null,this.getCalendarContentPosition=function(){var r=c("ReactDOM").findDOMNode(this.refs.scrollable);if(r)return c("getElementPosition")(r);return null}.bind(this),this.$OzCalendarMonthly6=function(){var r=c("getElementPosition")(c("ReactDOM").findDOMNode(this.refs.testCell));return r.height}.bind(this),this.$OzCalendarMonthly8=function(){var r=this.getCalendarStartDate(),s=c("OzCalendarUtils").getShiftedDate(r,c("DateConsts").DAYS_PER_WEEK*6-1);return{start:r.getTime(),end:s.getTime()}}.bind(this),this.$OzCalendarMonthly7=function(){var r=this.$OzCalendarMonthly8();if(this.props.onFrameChange)this.props.onFrameChange(r.start,r.end);if(this.props.scrollToCurrentTime){var s=this.refs.scrollable.getArea();if(s)s.setScrollTop(this.state.dayHeight*(this.getCurrentDateRow()-1)+1,false)}}.bind(this),this.groupEvents=function(){__p&&__p();var r=[],s=c("React").Children.toArray(this.props.children).sort(function(u,v){return u.props.startTime-v.props.startTime}),t=c("OzCalendarUtils").slotsByEventKey(s,this.getCalendarStartDate(),this.getCalendarEndDate());s.forEach(function(event){var u=c("OzCalendarUtils").daysOfEventInRange(event,this.getCalendarStartDate(),this.getCalendarEndDate());u.forEach(function(v){var w=t.get(event.key);if(!r[v])r[v]=[];r[v][w]=this.cloneOfEventForDay(event,v,w)}.bind(this))}.bind(this));return r}.bind(this),this.cloneOfEventForDay=function(event,r,s){var t=!c("OzCalendarUtils").datesEqual(event.props.startTime,event.props.endTime),u=c("OzCalendarUtils").datesEqual(r,event.props.startTime)||c("OzCalendarUtils").datesEqual(r,this.getCalendarStartDate()),v=c("OzCalendarUtils").datesEqual(r,event.props.endTime)||c("OzCalendarUtils").datesEqual(r,this.getCalendarEndDate());return c("React").cloneElement(event,{className:(!u&&!v?"_2bg_":"")+(t&&u?" _2bh2":"")+(t&&v?" _2bh3":""),key:event.key,height:24,onEventClicked:function(){return this.setState({selectedEventKey:event.key})}.bind(this),selected:this.state.selectedEventKey===event.key,style:{top:s*this.$OzCalendarMonthly4+this.$OzCalendarMonthly2+"px"}})}.bind(this),this.getCalendarStartDate=function(){var r=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);r.setDate(r.getDate()-r.getDay());return r}.bind(this),this.getCalendarEndDate=function(){var r=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);r.setDate(r.getDate()+42);return r}.bind(this),this.getCurrentDateRow=function(){var r=c("OzCalendarUtils").getDayDifference(this.getCalendarStartDate().getTime(),this.state.currentTime.getTime()),s=Math.floor(r/7);if(s>5)return 0;return s}.bind(this),this.renderGridLines=function(r,s,t){__p&&__p();var u=0,v=5,w=[];for(var x=0;x<=v;x++){u=x*c("DateConsts").DAYS_PER_WEEK+r;var y=c("OzCalendarUtils").getShiftedDate(this.getCalendarStartDate(),u),z=this.props.highlightedDay,A=(t&&x===0?"_2bh4":"")+(!t&&x===0?" _2bh5":"")+(r===0&&x===v?" _2bh6":"")+(t&&x===v?" _2bh7":"")+(t&&x!==v?" _2bh8":"")+(!t&&x===v?" _2bh9":"")+(r===0?" _2bha":"")+" _2bhb"+(y.toDateString()===this.state.currentTime.toDateString()?" _2bhe":"")+(z&&y.toDateString()===z.toDateString()?" _2bhf":""),B=null;if(this.state.dayHeight){var C=Math.floor((this.state.dayHeight-this.$OzCalendarMonthly2-this.$OzCalendarMonthly3)/this.$OzCalendarMonthly4)+1;if(s[y]&&s[y].length>C){(function(D){B=c("React").createElement(c("Link.react"),{onClick:function(){return this.$OzCalendarMonthly9(D)}.bind(this),className:"_2bhg"},"Show more ("+(s[y].length-C)+")")}).bind(this)(y);s[y]=s[y].slice(0,C)}}else s[y]=[];w.push(c("React").createElement("div",{key:x,ref:r===0&&x===0?"testCell":null,style:{height:"16.666%"},onDoubleClick:this.$OzCalendarMonthly10(y),className:A},c("React").createElement("div",{className:"_2bhh"+(y.getMonth()!==this.props.date.getMonth()?" _2bhi":"")},y.getMonth()!==this.props.date.getMonth()&&y.getDate()===1?c("DateStrings").getMonthNameShort(y.getMonth()+1).toString()+" ":null,y.getDate()),c("React").createElement("div",{className:"_2bhj"},s[y],B)))}return c("React").createElement("div",null,w)}.bind(this),this.$OzCalendarMonthly10=function(r){if(this.props.onDateClick){var s=this.props.onDateClick;return function(){return s(r)}}else return null}.bind(this),this.$OzCalendarMonthly9=function(r){if(this.props.onShowMore)this.props.onShowMore(r)}.bind(this),this.renderDayHeader=function(r){var s=c("React").createElement("div",{className:"_2bhk"},c("DateStrings").getWeekdayName(r)),t=r===6;return c("React").createElement("div",{className:"_2bhx",boxFlex:1,key:r},c("React").createElement("div",{className:"_2bhy"+(t?" _2bhz":"")+(r===0?" _2bh-":"")},s))},this.renderCol=function(r,s){var t=r===6;return c("React").createElement("div",{className:"_2bhx",boxFlex:1,key:r},this.renderGridLines(r,s,t))}.bind(this),n}l.prototype.componentDidMount=function(){"use strict";this.$OzCalendarMonthly1=setInterval(function(){return this.setState({currentTime:new Date()})}.bind(this),60*1e3);this.setState({dayHeight:this.$OzCalendarMonthly6()});setTimeout(function(){return this.$OzCalendarMonthly7()}.bind(this),0);this.$OzCalendarMonthly5=c("ResizeListener").add(function(){return this.setState({dayHeight:this.$OzCalendarMonthly6()})}.bind(this))};l.prototype.componentWillUnmount=function(){"use strict";if(this.$OzCalendarMonthly1)clearInterval(this.$OzCalendarMonthly1);if(this.$OzCalendarMonthly5)this.$OzCalendarMonthly5.remove()};l.prototype.componentDidUpdate=function(m,n){"use strict";if(m&&m.date!==this.props.date)this.$OzCalendarMonthly7()};l.prototype.render=function(){"use strict";__p&&__p();var m=this.groupEvents(),n=[],o=[];for(var p=0;p<c("DateConsts").DAYS_PER_WEEK;p++){n.push(this.renderCol(p,m));o.push(this.renderDayHeader(p))}var q=c("React").createElement(c("ScrollableArea.react"),{className:"_2bgx",ref:"scrollable",shadow:false},c("React").createElement(c("OzFlexBox.react"),{className:"_2bgy"},n)),r=c("joinClasses")(this.props.className,"_2bgz _2bg-"),s={};if(this.props.calendarHeight)s={height:this.props.calendarHeight+"px"};return c("React").createElement("div",{style:s,className:r},c("React").createElement(c("OzFlexBox.react"),{className:"_2bgy"},o),q)};l.propTypes={date:k.instanceOf(Date).isRequired,calendarHeight:k.number,onShowMore:k.func,scrollToCurrentTime:k.bool,onDateClick:k.func,highlightedDay:k.instanceOf(Date)};l.defaultProps={dayStartHour:9,dayEndHour:17,daysPerWeek:5,date:new Date(),weekStartDay:1,enableCurrentTimeMarker:true,calendarHeight:700};f.exports=l}),null);
__d("OzCalendarType",[],(function a(b,c,d,e,f,g){f.exports={MONTH:1,WEEK:2,DAY:3}}),null);
__d("OzCalendarPager.react",["cx","fbt","ix","OzCalendarUtils","Image.react","OzCalendarType","React","XUIButton.react","XUIButtonGroup.react"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m=c("React").PropTypes;k=babelHelpers.inherits(n,c("React").Component);l=k&&k.prototype;function n(){__p&&__p();var o,p;"use strict";for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=l.constructor).call.apply(o,[this].concat(r)),this.onWeekNavigate=function(t){this.props.onDateChange&&this.props.onDateChange(new Date(t))}.bind(this),this.$OzCalendarPager1=function(t){var u=this.props.date.getTime(),v=c("OzCalendarUtils").addDaysToTimestamp(u,t);return v}.bind(this),this.$OzCalendarPager2=function(t){var u=c("OzCalendarUtils").getWeekStartTimestamp(this.props.date.getTime()),v=c("OzCalendarUtils").addDaysToTimestamp(u,t*c("OzCalendarUtils").DAY_IN_WEEK);return v}.bind(this),this.$OzCalendarPager3=function(t){return new Date(this.props.date.getFullYear(),this.props.date.getMonth()+t*1,1).getTime()}.bind(this),this.$OzCalendarPager4=function(t){return new Date(this.props.date.getFullYear()+t*1,this.props.date.getMonth(),1).getTime()}.bind(this),this.$OzCalendarPager5=function(t){var u;switch(this.props.mode){case c("OzCalendarType").MONTH:u=this.$OzCalendarPager3(t);break;case c("OzCalendarType").WEEK:u=this.$OzCalendarPager2(t);break;case c("OzCalendarType").DAY:u=this.$OzCalendarPager1(t);break}this.onWeekNavigate(u)}.bind(this),this.$OzCalendarPager6=function(t){var u=this.props.mode===c("OzCalendarType").MONTH?this.$OzCalendarPager4(t):this.$OzCalendarPager3(t);this.onWeekNavigate(u)}.bind(this),p}n.prototype.render=function(){"use strict";var o=this.props,p=o.buttonSize,q=o.disabled,r=o.hasFastSwitch;return c("React").createElement(c("XUIButtonGroup.react"),{className:"_3-95"},r?c("React").createElement(c("XUIButton.react"),{disabled:q,image:c("React").createElement(c("Image.react"),{src:j("101337")}),label:i._("Primera p\u00e1gina"),labelIsHidden:true,role:"button",size:p,style:{opacity:.63},onClick:function(){return this.$OzCalendarPager6(-1)}.bind(this)}):null,c("React").createElement(c("XUIButton.react"),{disabled:q,image:c("React").createElement(c("Image.react"),{src:j("101339")}),label:i._("Atr\u00e1s"),labelIsHidden:true,role:"button",size:p,onClick:function(){return this.$OzCalendarPager5(-1)}.bind(this)}),c("React").createElement(c("XUIButton.react"),{label:"Today",disabled:q,size:p,onClick:function(){return this.onWeekNavigate(Date.now())}.bind(this)}),c("React").createElement(c("XUIButton.react"),{disabled:q,image:c("React").createElement(c("Image.react"),{src:j("101341")}),label:i._("Siguiente"),labelIsHidden:true,role:"button",size:p,onClick:function(){return this.$OzCalendarPager5(1)}.bind(this)}),r?c("React").createElement(c("XUIButton.react"),{disabled:q,image:c("React").createElement(c("Image.react"),{src:j("101338")}),label:i._("\u00daltima p\u00e1gina"),labelIsHidden:true,role:"button",size:p,style:{opacity:.63},onClick:function(){return this.$OzCalendarPager6(1)}.bind(this)}):null)};n.propTypes={date:m.instanceOf(Date).isRequired,onDateChange:m.func,buttonSize:m.string,mode:m.oneOf([c("OzCalendarType").MONTH,c("OzCalendarType").WEEK,c("OzCalendarType").DAY]),hasFastSwitch:m.bool,disabled:m.bool};n.defaultProps={mode:c("OzCalendarType").WEEK};f.exports=n}),null);
__d("OzPagedMonthlyCalendar.react",["cx","DateStrings","OzCalendarMonthly.react","OzCalendarPager.react","OzCalendarType","LoadingIndicator.react","React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={date:new Date(this.props.date)},this.$OzPagedMonthlyCalendar1=function(){return c("React").createElement("div",{className:"_1if9"},c("React").createElement("div",{className:"_1ifa"},this.props.events.length+" events"),c("React").createElement("div",{className:"_1ifb"},c("React").createElement(c("OzCalendarPager.react"),{date:this.state.date,mode:c("OzCalendarType").MONTH,onDateChange:this.$OzPagedMonthlyCalendar4,hasFastSwitch:true})),c("React").createElement("div",{className:"_1ifc"},c("React").createElement("strong",null,c("DateStrings").getMonthName(this.state.date.getMonth()+1)),"  ",this.state.date.getFullYear()))}.bind(this),this.$OzPagedMonthlyCalendar2=function(){if(!this.props.isLoading)return null;return c("React").createElement("div",{className:"_1ifd"},c("React").createElement(c("LoadingIndicator.react"),{size:"large",color:"white"}))}.bind(this),this.$OzPagedMonthlyCalendar3=function(){return c("React").createElement("div",{className:"_1ife"},c("React").createElement(c("OzCalendarMonthly.react"),{date:this.state.date,className:"_1iff",onDateClick:this.props.onDateClick,onShowMore:this.props.onShowMore,highlightedDay:this.props.highlightedDay},this.props.events))}.bind(this),this.$OzPagedMonthlyCalendar4=function(r){this.setState({date:r},function(){this.props.onDateChange(r)}.bind(this))}.bind(this),n}l.prototype.render=function(){"use strict";return c("React").createElement("div",{className:"_1if8"},this.$OzPagedMonthlyCalendar1(),this.$OzPagedMonthlyCalendar2(),this.$OzPagedMonthlyCalendar3())};l.propTypes={date:k.instanceOf(Date).isRequired,events:k.array.isRequired,isLoading:k.bool,onDateClick:k.func,onDateChange:k.func.isRequired,onShowMore:k.func.isRequired,highlightedDay:k.instanceOf(Date)};f.exports=l}),null);
__d("OzCalendarModal.react",["cx","OzConfig","OzImmutablePureRenderMixin","immutable","React","Reflux","OzDraggableModal.react","XUICloseButton.react","OzPagedMonthlyCalendar.react","OzCalendarEvent.react","XUIDialog.react","XUIDialogBody.react","XUIDialogTitle.react","formatDate"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes,l=c("immutable").Map,m=c("React").createClass({displayName:"OzCalendarModal",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{events:k.array.isRequired,onClose:k.func.isRequired},getInitialState:function q(){return{moreDialogShown:false,moreDialogDate:new Date()}},render:function q(){var r=this.state.config.get("GK",l()),s=r.get("calendar"),t=this.props,u=t.events,v=t.onClose;return c("React").createElement(c("OzDraggableModal.react"),{className:"_33-2",getHandle:function(w){return this.refs.header}.bind(this)},c("React").createElement("div",{className:"_33-3",ref:"header"},!s?"Calendar - Busy/Free Access only":"Calendar",c("React").createElement(c("XUICloseButton.react"),{onClick:v})),c("React").createElement(c("OzPagedMonthlyCalendar.react"),{isLoading:false,events:n(u,s),date:new Date(),onDateChange:function w(x){},onShowMore:this._calendarShowMore}),this._renderShowMoreDialog(s))},_renderShowMoreDialog:function q(r){if(this.state.moreDialogShown)return c("React").createElement(p,{events:o(this.props.events,this.state.moreDialogDate),date:this.state.moreDialogDate,onToggle:this._onShowMoreToggle,calendarBusy:r});return null},_calendarShowMore:function q(r){this.setState({moreDialogShown:true,moreDialogDate:r})}}),n=function n(q,r){return q.map(function(s){return c("React").createElement(c("OzCalendarEvent.react"),{key:s.identifier,title:r?s.title:"Busy",location:r?s.location:"",startTime:new Date(s.startDate).getTime(),endTime:new Date(s.endDate).getTime(),shade:"DarkBlue",hasTooltip:r})})},o=function o(q,r){var s=new Date(r);s.setTime(s.getTime()+864e5);return q.sort(function(t,u){return new Date(t.startDate).getTime()-new Date(u.startDate).getTime()}).filter(function(t){return new Date(t.startDate).getTime()>=new Date(r).getTime()||new Date(t.endDate).getTime()>=new Date(r).getTime()}).filter(function(t){return new Date(t.startDate).getTime()<s.getTime()})};i=babelHelpers.inherits(p,c("React").Component);j=i&&i.prototype;function p(){__p&&__p();var q,r;"use strict";for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=j.constructor).call.apply(q,[this].concat(t)),this.$OzCalendarEventShowMoreDialog1=function(v,w){var x=null,y="",z=null,A=new Date(v),B=new Date(w),C=A.getDate()==B.getDate()&&A.getMonth()==B.getMonth(),D=Math.floor((B-A)/(1e3*60*60))>13;if(!D||!C){x=c("formatDate")(A,C?"g:ia":"D M j, g:ia");y=c("formatDate")(B,C?"g:ia":"D M j, g:ia");z=x+(C?" - ":"\n")+y}else z="All day";return c("React").createElement("div",{className:"_33-c"},z)},r}p.prototype.render=function(){"use strict";var q=this.props.events.map(function(r){return c("React").createElement("div",{key:r.identifier,className:"_33-4"},this.$OzCalendarEventShowMoreDialog1(r.startDate,r.endDate),c("React").createElement("div",{className:"_33-b"},c("React").createElement("span",null,this.props.calendarBusy?r.title+"\n"+r.location:"Busy")))}.bind(this));return c("React").createElement(c("XUIDialog.react"),{shown:true,width:500,onToggle:this.props.onToggle},c("React").createElement(c("XUIDialogTitle.react"),null,q.length+" events on "+this.props.date.toDateString()),c("React").createElement(c("XUIDialogBody.react"),null,q))};p.propTypes={events:k.array.isRequired,date:k.instanceOf(Date).isRequired,onToggle:k.func,calendarBusy:k.bool};f.exports=m}),null);
__d("OzThreadMeta.react",["cx","OzAPI","OzHelpers","immutable","Keys","MessengerButtonReact.bs","OzFormPreview.react","OzThreadLabels.react","OzStores","OzSwitch.react","OzImmutablePureRenderMixin","React","Reflux","Tooltip","OzCalendarModal.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("MessengerButtonReact.bs").jsComponent,j=c("immutable").Map,k=c("OzFormPreview.react").Row,l=c("OzThreadLabels.react").OzUnderageLabel,m=c("React").PropTypes,n=c("OzStores").CalendarEventStore,o=c("React").createClass({displayName:"OzThreadMeta",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(n,"calendarEvents")],propTypes:{thread:m.object.isRequired,repNames:m.instanceOf(j).isRequired},getInitialState:function x(){return{newMeta:null,muted:w(this.props.thread),calendarShown:false}},componentWillReceiveProps:function x(y){if(c("OzHelpers").threadID(y.thread)!==c("OzHelpers").threadID(this.props.thread))this.setState({newMeta:null,muted:w(y.thread),locked:y.thread.get("locked")});else this.setState({muted:w(y.thread),locked:y.thread.get("locked")})},render:function x(){var y=c("OzHelpers").threadID(this.props.thread),z=this.state.calendarEvents.get(y,[]),A=[["Cancel","secondary",this._handleCancel],["DONE","primary",this._handleDone]],B=["Edit","primary",this._handleEdit],C=z&&z.length?[["Calendar","primary",this._handleCalendar],B]:[B],D=this.state.newMeta?A:C;return c("React").createElement("div",{className:"_56t0"+(this.state.newMeta?" _56t1":"")},this.state.calendarShown&&c("React").createElement(c("OzCalendarModal.react"),{events:z,onClose:this._onCalendarClose}),c("React").createElement(p,{thread:this.props.thread,buttons:D}),this.state.newMeta?c("React").createElement(t,{meta:this.state.newMeta,onCancel:this._handleCancel,onChange:this._handleChange,onDone:this._handleDone,onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}):c("React").createElement(r,{meta:v(this.props.thread),onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}),c("React").createElement(s,{thread:this.props.thread,repNames:this.props.repNames,locked:!!this.state.locked,onToggle:this._handleThreadLockToggle}))},_handleEdit:function x(){this.setState({newMeta:v(this.props.thread)})},_handleCancel:function x(){this.setState({newMeta:null})},_handleDone:function x(){c("OzAPI").saveMeta(c("OzHelpers").threadID(this.props.thread),this.state.newMeta);this.setState({newMeta:null})},_handleChange:function x(y){this.setState({newMeta:y})},_handleMutedToggle:function x(y){c("OzAPI").saveMuted(c("OzHelpers").threadID(this.props.thread),!y);this.setState({muted:!y})},_handleThreadLockToggle:function x(y){var z=this.props.thread,A=c("OzHelpers").threadID(z);if(this.state.locked){this.setState({locked:false});c("OzAPI").unlockThread(A,z.get("locked-at"))}else{this.setState({locked:true});c("OzAPI").lockThread(A)}},_handleCalendar:function x(){var y=this.props.thread,z=c("OzHelpers").threadID(y);c("OzAPI").fetchCalendar(z);this.setState({calendarShown:true})},_onCalendarClose:function x(){this.setState({calendarShown:false})}}),p=c("OzHelpers").pure(function(x){var y=x.thread,z=x.buttons;return c("React").createElement("div",{className:"_56t2"},c("React").createElement("div",{className:"_56t6"},c("React").createElement("h2",{className:"_56tb"},c("OzHelpers").getName(y)),c("React").createElement("div",{className:"_56tc"},z.map(function(A,B){var C=A[0],D=A[1],E=A[2];return c("React").createElement(i,{key:C,label:C,type:D,onClick:E})}))),c("React").createElement("div",{className:"_56td"},c("React").createElement(l,{thread:y})))}),q=c("OzHelpers").pure(function(x){var w=x.isMuted,y=x.onMutedToggle,z=function z(C){y(w)},A="Uncheck if person dislikes our proactive messages, e.g. surveys",B=c("React").createElement("span",c("Tooltip").propsFor(A),"Proactive?");return c("React").createElement(k,{label:B},c("React").createElement("input",{type:"checkbox",checked:!w,onChange:z}))}),r=c("OzHelpers").pure(function(x){var v=x.meta,w=x.isMuted,y=x.onMutedToggle,z=(v.get("address1","")+" "+v.get("address2","")+"\n     "+v.get("city","")+" "+v.get("state","")+" "+v.get("zip","")+"\n    ").trim();return c("React").createElement(c("OzFormPreview.react"),null,c("React").createElement(k,{label:"Nickname"},v.get("preferred-name")),c("React").createElement(k,{label:"Email"},v.get("email")),c("React").createElement(k,{label:"Phone"},v.get("phone")),c("React").createElement(k,{label:"Address"},z),c("React").createElement(k,{label:"Device OS"},v.get("os-type")),c("React").createElement(k,{label:"App Version"},v.get("app-version")),c("React").createElement(q,{isMuted:w,onMutedToggle:y}))}),s=c("OzHelpers").pure(function(x){var y=x.thread,z=x.repNames,A=x.locked,B=x.onToggle,C=z.get(y.get("locker-id")),D=C?(y.get("locked")?"Locked":"Last locked")+" by "+C:"";D+=D&&y.get("locked-at")?" at "+new Date(y.get("locked-at")).toLocaleString():"";var E=c("React").createElement("span",c("Tooltip").propsFor(D),A?"Click to unlock thread":"Click to lock thread");return c("React").createElement(c("OzSwitch.react"),{className:"_z1m",isAnimated:true,reverseColors:true,isOn:A,label:E,onToggle:B})}),t=c("React").createClass({displayName:"EditView",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{meta:m.instanceOf(j).isRequired,onCancel:m.func.isRequired,onChange:m.func.isRequired,onDone:m.func.isRequired,isMuted:m.bool.isRequired,onMutedToggle:m.func.isRequired},componentDidMount:function x(){this.refs["preferred-name"].focus()},render:function x(){var y=this._renderRow;return c("React").createElement("form",{className:"_56to",onKeyDown:this._handleKeyDown},c("React").createElement(u,null,y("Nickname","preferred-name","Add Preferred Name")),c("React").createElement(u,null,y("Email","email","Add email")),c("React").createElement(u,null,y("Phone","phone","Add phone")),c("React").createElement(u,null,y("Street","address1","Add Street"),y("Street","address2","Add Street"),y("City","city","Add City"),y("State","state"),y("Zip Code","zip")),c("React").createElement(u,null,c("React").createElement(q,{isMuted:this.props.isMuted,onMutedToggle:this.props.onMutedToggle})))},_handleKeyDown:function x(y){y.which===c("Keys").ESC?this.props.onCancel():y.which===c("Keys").RETURN?this.props.onDone():null},_renderRow:function x(y,z,A){var B=this.props,v=B.meta,C=B.onChange;return c("React").createElement(k,{label:y},c("React").createElement("input",{ref:z,type:"text",className:"_1-i0 _56uv",placeholder:A,value:v.get(z),onChange:function D(E){return C(v.set(z,E.target.value))}}))}}),u=c("OzHelpers").pure(function(x){var y=x.children;return c("React").createElement("div",{className:"_56vn"},y)});function v(x){return x.get("metadata-json")||j()}function w(x){return!!x.get("muted")}f.exports=o}),null);
__d("OzThreadNote.react",["cx","OzAPI","getActiveElement","OzHelpers","immutable","OzConfig","OzRequirementTokenizer.react","React","Reflux"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("React").PropTypes,k=1e3,l=c("React").createClass({displayName:"OzThreadNote",mixins:[c("Reflux").connect(c("OzConfig").ConfigStore,"config")],propTypes:{thread:j.instanceOf(i).isRequired,requirements:j.instanceOf(i).isRequired,timeline:j.bool},getDefaultProps:function m(){return{timeline:false}},getInitialState:function m(){return{editedText:this.props.thread.get("notes")||""}},componentWillReceiveProps:function m(n){var o=n.thread.get("notes"),p=c("getActiveElement")()===this.refs.textarea;if(o!==this.props.thread.get("notes")&&!p)this.setState({editedText:o})},render:function m(){var n=this.props,o=n.requirements,p=n.thread,q=n.timeline;return c("React").createElement("div",{className:"_1x92"},c("React").createElement("h2",{className:"_1x93"},"Thread Notes"),c("React").createElement("div",{className:"_41v4"},c("React").createElement(c("OzRequirementTokenizer.react"),{allRequirements:o,onDeleteRequirement:this._handleDeleteRequirement,onCreateRequirement:this._handleCreateRequirement,selectedRequirements:p.get("requirements"),placeholder:"Add a user tag...",timeline:q})),c("React").createElement("textarea",{ref:"textarea",className:"_1x95"+(this.props.timeline?" _11_w":""),placeholder:"Leave a note",value:this.state.editedText,onChange:this._handleChange}))},_handleChange:function m(){var n=this.props.thread,o=this.refs.textarea.value;this.setState({editedText:o});window.clearTimeout(this.timeout);this.timeout=window.setTimeout(function(){c("OzAPI").saveNote(c("OzHelpers").threadID(n),o)},k)},_handleCreateRequirement:function m(n){var o=this.props.thread;c("OzAPI").createThreadRequirement(c("OzHelpers").threadID(o),n.get("name"))},_handleDeleteRequirement:function m(n){var o=this.props.thread;c("OzAPI").deleteThreadRequirement(c("OzHelpers").threadID(o),n.get("id"))}});f.exports=l}),null);
__d("OzTimeline.react",["csx","cx","OzAPI","OzHelpers","immutable","OzActions","OzDate.react","OzStores","ozFormatTime","OzImmutablePureRenderMixin","React","ReactRouter","Reflux"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j=c("immutable").Map,k=c("immutable").List,l=c("React").PropTypes,m=c("ReactRouter").Link,n=c("OzStores").ActiveThreadStore,o=j({"send-email":"sent email","receive-email":"received email","send-calendar":"sent invite","completed-call":"phone call"}),p=c("React").createClass({displayName:"OzTimeline",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(n,"activeThread")],propTypes:{closedIntents:l.instanceOf(k).isRequired,events:l.instanceOf(k).isRequired,tasks:l.instanceOf(k).isRequired},contextTypes:{router:l.object.isRequired},componentDidMount:function w(){this._scrollTimeline();this._timeUpdateInterval=window.setInterval(function(x){return this.setState({time:c("OzHelpers").serverNow()})}.bind(this),6e4)},componentDidUpdate:function w(){this._scrollTimeline()},_scrollTimeline:function w(){var x=document.querySelector("._415b");if(x)x.scrollIntoView(true);var y=document.querySelector("._2mg4");if(y)y.scrollIntoView(true)},componentWillUnmount:function w(){window.clearInterval(this._timeUpdateInterval)},getInitialState:function w(){return{time:c("OzHelpers").serverNow()}},render:function w(){var x=this._sortedItems();return c("React").createElement("div",{className:"_201k"},c("React").createElement("div",{className:"_201l"},"Activity & tasks"),c("React").createElement("div",{className:"_4fj7 _201m",ref:"scrollable"},x.map(this._renderTimelineElement),c("React").createElement("div",{key:"OzTimelineSpacer",className:"_415b"})))},_sortedItems:function w(){var x=this.props,y=x.events,z=x.tasks,A=x.closedIntents;return y.filter(function(B){return o.has(B.get("type"))}).map(function(B){return B.set("item-type","event")}).concat(z.map(function(B){return B.set("item-type","task")})).concat(A.map(function(B){return B.set("item-type","intent").set("intent-id",B.get("id"))})).sortBy(v)},_renderTimelineElement:function w(x){var y=this.state,z=y.activeThread,A=y.time,B=this.props.tasks,C=x.get("item-type")+"-"+x.get("id");switch(x.get("item-type")){case"event":return c("React").createElement(r,{key:C,event:x,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply,onInviteView:this._handleInviteView,activeThread:z});case"task":return c("React").createElement(s,{key:C,task:x,activeThread:z,time:A});case"intent":return c("React").createElement(t,{key:C,intent:x,tasks:B,activeThread:z});default:c("OzHelpers").err("unknown item",x);return null}},_handleEmailView:function w(x){c("OzActions").emailComposer.add(babelHelpers["extends"]({},c("OzHelpers").eventToEmail(x),{disabled:true}))},_handleEmailReply:function w(x){c("OzActions").emailComposer.add(c("OzHelpers").eventToEmail(c("OzHelpers").reEmail(x)))},_handleInviteView:function w(x){c("OzActions").inviteComposer.add(c("OzHelpers").eventToInvite(x))},_handleCallPlay:function w(x){return c("OzAPI").everstoreURI(x).then(function(y){return window.open(y)})}}),q=c("OzHelpers").pure(function(w){var x=w.activeThread,y=w.contents,z=w.item,A=w.onClick,B=w.path,C=w.status,D=w.summary,E=z.get("intent-id")===x.get("activeIntent"),F=z.get("id")===x.get(z.get("item-type")==="task"?"activeTask":"activeEvent");C=C||"completed";return c("React").createElement(m,{to:B,className:"_8i9"+(E?" _8ia":"")+(!E?" _8ib":"")+(F?" _2mg4":"")+(C==="pending"?" _4rsf":"")+(C==="completed"?" _4rsg":"")+(C==="close"?" _4rsj":"")+(C==="late"?" _4rsm":"")},c("React").createElement("div",{className:"_8id"}),c("React").createElement("div",{className:"_201o"}),c("React").createElement("div",{className:"_201p"},c("React").createElement("div",{className:"_201r"},z.get("intent-name")),c("React").createElement("div",{className:"_8ie"},D||"[Untitled]"),c("React").createElement("div",{className:"_2022"},C!=="completed"?"Due: ":null,c("React").createElement(c("OzDate.react"),{className:"_1qdh",timestamp:v(z)}))))},"OzTimelineItem"),r=c("OzHelpers").pure(function(w){__p&&__p();var x=w.activeThread,event=w.event,y=w.onCallPlay,z=w.onEmailReply,A=w.onEmailView,B=w.onInviteView,C=event.get("type"),D;switch(C){case"send-email":D="Email to "+event.getIn(["data","to"]).join(", ");break;case"receive-email":D="Email from "+event.getIn(["data","from"]);break;case"send-calendar":if(event.hasIn(["data","place-id"]))D="Invite bubble";else D="Invite to "+event.getIn(["data","to"]).join(", ");break;case"completed-call":var E=event.get("data"),F={"in":"Call from ",out:"Call to ",voicemail:"Voicemail from "}[E.get("direction")],G=c("OzHelpers").parsePhoneNumber(E.get("remote-phone")),H=E.get("RecordingDuration"),I=E.get("recording-ev-handle");D=F+G;break;default:D="Another event"}return c("React").createElement(q,{activeThread:x,path:c("OzHelpers").threadPath({threadid:event.get("user-id"),intentid:event.get("intent-id"),eventid:event.get("id")}),item:event,summary:D})},"OzTimelineEvent"),s=c("OzHelpers").pure(function(w){__p&&__p();var x=w.task,y=w.time,z=w.activeThread,A=function A(x){switch(x.get("type")){case"reminder":return x.getIn(["data","description"]);default:return x.get("type")}},B;if(c("OzHelpers").isCompletedTask(x))B="completed";else if(x.get("start-at")>y)B="pending";else if(x.get("deadline")>y)B="close";else B="late";var C=c("React").createElement("div",null,x.getIn(["data","notes"]));return c("React").createElement(q,{activeThread:z,path:c("OzHelpers").threadPath({threadid:x.get("user-id"),intentid:x.get("intent-id"),taskid:x.get("id")}),item:x,status:B,summary:A(x),contents:C})},"OzTimelineTask"),t=c("OzHelpers").pure(function(w){var x=w.intent,y=w.activeThread,z=w.tasks,A="Closed: "+x.get("alias",x.get("name")),B=c("OzHelpers").nextTaskForIntent(x,z);return c("React").createElement(q,{activeThread:y,path:c("OzHelpers").threadPath({threadid:x.get("user-id"),intentid:x.get("id"),taskid:B&&B.get("id")}),item:x,summary:A})}),u=j({event:"timestamp",task:"deadline",separator:"timestamp",intent:"closed-at"});function v(w){var x=u.get(w.get("item-type"));return w.get(x,w.get("created-at"))}f.exports=p}),null);
__d("OzThreadPanel.react",["cx","OzAPI","OzHelpers","immutable","OzConfig","OzHumans","OzEventShow.react","OzIntent.react","OzIntentActions.react","OzIntentList.react","OzIntentTabs.react","OzReminders.react","OzReminderTask.react","OzReminderTasks.react","OzStores","OzTabHeader.react","OzTaskComposers.react","OzTaskShow.react","OzThreadMeta.react","OzThreadNote.react","OzTimeline.react","OzImmutablePureRenderMixin","React","OzWrapper.react","Reflux","XUISelector.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("XUISelector.react").Option,j=c("immutable").Map,k=c("immutable").List,l=c("immutable").Set,m=c("React").PropTypes,n=c("OzStores").ActiveThreadStore,o="NO_OWNER",p="TODO",q="HISTORY",r=c("React").createClass({displayName:"OzThreadPanel",mixins:[c("OzImmutablePureRenderMixin"),c("Reflux").connect(c("OzConfig").ConfigStore,"config"),c("Reflux").connect(n,"activeThread"),c("Reflux").listenTo(n,"onActiveIntentChange")],onActiveIntentChange:function u(v){if(v.get("activeIntent")&&!v.get("activeTask")){var w=this._activeTabForIntent();if(w)this.setState({activeTab:w})}},componentWillMount:function u(){var v=this._activeTabForIntent();if(v)this.setState({activeTab:v})},componentWillReceiveProps:function u(v){if(!this.state.activeTab){var w=this._activeTabForIntent();if(w)this.setState({activeTab:w})}},render:function u(){__p&&__p();var v=this.props,w=v.thread,x=v.repNames,y=this.state,z=y.activeTab,A=y.config,B=y.activeThread,C=A.getIn(["GK","timeline"]),D=A.get("display-tasks")||C,E=B.get("activeIntent"),F=B.get("activeTask"),G=B.get("activeEvent"),H=!(C||z!==q),I=c("OzHelpers").intents(w).find(function(S){return S.get("id")===E}),J=H?c("OzHelpers").closedIntents(w).filterNot(c("OzHelpers").isDeleted):I?l(c("OzHelpers").openIntents(w).push(I)).toList():c("OzHelpers").openIntents(w),K=I&&F?(I.get("tasks")||k()).find(function(S){return S.get("id")===F}):null,L=I&&G?(I.get("events")||k()).find(function(S){return S.get("id")===G}):null,M={isHistory:H,repNames:x,thread:w},N=j(J.map(function(S){return[S.get("id"),c("OzHelpers").intentAlias(S)]}).concat(I?[[E,c("OzHelpers").intentAlias(I)]]:[])),O=w.get("tasks",k()).filter(function(S){return I?S.get("intent-id")==I.get("id"):true}).map(function(S){return S.set("intent-name",N.get(S.get("intent-id")))}),P=w.get("tasks",k()).filter(function(S){return S.get("state")!=="completed"}).map(function(S){return S.get("intent-id")}).toSet(),Q=w.get("intents").filter(function(S){return c("OzHelpers").isClosedIntent(S)&&P.get(S.get("id"))}),R=I?I.get("events",j()).valueSeq().map(function(S){return S.set("intent-name",N.get(S.get("intent-id")))}).toList():J.reduce(function(S,T){return S.concat(T.get("events",j()).valueSeq())},k()).map(function(S){return S.set("intent-name",N.get(S.get("intent-id")))});return c("React").createElement("div",{className:"_5l_x"},I&&c("React").createElement(c("OzTaskComposers.react"),{intent:I}),C?c("React").createElement(c("OzIntentTabs.react"),{intents:c("OzHelpers").openIntents(w).concat(Q),tasks:O,activeIntentId:E,threadId:w.get("user-id")}):null,c("React").createElement("div",{className:"_1c1k"+(C?" _5mt9":"")},c("React").createElement("div",{className:"_5l_y"},!C&&c("React").createElement(c("OzTabHeader.react"),{active:z,tabs:[["Todo",p],["History",q]],onChange:this._handleTabChange}),c("React").createElement("div",{className:"_5l_z"+(C?" _5mt9":"")},C?c("React").createElement(c("OzTimeline.react"),{events:R,tasks:O,closedIntents:!E?c("OzHelpers").closedIntents(w):k()}):c("React").createElement("div",{className:"_4fj7"},c("React").createElement(c("OzIntentList.react"),{intents:J,activeIntentId:B.get("activeIntent"),witIntents:this.props.witIntents,isHistory:H,timelineGK:C}))),H||!C?c("React").createElement("div",{className:"_4sm5"},D?c("React").createElement(c("OzReminderTasks.react"),M):c("React").createElement(c("OzReminders.react"),M)):null),c("React").createElement("div",{className:"_5l_-"+(C?" _11_w":"")+(C?" _5mt9":"")},c("React").createElement("div",{className:"_5l__"},c("React").createElement("div",{className:"_4fj7"},I?c("React").createElement(c("OzIntent.react"),{intent:I,key:"intent-"+I.get("id"),location:w.get("location")||j(),repNames:x,requirements:this.props.requirements,timelineGK:C,thread:w}):null,C&&K?c("React").createElement(c("OzTaskShow.react"),{key:"task-"+K.get("id"),location:w.get("location")||j(),onCancel:this._handleCancelTask,onComplete:this._handleCompleteTask,onSave:this._handleSaveTask,onOpen:this._handleOpenTask,task:K}):L?c("React").createElement(c("OzEventShow.react"),{key:"event-"+L.get("id"),activeIntent:I,event:L}):null)),!C&&c("React").createElement("div",null,c("React").createElement(c("OzThreadNote.react"),{key:c("OzHelpers").threadID(w),thread:w,requirements:this.props.requirements}),c("React").createElement(c("OzThreadMeta.react"),{thread:w,repNames:x}),c("React").createElement(s,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:w})))),C&&c("React").createElement("div",{className:"_5mtb"},c("React").createElement("div",null,c("React").createElement(c("OzThreadMeta.react"),{thread:w,repNames:x}),c("React").createElement(s,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:w})),c("React").createElement(c("OzThreadNote.react"),{key:c("OzHelpers").threadID(w),thread:w,timeline:C,requirements:this.props.requirements})))},_activeTab:function u(){return this.state.activeTab||p},_activeTabForIntent:function u(){var v=this.state.activeThread.get("activeIntent"),w=this.props.thread.get("intents",k()),x=v?w.find(function(y){return y.get("id")===v}):null;if(x)if(c("OzHelpers").isClosedIntent(x))return q;else return p},_handleTabChange:function u(v){var w=v[0],x=v[1];this.setState({activeTab:x})},_handleSaveTask:function u(v){return c("OzAPI").editTask(c("OzHelpers").threadID(this.props.thread),v)},_handleCompleteTask:function u(v){return c("OzAPI").completeTask(c("OzHelpers").threadID(this.props.thread),v)},_handleCancelTask:function u(v){var w=arguments.length<=1||arguments[1]===undefined?false:arguments[1];return c("OzAPI").cancelTask(c("OzHelpers").threadID(this.props.thread),v,w)},_handleOpenTask:function u(v){return c("OzAPI").openTask(c("OzHelpers").threadID(this.props.thread),v)}}),s=c("OzHelpers").pure(function(u){var v=u.onOwnerChange,w=u.humans,x=u.reps,y=u.thread,z=y,A=c("OzHelpers").nameOrId(z.get("last-owner")).split(" ")[0];return c("React").createElement("div",{className:"_5m00"},x&&!x.isEmpty()?c("React").createElement(t,{onChange:v,value:z.getIn(["owner","id"])||o,reps:x,humans:w}):null,c("React").createElement("span",{className:"_5m01"},A?"Last owner: "+A:null))}),t=c("OzHelpers").pure(function(u){__p&&__p();var v=u.reps,w=u.humans,x=u.value,y=u.onChange,z=v.toSeq().filter(function(D){return c("OzHumans").isActive(w.get(D.get("fbid")))}).sortBy(function(D){return D.get("name")}).map(function(D){var E=D.get("fbid"),C=D.get("is-coach",false)?"_5m02":"";return c("React").createElement(i,{key:E,value:E},c("React").createElement("span",{className:C},D.get("name")))}),A=z.get(x);z=z.valueSeq();if(!A){var B=v.get(x,j()),C=B.get("is-coach",false)?"_5m02":"";z=z.toList().unshift(c("React").createElement(i,{key:"current",value:x},c("React").createElement("span",{className:C},B.get("name","None"))))}return c("React").createElement(c("XUISelector.react"),{size:"medium",value:x,onChange:y,maxheight:500},z)});f.exports=c("OzWrapper.react")(r)}),null);
__d("OzTop.react",["cx","OzAPI","OzHelpers","MessengerFlexScrollableArea.react","React","relativeTimeString.atlas","XUITextInput.react","SRTAdvancedDataTable.react","escapeRegex","ObjectSort","ReactRouter"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("ReactRouter").Link,l=[{id:"priority",label:"Priority",sortable:true,comparator:function n(o,p){return c("OzHelpers").compareBools(o.priority,p.priority)},cellRenderer:function n(o){return c("React").createElement("span",{className:o?"_1nnl":""},o?"yes":"no")}},{id:"trainer",label:"Trainer",sortable:true,comparator:c("ObjectSort").getStringSortFunction("trainer")},{id:"trainer-load",label:"Load",sortable:true,comparator:c("ObjectSort").getReverseNumericSortFunction("trainer-load"),isNumeric:true,cellRenderer:function n(o){return c("React").createElement("div",{className:o>3?"_1nnl":""},o?o:"Not present")}},{id:"trainer-team",label:"Team",sortable:true,comparator:c("ObjectSort").getStringSortFunction("trainer-team")},{id:"user-name",label:"User name",sortable:true,comparator:c("ObjectSort").getStringSortFunction("user-name"),cellRenderer:function n(o,p,q){return c("React").createElement(k,{target:"blank",to:c("OzHelpers").threadPath({threadid:q["user-id"]})},o)}},{id:"external",label:"External",sortable:true,comparator:function n(o,p){return c("OzHelpers").compareBools(o.external,p.external)},cellRenderer:function n(o){return c("React").createElement("span",null,o?"external":"internal")}},{id:"vip",label:"Vip",sortable:true,comparator:function n(o,p){return c("OzHelpers").compareBools(o.vip,p.vip)},cellRenderer:function n(o){return c("React").createElement("span",null,o?"yes":"no")}},{id:"name",label:"Type",sortable:true,comparator:c("ObjectSort").getStringSortFunction("name"),cellRenderer:function n(o,p,q){return c("React").createElement(k,{target:"blank",to:c("OzHelpers").threadPath({threadid:q["user-id"],intentid:q.id})},o)}},{id:"blocked",label:"Status",sortable:true,comparator:function n(o,p){return c("OzHelpers").compareBools(o.blocked,p.blocked)},cellRenderer:function n(o){return c("React").createElement("span",null,o?"waiting":"open")}},{id:"created-at",label:"Open",sortable:true,comparator:c("ObjectSort").getReverseNumericSortFunction("created-at"),isNumeric:true,cellRenderer:function n(o){return c("relativeTimeString.atlas")(o,true)}},{id:"ir",label:"IR",sortable:true,comparator:c("ObjectSort").getReverseNumericSortFunction("ir"),isNumeric:true,cellRenderer:function n(o,p,q){return c("React").createElement("div",null,o===0?"**":o)}},{id:"cr",label:"Current CR (s)",sortable:true,comparator:c("ObjectSort").getReverseNumericSortFunction("cr"),isNumeric:true,cellRenderer:function n(o){return c("React").createElement("div",null,o===0?"**":o)}}];i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={items:[],filterText:""},this.$OzTop2=function(s){var t=s.trim().replace(/ +/g," ").split(" "),u=new RegExp(t.map(c("escapeRegex")).join(".* .*"),"i");return function(v){return u.test(v.name)||u.test(v["user-name"])||u.test(v["trainer-team"])||u.test(v.trainer)||u.test(v["user-id"])||u.test(v.id)}},this.$OzTop3=function(event){this.setState({filterText:event.target.value});this.refs.theTable.setFilter(this.$OzTop2(event.target.value))}.bind(this),o}m.prototype.componentWillMount=function(){var n=function(){return c("OzAPI").topIntents().then(function(o){return this.setState({items:o.toJS()})}.bind(this))}.bind(this);n();this.$OzTop1=setInterval(n,30*1e3)};m.prototype.componentWillUnmount=function(){clearInterval(this.$OzTop1)};m.prototype.render=function(){return c("React").createElement("div",null,c("React").createElement("div",null,c("React").createElement("label",null,"Filter:"," ",c("React").createElement(c("XUITextInput.react"),{onChange:this.$OzTop3,value:this.state.filterText})),c("React").createElement("span",null,this.state.items.length," open intents")),c("React").createElement(c("MessengerFlexScrollableArea.react"),null,c("React").createElement(c("SRTAdvancedDataTable.react"),{ref:"theTable",rowKeyField:"id",outerBorder:true,columns:l,rows:this.state.items,enableSelection:false})))};f.exports=m}),null);
__d("OzTrainerDashboard.react",["cx","OzHelpers","relativeTimeString.atlas","immutable","OzButton.react","OzHumans","OzStores","OzImmutablePureRenderMixin","React","Reflux","XUITable.react"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("immutable").Map,j=c("OzStores").HumanStore,k=c("React").PropTypes,l=c("React").createClass({displayName:"OzTrainerDashboard",mixins:[c("Reflux").connect(j,"humans")],contextTypes:{router:k.object.isRequired},render:function q(){return c("React").createElement(m,{onThreadSelect:this._handleThreadSelect,humans:this.state.humans,reps:this.props.reps})},_handleThreadSelect:function q(r){this.context.router.push("inbox/"+r)}}),m=c("React").createClass({displayName:"Main",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onThreadSelect:k.func.isRequired,humans:k.instanceOf(i).isRequired,reps:k.instanceOf(i).isRequired},render:function q(){return c("React").createElement("div",{className:"_10cd"},c("React").createElement(c("XUITable.react"),null,c("React").createElement("thead",null,c("React").createElement("tr",null,c("React").createElement("th",null,"Trainer"),c("React").createElement("th",null,"Load"),c("React").createElement("th",null,"Status"),c("React").createElement("th",null,"Team"),c("React").createElement("th",null,"Link to Thread"))),c("React").createElement("tbody",null,this._getHumans().map(function(r){return c("React").createElement(n,{key:r.get("id"),onSelect:this._handleThreadSelect,human:r,rep:this.props.reps.get(r.get("id"))})}.bind(this)))))},_getHumans:function q(){var r=this.props,s=r.humans,t=r.reps;return s.sortBy(function(u){return t.getIn([u.get("id"),"name"])}).valueSeq()},_handleThreadSelect:function q(r){this.props.onThreadSelect(r.get("tid"))}}),n=c("React").createClass({displayName:"DashboardRow",mixins:[c("OzImmutablePureRenderMixin")],propTypes:{onSelect:k.func.isRequired,human:k.instanceOf(i).isRequired,rep:k.instanceOf(i)},render:function q(){var r=this.props,s=r.onSelect,t=r.human,u=r.rep;return c("React").createElement("tr",null,c("React").createElement("td",null,o(u,t)),c("React").createElement("td",null,t.get("load")),c("React").createElement("td",null,p(t)),c("React").createElement("td",null,t.get("team")),c("React").createElement("td",null,t.get("tid")?c("React").createElement(c("OzButton.react"),{onClick:function v(){return s(t)}},"See Thread"):null))}});function o(q,r){var s=q&&q.get("name")||"Unknown name";return""+s+(c("OzHumans").isCoach(r)?" (Coach)":"")}function p(q){var r=c("relativeTimeString.atlas")(+c("OzHelpers").serverNow()-q.get("inactive-ms",0),true),s=c("OzHumans").isActive(q)?"Active":"Away ("+r+")";return c("OzHumans").inCoachMode(q)?s+" | In Coach Mode":s}f.exports=l}),null);
__d("OzMount",["invariant","OzAPI","OzHelpers","promiseFinally","immutable","Oz.react","OzActions","OzAll.react","OzConfig","OzFeedbackDashboard.react","OzInbox.react","OzInboxShow.react","OzMerchants.react","OzStores","OzThreadPanel.react","OzTop.react","OzTrainerDashboard.react","React","ReactDOM","ReactRouter","URI","OzTwilio","OzServerTime","OzPerformance"],(function a(b,c,d,e,f,g,h){__p&&__p();c("OzTwilio");var i=c("ReactRouter").Route,j=c("ReactRouter").IndexRoute,k=c("ReactRouter").browserHistory,l=c("ReactRouter").match,m=c("ReactRouter").Router,n=c("ReactRouter").Redirect,o=c("OzStores").CalendarEventStore,p={mount:function x(y,z){__p&&__p();z=babelHelpers["extends"]({},z,u());c("OzPerformance").init();c("OzConfig").setConfig(c("immutable").fromJS(z));c("OzHelpers").info("[config]",z);var A=void 0,B=v(c("Oz.react"),{rev:z.rev,uid:z.uid,version:z.API_VERSION,skipToto:z.skipToto==="true",onUnmount:function K(){A&&A()}}),C=function C(K){var L=K.threadid,M=K.intentid,N=K.taskid,O=K.eventid;c("OzHelpers").info("[mount] storeParams",L,M,N,O);var P=M?parseInt(M,10):null;c("OzActions").activateThread({threadID:L,intentID:P,taskID:N?parseInt(N,10):null,eventID:O?parseInt(O,10):null});L&&c("OzAPI").threadFocus(L,P);if(!o.data.get(L))c("OzAPI").fetchCalendar(L)},D=w(c("OzAPI").thread,500),E={},F=function F(K,L,M){__p&&__p();c("OzHelpers").info("[mount] onThreadEnter",K);C(K.params);var N=K.params,O=N.threadid,P=N.intentid;if(O)D(O);if(P)M();else{c("OzHelpers").info("[mount] no intent id; computing");if(O&&E[O]){c("OzHelpers").info("[mount] loading intent from history",O,E[O]);L(c("OzHelpers").threadPath({threadid:O,intentid:E[O]}));M()}else if(O)c("promiseFinally")(D(O).then(function(Q){c("OzHelpers").info("[mount] missing intent; looking for last created");var R=c("OzHelpers").openIntents(Q).maxBy(function(S){return S.get("created-at")});if(R){c("OzHelpers").info("[mount] missing intent; using last created",O,R.get("id"));L(c("OzHelpers").threadPath({threadid:O,intentid:R.get("id")}))}else c("OzHelpers").info("[mount] no intent to pick",O)}),function(Q){return M()}).done();else{c("OzHelpers").warn("[mount] somehow missing threadid",K);M()}}},G=function G(K){c("OzHelpers").info("[mount] onIntentEnter",K);C(K.params);var L=K.params,M=L.threadid,N=L.intentid,O=N?parseInt(N,10):null;M&&O&&(E[M]=O);O&&c("OzAPI").handledEvents(O);c("OzConfig").ConfigStore.data.getIn(["GK","timeline"])&&M&&O&&c("OzAPI").tasksForIntent(O,M)},H=function H(K){c("OzHelpers").info("[mount] onThreadLeave",K);c("OzActions").activateThread({threadID:null,intentID:null,taskID:null})},I=c("React").createElement(i,{component:B},c("React").createElement(i,{path:"/",component:c("OzInbox.react")},c("React").createElement(i,{path:"/inbox/:threadid",component:c("OzInboxShow.react"),onEnter:F,onLeave:H},c("React").createElement(j,{onEnter:function K(L){var M=L.params;return C(M)},component:c("OzThreadPanel.react")}),c("React").createElement(i,{path:"intent/:intentid",component:c("OzThreadPanel.react"),onEnter:G}),c("React").createElement(i,{path:"intent/:intentid/task/:taskid",component:c("OzThreadPanel.react"),onEnter:G}),c("React").createElement(i,{path:"intent/:intentid/event/:eventid",component:c("OzThreadPanel.react"),onEnter:G}))),c("React").createElement(i,{path:"/all",component:c("OzAll.react")}),c("React").createElement(i,{path:"/merchants",component:c("OzMerchants.react")}),c("React").createElement(i,{path:"/top",component:c("OzTop.react")}),c("React").createElement(i,{path:"/feedback",component:c("OzFeedbackDashboard.react")}),c("React").createElement(i,{path:"/trainers",component:c("OzTrainerDashboard.react")}),c("React").createElement(n,{from:"/inbox",to:"/"})),J=function J(){c("ReactDOM").render(c("React").createElement(m,{history:k,routes:I}),y)};J();q(function(){__p&&__p();var K=c("OzConfig").getStaticConfig("skipSky")==="true",L=c("OzConfig").getStaticConfig("skipAPIInit")==="true";c("OzHelpers").info("[sky] connecting to "+z.skyTopic);if(K)c("OzActions").updateLoadingState({component:"skywalker",state:"loading",skip:true});var M=function M(O){__p&&__p();if(typeof A==="function")A();A=c("OzAPI").realTime(z.skyTopic,function(P,Q,R){__p&&__p();if(P){c("OzHelpers").warn("[sky] could not connect: "+P);if(O>0)return M(O-1);else c("OzActions").updateLoadingState({component:"skywalker",state:"failed",error:P,skip:K})}else{c("OzHelpers").info("[sky] connected to "+z.skyTopic+": "+Q.t,Q);c("OzAPI").repsSync();c("OzActions").updateLoadingState({component:"skywalker",state:"loaded",result:{data:Q,token:R},skip:K})}})};M(3);var N=function N(O,P,Q){Q().then(function(R){c("OzActions").updateLoadingState({component:P,state:"loaded",result:R,skip:L})})["catch"](function(R){if(O>0)N(O-1,P,Q);else c("OzActions").updateLoadingState({component:P,state:"failed",error:R,skip:L})}).done()};N(3,"init",c("OzAPI").init);N(3,"wit-intents",c("OzAPI").witIntents);N(3,"merchants",c("OzAPI").merchants);N(3,"humans",c("OzAPI").humans);N(3,"requirements",c("OzAPI").requirements);c("OzServerTime").setup()})}},q=function q(x){__p&&__p();var y;if(window.loaded)x();else(function(){var z=window.onload;if(typeof z=="function")window.onload=function(){try{z.apply(undefined,arguments)}catch(A){c("OzHelpers").log("Exception on window,inload",A)}x.apply(undefined,arguments)};else window.onload=x})()},r=/^ozcfg(.+)/;function s(){var x=new(c("URI"))(window.location.href).getQueryData();Object.keys(x).forEach(function(y){if(r.test(y))localStorage.setItem(y,x[y])})}function t(){var x,y,z,A={};for(x=0;x<localStorage.length;x++){y=localStorage.key(x);z=y.match(r);if(z&&z.length)A[z[1]]=localStorage.getItem(y)}return A}function u(){__p&&__p();s();var x=t(),y,z=document.location.hostname;if(z==="www.oz.wit.ai")y={skyTopic:"oz/all",env:"prod",scubaCategory:"oz_console",PAGE_ID:"881263441913087",API_PATH:"https://www.oz.wit.ai/api"};else if(z==="intern.oz.wit.ai"||!x.API_PATH)y={skyTopic:"oz-staging/all",env:"staging",scubaCategory:"oz_console_dev",PAGE_ID:"506060876211905",API_PATH:"https://intern.oz.wit.ai/api"};else{var A=z.split(".")[1];y={skyTopic:"oz-dev/"+A,env:"dev",scubaCategory:"oz_console_dev",PAGE_ID:"1579802578966277"}}y=babelHelpers["extends"]({},y,x,{API_VERSION:"20151027"});y.API_PATH||h(0);return y}function v(x,y){__p&&__p();var z,A;return A=z=function(){__p&&__p();var B,C;B=babelHelpers.inherits(D,c("React").Component);C=B&&B.prototype;D.prototype.render=function(){"use strict";return c("React").createElement(x,babelHelpers["extends"]({},y,this.props))};function D(){"use strict";B.apply(this,arguments)}return D}(),z.displayName="Curried"+x.displayName,A}var w=function w(x,y){__p&&__p();var z={},A={};return function(B){if(Date.now()-(z[B]||0)<=y&&A[B]){c("OzHelpers").info("[mount/throttle] using result",B,A[B]);return A[B]}else{z[B]=Date.now();c("OzHelpers").info("[mount/throttle] running!",B);return A[B]=x(B)}}};f.exports=p}),null);
__d("OzDev",["OzConfig","immutable","OzActions","OzHelpers","OzNotify","OzAPI","OzMount","OzStores","OzTwilio"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("immutable").Map;function i(m){c("OzConfig").updateConfig(c("immutable").fromJS(m))}function j(){for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];c("OzConfig").updateConfig(h().setIn(n,!c("OzConfig").getInStaticConfig(n)))}function k(){var k=arguments.length<=0||arguments[0]===undefined?true:arguments[0];c("OzConfig").updateConfig(h({devMode:k}))}document.addEventListener("keydown",function(m){__p&&__p();if(m.which===84&&m.ctrlKey)j("display-tasks");if(m.which===89&&m.ctrlKey)j("GK","timeline");if(m.which===82&&m.ctrlKey&&!m.shiftKey)j("GK","responsivenessV2");if(m.which===82&&m.ctrlKey&&m.shiftKey)j("GK","responsivenessExecTime");if(m.which===79&&m.ctrlKey){j("GK","openTableAPI");var n=c("OzConfig").getInStaticConfig(["GK","openTableAPI"]);c("OzNotify").info("openTableAPI set to "+n)}});function l(){var m=["selectAIPick"];m.map(function(n){c("OzActions")[n].listen(function(){for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return c("OzHelpers").debug("[Action]",n,p)})})}l();f.exports={api:c("OzAPI"),actions:c("OzActions"),config:c("OzConfig"),devMode:k,updateConfig:i,toggleConfig:j,h:c("OzHelpers"),mount:c("OzMount"),stores:c("OzStores"),twilio:c("OzTwilio"),notify:c("OzNotify")}}),null);